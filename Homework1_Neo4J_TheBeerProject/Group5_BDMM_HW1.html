<!DOCTYPE html>

<html lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Group5_BDMM_HW1</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .pm { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation.Marker */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
  </style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
 * Mozilla scrollbar styling
 */

/* use standard opaque scrollbars for most nodes */
[data-jp-theme-scrollbars='true'] {
  scrollbar-color: rgb(var(--jp-scrollbar-thumb-color))
    var(--jp-scrollbar-background-color);
}

/* for code nodes, use a transparent style of scrollbar. These selectors
 * will match lower in the tree, and so will override the above */
[data-jp-theme-scrollbars='true'] .CodeMirror-hscrollbar,
[data-jp-theme-scrollbars='true'] .CodeMirror-vscrollbar {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
}

/* tiny scrollbar */

.jp-scrollbar-tiny {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
  scrollbar-width: thin;
}

/* tiny scrollbar */

.jp-scrollbar-tiny::-webkit-scrollbar,
.jp-scrollbar-tiny::-webkit-scrollbar-corner {
  background-color: transparent;
  height: 4px;
  width: 4px;
}

.jp-scrollbar-tiny::-webkit-scrollbar-thumb {
  background: rgba(var(--jp-scrollbar-thumb-color), 0.5);
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:horizontal {
  border-left: 0 solid transparent;
  border-right: 0 solid transparent;
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:vertical {
  border-top: 0 solid transparent;
  border-bottom: 0 solid transparent;
}

/*
 * Lumino
 */

.lm-ScrollBar[data-orientation='horizontal'] {
  min-height: 16px;
  max-height: 16px;
  min-width: 45px;
  border-top: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] {
  min-width: 16px;
  max-width: 16px;
  min-height: 45px;
  border-left: 1px solid #a0a0a0;
}

.lm-ScrollBar-button {
  background-color: #f0f0f0;
  background-position: center center;
  min-height: 15px;
  max-height: 15px;
  min-width: 15px;
  max-width: 15px;
}

.lm-ScrollBar-button:hover {
  background-color: #dadada;
}

.lm-ScrollBar-button.lm-mod-active {
  background-color: #cdcdcd;
}

.lm-ScrollBar-track {
  background: #f0f0f0;
}

.lm-ScrollBar-thumb {
  background: #cdcdcd;
}

.lm-ScrollBar-thumb:hover {
  background: #bababa;
}

.lm-ScrollBar-thumb.lm-mod-active {
  background: #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-thumb {
  height: 100%;
  min-width: 15px;
  border-left: 1px solid #a0a0a0;
  border-right: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-thumb {
  width: 100%;
  min-height: 15px;
  border-top: 1px solid #a0a0a0;
  border-bottom: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-left);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-right);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-up);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-down);
  background-size: 17px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Widget {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
}

.lm-Widget.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.lm-AccordionPanel[data-orientation='horizontal'] > .lm-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  display: flex;
  flex-direction: column;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-CommandPalette-search {
  flex: 0 0 auto;
}

.lm-CommandPalette-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  min-height: 0;
  overflow: auto;
  list-style-type: none;
}

.lm-CommandPalette-header {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-CommandPalette-item {
  display: flex;
  flex-direction: row;
}

.lm-CommandPalette-itemIcon {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemContent {
  flex: 1 1 auto;
  overflow: hidden;
}

.lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemLabel {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-close-icon {
  border: 1px solid transparent;
  background-color: transparent;
  position: absolute;
  z-index: 1;
  right: 3%;
  top: 0;
  bottom: 0;
  margin: auto;
  padding: 7px 0;
  display: none;
  vertical-align: middle;
  outline: 0;
  cursor: pointer;
}
.lm-close-icon:after {
  content: 'X';
  display: block;
  width: 15px;
  height: 15px;
  text-align: center;
  color: #000;
  font-weight: normal;
  font-size: 12px;
  cursor: pointer;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-DockPanel {
  z-index: 0;
}

.lm-DockPanel-widget {
  z-index: 0;
}

.lm-DockPanel-tabBar {
  z-index: 1;
}

.lm-DockPanel-handle {
  z-index: 2;
}

.lm-DockPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-DockPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-DockPanel-handle[data-orientation='horizontal'] {
  cursor: ew-resize;
}

.lm-DockPanel-handle[data-orientation='vertical'] {
  cursor: ns-resize;
}

.lm-DockPanel-handle[data-orientation='horizontal']:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-DockPanel-handle[data-orientation='vertical']:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

.lm-DockPanel-overlay {
  z-index: 3;
  box-sizing: border-box;
  pointer-events: none;
}

.lm-DockPanel-overlay.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Menu {
  z-index: 10000;
  position: absolute;
  white-space: nowrap;
  overflow-x: hidden;
  overflow-y: auto;
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-Menu-content {
  margin: 0;
  padding: 0;
  display: table;
  list-style-type: none;
}

.lm-Menu-item {
  display: table-row;
}

.lm-Menu-item.lm-mod-hidden,
.lm-Menu-item.lm-mod-collapsed {
  display: none !important;
}

.lm-Menu-itemIcon,
.lm-Menu-itemSubmenuIcon {
  display: table-cell;
  text-align: center;
}

.lm-Menu-itemLabel {
  display: table-cell;
  text-align: left;
}

.lm-Menu-itemShortcut {
  display: table-cell;
  text-align: right;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-MenuBar {
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-MenuBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: row;
  list-style-type: none;
}

.lm-MenuBar-item {
  box-sizing: border-box;
}

.lm-MenuBar-itemIcon,
.lm-MenuBar-itemLabel {
  display: inline-block;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-ScrollBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-ScrollBar[data-orientation='horizontal'] {
  flex-direction: row;
}

.lm-ScrollBar[data-orientation='vertical'] {
  flex-direction: column;
}

.lm-ScrollBar-button {
  box-sizing: border-box;
  flex: 0 0 auto;
}

.lm-ScrollBar-track {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  flex: 1 1 auto;
}

.lm-ScrollBar-thumb {
  box-sizing: border-box;
  position: absolute;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-SplitPanel-child {
  z-index: 0;
}

.lm-SplitPanel-handle {
  z-index: 1;
}

.lm-SplitPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-SplitPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle {
  cursor: ew-resize;
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle {
  cursor: ns-resize;
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-TabBar[data-orientation='horizontal'] {
  flex-direction: row;
  align-items: flex-end;
}

.lm-TabBar[data-orientation='vertical'] {
  flex-direction: column;
  align-items: flex-end;
}

.lm-TabBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex: 1 1 auto;
  list-style-type: none;
}

.lm-TabBar[data-orientation='horizontal'] > .lm-TabBar-content {
  flex-direction: row;
}

.lm-TabBar[data-orientation='vertical'] > .lm-TabBar-content {
  flex-direction: column;
}

.lm-TabBar-tab {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
  overflow: hidden;
  touch-action: none; /* Disable native Drag/Drop */
}

.lm-TabBar-tabIcon,
.lm-TabBar-tabCloseIcon {
  flex: 0 0 auto;
}

.lm-TabBar-tabLabel {
  flex: 1 1 auto;
  overflow: hidden;
  white-space: nowrap;
}

.lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
}

.lm-TabBar-tab.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar-addButton.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab {
  position: relative;
}

.lm-TabBar.lm-mod-dragging[data-orientation='horizontal'] .lm-TabBar-tab {
  left: 0;
  transition: left 150ms ease;
}

.lm-TabBar.lm-mod-dragging[data-orientation='vertical'] .lm-TabBar-tab {
  top: 0;
  transition: top 150ms ease;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab.lm-mod-dragging {
  transition: none;
}

.lm-TabBar-tabLabel .lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
  background: inherit;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabPanel-tabBar {
  z-index: 1;
}

.lm-TabPanel-stackedPanel {
  z-index: 0;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapse {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

.jp-Collapse-header {
  padding: 1px 12px;
  background-color: var(--jp-layout-color1);
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  text-transform: uppercase;
  user-select: none;
}

.jp-Collapser-icon {
  height: 16px;
}

.jp-Collapse-header-collapsed .jp-Collapser-icon {
  transform: rotate(-90deg);
  margin: auto 0;
}

.jp-Collapser-title {
  line-height: 25px;
}

.jp-Collapse-contents {
  padding: 0 12px;
  background-color: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* This file was auto-generated by ensureUiComponents() in @jupyterlab/buildutils */

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

/* Icons urls */

:root {
  --jp-icon-add-above: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5MikiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik00Ljc1IDQuOTMwNjZINi42MjVWNi44MDU2NkM2LjYyNSA3LjAxMTkxIDYuNzkzNzUgNy4xODA2NiA3IDcuMTgwNjZDNy4yMDYyNSA3LjE4MDY2IDcuMzc1IDcuMDExOTEgNy4zNzUgNi44MDU2NlY0LjkzMDY2SDkuMjVDOS40NTYyNSA0LjkzMDY2IDkuNjI1IDQuNzYxOTEgOS42MjUgNC41NTU2NkM5LjYyNSA0LjM0OTQxIDkuNDU2MjUgNC4xODA2NiA5LjI1IDQuMTgwNjZINy4zNzVWMi4zMDU2NkM3LjM3NSAyLjA5OTQxIDcuMjA2MjUgMS45MzA2NiA3IDEuOTMwNjZDNi43OTM3NSAxLjkzMDY2IDYuNjI1IDIuMDk5NDEgNi42MjUgMi4zMDU2NlY0LjE4MDY2SDQuNzVDNC41NDM3NSA0LjE4MDY2IDQuMzc1IDQuMzQ5NDEgNC4zNzUgNC41NTU2NkM0LjM3NSA0Ljc2MTkxIDQuNTQzNzUgNC45MzA2NiA0Ljc1IDQuOTMwNjZaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC43Ii8+CjwvZz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjUgOS41VjExLjVMMi41IDExLjVWOS41TDExLjUgOS41Wk0xMiA4QzEyLjU1MjMgOCAxMyA4LjQ0NzcyIDEzIDlWMTJDMTMgMTIuNTUyMyAxMi41NTIzIDEzIDEyIDEzTDIgMTNDMS40NDc3MiAxMyAxIDEyLjU1MjMgMSAxMlY5QzEgOC40NDc3MiAxLjQ0NzcxIDggMiA4TDEyIDhaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5MiI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEwIDEuNTU1NjYpIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg==);
  --jp-icon-add-below: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5OCkiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik05LjI1IDEwLjA2OTNMNy4zNzUgMTAuMDY5M0w3LjM3NSA4LjE5NDM0QzcuMzc1IDcuOTg4MDkgNy4yMDYyNSA3LjgxOTM0IDcgNy44MTkzNEM2Ljc5Mzc1IDcuODE5MzQgNi42MjUgNy45ODgwOSA2LjYyNSA4LjE5NDM0TDYuNjI1IDEwLjA2OTNMNC43NSAxMC4wNjkzQzQuNTQzNzUgMTAuMDY5MyA0LjM3NSAxMC4yMzgxIDQuMzc1IDEwLjQ0NDNDNC4zNzUgMTAuNjUwNiA0LjU0Mzc1IDEwLjgxOTMgNC43NSAxMC44MTkzTDYuNjI1IDEwLjgxOTNMNi42MjUgMTIuNjk0M0M2LjYyNSAxMi45MDA2IDYuNzkzNzUgMTMuMDY5MyA3IDEzLjA2OTNDNy4yMDYyNSAxMy4wNjkzIDcuMzc1IDEyLjkwMDYgNy4zNzUgMTIuNjk0M0w3LjM3NSAxMC44MTkzTDkuMjUgMTAuODE5M0M5LjQ1NjI1IDEwLjgxOTMgOS42MjUgMTAuNjUwNiA5LjYyNSAxMC40NDQzQzkuNjI1IDEwLjIzODEgOS40NTYyNSAxMC4wNjkzIDkuMjUgMTAuMDY5M1oiIGZpbGw9IiM2MTYxNjEiIHN0cm9rZT0iIzYxNjE2MSIgc3Ryb2tlLXdpZHRoPSIwLjciLz4KPC9nPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMi41IDUuNUwyLjUgMy41TDExLjUgMy41TDExLjUgNS41TDIuNSA1LjVaTTIgN0MxLjQ0NzcyIDcgMSA2LjU1MjI4IDEgNkwxIDNDMSAyLjQ0NzcyIDEuNDQ3NzIgMiAyIDJMMTIgMkMxMi41NTIzIDIgMTMgMi40NDc3MiAxMyAzTDEzIDZDMTMgNi41NTIyOSAxMi41NTIzIDcgMTIgN0wyIDdaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5OCI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KDEgMS43NDg0NmUtMDcgMS43NDg0NmUtMDcgLTEgNCAxMy40NDQzKSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=);
  --jp-icon-add: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDEzaC02djZoLTJ2LTZINXYtMmg2VjVoMnY2aDZ2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bell: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiPgogICA8cGF0aCBjbGFzcz0ianAtaWNvbjIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzMzMzMzIgogICAgICBkPSJtOCAwLjI5Yy0xLjQgMC0yLjcgMC43My0zLjYgMS44LTEuMiAxLjUtMS40IDMuNC0xLjUgNS4yLTAuMTggMi4yLTAuNDQgNC0yLjMgNS4zbDAuMjggMS4zaDVjMC4wMjYgMC42NiAwLjMyIDEuMSAwLjcxIDEuNSAwLjg0IDAuNjEgMiAwLjYxIDIuOCAwIDAuNTItMC40IDAuNi0xIDAuNzEtMS41aDVsMC4yOC0xLjNjLTEuOS0wLjk3LTIuMi0zLjMtMi4zLTUuMy0wLjEzLTEuOC0wLjI2LTMuNy0xLjUtNS4yLTAuODUtMS0yLjItMS44LTMuNi0xLjh6bTAgMS40YzAuODggMCAxLjkgMC41NSAyLjUgMS4zIDAuODggMS4xIDEuMSAyLjcgMS4yIDQuNCAwLjEzIDEuNyAwLjIzIDMuNiAxLjMgNS4yaC0xMGMxLjEtMS42IDEuMi0zLjQgMS4zLTUuMiAwLjEzLTEuNyAwLjMtMy4zIDEuMi00LjQgMC41OS0wLjcyIDEuNi0xLjMgMi41LTEuM3ptLTAuNzQgMTJoMS41Yy0wLjAwMTUgMC4yOCAwLjAxNSAwLjc5LTAuNzQgMC43OS0wLjczIDAuMDAxNi0wLjcyLTAuNTMtMC43NC0wLjc5eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-bug-dot: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiPgogICAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTcuMTkgOEgyMFYxMEgxNy45MUMxNy45NiAxMC4zMyAxOCAxMC42NiAxOCAxMVYxMkgyMFYxNEgxOC41SDE4VjE0LjAyNzVDMTUuNzUgMTQuMjc2MiAxNCAxNi4xODM3IDE0IDE4LjVDMTQgMTkuMjA4IDE0LjE2MzUgMTkuODc3OSAxNC40NTQ5IDIwLjQ3MzlDMTMuNzA2MyAyMC44MTE3IDEyLjg3NTcgMjEgMTIgMjFDOS43OCAyMSA3Ljg1IDE5Ljc5IDYuODEgMThINFYxNkg2LjA5QzYuMDQgMTUuNjcgNiAxNS4zNCA2IDE1VjE0SDRWMTJINlYxMUM2IDEwLjY2IDYuMDQgMTAuMzMgNi4wOSAxMEg0VjhINi44MUM3LjI2IDcuMjIgNy44OCA2LjU1IDguNjIgNi4wNEw3IDQuNDFMOC40MSAzTDEwLjU5IDUuMTdDMTEuMDQgNS4wNiAxMS41MSA1IDEyIDVDMTIuNDkgNSAxMi45NiA1LjA2IDEzLjQyIDUuMTdMMTUuNTkgM0wxNyA0LjQxTDE1LjM3IDYuMDRDMTYuMTIgNi41NSAxNi43NCA3LjIyIDE3LjE5IDhaTTEwIDE2SDE0VjE0SDEwVjE2Wk0xMCAxMkgxNFYxMEgxMFYxMloiIGZpbGw9IiM2MTYxNjEiLz4KICAgICAgICA8cGF0aCBkPSJNMjIgMTguNUMyMiAyMC40MzMgMjAuNDMzIDIyIDE4LjUgMjJDMTYuNTY3IDIyIDE1IDIwLjQzMyAxNSAxOC41QzE1IDE2LjU2NyAxNi41NjcgMTUgMTguNSAxNUMyMC40MzMgMTUgMjIgMTYuNTY3IDIyIDE4LjVaIiBmaWxsPSIjNjE2MTYxIi8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bug: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yMCA4aC0yLjgxYy0uNDUtLjc4LTEuMDctMS40NS0xLjgyLTEuOTZMMTcgNC40MSAxNS41OSAzbC0yLjE3IDIuMTdDMTIuOTYgNS4wNiAxMi40OSA1IDEyIDVjLS40OSAwLS45Ni4wNi0xLjQxLjE3TDguNDEgMyA3IDQuNDFsMS42MiAxLjYzQzcuODggNi41NSA3LjI2IDcuMjIgNi44MSA4SDR2MmgyLjA5Yy0uMDUuMzMtLjA5LjY2LS4wOSAxdjFINHYyaDJ2MWMwIC4zNC4wNC42Ny4wOSAxSDR2MmgyLjgxYzEuMDQgMS43OSAyLjk3IDMgNS4xOSAzczQuMTUtMS4yMSA1LjE5LTNIMjB2LTJoLTIuMDljLjA1LS4zMy4wOS0uNjYuMDktMXYtMWgydi0yaC0ydi0xYzAtLjM0LS4wNC0uNjctLjA5LTFIMjBWOHptLTYgOGgtNHYtMmg0djJ6bTAtNGgtNHYtMmg0djJ6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-build: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE0LjkgMTcuNDVDMTYuMjUgMTcuNDUgMTcuMzUgMTYuMzUgMTcuMzUgMTVDMTcuMzUgMTMuNjUgMTYuMjUgMTIuNTUgMTQuOSAxMi41NUMxMy41NCAxMi41NSAxMi40NSAxMy42NSAxMi40NSAxNUMxMi40NSAxNi4zNSAxMy41NCAxNy40NSAxNC45IDE3LjQ1Wk0yMC4xIDE1LjY4TDIxLjU4IDE2Ljg0QzIxLjcxIDE2Ljk1IDIxLjc1IDE3LjEzIDIxLjY2IDE3LjI5TDIwLjI2IDE5LjcxQzIwLjE3IDE5Ljg2IDIwIDE5LjkyIDE5LjgzIDE5Ljg2TDE4LjA5IDE5LjE2QzE3LjczIDE5LjQ0IDE3LjMzIDE5LjY3IDE2LjkxIDE5Ljg1TDE2LjY0IDIxLjdDMTYuNjIgMjEuODcgMTYuNDcgMjIgMTYuMyAyMkgxMy41QzEzLjMyIDIyIDEzLjE4IDIxLjg3IDEzLjE1IDIxLjdMMTIuODkgMTkuODVDMTIuNDYgMTkuNjcgMTIuMDcgMTkuNDQgMTEuNzEgMTkuMTZMOS45NjAwMiAxOS44NkM5LjgxMDAyIDE5LjkyIDkuNjIwMDIgMTkuODYgOS41NDAwMiAxOS43MUw4LjE0MDAyIDE3LjI5QzguMDUwMDIgMTcuMTMgOC4wOTAwMiAxNi45NSA4LjIyMDAyIDE2Ljg0TDkuNzAwMDIgMTUuNjhMOS42NTAwMSAxNUw5LjcwMDAyIDE0LjMxTDguMjIwMDIgMTMuMTZDOC4wOTAwMiAxMy4wNSA4LjA1MDAyIDEyLjg2IDguMTQwMDIgMTIuNzFMOS41NDAwMiAxMC4yOUM5LjYyMDAyIDEwLjEzIDkuODEwMDIgMTAuMDcgOS45NjAwMiAxMC4xM0wxMS43MSAxMC44NEMxMi4wNyAxMC41NiAxMi40NiAxMC4zMiAxMi44OSAxMC4xNUwxMy4xNSA4LjI4OTk4QzEzLjE4IDguMTI5OTggMTMuMzIgNy45OTk5OCAxMy41IDcuOTk5OThIMTYuM0MxNi40NyA3Ljk5OTk4IDE2LjYyIDguMTI5OTggMTYuNjQgOC4yODk5OEwxNi45MSAxMC4xNUMxNy4zMyAxMC4zMiAxNy43MyAxMC41NiAxOC4wOSAxMC44NEwxOS44MyAxMC4xM0MyMCAxMC4wNyAyMC4xNyAxMC4xMyAyMC4yNiAxMC4yOUwyMS42NiAxMi43MUMyMS43NSAxMi44NiAyMS43MSAxMy4wNSAyMS41OCAxMy4xNkwyMC4xIDE0LjMxTDIwLjE1IDE1TDIwLjEgMTUuNjhaIi8+CiAgICA8cGF0aCBkPSJNNy4zMjk2NiA3LjQ0NDU0QzguMDgzMSA3LjAwOTU0IDguMzM5MzIgNi4wNTMzMiA3LjkwNDMyIDUuMjk5ODhDNy40NjkzMiA0LjU0NjQzIDYuNTA4MSA0LjI4MTU2IDUuNzU0NjYgNC43MTY1NkM1LjM5MTc2IDQuOTI2MDggNS4xMjY5NSA1LjI3MTE4IDUuMDE4NDkgNS42NzU5NEM0LjkxMDA0IDYuMDgwNzEgNC45NjY4MiA2LjUxMTk4IDUuMTc2MzQgNi44NzQ4OEM1LjYxMTM0IDcuNjI4MzIgNi41NzYyMiA3Ljg3OTU0IDcuMzI5NjYgNy40NDQ1NFpNOS42NTcxOCA0Ljc5NTkzTDEwLjg2NzIgNC45NTE3OUMxMC45NjI4IDQuOTc3NDEgMTEuMDQwMiA1LjA3MTMzIDExLjAzODIgNS4xODc5M0wxMS4wMzg4IDYuOTg4OTNDMTEuMDQ1NSA3LjEwMDU0IDEwLjk2MTYgNy4xOTUxOCAxMC44NTUgNy4yMTA1NEw5LjY2MDAxIDcuMzgwODNMOS4yMzkxNSA4LjEzMTg4TDkuNjY5NjEgOS4yNTc0NUM5LjcwNzI5IDkuMzYyNzEgOS42NjkzNCA5LjQ3Njk5IDkuNTc0MDggOS41MzE5OUw4LjAxNTIzIDEwLjQzMkM3LjkxMTMxIDEwLjQ5MiA3Ljc5MzM3IDEwLjQ2NzcgNy43MjEwNSAxMC4zODI0TDYuOTg3NDggOS40MzE4OEw2LjEwOTMxIDkuNDMwODNMNS4zNDcwNCAxMC4zOTA1QzUuMjg5MDkgMTAuNDcwMiA1LjE3MzgzIDEwLjQ5MDUgNS4wNzE4NyAxMC40MzM5TDMuNTEyNDUgOS41MzI5M0MzLjQxMDQ5IDkuNDc2MzMgMy4zNzY0NyA5LjM1NzQxIDMuNDEwNzUgOS4yNTY3OUwzLjg2MzQ3IDguMTQwOTNMMy42MTc0OSA3Ljc3NDg4TDMuNDIzNDcgNy4zNzg4M0wyLjIzMDc1IDcuMjEyOTdDMi4xMjY0NyA3LjE5MjM1IDIuMDQwNDkgNy4xMDM0MiAyLjA0MjQ1IDYuOTg2ODJMMi4wNDE4NyA1LjE4NTgyQzIuMDQzODMgNS4wNjkyMiAyLjExOTA5IDQuOTc5NTggMi4yMTcwNCA0Ljk2OTIyTDMuNDIwNjUgNC43OTM5M0wzLjg2NzQ5IDQuMDI3ODhMMy40MTEwNSAyLjkxNzMxQzMuMzczMzcgMi44MTIwNCAzLjQxMTMxIDIuNjk3NzYgMy41MTUyMyAyLjYzNzc2TDUuMDc0MDggMS43Mzc3NkM1LjE2OTM0IDEuNjgyNzYgNS4yODcyOSAxLjcwNzA0IDUuMzU5NjEgMS43OTIzMUw2LjExOTE1IDIuNzI3ODhMNi45ODAwMSAyLjczODkzTDcuNzI0OTYgMS43ODkyMkM3Ljc5MTU2IDEuNzA0NTggNy45MTU0OCAxLjY3OTIyIDguMDA4NzkgMS43NDA4Mkw5LjU2ODIxIDIuNjQxODJDOS42NzAxNyAyLjY5ODQyIDkuNzEyODUgMi44MTIzNCA5LjY4NzIzIDIuOTA3OTdMOS4yMTcxOCA0LjAzMzgzTDkuNDYzMTYgNC4zOTk4OEw5LjY1NzE4IDQuNzk1OTNaIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iOS45LDEzLjYgMy42LDcuNCA0LjQsNi42IDkuOSwxMi4yIDE1LjQsNi43IDE2LjEsNy40ICIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNS45TDksOS43bDMuOC0zLjhsMS4yLDEuMmwtNC45LDVsLTQuOS01TDUuMiw1Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNy41TDksMTEuMmwzLjgtMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-left: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik0xMC44LDEyLjhMNy4xLDlsMy44LTMuOGwwLDcuNkgxMC44eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-right: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik03LjIsNS4yTDEwLjksOWwtMy44LDMuOFY1LjJINy4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-up-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTUuNCwxMy4zIDkuOSw3LjcgNC40LDEzLjIgMy42LDEyLjUgOS45LDYuMyAxNi4xLDEyLjYgIi8+Cgk8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-up: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik01LjIsMTAuNUw5LDYuOGwzLjgsMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-case-sensitive: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWFjY2VudDIiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTcuNiw4aDAuOWwzLjUsOGgtMS4xTDEwLDE0SDZsLTAuOSwySDRMNy42LDh6IE04LDkuMUw2LjQsMTNoMy4yTDgsOS4xeiIvPgogICAgPHBhdGggZD0iTTE2LjYsOS44Yy0wLjIsMC4xLTAuNCwwLjEtMC43LDAuMWMtMC4yLDAtMC40LTAuMS0wLjYtMC4yYy0wLjEtMC4xLTAuMi0wLjQtMC4yLTAuNyBjLTAuMywwLjMtMC42LDAuNS0wLjksMC43Yy0wLjMsMC4xLTAuNywwLjItMS4xLDAuMmMtMC4zLDAtMC41LDAtMC43LTAuMWMtMC4yLTAuMS0wLjQtMC4yLTAuNi0wLjNjLTAuMi0wLjEtMC4zLTAuMy0wLjQtMC41IGMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjdjMC0wLjMsMC4xLTAuNiwwLjItMC44YzAuMS0wLjIsMC4zLTAuNCwwLjQtMC41QzEyLDcsMTIuMiw2LjksMTIuNSw2LjhjMC4yLTAuMSwwLjUtMC4xLDAuNy0wLjIgYzAuMy0wLjEsMC41LTAuMSwwLjctMC4xYzAuMiwwLDAuNC0wLjEsMC42LTAuMWMwLjIsMCwwLjMtMC4xLDAuNC0wLjJjMC4xLTAuMSwwLjItMC4yLDAuMi0wLjRjMC0xLTEuMS0xLTEuMy0xIGMtMC40LDAtMS40LDAtMS40LDEuMmgtMC45YzAtMC40LDAuMS0wLjcsMC4yLTFjMC4xLTAuMiwwLjMtMC40LDAuNS0wLjZjMC4yLTAuMiwwLjUtMC4zLDAuOC0wLjNDMTMuMyw0LDEzLjYsNCwxMy45LDQgYzAuMywwLDAuNSwwLDAuOCwwLjFjMC4zLDAsMC41LDAuMSwwLjcsMC4yYzAuMiwwLjEsMC40LDAuMywwLjUsMC41QzE2LDUsMTYsNS4yLDE2LDUuNnYyLjljMCwwLjIsMCwwLjQsMCwwLjUgYzAsMC4xLDAuMSwwLjIsMC4zLDAuMmMwLjEsMCwwLjIsMCwwLjMsMFY5Ljh6IE0xNS4yLDYuOWMtMS4yLDAuNi0zLjEsMC4yLTMuMSwxLjRjMCwxLjQsMy4xLDEsMy4xLTAuNVY2Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-circle-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDJDNi40NyAyIDIgNi40NyAyIDEyczQuNDcgMTAgMTAgMTAgMTAtNC40NyAxMC0xMFMxNy41MyAyIDEyIDJ6bTAgMThjLTQuNDEgMC04LTMuNTktOC04czMuNTktOCA4LTggOCAzLjU5IDggOC0zLjU5IDgtOCA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-circle: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-clear: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8bWFzayBpZD0iZG9udXRIb2xlIj4KICAgIDxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiIC8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSI4IiBmaWxsPSJibGFjayIvPgogIDwvbWFzaz4KCiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxyZWN0IGhlaWdodD0iMTgiIHdpZHRoPSIyIiB4PSIxMSIgeT0iMyIgdHJhbnNmb3JtPSJyb3RhdGUoMzE1LCAxMiwgMTIpIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgbWFzaz0idXJsKCNkb251dEhvbGUpIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-close: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1ub25lIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIGpwLWljb24zLWhvdmVyIiBmaWxsPSJub25lIj4KICAgIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjExIi8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIGpwLWljb24tYWNjZW50Mi1ob3ZlciIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPgogIDwvZz4KCiAgPGcgY2xhc3M9ImpwLWljb24tbm9uZSBqcC1pY29uLWJ1c3kiIGZpbGw9Im5vbmUiPgogICAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CiAgICA8cGF0aCBkPSJNNi41OSwzLjQxTDIsOEw2LjU5LDEyLjZMOCwxMS4xOEw0LjgyLDhMOCw0LjgyTDYuNTksMy40MU0xMi40MSwzLjQxTDExLDQuODJMMTQuMTgsOEwxMSwxMS4xOEwxMi40MSwxMi42TDE3LDhMMTIuNDEsMy40MU0yMS41OSwxMS41OUwxMy41LDE5LjY4TDkuODMsMTZMOC40MiwxNy40MUwxMy41LDIyLjVMMjMsMTNMMjEuNTksMTEuNTlaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTExLjQgMTguNkw2LjggMTRMMTEuNCA5LjRMMTAgOEw0IDE0TDEwIDIwTDExLjQgMTguNlpNMTYuNiAxOC42TDIxLjIgMTRMMTYuNiA5LjRMMTggOEwyNCAxNEwxOCAyMEwxNi42IDE4LjZWMTguNloiLz4KCTwvZz4KPC9zdmc+Cg==);
  --jp-icon-collapse-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNNiAxM3YyaDh2LTJ6IiAvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-console: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwMCAyMDAiPgogIDxnIGNsYXNzPSJqcC1jb25zb2xlLWljb24tYmFja2dyb3VuZC1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMjg4RDEiPgogICAgPHBhdGggZD0iTTIwIDE5LjhoMTYwdjE1OS45SDIweiIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtY29uc29sZS1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIj4KICAgIDxwYXRoIGQ9Ik0xMDUgMTI3LjNoNDB2MTIuOGgtNDB6TTUxLjEgNzdMNzQgOTkuOWwtMjMuMyAyMy4zIDEwLjUgMTAuNSAyMy4zLTIzLjNMOTUgOTkuOSA4NC41IDg5LjQgNjEuNiA2Ni41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copy: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTExLjksMUgzLjJDMi40LDEsMS43LDEuNywxLjcsMi41djEwLjJoMS41VjIuNWg4LjdWMXogTTE0LjEsMy45aC04Yy0wLjgsMC0xLjUsMC43LTEuNSwxLjV2MTAuMmMwLDAuOCwwLjcsMS41LDEuNSwxLjVoOCBjMC44LDAsMS41LTAuNywxLjUtMS41VjUuNEMxNS41LDQuNiwxNC45LDMuOSwxNC4xLDMuOXogTTE0LjEsMTUuNWgtOFY1LjRoOFYxNS41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copyright: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCI+CiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0xMS44OCw5LjE0YzEuMjgsMC4wNiwxLjYxLDEuMTUsMS42MywxLjY2aDEuNzljLTAuMDgtMS45OC0xLjQ5LTMuMTktMy40NS0zLjE5QzkuNjQsNy42MSw4LDksOCwxMi4xNCBjMCwxLjk0LDAuOTMsNC4yNCwzLjg0LDQuMjRjMi4yMiwwLDMuNDEtMS42NSwzLjQ0LTIuOTVoLTEuNzljLTAuMDMsMC41OS0wLjQ1LDEuMzgtMS42MywxLjQ0QzEwLjU1LDE0LjgzLDEwLDEzLjgxLDEwLDEyLjE0IEMxMCw5LjI1LDExLjI4LDkuMTYsMTEuODgsOS4xNHogTTEyLDJDNi40OCwyLDIsNi40OCwyLDEyczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMFMxNy41MiwyLDEyLDJ6IE0xMiwyMGMtNC40MSwwLTgtMy41OS04LTggczMuNTktOCw4LThzOCwzLjU5LDgsOFMxNi40MSwyMCwxMiwyMHoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-cut: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkuNjQgNy42NGMuMjMtLjUuMzYtMS4wNS4zNi0xLjY0IDAtMi4yMS0xLjc5LTQtNC00UzIgMy43OSAyIDZzMS43OSA0IDQgNGMuNTkgMCAxLjE0LS4xMyAxLjY0LS4zNkwxMCAxMmwtMi4zNiAyLjM2QzcuMTQgMTQuMTMgNi41OSAxNCA2IDE0Yy0yLjIxIDAtNCAxLjc5LTQgNHMxLjc5IDQgNCA0IDQtMS43OSA0LTRjMC0uNTktLjEzLTEuMTQtLjM2LTEuNjRMMTIgMTRsNyA3aDN2LTFMOS42NCA3LjY0ek02IDhjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTAgMTJjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTYtNy41Yy0uMjggMC0uNS0uMjItLjUtLjVzLjIyLS41LjUtLjUuNS4yMi41LjUtLjIyLjUtLjUuNXpNMTkgM2wtNiA2IDIgMiA3LTdWM3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-delete: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIiAvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjI2MjYyIiBkPSJNNiAxOWMwIDEuMS45IDIgMiAyaDhjMS4xIDAgMi0uOSAyLTJWN0g2djEyek0xOSA0aC0zLjVsLTEtMWgtNWwtMSAxSDV2MmgxNFY0eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-download: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDloLTRWM0g5djZINWw3IDcgNy03ek01IDE4djJoMTR2LTJINXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-duplicate: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIuNzk5OTggMC44NzVIOC44OTU4MkM5LjIwMDYxIDAuODc1IDkuNDQ5OTggMS4xMzkxNCA5LjQ0OTk4IDEuNDYxOThDOS40NDk5OCAxLjc4NDgyIDkuMjAwNjEgMi4wNDg5NiA4Ljg5NTgyIDIuMDQ4OTZIMy4zNTQxNUMzLjA0OTM2IDIuMDQ4OTYgMi43OTk5OCAyLjMxMzEgMi43OTk5OCAyLjYzNTk0VjkuNjc5NjlDMi43OTk5OCAxMC4wMDI1IDIuNTUwNjEgMTAuMjY2NyAyLjI0NTgyIDEwLjI2NjdDMS45NDEwMyAxMC4yNjY3IDEuNjkxNjUgMTAuMDAyNSAxLjY5MTY1IDkuNjc5NjlWMi4wNDg5NkMxLjY5MTY1IDEuNDAzMjggMi4xOTA0IDAuODc1IDIuNzk5OTggMC44NzVaTTUuMzY2NjUgMTEuOVY0LjU1SDExLjA4MzNWMTEuOUg1LjM2NjY1Wk00LjE0MTY1IDQuMTQxNjdDNC4xNDE2NSAzLjY5MDYzIDQuNTA3MjggMy4zMjUgNC45NTgzMiAzLjMyNUgxMS40OTE3QzExLjk0MjcgMy4zMjUgMTIuMzA4MyAzLjY5MDYzIDEyLjMwODMgNC4xNDE2N1YxMi4zMDgzQzEyLjMwODMgMTIuNzU5NCAxMS45NDI3IDEzLjEyNSAxMS40OTE3IDEzLjEyNUg0Ljk1ODMyQzQuNTA3MjggMTMuMTI1IDQuMTQxNjUgMTIuNzU5NCA0LjE0MTY1IDEyLjMwODNWNC4xNDE2N1oiIGZpbGw9IiM2MTYxNjEiLz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNOS40MzU3NCA4LjI2NTA3SDguMzY0MzFWOS4zMzY1QzguMzY0MzEgOS40NTQzNSA4LjI2Nzg4IDkuNTUwNzggOC4xNTAwMiA5LjU1MDc4QzguMDMyMTcgOS41NTA3OCA3LjkzNTc0IDkuNDU0MzUgNy45MzU3NCA5LjMzNjVWOC4yNjUwN0g2Ljg2NDMxQzYuNzQ2NDUgOC4yNjUwNyA2LjY1MDAyIDguMTY4NjQgNi42NTAwMiA4LjA1MDc4QzYuNjUwMDIgNy45MzI5MiA2Ljc0NjQ1IDcuODM2NSA2Ljg2NDMxIDcuODM2NUg3LjkzNTc0VjYuNzY1MDdDNy45MzU3NCA2LjY0NzIxIDguMDMyMTcgNi41NTA3OCA4LjE1MDAyIDYuNTUwNzhDOC4yNjc4OCA2LjU1MDc4IDguMzY0MzEgNi42NDcyMSA4LjM2NDMxIDYuNzY1MDdWNy44MzY1SDkuNDM1NzRDOS41NTM2IDcuODM2NSA5LjY1MDAyIDcuOTMyOTIgOS42NTAwMiA4LjA1MDc4QzkuNjUwMDIgOC4xNjg2NCA5LjU1MzYgOC4yNjUwNyA5LjQzNTc0IDguMjY1MDdaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC41Ii8+Cjwvc3ZnPgo=);
  --jp-icon-edit: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMgMTcuMjVWMjFoMy43NUwxNy44MSA5Ljk0bC0zLjc1LTMuNzVMMyAxNy4yNXpNMjAuNzEgNy4wNGMuMzktLjM5LjM5LTEuMDIgMC0xLjQxbC0yLjM0LTIuMzRjLS4zOS0uMzktMS4wMi0uMzktMS40MSAwbC0xLjgzIDEuODMgMy43NSAzLjc1IDEuODMtMS44M3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-ellipses: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iNSIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxOSIgY3k9IjEyIiByPSIyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-error: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjE5IiByPSIyIi8+PHBhdGggZD0iTTEwIDNoNHYxMmgtNHoiLz48L2c+CjxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMjR2MjRIMHoiLz4KPC9zdmc+Cg==);
  --jp-icon-expand-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNMTEgMTBIOXYzSDZ2MmgzdjNoMnYtM2gzdi0yaC0zeiIgLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-extension: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwLjUgMTFIMTlWN2MwLTEuMS0uOS0yLTItMmgtNFYzLjVDMTMgMi4xMiAxMS44OCAxIDEwLjUgMVM4IDIuMTIgOCAzLjVWNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAydjMuOEgzLjVjMS40OSAwIDIuNyAxLjIxIDIuNyAyLjdzLTEuMjEgMi43LTIuNyAyLjdIMlYyMGMwIDEuMS45IDIgMiAyaDMuOHYtMS41YzAtMS40OSAxLjIxLTIuNyAyLjctMi43IDEuNDkgMCAyLjcgMS4yMSAyLjcgMi43VjIySDE3YzEuMSAwIDItLjkgMi0ydi00aDEuNWMxLjM4IDAgMi41LTEuMTIgMi41LTIuNVMyMS44OCAxMSAyMC41IDExeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-fast-forward: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTQgMThsOC41LTZMNCA2djEyem05LTEydjEybDguNS02TDEzIDZ6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-file-upload: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkgMTZoNnYtNmg0bC03LTctNyA3aDR6bS00IDJoMTR2Mkg1eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-file: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuMyA4LjJsLTUuNS01LjVjLS4zLS4zLS43LS41LTEuMi0uNUgzLjljLS44LjEtMS42LjktMS42IDEuOHYxNC4xYzAgLjkuNyAxLjYgMS42IDEuNmgxNC4yYy45IDAgMS42LS43IDEuNi0xLjZWOS40Yy4xLS41LS4xLS45LS40LTEuMnptLTUuOC0zLjNsMy40IDMuNmgtMy40VjQuOXptMy45IDEyLjdINC43Yy0uMSAwLS4yIDAtLjItLjJWNC43YzAtLjIuMS0uMy4yLS4zaDcuMnY0LjRzMCAuOC4zIDEuMWMuMy4zIDEuMS4zIDEuMS4zaDQuM3Y3LjJzLS4xLjItLjIuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-filter-dot: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWRvdCIgZmlsbD0iI0ZGRiI+CiAgICA8Y2lyY2xlIGN4PSIxOCIgY3k9IjE3IiByPSIzIj48L2NpcmNsZT4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-filter-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEwIDE4aDR2LTJoLTR2MnpNMyA2djJoMThWNkgzem0zIDdoMTJ2LTJINnYyeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-filter: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-folder-favorite: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggY2xhc3M9ImpwLWljb24zIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxNjE2MSIgZD0iTTIwIDZoLThsLTItMkg0Yy0xLjEgMC0yIC45LTIgMnYxMmMwIDEuMS45IDIgMiAyaDE2YzEuMSAwIDItLjkgMi0yVjhjMC0xLjEtLjktMi0yLTJ6bS0yLjA2IDExTDE1IDE1LjI4IDEyLjA2IDE3bC43OC0zLjMzLTIuNTktMi4yNCAzLjQxLS4yOUwxNSA4bDEuMzQgMy4xNCAzLjQxLjI5LTIuNTkgMi4yNC43OCAzLjMzeiIvPgo8L3N2Zz4K);
  --jp-icon-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY4YzAtMS4xLS45LTItMi0yaC04bC0yLTJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-home: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xMCAyMHYtNmg0djZoNXYtOGgzTDEyIDMgMiAxMmgzdjh6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-html5: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uMCBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMDAiIGQ9Ik0xMDguNCAwaDIzdjIyLjhoMjEuMlYwaDIzdjY5aC0yM1Y0NmgtMjF2MjNoLTIzLjJNMjA2IDIzaC0yMC4zVjBoNjMuN3YyM0gyMjl2NDZoLTIzbTUzLjUtNjloMjQuMWwxNC44IDI0LjNMMzEzLjIgMGgyNC4xdjY5aC0yM1YzNC44bC0xNi4xIDI0LjgtMTYuMS0yNC44VjY5aC0yMi42bTg5LjItNjloMjN2NDYuMmgzMi42VjY5aC01NS42Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2U0NGQyNiIgZD0iTTEwNy42IDQ3MWwtMzMtMzcwLjRoMzYyLjhsLTMzIDM3MC4yTDI1NS43IDUxMiIvPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNmMTY1MjkiIGQ9Ik0yNTYgNDgwLjVWMTMxaDE0OC4zTDM3NiA0NDciLz4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNlYmViZWIiIGQ9Ik0xNDIgMTc2LjNoMTE0djQ1LjRoLTY0LjJsNC4yIDQ2LjVoNjB2NDUuM0gxNTQuNG0yIDIyLjhIMjAybDMuMiAzNi4zIDUwLjggMTMuNnY0Ny40bC05My4yLTI2Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIiBkPSJNMzY5LjYgMTc2LjNIMjU1Ljh2NDUuNGgxMDkuNm0tNC4xIDQ2LjVIMjU1Ljh2NDUuNGg1NmwtNS4zIDU5LTUwLjcgMTMuNnY0Ny4ybDkzLTI1LjgiLz4KPC9zdmc+Cg==);
  --jp-icon-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1icmFuZDQganAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNGRkYiIGQ9Ik0yLjIgMi4yaDE3LjV2MTcuNUgyLjJ6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzNGNTFCNSIgZD0iTTIuMiAyLjJ2MTcuNWgxNy41bC4xLTE3LjVIMi4yem0xMi4xIDIuMmMxLjIgMCAyLjIgMSAyLjIgMi4ycy0xIDIuMi0yLjIgMi4yLTIuMi0xLTIuMi0yLjIgMS0yLjIgMi4yLTIuMnpNNC40IDE3LjZsMy4zLTguOCAzLjMgNi42IDIuMi0zLjIgNC40IDUuNEg0LjR6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-info: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUwLjk3OCA1MC45NzgiPgoJPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KCQk8cGF0aCBkPSJNNDMuNTIsNy40NThDMzguNzExLDIuNjQ4LDMyLjMwNywwLDI1LjQ4OSwwQzE4LjY3LDAsMTIuMjY2LDIuNjQ4LDcuNDU4LDcuNDU4CgkJCWMtOS45NDMsOS45NDEtOS45NDMsMjYuMTE5LDAsMzYuMDYyYzQuODA5LDQuODA5LDExLjIxMiw3LjQ1NiwxOC4wMzEsNy40NThjMCwwLDAuMDAxLDAsMC4wMDIsMAoJCQljNi44MTYsMCwxMy4yMjEtMi42NDgsMTguMDI5LTcuNDU4YzQuODA5LTQuODA5LDcuNDU3LTExLjIxMiw3LjQ1Ny0xOC4wM0M1MC45NzcsMTguNjcsNDguMzI4LDEyLjI2Niw0My41Miw3LjQ1OHoKCQkJIE00Mi4xMDYsNDIuMTA1Yy00LjQzMiw0LjQzMS0xMC4zMzIsNi44NzItMTYuNjE1LDYuODcyaC0wLjAwMmMtNi4yODUtMC4wMDEtMTIuMTg3LTIuNDQxLTE2LjYxNy02Ljg3MgoJCQljLTkuMTYyLTkuMTYzLTkuMTYyLTI0LjA3MSwwLTMzLjIzM0MxMy4zMDMsNC40NCwxOS4yMDQsMiwyNS40ODksMmM2LjI4NCwwLDEyLjE4NiwyLjQ0LDE2LjYxNyw2Ljg3MgoJCQljNC40MzEsNC40MzEsNi44NzEsMTAuMzMyLDYuODcxLDE2LjYxN0M0OC45NzcsMzEuNzcyLDQ2LjUzNiwzNy42NzUsNDIuMTA2LDQyLjEwNXoiLz4KCQk8cGF0aCBkPSJNMjMuNTc4LDMyLjIxOGMtMC4wMjMtMS43MzQsMC4xNDMtMy4wNTksMC40OTYtMy45NzJjMC4zNTMtMC45MTMsMS4xMS0xLjk5NywyLjI3Mi0zLjI1MwoJCQljMC40NjgtMC41MzYsMC45MjMtMS4wNjIsMS4zNjctMS41NzVjMC42MjYtMC43NTMsMS4xMDQtMS40NzgsMS40MzYtMi4xNzVjMC4zMzEtMC43MDcsMC40OTUtMS41NDEsMC40OTUtMi41CgkJCWMwLTEuMDk2LTAuMjYtMi4wODgtMC43NzktMi45NzljLTAuNTY1LTAuODc5LTEuNTAxLTEuMzM2LTIuODA2LTEuMzY5Yy0xLjgwMiwwLjA1Ny0yLjk4NSwwLjY2Ny0zLjU1LDEuODMyCgkJCWMtMC4zMDEsMC41MzUtMC41MDMsMS4xNDEtMC42MDcsMS44MTRjLTAuMTM5LDAuNzA3LTAuMjA3LDEuNDMyLTAuMjA3LDIuMTc0aC0yLjkzN2MtMC4wOTEtMi4yMDgsMC40MDctNC4xMTQsMS40OTMtNS43MTkKCQkJYzEuMDYyLTEuNjQsMi44NTUtMi40ODEsNS4zNzgtMi41MjdjMi4xNiwwLjAyMywzLjg3NCwwLjYwOCw1LjE0MSwxLjc1OGMxLjI3OCwxLjE2LDEuOTI5LDIuNzY0LDEuOTUsNC44MTEKCQkJYzAsMS4xNDItMC4xMzcsMi4xMTEtMC40MSwyLjkxMWMtMC4zMDksMC44NDUtMC43MzEsMS41OTMtMS4yNjgsMi4yNDNjLTAuNDkyLDAuNjUtMS4wNjgsMS4zMTgtMS43MywyLjAwMgoJCQljLTAuNjUsMC42OTctMS4zMTMsMS40NzktMS45ODcsMi4zNDZjLTAuMjM5LDAuMzc3LTAuNDI5LDAuNzc3LTAuNTY1LDEuMTk5Yy0wLjE2LDAuOTU5LTAuMjE3LDEuOTUxLTAuMTcxLDIuOTc5CgkJCUMyNi41ODksMzIuMjE4LDIzLjU3OCwzMi4yMTgsMjMuNTc4LDMyLjIxOHogTTIzLjU3OCwzOC4yMnYtMy40ODRoMy4wNzZ2My40ODRIMjMuNTc4eiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-inspector: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaW5zcGVjdG9yLWljb24tY29sb3IganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY2YzAtMS4xLS45LTItMi0yem0tNSAxNEg0di00aDExdjR6bTAtNUg0VjloMTF2NHptNSA1aC00VjloNHY5eiIvPgo8L3N2Zz4K);
  --jp-icon-json: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtanNvbi1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0Y5QTgyNSI+CiAgICA8cGF0aCBkPSJNMjAuMiAxMS44Yy0xLjYgMC0xLjcuNS0xLjcgMSAwIC40LjEuOS4xIDEuMy4xLjUuMS45LjEgMS4zIDAgMS43LTEuNCAyLjMtMy41IDIuM2gtLjl2LTEuOWguNWMxLjEgMCAxLjQgMCAxLjQtLjggMC0uMyAwLS42LS4xLTEgMC0uNC0uMS0uOC0uMS0xLjIgMC0xLjMgMC0xLjggMS4zLTItMS4zLS4yLTEuMy0uNy0xLjMtMiAwLS40LjEtLjguMS0xLjIuMS0uNC4xLS43LjEtMSAwLS44LS40LS43LTEuNC0uOGgtLjVWNC4xaC45YzIuMiAwIDMuNS43IDMuNSAyLjMgMCAuNC0uMS45LS4xIDEuMy0uMS41LS4xLjktLjEgMS4zIDAgLjUuMiAxIDEuNyAxdjEuOHpNMS44IDEwLjFjMS42IDAgMS43LS41IDEuNy0xIDAtLjQtLjEtLjktLjEtMS4zLS4xLS41LS4xLS45LS4xLTEuMyAwLTEuNiAxLjQtMi4zIDMuNS0yLjNoLjl2MS45aC0uNWMtMSAwLTEuNCAwLTEuNC44IDAgLjMgMCAuNi4xIDEgMCAuMi4xLjYuMSAxIDAgMS4zIDAgMS44LTEuMyAyQzYgMTEuMiA2IDExLjcgNiAxM2MwIC40LS4xLjgtLjEgMS4yLS4xLjMtLjEuNy0uMSAxIDAgLjguMy44IDEuNC44aC41djEuOWgtLjljLTIuMSAwLTMuNS0uNi0zLjUtMi4zIDAtLjQuMS0uOS4xLTEuMy4xLS41LjEtLjkuMS0xLjMgMC0uNS0uMi0xLTEuNy0xdi0xLjl6Ii8+CiAgICA8Y2lyY2xlIGN4PSIxMSIgY3k9IjEzLjgiIHI9IjIuMSIvPgogICAgPGNpcmNsZSBjeD0iMTEiIGN5PSI4LjIiIHI9IjIuMSIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-julia: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDMyNSAzMDAiPgogIDxnIGNsYXNzPSJqcC1icmFuZDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjY2IzYzMzIj4KICAgIDxwYXRoIGQ9Ik0gMTUwLjg5ODQzOCAyMjUgQyAxNTAuODk4NDM4IDI2Ni40MjE4NzUgMTE3LjMyMDMxMiAzMDAgNzUuODk4NDM4IDMwMCBDIDM0LjQ3NjU2MiAzMDAgMC44OTg0MzggMjY2LjQyMTg3NSAwLjg5ODQzOCAyMjUgQyAwLjg5ODQzOCAxODMuNTc4MTI1IDM0LjQ3NjU2MiAxNTAgNzUuODk4NDM4IDE1MCBDIDExNy4zMjAzMTIgMTUwIDE1MC44OTg0MzggMTgzLjU3ODEyNSAxNTAuODk4NDM4IDIyNSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzM4OTgyNiI+CiAgICA8cGF0aCBkPSJNIDIzNy41IDc1IEMgMjM3LjUgMTE2LjQyMTg3NSAyMDMuOTIxODc1IDE1MCAxNjIuNSAxNTAgQyAxMjEuMDc4MTI1IDE1MCA4Ny41IDExNi40MjE4NzUgODcuNSA3NSBDIDg3LjUgMzMuNTc4MTI1IDEyMS4wNzgxMjUgMCAxNjIuNSAwIEMgMjAzLjkyMTg3NSAwIDIzNy41IDMzLjU3ODEyNSAyMzcuNSA3NSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzk1NThiMiI+CiAgICA8cGF0aCBkPSJNIDMyNC4xMDE1NjIgMjI1IEMgMzI0LjEwMTU2MiAyNjYuNDIxODc1IDI5MC41MjM0MzggMzAwIDI0OS4xMDE1NjIgMzAwIEMgMjA3LjY3OTY4OCAzMDAgMTc0LjEwMTU2MiAyNjYuNDIxODc1IDE3NC4xMDE1NjIgMjI1IEMgMTc0LjEwMTU2MiAxODMuNTc4MTI1IDIwNy42Nzk2ODggMTUwIDI0OS4xMDE1NjIgMTUwIEMgMjkwLjUyMzQzOCAxNTAgMzI0LjEwMTU2MiAxODMuNTc4MTI1IDMyNC4xMDE1NjIgMjI1Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-jupyter-favicon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUyIiBoZWlnaHQ9IjE2NSIgdmlld0JveD0iMCAwIDE1MiAxNjUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgPGcgY2xhc3M9ImpwLWp1cHl0ZXItaWNvbi1jb2xvciIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA3ODk0NywgMTEwLjU4MjkyNykiIGQ9Ik03NS45NDIyODQyLDI5LjU4MDQ1NjEgQzQzLjMwMjM5NDcsMjkuNTgwNDU2MSAxNC43OTY3ODMyLDE3LjY1MzQ2MzQgMCwwIEM1LjUxMDgzMjExLDE1Ljg0MDY4MjkgMTUuNzgxNTM4OSwyOS41NjY3NzMyIDI5LjM5MDQ5NDcsMzkuMjc4NDE3MSBDNDIuOTk5Nyw0OC45ODk4NTM3IDU5LjI3MzcsNTQuMjA2NzgwNSA3NS45NjA1Nzg5LDU0LjIwNjc4MDUgQzkyLjY0NzQ1NzksNTQuMjA2NzgwNSAxMDguOTIxNDU4LDQ4Ljk4OTg1MzcgMTIyLjUzMDY2MywzOS4yNzg0MTcxIEMxMzYuMTM5NDUzLDI5LjU2Njc3MzIgMTQ2LjQxMDI4NCwxNS44NDA2ODI5IDE1MS45MjExNTgsMCBDMTM3LjA4Nzg2OCwxNy42NTM0NjM0IDEwOC41ODI1ODksMjkuNTgwNDU2MSA3NS45NDIyODQyLDI5LjU4MDQ1NjEgTDc1Ljk0MjI4NDIsMjkuNTgwNDU2MSBaIiAvPgogICAgPHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMzczNjgsIDAuNzA0ODc4KSIgZD0iTTc1Ljk3ODQ1NzksMjQuNjI2NDA3MyBDMTA4LjYxODc2MywyNC42MjY0MDczIDEzNy4xMjQ0NTgsMzYuNTUzNDQxNSAxNTEuOTIxMTU4LDU0LjIwNjc4MDUgQzE0Ni40MTAyODQsMzguMzY2MjIyIDEzNi4xMzk0NTMsMjQuNjQwMTMxNyAxMjIuNTMwNjYzLDE0LjkyODQ4NzggQzEwOC45MjE0NTgsNS4yMTY4NDM5IDkyLjY0NzQ1NzksMCA3NS45NjA1Nzg5LDAgQzU5LjI3MzcsMCA0Mi45OTk3LDUuMjE2ODQzOSAyOS4zOTA0OTQ3LDE0LjkyODQ4NzggQzE1Ljc4MTUzODksMjQuNjQwMTMxNyA1LjUxMDgzMjExLDM4LjM2NjIyMiAwLDU0LjIwNjc4MDUgQzE0LjgzMzA4MTYsMzYuNTg5OTI5MyA0My4zMzg1Njg0LDI0LjYyNjQwNzMgNzUuOTc4NDU3OSwyNC42MjY0MDczIEw3NS45Nzg0NTc5LDI0LjYyNjQwNzMgWiIgLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-jupyter: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzkiIGhlaWdodD0iNTEiIHZpZXdCb3g9IjAgMCAzOSA1MSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTYzOCAtMjI4MSkiPgogICAgIDxnIGNsYXNzPSJqcC1qdXB5dGVyLWljb24tY29sb3IiIGZpbGw9IiNGMzc3MjYiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5Ljc0IDIzMTEuOTgpIiBkPSJNIDE4LjI2NDYgNy4xMzQxMUMgMTAuNDE0NSA3LjEzNDExIDMuNTU4NzIgNC4yNTc2IDAgMEMgMS4zMjUzOSAzLjgyMDQgMy43OTU1NiA3LjEzMDgxIDcuMDY4NiA5LjQ3MzAzQyAxMC4zNDE3IDExLjgxNTIgMTQuMjU1NyAxMy4wNzM0IDE4LjI2OSAxMy4wNzM0QyAyMi4yODIzIDEzLjA3MzQgMjYuMTk2MyAxMS44MTUyIDI5LjQ2OTQgOS40NzMwM0MgMzIuNzQyNCA3LjEzMDgxIDM1LjIxMjYgMy44MjA0IDM2LjUzOCAwQyAzMi45NzA1IDQuMjU3NiAyNi4xMTQ4IDcuMTM0MTEgMTguMjY0NiA3LjEzNDExWiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5LjczIDIyODUuNDgpIiBkPSJNIDE4LjI3MzMgNS45MzkzMUMgMjYuMTIzNSA1LjkzOTMxIDMyLjk3OTMgOC44MTU4MyAzNi41MzggMTMuMDczNEMgMzUuMjEyNiA5LjI1MzAzIDMyLjc0MjQgNS45NDI2MiAyOS40Njk0IDMuNjAwNEMgMjYuMTk2MyAxLjI1ODE4IDIyLjI4MjMgMCAxOC4yNjkgMEMgMTQuMjU1NyAwIDEwLjM0MTcgMS4yNTgxOCA3LjA2ODYgMy42MDA0QyAzLjc5NTU2IDUuOTQyNjIgMS4zMjUzOSA5LjI1MzAzIDAgMTMuMDczNEMgMy41Njc0NSA4LjgyNDYzIDEwLjQyMzIgNS45MzkzMSAxOC4yNzMzIDUuOTM5MzFaIi8+CiAgICA8L2c+CiAgICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjY5LjMgMjI4MS4zMSkiIGQ9Ik0gNS44OTM1MyAyLjg0NEMgNS45MTg4OSAzLjQzMTY1IDUuNzcwODUgNC4wMTM2NyA1LjQ2ODE1IDQuNTE2NDVDIDUuMTY1NDUgNS4wMTkyMiA0LjcyMTY4IDUuNDIwMTUgNC4xOTI5OSA1LjY2ODUxQyAzLjY2NDMgNS45MTY4OCAzLjA3NDQ0IDYuMDAxNTEgMi40OTgwNSA1LjkxMTcxQyAxLjkyMTY2IDUuODIxOSAxLjM4NDYzIDUuNTYxNyAwLjk1NDg5OCA1LjE2NDAxQyAwLjUyNTE3IDQuNzY2MzMgMC4yMjIwNTYgNC4yNDkwMyAwLjA4MzkwMzcgMy42Nzc1N0MgLTAuMDU0MjQ4MyAzLjEwNjExIC0wLjAyMTIzIDIuNTA2MTcgMC4xNzg3ODEgMS45NTM2NEMgMC4zNzg3OTMgMS40MDExIDAuNzM2ODA5IDAuOTIwODE3IDEuMjA3NTQgMC41NzM1MzhDIDEuNjc4MjYgMC4yMjYyNTkgMi4yNDA1NSAwLjAyNzU5MTkgMi44MjMyNiAwLjAwMjY3MjI5QyAzLjYwMzg5IC0wLjAzMDcxMTUgNC4zNjU3MyAwLjI0OTc4OSA0Ljk0MTQyIDAuNzgyNTUxQyA1LjUxNzExIDEuMzE1MzEgNS44NTk1NiAyLjA1Njc2IDUuODkzNTMgMi44NDRaIi8+CiAgICAgIDxwYXRoIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MzkuOCAyMzIzLjgxKSIgZD0iTSA3LjQyNzg5IDMuNTgzMzhDIDcuNDYwMDggNC4zMjQzIDcuMjczNTUgNS4wNTgxOSA2Ljg5MTkzIDUuNjkyMTNDIDYuNTEwMzEgNi4zMjYwNyA1Ljk1MDc1IDYuODMxNTYgNS4yODQxMSA3LjE0NDZDIDQuNjE3NDcgNy40NTc2MyAzLjg3MzcxIDcuNTY0MTQgMy4xNDcwMiA3LjQ1MDYzQyAyLjQyMDMyIDcuMzM3MTIgMS43NDMzNiA3LjAwODcgMS4yMDE4NCA2LjUwNjk1QyAwLjY2MDMyOCA2LjAwNTIgMC4yNzg2MSA1LjM1MjY4IDAuMTA1MDE3IDQuNjMyMDJDIC0wLjA2ODU3NTcgMy45MTEzNSAtMC4wMjYyMzYxIDMuMTU0OTQgMC4yMjY2NzUgMi40NTg1NkMgMC40Nzk1ODcgMS43NjIxNyAwLjkzMTY5NyAxLjE1NzEzIDEuNTI1NzYgMC43MjAwMzNDIDIuMTE5ODMgMC4yODI5MzUgMi44MjkxNCAwLjAzMzQzOTUgMy41NjM4OSAwLjAwMzEzMzQ0QyA0LjU0NjY3IC0wLjAzNzQwMzMgNS41MDUyOSAwLjMxNjcwNiA2LjIyOTYxIDAuOTg3ODM1QyA2Ljk1MzkzIDEuNjU4OTYgNy4zODQ4NCAyLjU5MjM1IDcuNDI3ODkgMy41ODMzOEwgNy40Mjc4OSAzLjU4MzM4WiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM4LjM2IDIyODYuMDYpIiBkPSJNIDIuMjc0NzEgNC4zOTYyOUMgMS44NDM2MyA0LjQxNTA4IDEuNDE2NzEgNC4zMDQ0NSAxLjA0Nzk5IDQuMDc4NDNDIDAuNjc5MjY4IDMuODUyNCAwLjM4NTMyOCAzLjUyMTE0IDAuMjAzMzcxIDMuMTI2NTZDIDAuMDIxNDEzNiAyLjczMTk4IC0wLjA0MDM3OTggMi4yOTE4MyAwLjAyNTgxMTYgMS44NjE4MUMgMC4wOTIwMDMxIDEuNDMxOCAwLjI4MzIwNCAxLjAzMTI2IDAuNTc1MjEzIDAuNzEwODgzQyAwLjg2NzIyMiAwLjM5MDUxIDEuMjQ2OTEgMC4xNjQ3MDggMS42NjYyMiAwLjA2MjA1OTJDIDIuMDg1NTMgLTAuMDQwNTg5NyAyLjUyNTYxIC0wLjAxNTQ3MTQgMi45MzA3NiAwLjEzNDIzNUMgMy4zMzU5MSAwLjI4Mzk0MSAzLjY4NzkyIDAuNTUxNTA1IDMuOTQyMjIgMC45MDMwNkMgNC4xOTY1MiAxLjI1NDYyIDQuMzQxNjkgMS42NzQzNiA0LjM1OTM1IDIuMTA5MTZDIDQuMzgyOTkgMi42OTEwNyA0LjE3Njc4IDMuMjU4NjkgMy43ODU5NyAzLjY4NzQ2QyAzLjM5NTE2IDQuMTE2MjQgMi44NTE2NiA0LjM3MTE2IDIuMjc0NzEgNC4zOTYyOUwgMi4yNzQ3MSA0LjM5NjI5WiIvPgogICAgPC9nPgogIDwvZz4+Cjwvc3ZnPgo=);
  --jp-icon-jupyterlab-wordmark: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIHZpZXdCb3g9IjAgMCAxODYwLjggNDc1Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0RTRFNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4MC4xMzY0MDEsIDY0LjI3MTQ5MykiPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDU4Ljg3NTU2NikiPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA4NzYwMywgMC4xNDAyOTQpIj4KICAgICAgICA8cGF0aCBkPSJNLTQyNi45LDE2OS44YzAsNDguNy0zLjcsNjQuNy0xMy42LDc2LjRjLTEwLjgsMTAtMjUsMTUuNS0zOS43LDE1LjVsMy43LDI5IGMyMi44LDAuMyw0NC44LTcuOSw2MS45LTIzLjFjMTcuOC0xOC41LDI0LTQ0LjEsMjQtODMuM1YwSC00Mjd2MTcwLjFMLTQyNi45LDE2OS44TC00MjYuOSwxNjkuOHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU1LjA0NTI5NiwgNTYuODM3MTA0KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuNTYyNDUzLCAxLjc5OTg0MikiPgogICAgICAgIDxwYXRoIGQ9Ik0tMzEyLDE0OGMwLDIxLDAsMzkuNSwxLjcsNTUuNGgtMzEuOGwtMi4xLTMzLjNoLTAuOGMtNi43LDExLjYtMTYuNCwyMS4zLTI4LDI3LjkgYy0xMS42LDYuNi0yNC44LDEwLTM4LjIsOS44Yy0zMS40LDAtNjktMTcuNy02OS04OVYwaDM2LjR2MTEyLjdjMCwzOC43LDExLjYsNjQuNyw0NC42LDY0LjdjMTAuMy0wLjIsMjAuNC0zLjUsMjguOS05LjQgYzguNS01LjksMTUuMS0xNC4zLDE4LjktMjMuOWMyLjItNi4xLDMuMy0xMi41LDMuMy0xOC45VjAuMmgzNi40VjE0OEgtMzEyTC0zMTIsMTQ4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOTAuMDEzMzIyLCA1My40Nzk2MzgpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS43MDY0NTgsIDAuMjMxNDI1KSI+CiAgICAgICAgPHBhdGggZD0iTS00NzguNiw3MS40YzAtMjYtMC44LTQ3LTEuNy02Ni43aDMyLjdsMS43LDM0LjhoMC44YzcuMS0xMi41LDE3LjUtMjIuOCwzMC4xLTI5LjcgYzEyLjUtNywyNi43LTEwLjMsNDEtOS44YzQ4LjMsMCw4NC43LDQxLjcsODQuNywxMDMuM2MwLDczLjEtNDMuNywxMDkuMi05MSwxMDkuMmMtMTIuMSwwLjUtMjQuMi0yLjItMzUtNy44IGMtMTAuOC01LjYtMTkuOS0xMy45LTI2LjYtMjQuMmgtMC44VjI5MWgtMzZ2LTIyMEwtNDc4LjYsNzEuNEwtNDc4LjYsNzEuNHogTS00NDIuNiwxMjUuNmMwLjEsNS4xLDAuNiwxMC4xLDEuNywxNS4xIGMzLDEyLjMsOS45LDIzLjMsMTkuOCwzMS4xYzkuOSw3LjgsMjIuMSwxMi4xLDM0LjcsMTIuMWMzOC41LDAsNjAuNy0zMS45LDYwLjctNzguNWMwLTQwLjctMjEuMS03NS42LTU5LjUtNzUuNiBjLTEyLjksMC40LTI1LjMsNS4xLTM1LjMsMTMuNGMtOS45LDguMy0xNi45LDE5LjctMTkuNiwzMi40Yy0xLjUsNC45LTIuMywxMC0yLjUsMTUuMVYxMjUuNkwtNDQyLjYsMTI1LjZMLTQ0Mi42LDEyNS42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MDYuNzQwNzI2LCA1Ni44MzcxMDQpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC43NTEyMjYsIDEuOTg5Mjk5KSI+CiAgICAgICAgPHBhdGggZD0iTS00NDAuOCwwbDQzLjcsMTIwLjFjNC41LDEzLjQsOS41LDI5LjQsMTIuOCw0MS43aDAuOGMzLjctMTIuMiw3LjktMjcuNywxMi44LTQyLjQgbDM5LjctMTE5LjJoMzguNUwtMzQ2LjksMTQ1Yy0yNiw2OS43LTQzLjcsMTA1LjQtNjguNiwxMjcuMmMtMTIuNSwxMS43LTI3LjksMjAtNDQuNiwyMy45bC05LjEtMzEuMSBjMTEuNy0zLjksMjIuNS0xMC4xLDMxLjgtMTguMWMxMy4yLTExLjEsMjMuNy0yNS4yLDMwLjYtNDEuMmMxLjUtMi44LDIuNS01LjcsMi45LTguOGMtMC4zLTMuMy0xLjItNi42LTIuNS05LjdMLTQ4MC4yLDAuMSBoMzkuN0wtNDQwLjgsMEwtNDQwLjgsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODIyLjc0ODEwNCwgMC4wMDAwMDApIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS40NjQwNTAsIDAuMzc4OTE0KSI+CiAgICAgICAgPHBhdGggZD0iTS00MTMuNywwdjU4LjNoNTJ2MjguMmgtNTJWMTk2YzAsMjUsNywzOS41LDI3LjMsMzkuNWM3LjEsMC4xLDE0LjItMC43LDIxLjEtMi41IGwxLjcsMjcuN2MtMTAuMywzLjctMjEuMyw1LjQtMzIuMiw1Yy03LjMsMC40LTE0LjYtMC43LTIxLjMtMy40Yy02LjgtMi43LTEyLjktNi44LTE3LjktMTIuMWMtMTAuMy0xMC45LTE0LjEtMjktMTQuMS01Mi45IFY4Ni41aC0zMVY1OC4zaDMxVjkuNkwtNDEzLjcsMEwtNDEzLjcsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTc0LjQzMzI4NiwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuOTkwMDM0LCAwLjYxMDMzOSkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDQ1LjgsMTEzYzAuOCw1MCwzMi4yLDcwLjYsNjguNiw3MC42YzE5LDAuNiwzNy45LTMsNTUuMy0xMC41bDYuMiwyNi40IGMtMjAuOSw4LjktNDMuNSwxMy4xLTY2LjIsMTIuNmMtNjEuNSwwLTk4LjMtNDEuMi05OC4zLTEwMi41Qy00ODAuMiw0OC4yLTQ0NC43LDAtMzg2LjUsMGM2NS4yLDAsODIuNyw1OC4zLDgyLjcsOTUuNyBjLTAuMSw1LjgtMC41LDExLjUtMS4yLDE3LjJoLTE0MC42SC00NDUuOEwtNDQ1LjgsMTEzeiBNLTMzOS4yLDg2LjZjMC40LTIzLjUtOS41LTYwLjEtNTAuNC02MC4xIGMtMzYuOCwwLTUyLjgsMzQuNC01NS43LDYwLjFILTMzOS4yTC0zMzkuMiw4Ni42TC0zMzkuMiw4Ni42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjAxLjk2MTA1OCwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMTc5NjQwLCAwLjcwNTA2OCkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDc4LjYsNjhjMC0yMy45LTAuNC00NC41LTEuNy02My40aDMxLjhsMS4yLDM5LjloMS43YzkuMS0yNy4zLDMxLTQ0LjUsNTUuMy00NC41IGMzLjUtMC4xLDcsMC40LDEwLjMsMS4ydjM0LjhjLTQuMS0wLjktOC4yLTEuMy0xMi40LTEuMmMtMjUuNiwwLTQzLjcsMTkuNy00OC43LDQ3LjRjLTEsNS43LTEuNiwxMS41LTEuNywxNy4ydjEwOC4zaC0zNlY2OCBMLTQ3OC42LDY4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi13YXJuMCIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCBkPSJNMTM1Mi4zLDMyNi4yaDM3VjI4aC0zN1YzMjYuMnogTTE2MDQuOCwzMjYuMmMtMi41LTEzLjktMy40LTMxLjEtMy40LTQ4Ljd2LTc2IGMwLTQwLjctMTUuMS04My4xLTc3LjMtODMuMWMtMjUuNiwwLTUwLDcuMS02Ni44LDE4LjFsOC40LDI0LjRjMTQuMy05LjIsMzQtMTUuMSw1My0xNS4xYzQxLjYsMCw0Ni4yLDMwLjIsNDYuMiw0N3Y0LjIgYy03OC42LTAuNC0xMjIuMywyNi41LTEyMi4zLDc1LjZjMCwyOS40LDIxLDU4LjQsNjIuMiw1OC40YzI5LDAsNTAuOS0xNC4zLDYyLjItMzAuMmgxLjNsMi45LDI1LjZIMTYwNC44eiBNMTU2NS43LDI1Ny43IGMwLDMuOC0wLjgsOC0yLjEsMTEuOGMtNS45LDE3LjItMjIuNywzNC00OS4yLDM0Yy0xOC45LDAtMzQuOS0xMS4zLTM0LjktMzUuM2MwLTM5LjUsNDUuOC00Ni42LDg2LjItNDUuOFYyNTcuN3ogTTE2OTguNSwzMjYuMiBsMS43LTMzLjZoMS4zYzE1LjEsMjYuOSwzOC43LDM4LjIsNjguMSwzOC4yYzQ1LjQsMCw5MS4yLTM2LjEsOTEuMi0xMDguOGMwLjQtNjEuNy0zNS4zLTEwMy43LTg1LjctMTAzLjcgYy0zMi44LDAtNTYuMywxNC43LTY5LjMsMzcuNGgtMC44VjI4aC0zNi42djI0NS43YzAsMTguMS0wLjgsMzguNi0xLjcsNTIuNUgxNjk4LjV6IE0xNzA0LjgsMjA4LjJjMC01LjksMS4zLTEwLjksMi4xLTE1LjEgYzcuNi0yOC4xLDMxLjEtNDUuNCw1Ni4zLTQ1LjRjMzkuNSwwLDYwLjUsMzQuOSw2MC41LDc1LjZjMCw0Ni42LTIzLjEsNzguMS02MS44LDc4LjFjLTI2LjksMC00OC4zLTE3LjYtNTUuNS00My4zIGMtMC44LTQuMi0xLjctOC44LTEuNy0xMy40VjIwOC4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzYxNjE2MSIgZD0iTTE1IDlIOXY2aDZWOXptLTIgNGgtMnYtMmgydjJ6bTgtMlY5aC0yVjdjMC0xLjEtLjktMi0yLTJoLTJWM2gtMnYyaC0yVjNIOXYySDdjLTEuMSAwLTIgLjktMiAydjJIM3YyaDJ2MkgzdjJoMnYyYzAgMS4xLjkgMiAyIDJoMnYyaDJ2LTJoMnYyaDJ2LTJoMmMxLjEgMCAyLS45IDItMnYtMmgydi0yaC0ydi0yaDJ6bS00IDZIN1Y3aDEwdjEweiIvPgo8L3N2Zz4K);
  --jp-icon-keyboard: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMTdjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY3YzAtMS4xLS45LTItMi0yem0tOSAzaDJ2MmgtMlY4em0wIDNoMnYyaC0ydi0yek04IDhoMnYySDhWOHptMCAzaDJ2Mkg4di0yem0tMSAySDV2LTJoMnYyem0wLTNINVY4aDJ2MnptOSA3SDh2LTJoOHYyem0wLTRoLTJ2LTJoMnYyem0wLTNoLTJWOGgydjJ6bTMgM2gtMnYtMmgydjJ6bTAtM2gtMlY4aDJ2MnoiLz4KPC9zdmc+Cg==);
  --jp-icon-launch: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzIgMzIiIHdpZHRoPSIzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yNiwyOEg2YTIuMDAyNywyLjAwMjcsMCwwLDEtMi0yVjZBMi4wMDI3LDIuMDAyNywwLDAsMSw2LDRIMTZWNkg2VjI2SDI2VjE2aDJWMjZBMi4wMDI3LDIuMDAyNywwLDAsMSwyNiwyOFoiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjAgMiAyMCA0IDI2LjU4NiA0IDE4IDEyLjU4NiAxOS40MTQgMTQgMjggNS40MTQgMjggMTIgMzAgMTIgMzAgMiAyMCAyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-launcher: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkgMTlINVY1aDdWM0g1YTIgMiAwIDAwLTIgMnYxNGEyIDIgMCAwMDIgMmgxNGMxLjEgMCAyLS45IDItMnYtN2gtMnY3ek0xNCAzdjJoMy41OWwtOS44MyA5LjgzIDEuNDEgMS40MUwxOSA2LjQxVjEwaDJWM2gtN3oiLz4KPC9zdmc+Cg==);
  --jp-icon-line-form: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGZpbGw9IndoaXRlIiBkPSJNNS44OCA0LjEyTDEzLjc2IDEybC03Ljg4IDcuODhMOCAyMmwxMC0xMEw4IDJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-link: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMuOSAxMmMwLTEuNzEgMS4zOS0zLjEgMy4xLTMuMWg0VjdIN2MtMi43NiAwLTUgMi4yNC01IDVzMi4yNCA1IDUgNWg0di0xLjlIN2MtMS43MSAwLTMuMS0xLjM5LTMuMS0zLjF6TTggMTNoOHYtMkg4djJ6bTktNmgtNHYxLjloNGMxLjcxIDAgMy4xIDEuMzkgMy4xIDMuMXMtMS4zOSAzLjEtMy4xIDMuMWgtNFYxN2g0YzIuNzYgMCA1LTIuMjQgNS01cy0yLjI0LTUtNS01eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xOSA1djE0SDVWNWgxNG0xLjEtMkgzLjljLS41IDAtLjkuNC0uOS45djE2LjJjMCAuNC40LjkuOS45aDE2LjJjLjQgMCAuOS0uNS45LS45VjMuOWMwLS41LS41LS45LS45LS45ek0xMSA3aDZ2MmgtNlY3em0wIDRoNnYyaC02di0yem0wIDRoNnYyaC02ek03IDdoMnYySDd6bTAgNGgydjJIN3ptMCA0aDJ2Mkg3eiIvPgo8L3N2Zz4K);
  --jp-icon-markdown: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjN0IxRkEyIiBkPSJNNSAxNC45aDEybC02LjEgNnptOS40LTYuOGMwLTEuMy0uMS0yLjktLjEtNC41LS40IDEuNC0uOSAyLjktMS4zIDQuM2wtMS4zIDQuM2gtMkw4LjUgNy45Yy0uNC0xLjMtLjctMi45LTEtNC4zLS4xIDEuNi0uMSAzLjItLjIgNC42TDcgMTIuNEg0LjhsLjctMTFoMy4zTDEwIDVjLjQgMS4yLjcgMi43IDEgMy45LjMtMS4yLjctMi42IDEtMy45bDEuMi0zLjdoMy4zbC42IDExaC0yLjRsLS4zLTQuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-move-down: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMTIuNDcxIDcuNTI4OTlDMTIuNzYzMiA3LjIzNjg0IDEyLjc2MzIgNi43NjMxNiAxMi40NzEgNi40NzEwMVY2LjQ3MTAxQzEyLjE3OSA2LjE3OTA1IDExLjcwNTcgNi4xNzg4NCAxMS40MTM1IDYuNDcwNTRMNy43NSAxMC4xMjc1VjEuNzVDNy43NSAxLjMzNTc5IDcuNDE0MjEgMSA3IDFWMUM2LjU4NTc5IDEgNi4yNSAxLjMzNTc5IDYuMjUgMS43NVYxMC4xMjc1TDIuNTk3MjYgNi40NjgyMkMyLjMwMzM4IDYuMTczODEgMS44MjY0MSA2LjE3MzU5IDEuNTMyMjYgNi40Njc3NFY2LjQ2Nzc0QzEuMjM4MyA2Ljc2MTcgMS4yMzgzIDcuMjM4MyAxLjUzMjI2IDcuNTMyMjZMNi4yOTI4OSAxMi4yOTI5QzYuNjgzNDIgMTIuNjgzNCA3LjMxNjU4IDEyLjY4MzQgNy43MDcxMSAxMi4yOTI5TDEyLjQ3MSA3LjUyODk5WiIgZmlsbD0iIzYxNjE2MSIvPgo8L3N2Zz4K);
  --jp-icon-move-up: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMS41Mjg5OSA2LjQ3MTAxQzEuMjM2ODQgNi43NjMxNiAxLjIzNjg0IDcuMjM2ODQgMS41Mjg5OSA3LjUyODk5VjcuNTI4OTlDMS44MjA5NSA3LjgyMDk1IDIuMjk0MjYgNy44MjExNiAyLjU4NjQ5IDcuNTI5NDZMNi4yNSAzLjg3MjVWMTIuMjVDNi4yNSAxMi42NjQyIDYuNTg1NzkgMTMgNyAxM1YxM0M3LjQxNDIxIDEzIDcuNzUgMTIuNjY0MiA3Ljc1IDEyLjI1VjMuODcyNUwxMS40MDI3IDcuNTMxNzhDMTEuNjk2NiA3LjgyNjE5IDEyLjE3MzYgNy44MjY0MSAxMi40Njc3IDcuNTMyMjZWNy41MzIyNkMxMi43NjE3IDcuMjM4MyAxMi43NjE3IDYuNzYxNyAxMi40Njc3IDYuNDY3NzRMNy43MDcxMSAxLjcwNzExQzcuMzE2NTggMS4zMTY1OCA2LjY4MzQyIDEuMzE2NTggNi4yOTI4OSAxLjcwNzExTDEuNTI4OTkgNi40NzEwMVoiIGZpbGw9IiM2MTYxNjEiLz4KPC9zdmc+Cg==);
  --jp-icon-new-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwIDZoLThsLTItMkg0Yy0xLjExIDAtMS45OS44OS0xLjk5IDJMMiAxOGMwIDEuMTEuODkgMiAyIDJoMTZjMS4xMSAwIDItLjg5IDItMlY4YzAtMS4xMS0uODktMi0yLTJ6bS0xIDhoLTN2M2gtMnYtM2gtM3YtMmgzVjloMnYzaDN2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-not-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI1IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMTkgMTcuMTg0NCAyLjk2OTY4IDE0LjMwMzIgMS44NjA5NCAxMS40NDA5WiIvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24yIiBzdHJva2U9IiMzMzMzMzMiIHN0cm9rZS13aWR0aD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOS4zMTU5MiA5LjMyMDMxKSIgZD0iTTcuMzY4NDIgMEwwIDcuMzY0NzkiLz4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkuMzE1OTIgMTYuNjgzNikgc2NhbGUoMSAtMSkiIGQ9Ik03LjM2ODQyIDBMMCA3LjM2NDc5Ii8+Cjwvc3ZnPgo=);
  --jp-icon-notebook: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtbm90ZWJvb2staWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNFRjZDMDAiPgogICAgPHBhdGggZD0iTTE4LjcgMy4zdjE1LjRIMy4zVjMuM2gxNS40bTEuNS0xLjVIMS44djE4LjNoMTguM2wuMS0xOC4zeiIvPgogICAgPHBhdGggZD0iTTE2LjUgMTYuNWwtNS40LTQuMy01LjYgNC4zdi0xMWgxMXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-numbering: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTQgMTlINlYxOS41SDVWMjAuNUg2VjIxSDRWMjJIN1YxOEg0VjE5Wk01IDEwSDZWNkg0VjdINVYxMFpNNCAxM0g1LjhMNCAxNS4xVjE2SDdWMTVINS4yTDcgMTIuOVYxMkg0VjEzWk05IDdWOUgyM1Y3SDlaTTkgMjFIMjNWMTlIOVYyMVpNOSAxNUgyM1YxM0g5VjE1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-offline-bolt: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDIuMDJjLTUuNTEgMC05Ljk4IDQuNDctOS45OCA5Ljk4czQuNDcgOS45OCA5Ljk4IDkuOTggOS45OC00LjQ3IDkuOTgtOS45OFMxNy41MSAyLjAyIDEyIDIuMDJ6TTExLjQ4IDIwdi02LjI2SDhMMTMgNHY2LjI2aDMuMzVMMTEuNDggMjB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-palette: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE4IDEzVjIwSDRWNkg5LjAyQzkuMDcgNS4yOSA5LjI0IDQuNjIgOS41IDRINEMyLjkgNCAyIDQuOSAyIDZWMjBDMiAyMS4xIDIuOSAyMiA0IDIySDE4QzE5LjEgMjIgMjAgMjEuMSAyMCAyMFYxNUwxOCAxM1pNMTkuMyA4Ljg5QzE5Ljc0IDguMTkgMjAgNy4zOCAyMCA2LjVDMjAgNC4wMSAxNy45OSAyIDE1LjUgMkMxMy4wMSAyIDExIDQuMDEgMTEgNi41QzExIDguOTkgMTMuMDEgMTEgMTUuNDkgMTFDMTYuMzcgMTEgMTcuMTkgMTAuNzQgMTcuODggMTAuM0wyMSAxMy40MkwyMi40MiAxMkwxOS4zIDguODlaTTE1LjUgOUMxNC4xMiA5IDEzIDcuODggMTMgNi41QzEzIDUuMTIgMTQuMTIgNCAxNS41IDRDMTYuODggNCAxOCA1LjEyIDE4IDYuNUMxOCA3Ljg4IDE2Ljg4IDkgMTUuNSA5WiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDZIOS4wMTg5NEM5LjAwNjM5IDYuMTY1MDIgOSA2LjMzMTc2IDkgNi41QzkgOC44MTU3NyAxMC4yMTEgMTAuODQ4NyAxMi4wMzQzIDEySDlWMTRIMTZWMTIuOTgxMUMxNi41NzAzIDEyLjkzNzcgMTcuMTIgMTIuODIwNyAxNy42Mzk2IDEyLjYzOTZMMTggMTNWMjBINFY2Wk04IDhINlYxMEg4VjhaTTYgMTJIOFYxNEg2VjEyWk04IDE2SDZWMThIOFYxNlpNOSAxNkgxNlYxOEg5VjE2WiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-paste: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE5IDJoLTQuMThDMTQuNC44NCAxMy4zIDAgMTIgMGMtMS4zIDAtMi40Ljg0LTIuODIgMkg1Yy0xLjEgMC0yIC45LTIgMnYxNmMwIDEuMS45IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjRjMC0xLjEtLjktMi0yLTJ6bS03IDBjLjU1IDAgMSAuNDUgMSAxcy0uNDUgMS0xIDEtMS0uNDUtMS0xIC40NS0xIDEtMXptNyAxOEg1VjRoMnYzaDEwVjRoMnYxNnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-pdf: url(data:image/svg+xml;base64,PHN2ZwogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMiAyMiIgd2lkdGg9IjE2Ij4KICAgIDxwYXRoIHRyYW5zZm9ybT0icm90YXRlKDQ1KSIgY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0ZGMkEyQSIKICAgICAgIGQ9Im0gMjIuMzQ0MzY5LC0zLjAxNjM2NDIgaCA1LjYzODYwNCB2IDEuNTc5MjQzMyBoIC0zLjU0OTIyNyB2IDEuNTA4NjkyOTkgaCAzLjMzNzU3NiBWIDEuNjUwODE1NCBoIC0zLjMzNzU3NiB2IDMuNDM1MjYxMyBoIC0yLjA4OTM3NyB6IG0gLTcuMTM2NDQ0LDEuNTc5MjQzMyB2IDQuOTQzOTU0MyBoIDAuNzQ4OTIgcSAxLjI4MDc2MSwwIDEuOTUzNzAzLC0wLjYzNDk1MzUgMC42NzgzNjksLTAuNjM0OTUzNSAwLjY3ODM2OSwtMS44NDUxNjQxIDAsLTEuMjA0NzgzNTUgLTAuNjcyOTQyLC0xLjgzNDMxMDExIC0wLjY3Mjk0MiwtMC42Mjk1MjY1OSAtMS45NTkxMywtMC42Mjk1MjY1OSB6IG0gLTIuMDg5Mzc3LC0xLjU3OTI0MzMgaCAyLjIwMzM0MyBxIDEuODQ1MTY0LDAgMi43NDYwMzksMC4yNjU5MjA3IDAuOTA2MzAxLDAuMjYwNDkzNyAxLjU1MjEwOCwwLjg5MDAyMDMgMC41Njk4MywwLjU0ODEyMjMgMC44NDY2MDUsMS4yNjQ0ODAwNiAwLjI3Njc3NCwwLjcxNjM1NzgxIDAuMjc2Nzc0LDEuNjIyNjU4OTQgMCwwLjkxNzE1NTEgLTAuMjc2Nzc0LDEuNjM4OTM5OSAtMC4yNzY3NzUsMC43MTYzNTc4IC0wLjg0NjYwNSwxLjI2NDQ4IC0wLjY1MTIzNCwwLjYyOTUyNjYgLTEuNTYyOTYyLDAuODk1NDQ3MyAtMC45MTE3MjgsMC4yNjA0OTM3IC0yLjczNTE4NSwwLjI2MDQ5MzcgaCAtMi4yMDMzNDMgeiBtIC04LjE0NTg1NjUsMCBoIDMuNDY3ODIzIHEgMS41NDY2ODE2LDAgMi4zNzE1Nzg1LDAuNjg5MjIzIDAuODMwMzI0LDAuNjgzNzk2MSAwLjgzMDMyNCwxLjk1MzcwMzE0IDAsMS4yNzUzMzM5NyAtMC44MzAzMjQsMS45NjQ1NTcwNiBRIDkuOTg3MTk2MSwyLjI3NDkxNSA4LjQ0MDUxNDUsMi4yNzQ5MTUgSCA3LjA2MjA2ODQgViA1LjA4NjA3NjcgSCA0Ljk3MjY5MTUgWiBtIDIuMDg5Mzc2OSwxLjUxNDExOTkgdiAyLjI2MzAzOTQzIGggMS4xNTU5NDEgcSAwLjYwNzgxODgsMCAwLjkzODg2MjksLTAuMjkzMDU1NDcgMC4zMzEwNDQxLC0wLjI5ODQ4MjQxIDAuMzMxMDQ0MSwtMC44NDExNzc3MiAwLC0wLjU0MjY5NTMxIC0wLjMzMTA0NDEsLTAuODM1NzUwNzQgLTAuMzMxMDQ0MSwtMC4yOTMwNTU1IC0wLjkzODg2MjksLTAuMjkzMDU1NSB6IgovPgo8L3N2Zz4K);
  --jp-icon-python: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iLTEwIC0xMCAxMzEuMTYxMzYxNjk0MzM1OTQgMTMyLjM4ODk5OTkzODk2NDg0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzA2OTk4IiBkPSJNIDU0LjkxODc4NSw5LjE5Mjc0MjFlLTQgQyA1MC4zMzUxMzIsMC4wMjIyMTcyNyA0NS45NTc4NDYsMC40MTMxMzY5NyA0Mi4xMDYyODUsMS4wOTQ2NjkzIDMwLjc2MDA2OSwzLjA5OTE3MzEgMjguNzAwMDM2LDcuMjk0NzcxNCAyOC43MDAwMzUsMTUuMDMyMTY5IHYgMTAuMjE4NzUgaCAyNi44MTI1IHYgMy40MDYyNSBoIC0yNi44MTI1IC0xMC4wNjI1IGMgLTcuNzkyNDU5LDAgLTE0LjYxNTc1ODgsNC42ODM3MTcgLTE2Ljc0OTk5OTgsMTMuNTkzNzUgLTIuNDYxODE5OTgsMTAuMjEyOTY2IC0yLjU3MTAxNTA4LDE2LjU4NjAyMyAwLDI3LjI1IDEuOTA1OTI4Myw3LjkzNzg1MiA2LjQ1NzU0MzIsMTMuNTkzNzQ4IDE0LjI0OTk5OTgsMTMuNTkzNzUgaCA5LjIxODc1IHYgLTEyLjI1IGMgMCwtOC44NDk5MDIgNy42NTcxNDQsLTE2LjY1NjI0OCAxNi43NSwtMTYuNjU2MjUgaCAyNi43ODEyNSBjIDcuNDU0OTUxLDAgMTMuNDA2MjUzLC02LjEzODE2NCAxMy40MDYyNSwtMTMuNjI1IHYgLTI1LjUzMTI1IGMgMCwtNy4yNjYzMzg2IC02LjEyOTk4LC0xMi43MjQ3NzcxIC0xMy40MDYyNSwtMTMuOTM3NDk5NyBDIDY0LjI4MTU0OCwwLjMyNzk0Mzk3IDU5LjUwMjQzOCwtMC4wMjAzNzkwMyA1NC45MTg3ODUsOS4xOTI3NDIxZS00IFogbSAtMTQuNSw4LjIxODc1MDEyNTc5IGMgMi43Njk1NDcsMCA1LjAzMTI1LDIuMjk4NjQ1NiA1LjAzMTI1LDUuMTI0OTk5NiAtMmUtNiwyLjgxNjMzNiAtMi4yNjE3MDMsNS4wOTM3NSAtNS4wMzEyNSw1LjA5Mzc1IC0yLjc3OTQ3NiwtMWUtNiAtNS4wMzEyNSwtMi4yNzc0MTUgLTUuMDMxMjUsLTUuMDkzNzUgLTEwZS03LC0yLjgyNjM1MyAyLjI1MTc3NCwtNS4xMjQ5OTk2IDUuMDMxMjUsLTUuMTI0OTk5NiB6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2ZmZDQzYiIgZD0ibSA4NS42Mzc1MzUsMjguNjU3MTY5IHYgMTEuOTA2MjUgYyAwLDkuMjMwNzU1IC03LjgyNTg5NSwxNi45OTk5OTkgLTE2Ljc1LDE3IGggLTI2Ljc4MTI1IGMgLTcuMzM1ODMzLDAgLTEzLjQwNjI0OSw2LjI3ODQ4MyAtMTMuNDA2MjUsMTMuNjI1IHYgMjUuNTMxMjQ3IGMgMCw3LjI2NjM0NCA2LjMxODU4OCwxMS41NDAzMjQgMTMuNDA2MjUsMTMuNjI1MDA0IDguNDg3MzMxLDIuNDk1NjEgMTYuNjI2MjM3LDIuOTQ2NjMgMjYuNzgxMjUsMCA2Ljc1MDE1NSwtMS45NTQzOSAxMy40MDYyNTMsLTUuODg3NjEgMTMuNDA2MjUsLTEzLjYyNTAwNCBWIDg2LjUwMDkxOSBoIC0yNi43ODEyNSB2IC0zLjQwNjI1IGggMjYuNzgxMjUgMTMuNDA2MjU0IGMgNy43OTI0NjEsMCAxMC42OTYyNTEsLTUuNDM1NDA4IDEzLjQwNjI0MSwtMTMuNTkzNzUgMi43OTkzMywtOC4zOTg4ODYgMi42ODAyMiwtMTYuNDc1Nzc2IDAsLTI3LjI1IC0xLjkyNTc4LC03Ljc1NzQ0MSAtNS42MDM4NywtMTMuNTkzNzUgLTEzLjQwNjI0MSwtMTMuNTkzNzUgeiBtIC0xNS4wNjI1LDY0LjY1NjI1IGMgMi43Nzk0NzgsM2UtNiA1LjAzMTI1LDIuMjc3NDE3IDUuMDMxMjUsNS4wOTM3NDcgLTJlLTYsMi44MjYzNTQgLTIuMjUxNzc1LDUuMTI1MDA0IC01LjAzMTI1LDUuMTI1MDA0IC0yLjc2OTU1LDAgLTUuMDMxMjUsLTIuMjk4NjUgLTUuMDMxMjUsLTUuMTI1MDA0IDJlLTYsLTIuODE2MzMgMi4yNjE2OTcsLTUuMDkzNzQ3IDUuMDMxMjUsLTUuMDkzNzQ3IHoiLz4KPC9zdmc+Cg==);
  --jp-icon-r-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjE5NkYzIiBkPSJNNC40IDIuNWMxLjItLjEgMi45LS4zIDQuOS0uMyAyLjUgMCA0LjEuNCA1LjIgMS4zIDEgLjcgMS41IDEuOSAxLjUgMy41IDAgMi0xLjQgMy41LTIuOSA0LjEgMS4yLjQgMS43IDEuNiAyLjIgMyAuNiAxLjkgMSAzLjkgMS4zIDQuNmgtMy44Yy0uMy0uNC0uOC0xLjctMS4yLTMuN3MtMS4yLTIuNi0yLjYtMi42aC0uOXY2LjRINC40VjIuNXptMy43IDYuOWgxLjRjMS45IDAgMi45LS45IDIuOS0yLjNzLTEtMi4zLTIuOC0yLjNjLS43IDAtMS4zIDAtMS42LjJ2NC41aC4xdi0uMXoiLz4KPC9zdmc+Cg==);
  --jp-icon-react: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMTUwIDE1MCA1NDEuOSAyOTUuMyI+CiAgPGcgY2xhc3M9ImpwLWljb24tYnJhbmQyIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxREFGQiI+CiAgICA8cGF0aCBkPSJNNjY2LjMgMjk2LjVjMC0zMi41LTQwLjctNjMuMy0xMDMuMS04Mi40IDE0LjQtNjMuNiA4LTExNC4yLTIwLjItMTMwLjQtNi41LTMuOC0xNC4xLTUuNi0yMi40LTUuNnYyMi4zYzQuNiAwIDguMy45IDExLjQgMi42IDEzLjYgNy44IDE5LjUgMzcuNSAxNC45IDc1LjctMS4xIDkuNC0yLjkgMTkuMy01LjEgMjkuNC0xOS42LTQuOC00MS04LjUtNjMuNS0xMC45LTEzLjUtMTguNS0yNy41LTM1LjMtNDEuNi01MCAzMi42LTMwLjMgNjMuMi00Ni45IDg0LTQ2LjlWNzhjLTI3LjUgMC02My41IDE5LjYtOTkuOSA1My42LTM2LjQtMzMuOC03Mi40LTUzLjItOTkuOS01My4ydjIyLjNjMjAuNyAwIDUxLjQgMTYuNSA4NCA0Ni42LTE0IDE0LjctMjggMzEuNC00MS4zIDQ5LjktMjIuNiAyLjQtNDQgNi4xLTYzLjYgMTEtMi4zLTEwLTQtMTkuNy01LjItMjktNC43LTM4LjIgMS4xLTY3LjkgMTQuNi03NS44IDMtMS44IDYuOS0yLjYgMTEuNS0yLjZWNzguNWMtOC40IDAtMTYgMS44LTIyLjYgNS42LTI4LjEgMTYuMi0zNC40IDY2LjctMTkuOSAxMzAuMS02Mi4yIDE5LjItMTAyLjcgNDkuOS0xMDIuNyA4Mi4zIDAgMzIuNSA0MC43IDYzLjMgMTAzLjEgODIuNC0xNC40IDYzLjYtOCAxMTQuMiAyMC4yIDEzMC40IDYuNSAzLjggMTQuMSA1LjYgMjIuNSA1LjYgMjcuNSAwIDYzLjUtMTkuNiA5OS45LTUzLjYgMzYuNCAzMy44IDcyLjQgNTMuMiA5OS45IDUzLjIgOC40IDAgMTYtMS44IDIyLjYtNS42IDI4LjEtMTYuMiAzNC40LTY2LjcgMTkuOS0xMzAuMSA2Mi0xOS4xIDEwMi41LTQ5LjkgMTAyLjUtODIuM3ptLTEzMC4yLTY2LjdjLTMuNyAxMi45LTguMyAyNi4yLTEzLjUgMzkuNS00LjEtOC04LjQtMTYtMTMuMS0yNC00LjYtOC05LjUtMTUuOC0xNC40LTIzLjQgMTQuMiAyLjEgMjcuOSA0LjcgNDEgNy45em0tNDUuOCAxMDYuNWMtNy44IDEzLjUtMTUuOCAyNi4zLTI0LjEgMzguMi0xNC45IDEuMy0zMCAyLTQ1LjIgMi0xNS4xIDAtMzAuMi0uNy00NS0xLjktOC4zLTExLjktMTYuNC0yNC42LTI0LjItMzgtNy42LTEzLjEtMTQuNS0yNi40LTIwLjgtMzkuOCA2LjItMTMuNCAxMy4yLTI2LjggMjAuNy0zOS45IDcuOC0xMy41IDE1LjgtMjYuMyAyNC4xLTM4LjIgMTQuOS0xLjMgMzAtMiA0NS4yLTIgMTUuMSAwIDMwLjIuNyA0NSAxLjkgOC4zIDExLjkgMTYuNCAyNC42IDI0LjIgMzggNy42IDEzLjEgMTQuNSAyNi40IDIwLjggMzkuOC02LjMgMTMuNC0xMy4yIDI2LjgtMjAuNyAzOS45em0zMi4zLTEzYzUuNCAxMy40IDEwIDI2LjggMTMuOCAzOS44LTEzLjEgMy4yLTI2LjkgNS45LTQxLjIgOCA0LjktNy43IDkuOC0xNS42IDE0LjQtMjMuNyA0LjYtOCA4LjktMTYuMSAxMy0yNC4xek00MjEuMiA0MzBjLTkuMy05LjYtMTguNi0yMC4zLTI3LjgtMzIgOSAuNCAxOC4yLjcgMjcuNS43IDkuNCAwIDE4LjctLjIgMjcuOC0uNy05IDExLjctMTguMyAyMi40LTI3LjUgMzJ6bS03NC40LTU4LjljLTE0LjItMi4xLTI3LjktNC43LTQxLTcuOSAzLjctMTIuOSA4LjMtMjYuMiAxMy41LTM5LjUgNC4xIDggOC40IDE2IDEzLjEgMjQgNC43IDggOS41IDE1LjggMTQuNCAyMy40ek00MjAuNyAxNjNjOS4zIDkuNiAxOC42IDIwLjMgMjcuOCAzMi05LS40LTE4LjItLjctMjcuNS0uNy05LjQgMC0xOC43LjItMjcuOC43IDktMTEuNyAxOC4zLTIyLjQgMjcuNS0zMnptLTc0IDU4LjljLTQuOSA3LjctOS44IDE1LjYtMTQuNCAyMy43LTQuNiA4LTguOSAxNi0xMyAyNC01LjQtMTMuNC0xMC0yNi44LTEzLjgtMzkuOCAxMy4xLTMuMSAyNi45LTUuOCA0MS4yLTcuOXptLTkwLjUgMTI1LjJjLTM1LjQtMTUuMS01OC4zLTM0LjktNTguMy01MC42IDAtMTUuNyAyMi45LTM1LjYgNTguMy01MC42IDguNi0zLjcgMTgtNyAyNy43LTEwLjEgNS43IDE5LjYgMTMuMiA0MCAyMi41IDYwLjktOS4yIDIwLjgtMTYuNiA0MS4xLTIyLjIgNjAuNi05LjktMy4xLTE5LjMtNi41LTI4LTEwLjJ6TTMxMCA0OTBjLTEzLjYtNy44LTE5LjUtMzcuNS0xNC45LTc1LjcgMS4xLTkuNCAyLjktMTkuMyA1LjEtMjkuNCAxOS42IDQuOCA0MSA4LjUgNjMuNSAxMC45IDEzLjUgMTguNSAyNy41IDM1LjMgNDEuNiA1MC0zMi42IDMwLjMtNjMuMiA0Ni45LTg0IDQ2LjktNC41LS4xLTguMy0xLTExLjMtMi43em0yMzcuMi03Ni4yYzQuNyAzOC4yLTEuMSA2Ny45LTE0LjYgNzUuOC0zIDEuOC02LjkgMi42LTExLjUgMi42LTIwLjcgMC01MS40LTE2LjUtODQtNDYuNiAxNC0xNC43IDI4LTMxLjQgNDEuMy00OS45IDIyLjYtMi40IDQ0LTYuMSA2My42LTExIDIuMyAxMC4xIDQuMSAxOS44IDUuMiAyOS4xem0zOC41LTY2LjdjLTguNiAzLjctMTggNy0yNy43IDEwLjEtNS43LTE5LjYtMTMuMi00MC0yMi41LTYwLjkgOS4yLTIwLjggMTYuNi00MS4xIDIyLjItNjAuNiA5LjkgMy4xIDE5LjMgNi41IDI4LjEgMTAuMiAzNS40IDE1LjEgNTguMyAzNC45IDU4LjMgNTAuNi0uMSAxNS43LTIzIDM1LjYtNTguNCA1MC42ek0zMjAuOCA3OC40eiIvPgogICAgPGNpcmNsZSBjeD0iNDIwLjkiIGN5PSIyOTYuNSIgcj0iNDUuNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-redo: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTE4LjQgMTAuNkMxNi41NSA4Ljk5IDE0LjE1IDggMTEuNSA4Yy00LjY1IDAtOC41OCAzLjAzLTkuOTYgNy4yMkwzLjkgMTZjMS4wNS0zLjE5IDQuMDUtNS41IDcuNi01LjUgMS45NSAwIDMuNzMuNzIgNS4xMiAxLjg4TDEzIDE2aDlWN2wtMy42IDMuNnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-refresh: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTkgMTMuNWMtMi40OSAwLTQuNS0yLjAxLTQuNS00LjVTNi41MSA0LjUgOSA0LjVjMS4yNCAwIDIuMzYuNTIgMy4xNyAxLjMzTDEwIDhoNVYzbC0xLjc2IDEuNzZDMTIuMTUgMy42OCAxMC42NiAzIDkgMyA1LjY5IDMgMy4wMSA1LjY5IDMuMDEgOVM1LjY5IDE1IDkgMTVjMi45NyAwIDUuNDMtMi4xNiA1LjktNWgtMS41MmMtLjQ2IDItMi4yNCAzLjUtNC4zOCAzLjV6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-regex: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiBmaWxsPSIjRkZGIj4KICAgIDxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjUuNSIgY3k9IjE0LjUiIHI9IjEuNSIvPgogICAgPHJlY3QgeD0iMTIiIHk9IjQiIGNsYXNzPSJzdDIiIHdpZHRoPSIxIiBoZWlnaHQ9IjgiLz4KICAgIDxyZWN0IHg9IjguNSIgeT0iNy41IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjg2NiAtMC41IDAuNSAwLjg2NiAtMi4zMjU1IDcuMzIxOSkiIGNsYXNzPSJzdDIiIHdpZHRoPSI4IiBoZWlnaHQ9IjEiLz4KICAgIDxyZWN0IHg9IjEyIiB5PSI0IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjUgLTAuODY2IDAuODY2IDAuNSAtMC42Nzc5IDE0LjgyNTIpIiBjbGFzcz0ic3QyIiB3aWR0aD0iMSIgaGVpZ2h0PSI4Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-run: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTggNXYxNGwxMS03eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-running: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptOTYgMzI4YzAgOC44LTcuMiAxNi0xNiAxNkgxNzZjLTguOCAwLTE2LTcuMi0xNi0xNlYxNzZjMC04LjggNy4yLTE2IDE2LTE2aDE2MGM4LjggMCAxNiA3LjIgMTYgMTZ2MTYweiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-save: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE3IDNINWMtMS4xMSAwLTIgLjktMiAydjE0YzAgMS4xLjg5IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjdsLTQtNHptLTUgMTZjLTEuNjYgMC0zLTEuMzQtMy0zczEuMzQtMyAzLTMgMyAxLjM0IDMgMy0xLjM0IDMtMyAzem0zLTEwSDVWNWgxMHY0eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-search: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjEsMTAuOWgtMC43bC0wLjItMC4yYzAuOC0wLjksMS4zLTIuMiwxLjMtMy41YzAtMy0yLjQtNS40LTUuNC01LjRTMS44LDQuMiwxLjgsNy4xczIuNCw1LjQsNS40LDUuNCBjMS4zLDAsMi41LTAuNSwzLjUtMS4zbDAuMiwwLjJ2MC43bDQuMSw0LjFsMS4yLTEuMkwxMi4xLDEwLjl6IE03LjEsMTAuOWMtMi4xLDAtMy43LTEuNy0zLjctMy43czEuNy0zLjcsMy43LTMuN3MzLjcsMS43LDMuNywzLjcgUzkuMiwxMC45LDcuMSwxMC45eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-settings: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVBLjQ4OC40ODggMCAwMDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==);
  --jp-icon-share: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTSAxOCAyIEMgMTYuMzU0OTkgMiAxNSAzLjM1NDk5MDQgMTUgNSBDIDE1IDUuMTkwOTUyOSAxNS4wMjE3OTEgNS4zNzcxMjI0IDE1LjA1NjY0MSA1LjU1ODU5MzggTCA3LjkyMTg3NSA5LjcyMDcwMzEgQyA3LjM5ODUzOTkgOS4yNzc4NTM5IDYuNzMyMDc3MSA5IDYgOSBDIDQuMzU0OTkwNCA5IDMgMTAuMzU0OTkgMyAxMiBDIDMgMTMuNjQ1MDEgNC4zNTQ5OTA0IDE1IDYgMTUgQyA2LjczMjA3NzEgMTUgNy4zOTg1Mzk5IDE0LjcyMjE0NiA3LjkyMTg3NSAxNC4yNzkyOTcgTCAxNS4wNTY2NDEgMTguNDM5NDUzIEMgMTUuMDIxNTU1IDE4LjYyMTUxNCAxNSAxOC44MDgzODYgMTUgMTkgQyAxNSAyMC42NDUwMSAxNi4zNTQ5OSAyMiAxOCAyMiBDIDE5LjY0NTAxIDIyIDIxIDIwLjY0NTAxIDIxIDE5IEMgMjEgMTcuMzU0OTkgMTkuNjQ1MDEgMTYgMTggMTYgQyAxNy4yNjc0OCAxNiAxNi42MDE1OTMgMTYuMjc5MzI4IDE2LjA3ODEyNSAxNi43MjI2NTYgTCA4Ljk0MzM1OTQgMTIuNTU4NTk0IEMgOC45NzgyMDk1IDEyLjM3NzEyMiA5IDEyLjE5MDk1MyA5IDEyIEMgOSAxMS44MDkwNDcgOC45NzgyMDk1IDExLjYyMjg3OCA4Ljk0MzM1OTQgMTEuNDQxNDA2IEwgMTYuMDc4MTI1IDcuMjc5Mjk2OSBDIDE2LjYwMTQ2IDcuNzIyMTQ2MSAxNy4yNjc5MjMgOCAxOCA4IEMgMTkuNjQ1MDEgOCAyMSA2LjY0NTAwOTYgMjEgNSBDIDIxIDMuMzU0OTkwNCAxOS42NDUwMSAyIDE4IDIgeiBNIDE4IDQgQyAxOC41NjQxMjkgNCAxOSA0LjQzNTg3MDYgMTkgNSBDIDE5IDUuNTY0MTI5NCAxOC41NjQxMjkgNiAxOCA2IEMgMTcuNDM1ODcxIDYgMTcgNS41NjQxMjk0IDE3IDUgQyAxNyA0LjQzNTg3MDYgMTcuNDM1ODcxIDQgMTggNCB6IE0gNiAxMSBDIDYuNTY0MTI5NCAxMSA3IDExLjQzNTg3MSA3IDEyIEMgNyAxMi41NjQxMjkgNi41NjQxMjk0IDEzIDYgMTMgQyA1LjQzNTg3MDYgMTMgNSAxMi41NjQxMjkgNSAxMiBDIDUgMTEuNDM1ODcxIDUuNDM1ODcwNiAxMSA2IDExIHogTSAxOCAxOCBDIDE4LjU2NDEyOSAxOCAxOSAxOC40MzU4NzEgMTkgMTkgQyAxOSAxOS41NjQxMjkgMTguNTY0MTI5IDIwIDE4IDIwIEMgMTcuNDM1ODcxIDIwIDE3IDE5LjU2NDEyOSAxNyAxOSBDIDE3IDE4LjQzNTg3MSAxNy40MzU4NzEgMTggMTggMTggeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-spreadsheet: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNENBRjUwIiBkPSJNMi4yIDIuMnYxNy42aDE3LjZWMi4ySDIuMnptMTUuNCA3LjdoLTUuNVY0LjRoNS41djUuNXpNOS45IDQuNHY1LjVINC40VjQuNGg1LjV6bS01LjUgNy43aDUuNXY1LjVINC40di01LjV6bTcuNyA1LjV2LTUuNWg1LjV2NS41aC01LjV6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-stop: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik02IDZoMTJ2MTJINnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tab: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIxIDNIM2MtMS4xIDAtMiAuOS0yIDJ2MTRjMCAxLjEuOSAyIDIgMmgxOGMxLjEgMCAyLS45IDItMlY1YzAtMS4xLS45LTItMi0yem0wIDE2SDNWNWgxMHY0aDh2MTB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-table-rows: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMSw4SDNWNGgxOFY4eiBNMjEsMTBIM3Y0aDE4VjEweiBNMjEsMTZIM3Y0aDE4VjE2eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-tag: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCA0MyAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTI4LjgzMzIgMTIuMzM0TDMyLjk5OTggMTYuNTAwN0wzNy4xNjY1IDEyLjMzNEgyOC44MzMyWiIvPgoJCTxwYXRoIGQ9Ik0xNi4yMDk1IDIxLjYxMDRDMTUuNjg3MyAyMi4xMjk5IDE0Ljg0NDMgMjIuMTI5OSAxNC4zMjQ4IDIxLjYxMDRMNi45ODI5IDE0LjcyNDVDNi41NzI0IDE0LjMzOTQgNi4wODMxMyAxMy42MDk4IDYuMDQ3ODYgMTMuMDQ4MkM1Ljk1MzQ3IDExLjUyODggNi4wMjAwMiA4LjYxOTQ0IDYuMDY2MjEgNy4wNzY5NUM2LjA4MjgxIDYuNTE0NzcgNi41NTU0OCA2LjA0MzQ3IDcuMTE4MDQgNi4wMzA1NUM5LjA4ODYzIDUuOTg0NzMgMTMuMjYzOCA1LjkzNTc5IDEzLjY1MTggNi4zMjQyNUwyMS43MzY5IDEzLjYzOUMyMi4yNTYgMTQuMTU4NSAyMS43ODUxIDE1LjQ3MjQgMjEuMjYyIDE1Ljk5NDZMMTYuMjA5NSAyMS42MTA0Wk05Ljc3NTg1IDguMjY1QzkuMzM1NTEgNy44MjU2NiA4LjYyMzUxIDcuODI1NjYgOC4xODI4IDguMjY1QzcuNzQzNDYgOC43MDU3MSA3Ljc0MzQ2IDkuNDE3MzMgOC4xODI4IDkuODU2NjdDOC42MjM4MiAxMC4yOTY0IDkuMzM1ODIgMTAuMjk2NCA5Ljc3NTg1IDkuODU2NjdDMTAuMjE1NiA5LjQxNzMzIDEwLjIxNTYgOC43MDUzMyA5Ljc3NTg1IDguMjY1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-terminal: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiA+CiAgICA8cmVjdCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1iYWNrZ3JvdW5kLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIiBmaWxsPSIjMzMzMzMzIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUtaW52ZXJzZSIgZD0iTTUuMDU2NjQgOC43NjE3MkM1LjA1NjY0IDguNTk3NjYgNS4wMzEyNSA4LjQ1MzEyIDQuOTgwNDcgOC4zMjgxMkM0LjkzMzU5IDguMTk5MjIgNC44NTU0NyA4LjA4MjAzIDQuNzQ2MDkgNy45NzY1NkM0LjY0MDYyIDcuODcxMDkgNC41IDcuNzc1MzkgNC4zMjQyMiA3LjY4OTQ1QzQuMTUyMzQgNy41OTk2MSAzLjk0MzM2IDcuNTExNzIgMy42OTcyNyA3LjQyNTc4QzMuMzAyNzMgNy4yODUxNiAyLjk0MzM2IDcuMTM2NzIgMi42MTkxNCA2Ljk4MDQ3QzIuMjk0OTIgNi44MjQyMiAyLjAxNzU4IDYuNjQyNTggMS43ODcxMSA2LjQzNTU1QzEuNTYwNTUgNi4yMjg1MiAxLjM4NDc3IDUuOTg4MjggMS4yNTk3NyA1LjcxNDg0QzEuMTM0NzcgNS40Mzc1IDEuMDcyMjcgNS4xMDkzOCAxLjA3MjI3IDQuNzMwNDdDMS4wNzIyNyA0LjM5ODQ0IDEuMTI4OTEgNC4wOTU3IDEuMjQyMTkgMy44MjIyN0MxLjM1NTQ3IDMuNTQ0OTIgMS41MTU2MiAzLjMwNDY5IDEuNzIyNjYgMy4xMDE1NkMxLjkyOTY5IDIuODk4NDQgMi4xNzk2OSAyLjczNDM3IDIuNDcyNjYgMi42MDkzOEMyLjc2NTYyIDIuNDg0MzggMy4wOTE4IDIuNDA0MyAzLjQ1MTE3IDIuMzY5MTRWMS4xMDkzOEg0LjM4ODY3VjIuMzgwODZDNC43NDAyMyAyLjQyNzczIDUuMDU2NjQgMi41MjM0NCA1LjMzNzg5IDIuNjY3OTdDNS42MTkxNCAyLjgxMjUgNS44NTc0MiAzLjAwMTk1IDYuMDUyNzMgMy4yMzYzM0M2LjI1MTk1IDMuNDY2OCA2LjQwNDMgMy43NDAyMyA2LjUwOTc3IDQuMDU2NjRDNi42MTkxNCA0LjM2OTE0IDYuNjczODMgNC43MjA3IDYuNjczODMgNS4xMTEzM0g1LjA0NDkyQzUuMDQ0OTIgNC42Mzg2NyA0LjkzNzUgNC4yODEyNSA0LjcyMjY2IDQuMDM5MDZDNC41MDc4MSAzLjc5Mjk3IDQuMjE2OCAzLjY2OTkyIDMuODQ5NjEgMy42Njk5MkMzLjY1MDM5IDMuNjY5OTIgMy40NzY1NiAzLjY5NzI3IDMuMzI4MTIgMy43NTE5NUMzLjE4MzU5IDMuODAyNzMgMy4wNjQ0NSAzLjg3Njk1IDIuOTcwNyAzLjk3NDYxQzIuODc2OTUgNC4wNjgzNiAyLjgwNjY0IDQuMTc5NjkgMi43NTk3NyA0LjMwODU5QzIuNzE2OCA0LjQzNzUgMi42OTUzMSA0LjU3ODEyIDIuNjk1MzEgNC43MzA0N0MyLjY5NTMxIDQuODgyODEgMi43MTY4IDUuMDE5NTMgMi43NTk3NyA1LjE0MDYyQzIuODA2NjQgNS4yNTc4MSAyLjg4MjgxIDUuMzY3MTkgMi45ODgyOCA1LjQ2ODc1QzMuMDk3NjYgNS41NzAzMSAzLjI0MDIzIDUuNjY3OTcgMy40MTYwMiA1Ljc2MTcyQzMuNTkxOCA1Ljg1MTU2IDMuODEwNTUgNS45NDMzNiA0LjA3MjI3IDYuMDM3MTFDNC40NjY4IDYuMTg1NTUgNC44MjQyMiA2LjMzOTg0IDUuMTQ0NTMgNi41QzUuNDY0ODQgNi42NTYyNSA1LjczODI4IDYuODM5ODQgNS45NjQ4NCA3LjA1MDc4QzYuMTk1MzEgNy4yNTc4MSA2LjM3MTA5IDcuNSA2LjQ5MjE5IDcuNzc3MzRDNi42MTcxOSA4LjA1MDc4IDYuNjc5NjkgOC4zNzUgNi42Nzk2OSA4Ljc1QzYuNjc5NjkgOS4wOTM3NSA2LjYyMzA1IDkuNDA0MyA2LjUwOTc3IDkuNjgxNjRDNi4zOTY0OCA5Ljk1NTA4IDYuMjM0MzggMTAuMTkxNCA2LjAyMzQ0IDEwLjM5MDZDNS44MTI1IDEwLjU4OTggNS41NTg1OSAxMC43NSA1LjI2MTcyIDEwLjg3MTFDNC45NjQ4NCAxMC45ODgzIDQuNjMyODEgMTEuMDY0NSA0LjI2NTYyIDExLjA5OTZWMTIuMjQ4SDMuMzMzOThWMTEuMDk5NkMzLjAwMTk1IDExLjA2ODQgMi42Nzk2OSAxMC45OTYxIDIuMzY3MTkgMTAuODgyOEMyLjA1NDY5IDEwLjc2NTYgMS43NzczNCAxMC41OTc3IDEuNTM1MTYgMTAuMzc4OUMxLjI5Njg4IDEwLjE2MDIgMS4xMDU0NyA5Ljg4NDc3IDAuOTYwOTM4IDkuNTUyNzNDMC44MTY0MDYgOS4yMTY4IDAuNzQ0MTQxIDguODE0NDUgMC43NDQxNDEgOC4zNDU3SDIuMzc4OTFDMi4zNzg5MSA4LjYyNjk1IDIuNDE5OTIgOC44NjMyOCAyLjUwMTk1IDkuMDU0NjlDMi41ODM5OCA5LjI0MjE5IDIuNjg5NDUgOS4zOTI1OCAyLjgxODM2IDkuNTA1ODZDMi45NTExNyA5LjYxNTIzIDMuMTAxNTYgOS42OTMzNiAzLjI2OTUzIDkuNzQwMjNDMy40Mzc1IDkuNzg3MTEgMy42MDkzOCA5LjgxMDU1IDMuNzg1MTYgOS44MTA1NUM0LjIwMzEyIDkuODEwNTUgNC41MTk1MyA5LjcxMjg5IDQuNzM0MzggOS41MTc1OEM0Ljk0OTIyIDkuMzIyMjcgNS4wNTY2NCA5LjA3MDMxIDUuMDU2NjQgOC43NjE3MlpNMTMuNDE4IDEyLjI3MTVIOC4wNzQyMlYxMUgxMy40MThWMTIuMjcxNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuOTUyNjQgNikiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=);
  --jp-icon-text-editor: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtdGV4dC1lZGl0b3ItaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xNSAxNUgzdjJoMTJ2LTJ6bTAtOEgzdjJoMTJWN3pNMyAxM2gxOHYtMkgzdjJ6bTAgOGgxOHYtMkgzdjJ6TTMgM3YyaDE4VjNIM3oiLz4KPC9zdmc+Cg==);
  --jp-icon-toc: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik03LDVIMjFWN0g3VjVNNywxM1YxMUgyMVYxM0g3TTQsNC41QTEuNSwxLjUgMCAwLDEgNS41LDZBMS41LDEuNSAwIDAsMSA0LDcuNUExLjUsMS41IDAgMCwxIDIuNSw2QTEuNSwxLjUgMCAwLDEgNCw0LjVNNCwxMC41QTEuNSwxLjUgMCAwLDEgNS41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMy41QTEuNSwxLjUgMCAwLDEgMi41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMC41TTcsMTlWMTdIMjFWMTlIN000LDE2LjVBMS41LDEuNSAwIDAsMSA1LjUsMThBMS41LDEuNSAwIDAsMSA0LDE5LjVBMS41LDEuNSAwIDAsMSAyLjUsMThBMS41LDEuNSAwIDAsMSA0LDE2LjVaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tree-view: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMiAxMVYzaC03djNIOVYzSDJ2OGg3VjhoMnYxMGg0djNoN3YtOGgtN3YzaC0yVjhoMnYzeiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMiAxNy4xODQ0IDIuOTY5NjggMTQuMzAzMiAxLjg2MDk0IDExLjQ0MDlaIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiMzMzMzMzMiIHN0cm9rZT0iIzMzMzMzMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCA5Ljg2NzE5KSIgZD0iTTIuODYwMTUgNC44NjUzNUwwLjcyNjU0OSAyLjk5OTU5TDAgMy42MzA0NUwyLjg2MDE1IDYuMTMxNTdMOCAwLjYzMDg3Mkw3LjI3ODU3IDBMMi44NjAxNSA0Ljg2NTM1WiIvPgo8L3N2Zz4K);
  --jp-icon-undo: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjUgOGMtMi42NSAwLTUuMDUuOTktNi45IDIuNkwyIDd2OWg5bC0zLjYyLTMuNjJjMS4zOS0xLjE2IDMuMTYtMS44OCA1LjEyLTEuODggMy41NCAwIDYuNTUgMi4zMSA3LjYgNS41bDIuMzctLjc4QzIxLjA4IDExLjAzIDE3LjE1IDggMTIuNSA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-user: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE2IDdhNCA0IDAgMTEtOCAwIDQgNCAwIDAxOCAwek0xMiAxNGE3IDcgMCAwMC03IDdoMTRhNyA3IDAgMDAtNy03eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-users: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM2IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogPGcgY2xhc3M9ImpwLWljb24zIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjczMjcgMCAwIDEuNzMyNyAtMy42MjgyIC4wOTk1NzcpIiBmaWxsPSIjNjE2MTYxIj4KICA8cGF0aCB0cmFuc2Zvcm09Im1hdHJpeCgxLjUsMCwwLDEuNSwwLC02KSIgZD0ibTEyLjE4NiA3LjUwOThjLTEuMDUzNSAwLTEuOTc1NyAwLjU2NjUtMi40Nzg1IDEuNDEwMiAwLjc1MDYxIDAuMzEyNzcgMS4zOTc0IDAuODI2NDggMS44NzMgMS40NzI3aDMuNDg2M2MwLTEuNTkyLTEuMjg4OS0yLjg4MjgtMi44ODA5LTIuODgyOHoiLz4KICA8cGF0aCBkPSJtMjAuNDY1IDIuMzg5NWEyLjE4ODUgMi4xODg1IDAgMCAxLTIuMTg4NCAyLjE4ODUgMi4xODg1IDIuMTg4NSAwIDAgMS0yLjE4ODUtMi4xODg1IDIuMTg4NSAyLjE4ODUgMCAwIDEgMi4xODg1LTIuMTg4NSAyLjE4ODUgMi4xODg1IDAgMCAxIDIuMTg4NCAyLjE4ODV6Ii8+CiAgPHBhdGggdHJhbnNmb3JtPSJtYXRyaXgoMS41LDAsMCwxLjUsMCwtNikiIGQ9Im0zLjU4OTggOC40MjE5Yy0xLjExMjYgMC0yLjAxMzcgMC45MDExMS0yLjAxMzcgMi4wMTM3aDIuODE0NWMwLjI2Nzk3LTAuMzczMDkgMC41OTA3LTAuNzA0MzUgMC45NTg5OC0wLjk3ODUyLTAuMzQ0MzMtMC42MTY4OC0xLjAwMzEtMS4wMzUyLTEuNzU5OC0xLjAzNTJ6Ii8+CiAgPHBhdGggZD0ibTYuOTE1NCA0LjYyM2ExLjUyOTQgMS41Mjk0IDAgMCAxLTEuNTI5NCAxLjUyOTQgMS41Mjk0IDEuNTI5NCAwIDAgMS0xLjUyOTQtMS41Mjk0IDEuNTI5NCAxLjUyOTQgMCAwIDEgMS41Mjk0LTEuNTI5NCAxLjUyOTQgMS41Mjk0IDAgMCAxIDEuNTI5NCAxLjUyOTR6Ii8+CiAgPHBhdGggZD0ibTYuMTM1IDEzLjUzNWMwLTMuMjM5MiAyLjYyNTktNS44NjUgNS44NjUtNS44NjUgMy4yMzkyIDAgNS44NjUgMi42MjU5IDUuODY1IDUuODY1eiIvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iMy43Njg1IiByPSIyLjk2ODUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-vega: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbjEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjEyMTIxIj4KICAgIDxwYXRoIGQ9Ik0xMC42IDUuNGwyLjItMy4ySDIuMnY3LjNsNC02LjZ6Ii8+CiAgICA8cGF0aCBkPSJNMTUuOCAyLjJsLTQuNCA2LjZMNyA2LjNsLTQuOCA4djUuNWgxNy42VjIuMmgtNHptLTcgMTUuNEg1LjV2LTQuNGgzLjN2NC40em00LjQgMEg5LjhWOS44aDMuNHY3Ljh6bTQuNCAwaC0zLjRWNi41aDMuNHYxMS4xeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-word: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KIDxnIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzQxNDE0MSI+CiAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiA8L2c+CiA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguNDMgLjA0MDEpIiBmaWxsPSIjZmZmIj4KICA8cGF0aCBkPSJtNC4xNCA4Ljc2cTAuMDY4Mi0xLjg5IDIuNDItMS44OSAxLjE2IDAgMS42OCAwLjQyIDAuNTY3IDAuNDEgMC41NjcgMS4xNnYzLjQ3cTAgMC40NjIgMC41MTQgMC40NjIgMC4xMDMgMCAwLjItMC4wMjMxdjAuNzE0cS0wLjM5OSAwLjEwMy0wLjY1MSAwLjEwMy0wLjQ1MiAwLTAuNjkzLTAuMjItMC4yMzEtMC4yLTAuMjg0LTAuNjYyLTAuOTU2IDAuODcyLTIgMC44NzItMC45MDMgMC0xLjQ3LTAuNDcyLTAuNTI1LTAuNDcyLTAuNTI1LTEuMjYgMC0wLjI2MiAwLjA0NTItMC40NzIgMC4wNTY3LTAuMjIgMC4xMTYtMC4zNzggMC4wNjgyLTAuMTY4IDAuMjMxLTAuMzA0IDAuMTU4LTAuMTQ3IDAuMjYyLTAuMjQyIDAuMTE2LTAuMDkxNCAwLjM2OC0wLjE2OCAwLjI2Mi0wLjA5MTQgMC4zOTktMC4xMjYgMC4xMzYtMC4wNDUyIDAuNDcyLTAuMTAzIDAuMzM2LTAuMDU3OCAwLjUwNC0wLjA3OTggMC4xNTgtMC4wMjMxIDAuNTY3LTAuMDc5OCAwLjU1Ni0wLjA2ODIgMC43NzctMC4yMjEgMC4yMi0wLjE1MiAwLjIyLTAuNDQxdi0wLjI1MnEwLTAuNDMtMC4zNTctMC42NjItMC4zMzYtMC4yMzEtMC45NzYtMC4yMzEtMC42NjIgMC0wLjk5OCAwLjI2Mi0wLjMzNiAwLjI1Mi0wLjM5OSAwLjc5OHptMS44OSAzLjY4cTAuNzg4IDAgMS4yNi0wLjQxIDAuNTA0LTAuNDIgMC41MDQtMC45MDN2LTEuMDVxLTAuMjg0IDAuMTM2LTAuODYxIDAuMjMxLTAuNTY3IDAuMDkxNC0wLjk4NyAwLjE1OC0wLjQyIDAuMDY4Mi0wLjc2NiAwLjMyNi0wLjMzNiAwLjI1Mi0wLjMzNiAwLjcwNHQwLjMwNCAwLjcwNCAwLjg2MSAwLjI1MnoiIHN0cm9rZS13aWR0aD0iMS4wNSIvPgogIDxwYXRoIGQ9Im0xMCA0LjU2aDAuOTQ1djMuMTVxMC42NTEtMC45NzYgMS44OS0wLjk3NiAxLjE2IDAgMS44OSAwLjg0IDAuNjgyIDAuODQgMC42ODIgMi4zMSAwIDEuNDctMC43MDQgMi40Mi0wLjcwNCAwLjg4Mi0xLjg5IDAuODgyLTEuMjYgMC0xLjg5LTEuMDJ2MC43NjZoLTAuODV6bTIuNjIgMy4wNHEtMC43NDYgMC0xLjE2IDAuNjQtMC40NTIgMC42My0wLjQ1MiAxLjY4IDAgMS4wNSAwLjQ1MiAxLjY4dDEuMTYgMC42M3EwLjc3NyAwIDEuMjYtMC42MyAwLjQ5NC0wLjY0IDAuNDk0LTEuNjggMC0xLjA1LTAuNDcyLTEuNjgtMC40NjItMC42NC0xLjI2LTAuNjR6IiBzdHJva2Utd2lkdGg9IjEuMDUiLz4KICA8cGF0aCBkPSJtMi43MyAxNS44IDEzLjYgMC4wMDgxYzAuMDA2OSAwIDAtMi42IDAtMi42IDAtMC4wMDc4LTEuMTUgMC0xLjE1IDAtMC4wMDY5IDAtMC4wMDgzIDEuNS0wLjAwODMgMS41LTJlLTMgLTAuMDAxNC0xMS4zLTAuMDAxNC0xMS4zLTAuMDAxNGwtMC4wMDU5Mi0xLjVjMC0wLjAwNzgtMS4xNyAwLjAwMTMtMS4xNyAwLjAwMTN6IiBzdHJva2Utd2lkdGg9Ii45NzUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-yaml: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1jb250cmFzdDIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjRDgxQjYwIj4KICAgIDxwYXRoIGQ9Ik03LjIgMTguNnYtNS40TDMgNS42aDMuM2wxLjQgMy4xYy4zLjkuNiAxLjYgMSAyLjUuMy0uOC42LTEuNiAxLTIuNWwxLjQtMy4xaDMuNGwtNC40IDcuNnY1LjVsLTIuOS0uMXoiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxNi41IiByPSIyLjEiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxMSIgcj0iMi4xIi8+CiAgPC9nPgo8L3N2Zz4K);
}

/* Icon CSS class declarations */

.jp-AddAboveIcon {
  background-image: var(--jp-icon-add-above);
}

.jp-AddBelowIcon {
  background-image: var(--jp-icon-add-below);
}

.jp-AddIcon {
  background-image: var(--jp-icon-add);
}

.jp-BellIcon {
  background-image: var(--jp-icon-bell);
}

.jp-BugDotIcon {
  background-image: var(--jp-icon-bug-dot);
}

.jp-BugIcon {
  background-image: var(--jp-icon-bug);
}

.jp-BuildIcon {
  background-image: var(--jp-icon-build);
}

.jp-CaretDownEmptyIcon {
  background-image: var(--jp-icon-caret-down-empty);
}

.jp-CaretDownEmptyThinIcon {
  background-image: var(--jp-icon-caret-down-empty-thin);
}

.jp-CaretDownIcon {
  background-image: var(--jp-icon-caret-down);
}

.jp-CaretLeftIcon {
  background-image: var(--jp-icon-caret-left);
}

.jp-CaretRightIcon {
  background-image: var(--jp-icon-caret-right);
}

.jp-CaretUpEmptyThinIcon {
  background-image: var(--jp-icon-caret-up-empty-thin);
}

.jp-CaretUpIcon {
  background-image: var(--jp-icon-caret-up);
}

.jp-CaseSensitiveIcon {
  background-image: var(--jp-icon-case-sensitive);
}

.jp-CheckIcon {
  background-image: var(--jp-icon-check);
}

.jp-CircleEmptyIcon {
  background-image: var(--jp-icon-circle-empty);
}

.jp-CircleIcon {
  background-image: var(--jp-icon-circle);
}

.jp-ClearIcon {
  background-image: var(--jp-icon-clear);
}

.jp-CloseIcon {
  background-image: var(--jp-icon-close);
}

.jp-CodeCheckIcon {
  background-image: var(--jp-icon-code-check);
}

.jp-CodeIcon {
  background-image: var(--jp-icon-code);
}

.jp-CollapseAllIcon {
  background-image: var(--jp-icon-collapse-all);
}

.jp-ConsoleIcon {
  background-image: var(--jp-icon-console);
}

.jp-CopyIcon {
  background-image: var(--jp-icon-copy);
}

.jp-CopyrightIcon {
  background-image: var(--jp-icon-copyright);
}

.jp-CutIcon {
  background-image: var(--jp-icon-cut);
}

.jp-DeleteIcon {
  background-image: var(--jp-icon-delete);
}

.jp-DownloadIcon {
  background-image: var(--jp-icon-download);
}

.jp-DuplicateIcon {
  background-image: var(--jp-icon-duplicate);
}

.jp-EditIcon {
  background-image: var(--jp-icon-edit);
}

.jp-EllipsesIcon {
  background-image: var(--jp-icon-ellipses);
}

.jp-ErrorIcon {
  background-image: var(--jp-icon-error);
}

.jp-ExpandAllIcon {
  background-image: var(--jp-icon-expand-all);
}

.jp-ExtensionIcon {
  background-image: var(--jp-icon-extension);
}

.jp-FastForwardIcon {
  background-image: var(--jp-icon-fast-forward);
}

.jp-FileIcon {
  background-image: var(--jp-icon-file);
}

.jp-FileUploadIcon {
  background-image: var(--jp-icon-file-upload);
}

.jp-FilterDotIcon {
  background-image: var(--jp-icon-filter-dot);
}

.jp-FilterIcon {
  background-image: var(--jp-icon-filter);
}

.jp-FilterListIcon {
  background-image: var(--jp-icon-filter-list);
}

.jp-FolderFavoriteIcon {
  background-image: var(--jp-icon-folder-favorite);
}

.jp-FolderIcon {
  background-image: var(--jp-icon-folder);
}

.jp-HomeIcon {
  background-image: var(--jp-icon-home);
}

.jp-Html5Icon {
  background-image: var(--jp-icon-html5);
}

.jp-ImageIcon {
  background-image: var(--jp-icon-image);
}

.jp-InfoIcon {
  background-image: var(--jp-icon-info);
}

.jp-InspectorIcon {
  background-image: var(--jp-icon-inspector);
}

.jp-JsonIcon {
  background-image: var(--jp-icon-json);
}

.jp-JuliaIcon {
  background-image: var(--jp-icon-julia);
}

.jp-JupyterFaviconIcon {
  background-image: var(--jp-icon-jupyter-favicon);
}

.jp-JupyterIcon {
  background-image: var(--jp-icon-jupyter);
}

.jp-JupyterlabWordmarkIcon {
  background-image: var(--jp-icon-jupyterlab-wordmark);
}

.jp-KernelIcon {
  background-image: var(--jp-icon-kernel);
}

.jp-KeyboardIcon {
  background-image: var(--jp-icon-keyboard);
}

.jp-LaunchIcon {
  background-image: var(--jp-icon-launch);
}

.jp-LauncherIcon {
  background-image: var(--jp-icon-launcher);
}

.jp-LineFormIcon {
  background-image: var(--jp-icon-line-form);
}

.jp-LinkIcon {
  background-image: var(--jp-icon-link);
}

.jp-ListIcon {
  background-image: var(--jp-icon-list);
}

.jp-MarkdownIcon {
  background-image: var(--jp-icon-markdown);
}

.jp-MoveDownIcon {
  background-image: var(--jp-icon-move-down);
}

.jp-MoveUpIcon {
  background-image: var(--jp-icon-move-up);
}

.jp-NewFolderIcon {
  background-image: var(--jp-icon-new-folder);
}

.jp-NotTrustedIcon {
  background-image: var(--jp-icon-not-trusted);
}

.jp-NotebookIcon {
  background-image: var(--jp-icon-notebook);
}

.jp-NumberingIcon {
  background-image: var(--jp-icon-numbering);
}

.jp-OfflineBoltIcon {
  background-image: var(--jp-icon-offline-bolt);
}

.jp-PaletteIcon {
  background-image: var(--jp-icon-palette);
}

.jp-PasteIcon {
  background-image: var(--jp-icon-paste);
}

.jp-PdfIcon {
  background-image: var(--jp-icon-pdf);
}

.jp-PythonIcon {
  background-image: var(--jp-icon-python);
}

.jp-RKernelIcon {
  background-image: var(--jp-icon-r-kernel);
}

.jp-ReactIcon {
  background-image: var(--jp-icon-react);
}

.jp-RedoIcon {
  background-image: var(--jp-icon-redo);
}

.jp-RefreshIcon {
  background-image: var(--jp-icon-refresh);
}

.jp-RegexIcon {
  background-image: var(--jp-icon-regex);
}

.jp-RunIcon {
  background-image: var(--jp-icon-run);
}

.jp-RunningIcon {
  background-image: var(--jp-icon-running);
}

.jp-SaveIcon {
  background-image: var(--jp-icon-save);
}

.jp-SearchIcon {
  background-image: var(--jp-icon-search);
}

.jp-SettingsIcon {
  background-image: var(--jp-icon-settings);
}

.jp-ShareIcon {
  background-image: var(--jp-icon-share);
}

.jp-SpreadsheetIcon {
  background-image: var(--jp-icon-spreadsheet);
}

.jp-StopIcon {
  background-image: var(--jp-icon-stop);
}

.jp-TabIcon {
  background-image: var(--jp-icon-tab);
}

.jp-TableRowsIcon {
  background-image: var(--jp-icon-table-rows);
}

.jp-TagIcon {
  background-image: var(--jp-icon-tag);
}

.jp-TerminalIcon {
  background-image: var(--jp-icon-terminal);
}

.jp-TextEditorIcon {
  background-image: var(--jp-icon-text-editor);
}

.jp-TocIcon {
  background-image: var(--jp-icon-toc);
}

.jp-TreeViewIcon {
  background-image: var(--jp-icon-tree-view);
}

.jp-TrustedIcon {
  background-image: var(--jp-icon-trusted);
}

.jp-UndoIcon {
  background-image: var(--jp-icon-undo);
}

.jp-UserIcon {
  background-image: var(--jp-icon-user);
}

.jp-UsersIcon {
  background-image: var(--jp-icon-users);
}

.jp-VegaIcon {
  background-image: var(--jp-icon-vega);
}

.jp-WordIcon {
  background-image: var(--jp-icon-word);
}

.jp-YamlIcon {
  background-image: var(--jp-icon-yaml);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

.jp-Icon,
.jp-MaterialIcon {
  background-position: center;
  background-repeat: no-repeat;
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-cover {
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
}

/**
 * (DEPRECATED) Support for specific CSS icon sizes
 */

.jp-Icon-16 {
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-18 {
  background-size: 18px;
  min-width: 18px;
  min-height: 18px;
}

.jp-Icon-20 {
  background-size: 20px;
  min-width: 20px;
  min-height: 20px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.lm-TabBar .lm-TabBar-addButton {
  align-items: center;
  display: flex;
  padding: 4px;
  padding-bottom: 5px;
  margin-right: 1px;
  background-color: var(--jp-layout-color2);
}

.lm-TabBar .lm-TabBar-addButton:hover {
  background-color: var(--jp-layout-color1);
}

.lm-DockPanel-tabBar .lm-TabBar-tab {
  width: var(--jp-private-horizontal-tab-width);
}

.lm-DockPanel-tabBar .lm-TabBar-content {
  flex: unset;
}

.lm-DockPanel-tabBar[data-orientation='horizontal'] {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for icons as inline SVG HTMLElements
 */

/* recolor the primary elements of an icon */
.jp-icon0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-accent0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-accent1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-accent2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-accent3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-accent4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-accent0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-accent1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-accent2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-accent3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-accent4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-none[fill] {
  fill: none;
}

.jp-icon-none[stroke] {
  stroke: none;
}

/* brand icon colors. Same for light and dark */
.jp-icon-brand0[fill] {
  fill: var(--jp-brand-color0);
}

.jp-icon-brand1[fill] {
  fill: var(--jp-brand-color1);
}

.jp-icon-brand2[fill] {
  fill: var(--jp-brand-color2);
}

.jp-icon-brand3[fill] {
  fill: var(--jp-brand-color3);
}

.jp-icon-brand4[fill] {
  fill: var(--jp-brand-color4);
}

.jp-icon-brand0[stroke] {
  stroke: var(--jp-brand-color0);
}

.jp-icon-brand1[stroke] {
  stroke: var(--jp-brand-color1);
}

.jp-icon-brand2[stroke] {
  stroke: var(--jp-brand-color2);
}

.jp-icon-brand3[stroke] {
  stroke: var(--jp-brand-color3);
}

.jp-icon-brand4[stroke] {
  stroke: var(--jp-brand-color4);
}

/* warn icon colors. Same for light and dark */
.jp-icon-warn0[fill] {
  fill: var(--jp-warn-color0);
}

.jp-icon-warn1[fill] {
  fill: var(--jp-warn-color1);
}

.jp-icon-warn2[fill] {
  fill: var(--jp-warn-color2);
}

.jp-icon-warn3[fill] {
  fill: var(--jp-warn-color3);
}

.jp-icon-warn0[stroke] {
  stroke: var(--jp-warn-color0);
}

.jp-icon-warn1[stroke] {
  stroke: var(--jp-warn-color1);
}

.jp-icon-warn2[stroke] {
  stroke: var(--jp-warn-color2);
}

.jp-icon-warn3[stroke] {
  stroke: var(--jp-warn-color3);
}

/* icon colors that contrast well with each other and most backgrounds */
.jp-icon-contrast0[fill] {
  fill: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[fill] {
  fill: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[fill] {
  fill: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[fill] {
  fill: var(--jp-icon-contrast-color3);
}

.jp-icon-contrast0[stroke] {
  stroke: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[stroke] {
  stroke: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[stroke] {
  stroke: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[stroke] {
  stroke: var(--jp-icon-contrast-color3);
}

.jp-icon-dot[fill] {
  fill: var(--jp-warn-color0);
}

.jp-jupyter-icon-color[fill] {
  fill: var(--jp-jupyter-icon-color, var(--jp-warn-color0));
}

.jp-notebook-icon-color[fill] {
  fill: var(--jp-notebook-icon-color, var(--jp-warn-color0));
}

.jp-json-icon-color[fill] {
  fill: var(--jp-json-icon-color, var(--jp-warn-color1));
}

.jp-console-icon-color[fill] {
  fill: var(--jp-console-icon-color, white);
}

.jp-console-icon-background-color[fill] {
  fill: var(--jp-console-icon-background-color, var(--jp-brand-color1));
}

.jp-terminal-icon-color[fill] {
  fill: var(--jp-terminal-icon-color, var(--jp-layout-color2));
}

.jp-terminal-icon-background-color[fill] {
  fill: var(
    --jp-terminal-icon-background-color,
    var(--jp-inverse-layout-color2)
  );
}

.jp-text-editor-icon-color[fill] {
  fill: var(--jp-text-editor-icon-color, var(--jp-inverse-layout-color3));
}

.jp-inspector-icon-color[fill] {
  fill: var(--jp-inspector-icon-color, var(--jp-inverse-layout-color3));
}

/* CSS for icons in selected filebrowser listing items */
.jp-DirListing-item.jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

.jp-DirListing-item.jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* stylelint-disable selector-max-class, selector-max-compound-selectors */

/**
* TODO: come up with non css-hack solution for showing the busy icon on top
*  of the close icon
* CSS for complex behavior of close icon of tabs in the main area tabbar
*/
.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon3[fill] {
  fill: none;
}

.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon-busy[fill] {
  fill: var(--jp-inverse-layout-color3);
}

/* stylelint-enable selector-max-class, selector-max-compound-selectors */

/* CSS for icons in status bar */
#jp-main-statusbar .jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

#jp-main-statusbar .jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* special handling for splash icon CSS. While the theme CSS reloads during
   splash, the splash icon can loose theming. To prevent that, we set a
   default for its color variable */
:root {
  --jp-warn-color0: var(--md-orange-700);
}

/* not sure what to do with this one, used in filebrowser listing */
.jp-DragIcon {
  margin-right: 4px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for alt colors for icons as inline SVG HTMLElements
 */

/* alt recolor the primary elements of an icon */
.jp-icon-alt .jp-icon0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-alt .jp-icon0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* alt recolor the accent elements of an icon */
.jp-icon-alt .jp-icon-accent0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-alt .jp-icon-accent0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-icon-hoverShow:not(:hover) .jp-icon-hoverShow-content {
  display: none !important;
}

/**
 * Support for hover colors for icons as inline SVG HTMLElements
 */

/**
 * regular colors
 */

/* recolor the primary elements of an icon */
.jp-icon-hover :hover .jp-icon0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-hover :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-hover :hover .jp-icon-none-hover[fill] {
  fill: none;
}

.jp-icon-hover :hover .jp-icon-none-hover[stroke] {
  stroke: none;
}

/**
 * inverse colors
 */

/* inverse recolor the primary elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* inverse recolor the accent elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-IFrame {
  width: 100%;
  height: 100%;
}

.jp-IFrame > iframe {
  border: none;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-IFrame {
  position: relative;
}

body.lm-mod-override-cursor .jp-IFrame::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-HoverBox {
  position: fixed;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FormGroup-content fieldset {
  border: none;
  padding: 0;
  min-width: 0;
  width: 100%;
}

/* stylelint-disable selector-max-type */

.jp-FormGroup-content fieldset .jp-inputFieldWrapper input,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper select,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper textarea {
  font-size: var(--jp-content-font-size2);
  border-color: var(--jp-input-border-color);
  border-style: solid;
  border-radius: var(--jp-border-radius);
  border-width: 1px;
  padding: 6px 8px;
  background: none;
  color: var(--jp-ui-font-color0);
  height: inherit;
}

.jp-FormGroup-content fieldset input[type='checkbox'] {
  position: relative;
  top: 2px;
  margin-left: 0;
}

.jp-FormGroup-content button.jp-mod-styled {
  cursor: pointer;
}

.jp-FormGroup-content .checkbox label {
  cursor: pointer;
  font-size: var(--jp-content-font-size1);
}

.jp-FormGroup-content .jp-root > fieldset > legend {
  display: none;
}

.jp-FormGroup-content .jp-root > fieldset > p {
  display: none;
}

/** copy of `input.jp-mod-styled:focus` style */
.jp-FormGroup-content fieldset input:focus,
.jp-FormGroup-content fieldset select:focus {
  -moz-outline-radius: unset;
  outline: var(--jp-border-width) solid var(--md-blue-500);
  outline-offset: -1px;
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-FormGroup-content fieldset input:hover:not(:focus),
.jp-FormGroup-content fieldset select:hover:not(:focus) {
  background-color: var(--jp-border-color2);
}

/* stylelint-enable selector-max-type */

.jp-FormGroup-content .checkbox .field-description {
  /* Disable default description field for checkbox:
   because other widgets do not have description fields,
   we add descriptions to each widget on the field level.
  */
  display: none;
}

.jp-FormGroup-content #root__description {
  display: none;
}

.jp-FormGroup-content .jp-modifiedIndicator {
  width: 5px;
  background-color: var(--jp-brand-color2);
  margin-top: 0;
  margin-left: calc(var(--jp-private-settingeditor-modifier-indent) * -1);
  flex-shrink: 0;
}

.jp-FormGroup-content .jp-modifiedIndicator.jp-errorIndicator {
  background-color: var(--jp-error-color0);
  margin-right: 0.5em;
}

/* RJSF ARRAY style */

.jp-arrayFieldWrapper legend {
  font-size: var(--jp-content-font-size2);
  color: var(--jp-ui-font-color0);
  flex-basis: 100%;
  padding: 4px 0;
  font-weight: var(--jp-content-heading-font-weight);
  border-bottom: 1px solid var(--jp-border-color2);
}

.jp-arrayFieldWrapper .field-description {
  padding: 4px 0;
  white-space: pre-wrap;
}

.jp-arrayFieldWrapper .array-item {
  width: 100%;
  border: 1px solid var(--jp-border-color2);
  border-radius: 4px;
  margin: 4px;
}

.jp-ArrayOperations {
  display: flex;
  margin-left: 8px;
}

.jp-ArrayOperationsButton {
  margin: 2px;
}

.jp-ArrayOperationsButton .jp-icon3[fill] {
  fill: var(--jp-ui-font-color0);
}

button.jp-ArrayOperationsButton.jp-mod-styled:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

/* RJSF form validation error */

.jp-FormGroup-content .validationErrors {
  color: var(--jp-error-color0);
}

/* Hide panel level error as duplicated the field level error */
.jp-FormGroup-content .panel.errors {
  display: none;
}

/* RJSF normal content (settings-editor) */

.jp-FormGroup-contentNormal {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-FormGroup-contentItem {
  margin-left: 7px;
  color: var(--jp-ui-font-color0);
}

.jp-FormGroup-contentNormal .jp-FormGroup-description {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-default {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-fieldLabel {
  font-size: var(--jp-content-font-size1);
  font-weight: normal;
  min-width: 120px;
}

.jp-FormGroup-contentNormal fieldset:not(:first-child) {
  margin-left: 7px;
}

.jp-FormGroup-contentNormal .field-array-of-string .array-item {
  /* Display `jp-ArrayOperations` buttons side-by-side with content except
    for small screens where flex-wrap will place them one below the other.
  */
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-objectFieldWrapper .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

/* RJSF compact content (metadata-form) */

.jp-FormGroup-content.jp-FormGroup-contentCompact {
  width: 100%;
}

.jp-FormGroup-contentCompact .form-group {
  display: flex;
  padding: 0.5em 0.2em 0.5em 0;
}

.jp-FormGroup-contentCompact
  .jp-FormGroup-compactTitle
  .jp-FormGroup-description {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color2);
}

.jp-FormGroup-contentCompact .jp-FormGroup-fieldLabel {
  padding-bottom: 0.3em;
}

.jp-FormGroup-contentCompact .jp-inputFieldWrapper .form-control {
  width: 100%;
  box-sizing: border-box;
}

.jp-FormGroup-contentCompact .jp-arrayFieldWrapper .jp-FormGroup-compactTitle {
  padding-bottom: 7px;
}

.jp-FormGroup-contentCompact
  .jp-objectFieldWrapper
  .jp-objectFieldWrapper
  .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

.jp-FormGroup-contentCompact ul.error-detail {
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
  padding-inline-start: 1em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-SidePanel {
  display: flex;
  flex-direction: column;
  min-width: var(--jp-sidebar-min-width);
  overflow-y: auto;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);
  font-size: var(--jp-ui-font-size1);
}

.jp-SidePanel-header {
  flex: 0 0 auto;
  display: flex;
  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin: 0;
  padding: 2px;
  text-transform: uppercase;
}

.jp-SidePanel-toolbar {
  flex: 0 0 auto;
}

.jp-SidePanel-content {
  flex: 1 1 auto;
}

.jp-SidePanel-toolbar,
.jp-AccordionPanel-toolbar {
  height: var(--jp-private-toolbar-height);
}

.jp-SidePanel-toolbar.jp-Toolbar-micro {
  display: none;
}

.lm-AccordionPanel .jp-AccordionPanel-title {
  box-sizing: border-box;
  line-height: 25px;
  margin: 0;
  display: flex;
  align-items: center;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  font-size: var(--jp-ui-font-size0);
}

.jp-AccordionPanel-title {
  cursor: pointer;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  text-transform: uppercase;
}

.lm-AccordionPanel[data-orientation='horizontal'] > .jp-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleLabel {
  user-select: none;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleCollapser {
  transform: rotate(-90deg);
  margin: auto 0;
  height: 16px;
}

.jp-AccordionPanel-title.lm-mod-expanded .lm-AccordionPanel-titleCollapser {
  transform: rotate(0deg);
}

.lm-AccordionPanel .jp-AccordionPanel-toolbar {
  background: none;
  box-shadow: none;
  border: none;
  margin-left: auto;
}

.lm-AccordionPanel .lm-SplitPanel-handle:hover {
  background: var(--jp-layout-color3);
}

.jp-text-truncated {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Spinner {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-layout-color0);
  outline: none;
}

.jp-SpinnerContent {
  font-size: 10px;
  margin: 50px auto;
  text-indent: -9999em;
  width: 3em;
  height: 3em;
  border-radius: 50%;
  background: var(--jp-brand-color3);
  background: linear-gradient(
    to right,
    #f37626 10%,
    rgba(255, 255, 255, 0) 42%
  );
  position: relative;
  animation: load3 1s infinite linear, fadeIn 1s;
}

.jp-SpinnerContent::before {
  width: 50%;
  height: 50%;
  background: #f37626;
  border-radius: 100% 0 0;
  position: absolute;
  top: 0;
  left: 0;
  content: '';
}

.jp-SpinnerContent::after {
  background: var(--jp-layout-color0);
  width: 75%;
  height: 75%;
  border-radius: 50%;
  content: '';
  margin: auto;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
}

@keyframes fadeIn {
  0% {
    opacity: 0;
  }

  100% {
    opacity: 1;
  }
}

@keyframes load3 {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

button.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: none;
  box-sizing: border-box;
  text-align: center;
  line-height: 32px;
  height: 32px;
  padding: 0 12px;
  letter-spacing: 0.8px;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input.jp-mod-styled {
  background: var(--jp-input-background);
  height: 28px;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color1);
  padding-left: 7px;
  padding-right: 7px;
  font-size: var(--jp-ui-font-size2);
  color: var(--jp-ui-font-color0);
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input[type='checkbox'].jp-mod-styled {
  appearance: checkbox;
  -webkit-appearance: checkbox;
  -moz-appearance: checkbox;
  height: auto;
}

input.jp-mod-styled:focus {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-select-wrapper {
  display: flex;
  position: relative;
  flex-direction: column;
  padding: 1px;
  background-color: var(--jp-layout-color1);
  box-sizing: border-box;
  margin-bottom: 12px;
}

.jp-select-wrapper:not(.multiple) {
  height: 28px;
}

.jp-select-wrapper.jp-mod-focused select.jp-mod-styled {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-input-active-background);
}

select.jp-mod-styled:hover {
  cursor: pointer;
  color: var(--jp-ui-font-color0);
  background-color: var(--jp-input-hover-background);
  box-shadow: inset 0 0 1px rgba(0, 0, 0, 0.5);
}

select.jp-mod-styled {
  flex: 1 1 auto;
  width: 100%;
  font-size: var(--jp-ui-font-size2);
  background: var(--jp-input-background);
  color: var(--jp-ui-font-color0);
  padding: 0 25px 0 8px;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

select.jp-mod-styled:not([multiple]) {
  height: 32px;
}

select.jp-mod-styled[multiple] {
  max-height: 200px;
  overflow-y: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-switch {
  display: flex;
  align-items: center;
  padding-left: 4px;
  padding-right: 4px;
  font-size: var(--jp-ui-font-size1);
  background-color: transparent;
  color: var(--jp-ui-font-color1);
  border: none;
  height: 20px;
}

.jp-switch:hover {
  background-color: var(--jp-layout-color2);
}

.jp-switch-label {
  margin-right: 5px;
  font-family: var(--jp-ui-font-family);
}

.jp-switch-track {
  cursor: pointer;
  background-color: var(--jp-switch-color, var(--jp-border-color1));
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 34px;
  height: 16px;
  width: 35px;
  position: relative;
}

.jp-switch-track::before {
  content: '';
  position: absolute;
  height: 10px;
  width: 10px;
  margin: 3px;
  left: 0;
  background-color: var(--jp-ui-inverse-font-color1);
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 50%;
}

.jp-switch[aria-checked='true'] .jp-switch-track {
  background-color: var(--jp-switch-true-position-color, var(--jp-warn-color0));
}

.jp-switch[aria-checked='true'] .jp-switch-track::before {
  /* track width (35) - margins (3 + 3) - thumb width (10) */
  left: 19px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toolbar-height: calc(
    28px + var(--jp-border-width)
  ); /* leave 28px for content */
}

.jp-Toolbar {
  color: var(--jp-ui-font-color1);
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: 2px;
  z-index: 8;
  overflow-x: hidden;
}

/* Toolbar items */

.jp-Toolbar > .jp-Toolbar-item.jp-Toolbar-spacer {
  flex-grow: 1;
  flex-shrink: 1;
}

.jp-Toolbar-item.jp-Toolbar-kernelStatus {
  display: inline-block;
  width: 32px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 16px;
}

.jp-Toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  display: flex;
  padding-left: 1px;
  padding-right: 1px;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-private-toolbar-height);
  height: 100%;
}

/* Toolbar buttons */

/* This is the div we use to wrap the react component into a Widget */
div.jp-ToolbarButton {
  color: transparent;
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0;
  margin: 0;
}

button.jp-ToolbarButtonComponent {
  background: var(--jp-layout-color1);
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0 6px;
  margin: 0;
  height: 24px;
  border-radius: var(--jp-border-radius);
  display: flex;
  align-items: center;
  text-align: center;
  font-size: 14px;
  min-width: unset;
  min-height: unset;
}

button.jp-ToolbarButtonComponent:disabled {
  opacity: 0.4;
}

button.jp-ToolbarButtonComponent > span {
  padding: 0;
  flex: 0 0 auto;
}

button.jp-ToolbarButtonComponent .jp-ToolbarButtonComponent-label {
  font-size: var(--jp-ui-font-size1);
  line-height: 100%;
  padding-left: 2px;
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar.jp-Toolbar-micro {
  padding: 0;
  min-height: 0;
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar {
  border: none;
  box-shadow: none;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-WindowedPanel-outer {
  position: relative;
  overflow-y: auto;
}

.jp-WindowedPanel-inner {
  position: relative;
}

.jp-WindowedPanel-window {
  position: absolute;
  left: 0;
  right: 0;
  overflow: visible;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* Sibling imports */

body {
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
}

/* Disable native link decoration styles everywhere outside of dialog boxes */
a {
  text-decoration: unset;
  color: unset;
}

a:hover {
  text-decoration: unset;
  color: unset;
}

/* Accessibility for links inside dialog box text */
.jp-Dialog-content a {
  text-decoration: revert;
  color: var(--jp-content-link-color);
}

.jp-Dialog-content a:hover {
  text-decoration: revert;
}

/* Styles for ui-components */
.jp-Button {
  color: var(--jp-ui-font-color2);
  border-radius: var(--jp-border-radius);
  padding: 0 12px;
  font-size: var(--jp-ui-font-size1);

  /* Copy from blueprint 3 */
  display: inline-flex;
  flex-direction: row;
  border: none;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  text-align: left;
  vertical-align: middle;
  min-height: 30px;
  min-width: 30px;
}

.jp-Button:disabled {
  cursor: not-allowed;
}

.jp-Button:empty {
  padding: 0 !important;
}

.jp-Button.jp-mod-small {
  min-height: 24px;
  min-width: 24px;
  font-size: 12px;
  padding: 0 7px;
}

/* Use our own theme for hover styles */
.jp-Button.jp-mod-minimal:hover {
  background-color: var(--jp-layout-color2);
}

.jp-Button.jp-mod-minimal {
  background: none;
}

.jp-InputGroup {
  display: block;
  position: relative;
}

.jp-InputGroup input {
  box-sizing: border-box;
  border: none;
  border-radius: 0;
  background-color: transparent;
  color: var(--jp-ui-font-color0);
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
  padding-bottom: 0;
  padding-top: 0;
  padding-left: 10px;
  padding-right: 28px;
  position: relative;
  width: 100%;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  font-size: 14px;
  font-weight: 400;
  height: 30px;
  line-height: 30px;
  outline: none;
  vertical-align: middle;
}

.jp-InputGroup input:focus {
  box-shadow: inset 0 0 0 var(--jp-border-width)
      var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-InputGroup input:disabled {
  cursor: not-allowed;
  resize: block;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input:disabled ~ span {
  cursor: not-allowed;
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input::placeholder,
input::placeholder {
  color: var(--jp-ui-font-color2);
}

.jp-InputGroupAction {
  position: absolute;
  bottom: 1px;
  right: 0;
  padding: 6px;
}

.jp-HTMLSelect.jp-DefaultStyle select {
  background-color: initial;
  border: none;
  border-radius: 0;
  box-shadow: none;
  color: var(--jp-ui-font-color0);
  display: block;
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  height: 24px;
  line-height: 14px;
  padding: 0 25px 0 10px;
  text-align: left;
  -moz-appearance: none;
  -webkit-appearance: none;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
  cursor: not-allowed;
  resize: block;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled ~ span {
  cursor: not-allowed;
}

/* Use our own theme for hover and option styles */
/* stylelint-disable-next-line selector-max-type */
.jp-HTMLSelect.jp-DefaultStyle select:hover,
.jp-HTMLSelect.jp-DefaultStyle select > option {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color0);
}

select {
  box-sizing: border-box;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-StatusBar-Widget {
  display: flex;
  align-items: center;
  background: var(--jp-layout-color2);
  min-height: var(--jp-statusbar-height);
  justify-content: space-between;
  padding: 0 10px;
}

.jp-StatusBar-Left {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-StatusBar-Middle {
  display: flex;
  align-items: center;
}

.jp-StatusBar-Right {
  display: flex;
  align-items: center;
  flex-direction: row-reverse;
}

.jp-StatusBar-Item {
  max-height: var(--jp-statusbar-height);
  margin: 0 2px;
  height: var(--jp-statusbar-height);
  white-space: nowrap;
  text-overflow: ellipsis;
  color: var(--jp-ui-font-color1);
  padding: 0 6px;
}

.jp-mod-highlighted:hover {
  background-color: var(--jp-layout-color3);
}

.jp-mod-clicked {
  background-color: var(--jp-brand-color1);
}

.jp-mod-clicked:hover {
  background-color: var(--jp-brand-color0);
}

.jp-mod-clicked .jp-StatusBar-TextItem {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-StatusBar-HoverItem {
  box-shadow: '0px 4px 4px rgba(0, 0, 0, 0.25)';
}

.jp-StatusBar-TextItem {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  line-height: 24px;
  color: var(--jp-ui-font-color1);
}

.jp-StatusBar-GroupItem {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-Statusbar-ProgressCircle svg {
  display: block;
  margin: 0 auto;
  width: 16px;
  height: 24px;
  align-self: normal;
}

.jp-Statusbar-ProgressCircle path {
  fill: var(--jp-inverse-layout-color3);
}

.jp-Statusbar-ProgressBar-progress-bar {
  height: 10px;
  width: 100px;
  border: solid 0.25px var(--jp-brand-color2);
  border-radius: 3px;
  overflow: hidden;
  align-self: center;
}

.jp-Statusbar-ProgressBar-progress-bar > div {
  background-color: var(--jp-brand-color2);
  background-image: linear-gradient(
    -45deg,
    rgba(255, 255, 255, 0.2) 25%,
    transparent 25%,
    transparent 50%,
    rgba(255, 255, 255, 0.2) 50%,
    rgba(255, 255, 255, 0.2) 75%,
    transparent 75%,
    transparent
  );
  background-size: 40px 40px;
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 14px;
  color: #fff;
  text-align: center;
  animation: jp-Statusbar-ExecutionTime-progress-bar 2s linear infinite;
}

.jp-Statusbar-ProgressBar-progress-bar p {
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  line-height: 10px;
  width: 100px;
}

@keyframes jp-Statusbar-ExecutionTime-progress-bar {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 40px 40px;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-commandpalette-search-height: 28px;
}

/*-----------------------------------------------------------------------------
| Overall styles
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  padding-bottom: 0;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Modal variant
|----------------------------------------------------------------------------*/

.jp-ModalCommandPalette {
  position: absolute;
  z-index: 10000;
  top: 38px;
  left: 30%;
  margin: 0;
  padding: 4px;
  width: 40%;
  box-shadow: var(--jp-elevation-z4);
  border-radius: 4px;
  background: var(--jp-layout-color0);
}

.jp-ModalCommandPalette .lm-CommandPalette {
  max-height: 40vh;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-close-icon::after {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-header {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-item {
  margin-left: 4px;
  margin-right: 4px;
}

.jp-ModalCommandPalette
  .lm-CommandPalette
  .lm-CommandPalette-item.lm-mod-disabled {
  display: none;
}

/*-----------------------------------------------------------------------------
| Search
|----------------------------------------------------------------------------*/

.lm-CommandPalette-search {
  padding: 4px;
  background-color: var(--jp-layout-color1);
  z-index: 2;
}

.lm-CommandPalette-wrapper {
  overflow: overlay;
  padding: 0 9px;
  background-color: var(--jp-input-active-background);
  height: 30px;
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
}

.lm-CommandPalette.lm-mod-focused .lm-CommandPalette-wrapper {
  box-shadow: inset 0 0 0 1px var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-SearchIconGroup {
  color: white;
  background-color: var(--jp-brand-color1);
  position: absolute;
  top: 4px;
  right: 4px;
  padding: 5px 5px 1px;
}

.jp-SearchIconGroup svg {
  height: 20px;
  width: 20px;
}

.jp-SearchIconGroup .jp-icon3[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-input {
  background: transparent;
  width: calc(100% - 18px);
  float: left;
  border: none;
  outline: none;
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  line-height: var(--jp-private-commandpalette-search-height);
}

.lm-CommandPalette-input::-webkit-input-placeholder,
.lm-CommandPalette-input::-moz-placeholder,
.lm-CommandPalette-input:-ms-input-placeholder {
  color: var(--jp-ui-font-color2);
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Results
|----------------------------------------------------------------------------*/

.lm-CommandPalette-header:first-child {
  margin-top: 0;
}

.lm-CommandPalette-header {
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin-top: 8px;
  padding: 8px 0 8px 12px;
  text-transform: uppercase;
}

.lm-CommandPalette-header.lm-mod-active {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-header > mark {
  background-color: transparent;
  font-weight: bold;
  color: var(--jp-ui-font-color1);
}

.lm-CommandPalette-item {
  padding: 4px 12px 4px 4px;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  font-weight: 400;
  display: flex;
}

.lm-CommandPalette-item.lm-mod-disabled {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item.lm-mod-active {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item.lm-mod-active .lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-inverse-font-color0);
}

.lm-CommandPalette-item.lm-mod-active .jp-icon-selectable[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-item.lm-mod-active:hover:not(.lm-mod-disabled) {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item:hover:not(.lm-mod-active):not(.lm-mod-disabled) {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-itemContent {
  overflow: hidden;
}

.lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.lm-CommandPalette-item.lm-mod-disabled mark {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item .lm-CommandPalette-itemIcon {
  margin: 0 4px 0 0;
  position: relative;
  width: 16px;
  top: 2px;
  flex: 0 0 auto;
}

.lm-CommandPalette-item.lm-mod-disabled .lm-CommandPalette-itemIcon {
  opacity: 0.6;
}

.lm-CommandPalette-item .lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemCaption {
  display: none;
}

.lm-CommandPalette-content {
  background-color: var(--jp-layout-color1);
}

.lm-CommandPalette-content:empty::after {
  content: 'No results';
  margin: auto;
  margin-top: 20px;
  width: 100px;
  display: block;
  font-size: var(--jp-ui-font-size2);
  font-family: var(--jp-ui-font-family);
  font-weight: lighter;
}

.lm-CommandPalette-emptyMessage {
  text-align: center;
  margin-top: 24px;
  line-height: 1.32;
  padding: 0 8px;
  color: var(--jp-content-font-color3);
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Dialog {
  position: absolute;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-dialog-background);
}

.jp-Dialog-content {
  display: flex;
  flex-direction: column;
  margin-left: auto;
  margin-right: auto;
  background: var(--jp-layout-color1);
  padding: 24px 24px 12px;
  min-width: 300px;
  min-height: 150px;
  max-width: 1000px;
  max-height: 500px;
  box-sizing: border-box;
  box-shadow: var(--jp-elevation-z20);
  word-wrap: break-word;
  border-radius: var(--jp-border-radius);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color1);
  resize: both;
}

.jp-Dialog-content.jp-Dialog-content-small {
  max-width: 500px;
}

.jp-Dialog-button {
  overflow: visible;
}

button.jp-Dialog-button:focus {
  outline: 1px solid var(--jp-brand-color1);
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button:focus::-moz-focus-inner {
  border: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus {
  outline: 1px solid var(--jp-accept-color-normal, var(--jp-brand-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus {
  outline: 1px solid var(--jp-warn-color-normal, var(--jp-error-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline: 1px solid var(--jp-reject-color-normal, var(--md-grey-600));
}

button.jp-Dialog-close-button {
  padding: 0;
  height: 100%;
  min-width: unset;
  min-height: unset;
}

.jp-Dialog-header {
  display: flex;
  justify-content: space-between;
  flex: 0 0 auto;
  padding-bottom: 12px;
  font-size: var(--jp-ui-font-size3);
  font-weight: 400;
  color: var(--jp-ui-font-color1);
}

.jp-Dialog-body {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  font-size: var(--jp-ui-font-size1);
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

.jp-Dialog-footer {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  flex: 0 0 auto;
  margin-left: -12px;
  margin-right: -12px;
  padding: 12px;
}

.jp-Dialog-checkbox {
  padding-right: 5px;
}

.jp-Dialog-checkbox > input:focus-visible {
  outline: 1px solid var(--jp-input-active-border-color);
  outline-offset: 1px;
}

.jp-Dialog-spacer {
  flex: 1 1 auto;
}

.jp-Dialog-title {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.jp-Dialog-body > .jp-select-wrapper {
  width: 100%;
}

.jp-Dialog-body > button {
  padding: 0 16px;
}

.jp-Dialog-body > label {
  line-height: 1.4;
  color: var(--jp-ui-font-color0);
}

.jp-Dialog-button.jp-mod-styled:not(:last-child) {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Input-Boolean-Dialog {
  flex-direction: row-reverse;
  align-items: end;
  width: 100%;
}

.jp-Input-Boolean-Dialog > label {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MainAreaWidget > :focus {
  outline: none;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error {
  padding: 6px;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error > pre {
  width: auto;
  padding: 10px;
  background: var(--jp-error-color3);
  border: var(--jp-border-width) solid var(--jp-error-color1);
  border-radius: var(--jp-border-radius);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  white-space: pre-wrap;
  word-wrap: break-word;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/**
 * google-material-color v1.2.6
 * https://github.com/danlevan/google-material-color
 */
:root {
  --md-red-50: #ffebee;
  --md-red-100: #ffcdd2;
  --md-red-200: #ef9a9a;
  --md-red-300: #e57373;
  --md-red-400: #ef5350;
  --md-red-500: #f44336;
  --md-red-600: #e53935;
  --md-red-700: #d32f2f;
  --md-red-800: #c62828;
  --md-red-900: #b71c1c;
  --md-red-A100: #ff8a80;
  --md-red-A200: #ff5252;
  --md-red-A400: #ff1744;
  --md-red-A700: #d50000;
  --md-pink-50: #fce4ec;
  --md-pink-100: #f8bbd0;
  --md-pink-200: #f48fb1;
  --md-pink-300: #f06292;
  --md-pink-400: #ec407a;
  --md-pink-500: #e91e63;
  --md-pink-600: #d81b60;
  --md-pink-700: #c2185b;
  --md-pink-800: #ad1457;
  --md-pink-900: #880e4f;
  --md-pink-A100: #ff80ab;
  --md-pink-A200: #ff4081;
  --md-pink-A400: #f50057;
  --md-pink-A700: #c51162;
  --md-purple-50: #f3e5f5;
  --md-purple-100: #e1bee7;
  --md-purple-200: #ce93d8;
  --md-purple-300: #ba68c8;
  --md-purple-400: #ab47bc;
  --md-purple-500: #9c27b0;
  --md-purple-600: #8e24aa;
  --md-purple-700: #7b1fa2;
  --md-purple-800: #6a1b9a;
  --md-purple-900: #4a148c;
  --md-purple-A100: #ea80fc;
  --md-purple-A200: #e040fb;
  --md-purple-A400: #d500f9;
  --md-purple-A700: #a0f;
  --md-deep-purple-50: #ede7f6;
  --md-deep-purple-100: #d1c4e9;
  --md-deep-purple-200: #b39ddb;
  --md-deep-purple-300: #9575cd;
  --md-deep-purple-400: #7e57c2;
  --md-deep-purple-500: #673ab7;
  --md-deep-purple-600: #5e35b1;
  --md-deep-purple-700: #512da8;
  --md-deep-purple-800: #4527a0;
  --md-deep-purple-900: #311b92;
  --md-deep-purple-A100: #b388ff;
  --md-deep-purple-A200: #7c4dff;
  --md-deep-purple-A400: #651fff;
  --md-deep-purple-A700: #6200ea;
  --md-indigo-50: #e8eaf6;
  --md-indigo-100: #c5cae9;
  --md-indigo-200: #9fa8da;
  --md-indigo-300: #7986cb;
  --md-indigo-400: #5c6bc0;
  --md-indigo-500: #3f51b5;
  --md-indigo-600: #3949ab;
  --md-indigo-700: #303f9f;
  --md-indigo-800: #283593;
  --md-indigo-900: #1a237e;
  --md-indigo-A100: #8c9eff;
  --md-indigo-A200: #536dfe;
  --md-indigo-A400: #3d5afe;
  --md-indigo-A700: #304ffe;
  --md-blue-50: #e3f2fd;
  --md-blue-100: #bbdefb;
  --md-blue-200: #90caf9;
  --md-blue-300: #64b5f6;
  --md-blue-400: #42a5f5;
  --md-blue-500: #2196f3;
  --md-blue-600: #1e88e5;
  --md-blue-700: #1976d2;
  --md-blue-800: #1565c0;
  --md-blue-900: #0d47a1;
  --md-blue-A100: #82b1ff;
  --md-blue-A200: #448aff;
  --md-blue-A400: #2979ff;
  --md-blue-A700: #2962ff;
  --md-light-blue-50: #e1f5fe;
  --md-light-blue-100: #b3e5fc;
  --md-light-blue-200: #81d4fa;
  --md-light-blue-300: #4fc3f7;
  --md-light-blue-400: #29b6f6;
  --md-light-blue-500: #03a9f4;
  --md-light-blue-600: #039be5;
  --md-light-blue-700: #0288d1;
  --md-light-blue-800: #0277bd;
  --md-light-blue-900: #01579b;
  --md-light-blue-A100: #80d8ff;
  --md-light-blue-A200: #40c4ff;
  --md-light-blue-A400: #00b0ff;
  --md-light-blue-A700: #0091ea;
  --md-cyan-50: #e0f7fa;
  --md-cyan-100: #b2ebf2;
  --md-cyan-200: #80deea;
  --md-cyan-300: #4dd0e1;
  --md-cyan-400: #26c6da;
  --md-cyan-500: #00bcd4;
  --md-cyan-600: #00acc1;
  --md-cyan-700: #0097a7;
  --md-cyan-800: #00838f;
  --md-cyan-900: #006064;
  --md-cyan-A100: #84ffff;
  --md-cyan-A200: #18ffff;
  --md-cyan-A400: #00e5ff;
  --md-cyan-A700: #00b8d4;
  --md-teal-50: #e0f2f1;
  --md-teal-100: #b2dfdb;
  --md-teal-200: #80cbc4;
  --md-teal-300: #4db6ac;
  --md-teal-400: #26a69a;
  --md-teal-500: #009688;
  --md-teal-600: #00897b;
  --md-teal-700: #00796b;
  --md-teal-800: #00695c;
  --md-teal-900: #004d40;
  --md-teal-A100: #a7ffeb;
  --md-teal-A200: #64ffda;
  --md-teal-A400: #1de9b6;
  --md-teal-A700: #00bfa5;
  --md-green-50: #e8f5e9;
  --md-green-100: #c8e6c9;
  --md-green-200: #a5d6a7;
  --md-green-300: #81c784;
  --md-green-400: #66bb6a;
  --md-green-500: #4caf50;
  --md-green-600: #43a047;
  --md-green-700: #388e3c;
  --md-green-800: #2e7d32;
  --md-green-900: #1b5e20;
  --md-green-A100: #b9f6ca;
  --md-green-A200: #69f0ae;
  --md-green-A400: #00e676;
  --md-green-A700: #00c853;
  --md-light-green-50: #f1f8e9;
  --md-light-green-100: #dcedc8;
  --md-light-green-200: #c5e1a5;
  --md-light-green-300: #aed581;
  --md-light-green-400: #9ccc65;
  --md-light-green-500: #8bc34a;
  --md-light-green-600: #7cb342;
  --md-light-green-700: #689f38;
  --md-light-green-800: #558b2f;
  --md-light-green-900: #33691e;
  --md-light-green-A100: #ccff90;
  --md-light-green-A200: #b2ff59;
  --md-light-green-A400: #76ff03;
  --md-light-green-A700: #64dd17;
  --md-lime-50: #f9fbe7;
  --md-lime-100: #f0f4c3;
  --md-lime-200: #e6ee9c;
  --md-lime-300: #dce775;
  --md-lime-400: #d4e157;
  --md-lime-500: #cddc39;
  --md-lime-600: #c0ca33;
  --md-lime-700: #afb42b;
  --md-lime-800: #9e9d24;
  --md-lime-900: #827717;
  --md-lime-A100: #f4ff81;
  --md-lime-A200: #eeff41;
  --md-lime-A400: #c6ff00;
  --md-lime-A700: #aeea00;
  --md-yellow-50: #fffde7;
  --md-yellow-100: #fff9c4;
  --md-yellow-200: #fff59d;
  --md-yellow-300: #fff176;
  --md-yellow-400: #ffee58;
  --md-yellow-500: #ffeb3b;
  --md-yellow-600: #fdd835;
  --md-yellow-700: #fbc02d;
  --md-yellow-800: #f9a825;
  --md-yellow-900: #f57f17;
  --md-yellow-A100: #ffff8d;
  --md-yellow-A200: #ff0;
  --md-yellow-A400: #ffea00;
  --md-yellow-A700: #ffd600;
  --md-amber-50: #fff8e1;
  --md-amber-100: #ffecb3;
  --md-amber-200: #ffe082;
  --md-amber-300: #ffd54f;
  --md-amber-400: #ffca28;
  --md-amber-500: #ffc107;
  --md-amber-600: #ffb300;
  --md-amber-700: #ffa000;
  --md-amber-800: #ff8f00;
  --md-amber-900: #ff6f00;
  --md-amber-A100: #ffe57f;
  --md-amber-A200: #ffd740;
  --md-amber-A400: #ffc400;
  --md-amber-A700: #ffab00;
  --md-orange-50: #fff3e0;
  --md-orange-100: #ffe0b2;
  --md-orange-200: #ffcc80;
  --md-orange-300: #ffb74d;
  --md-orange-400: #ffa726;
  --md-orange-500: #ff9800;
  --md-orange-600: #fb8c00;
  --md-orange-700: #f57c00;
  --md-orange-800: #ef6c00;
  --md-orange-900: #e65100;
  --md-orange-A100: #ffd180;
  --md-orange-A200: #ffab40;
  --md-orange-A400: #ff9100;
  --md-orange-A700: #ff6d00;
  --md-deep-orange-50: #fbe9e7;
  --md-deep-orange-100: #ffccbc;
  --md-deep-orange-200: #ffab91;
  --md-deep-orange-300: #ff8a65;
  --md-deep-orange-400: #ff7043;
  --md-deep-orange-500: #ff5722;
  --md-deep-orange-600: #f4511e;
  --md-deep-orange-700: #e64a19;
  --md-deep-orange-800: #d84315;
  --md-deep-orange-900: #bf360c;
  --md-deep-orange-A100: #ff9e80;
  --md-deep-orange-A200: #ff6e40;
  --md-deep-orange-A400: #ff3d00;
  --md-deep-orange-A700: #dd2c00;
  --md-brown-50: #efebe9;
  --md-brown-100: #d7ccc8;
  --md-brown-200: #bcaaa4;
  --md-brown-300: #a1887f;
  --md-brown-400: #8d6e63;
  --md-brown-500: #795548;
  --md-brown-600: #6d4c41;
  --md-brown-700: #5d4037;
  --md-brown-800: #4e342e;
  --md-brown-900: #3e2723;
  --md-grey-50: #fafafa;
  --md-grey-100: #f5f5f5;
  --md-grey-200: #eee;
  --md-grey-300: #e0e0e0;
  --md-grey-400: #bdbdbd;
  --md-grey-500: #9e9e9e;
  --md-grey-600: #757575;
  --md-grey-700: #616161;
  --md-grey-800: #424242;
  --md-grey-900: #212121;
  --md-blue-grey-50: #eceff1;
  --md-blue-grey-100: #cfd8dc;
  --md-blue-grey-200: #b0bec5;
  --md-blue-grey-300: #90a4ae;
  --md-blue-grey-400: #78909c;
  --md-blue-grey-500: #607d8b;
  --md-blue-grey-600: #546e7a;
  --md-blue-grey-700: #455a64;
  --md-blue-grey-800: #37474f;
  --md-blue-grey-900: #263238;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| RenderedText
|----------------------------------------------------------------------------*/

:root {
  /* This is the padding value to fill the gaps between lines containing spans with background color. */
  --jp-private-code-span-padding: calc(
    (var(--jp-code-line-height) - 1) * var(--jp-code-font-size) / 2
  );
}

.jp-RenderedText {
  text-align: left;
  padding-left: var(--jp-code-padding);
  line-height: var(--jp-code-line-height);
  font-family: var(--jp-code-font-family);
}

.jp-RenderedText pre,
.jp-RenderedJavaScript pre,
.jp-RenderedHTMLCommon pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
  border: none;
  margin: 0;
  padding: 0;
}

.jp-RenderedText pre a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* console foregrounds and backgrounds */
.jp-RenderedText pre .ansi-black-fg {
  color: #3e424d;
}

.jp-RenderedText pre .ansi-red-fg {
  color: #e75c58;
}

.jp-RenderedText pre .ansi-green-fg {
  color: #00a250;
}

.jp-RenderedText pre .ansi-yellow-fg {
  color: #ddb62b;
}

.jp-RenderedText pre .ansi-blue-fg {
  color: #208ffb;
}

.jp-RenderedText pre .ansi-magenta-fg {
  color: #d160c4;
}

.jp-RenderedText pre .ansi-cyan-fg {
  color: #60c6c8;
}

.jp-RenderedText pre .ansi-white-fg {
  color: #c5c1b4;
}

.jp-RenderedText pre .ansi-black-bg {
  background-color: #3e424d;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-bg {
  background-color: #e75c58;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-bg {
  background-color: #00a250;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-bg {
  background-color: #ddb62b;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-bg {
  background-color: #208ffb;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-bg {
  background-color: #d160c4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-bg {
  background-color: #60c6c8;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-bg {
  background-color: #c5c1b4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-black-intense-fg {
  color: #282c36;
}

.jp-RenderedText pre .ansi-red-intense-fg {
  color: #b22b31;
}

.jp-RenderedText pre .ansi-green-intense-fg {
  color: #007427;
}

.jp-RenderedText pre .ansi-yellow-intense-fg {
  color: #b27d12;
}

.jp-RenderedText pre .ansi-blue-intense-fg {
  color: #0065ca;
}

.jp-RenderedText pre .ansi-magenta-intense-fg {
  color: #a03196;
}

.jp-RenderedText pre .ansi-cyan-intense-fg {
  color: #258f8f;
}

.jp-RenderedText pre .ansi-white-intense-fg {
  color: #a1a6b2;
}

.jp-RenderedText pre .ansi-black-intense-bg {
  background-color: #282c36;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-intense-bg {
  background-color: #b22b31;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-intense-bg {
  background-color: #007427;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-intense-bg {
  background-color: #b27d12;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-intense-bg {
  background-color: #0065ca;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-intense-bg {
  background-color: #a03196;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-intense-bg {
  background-color: #258f8f;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-intense-bg {
  background-color: #a1a6b2;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-default-inverse-fg {
  color: var(--jp-ui-inverse-font-color0);
}

.jp-RenderedText pre .ansi-default-inverse-bg {
  background-color: var(--jp-inverse-layout-color0);
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-bold {
  font-weight: bold;
}

.jp-RenderedText pre .ansi-underline {
  text-decoration: underline;
}

.jp-RenderedText[data-mime-type='application/vnd.jupyter.stderr'] {
  background: var(--jp-rendermime-error-background);
  padding-top: var(--jp-code-padding);
}

/*-----------------------------------------------------------------------------
| RenderedLatex
|----------------------------------------------------------------------------*/

.jp-RenderedLatex {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);
}

/* Left-justify outputs.*/
.jp-OutputArea-output.jp-RenderedLatex {
  padding: var(--jp-code-padding);
  text-align: left;
}

/*-----------------------------------------------------------------------------
| RenderedHTML
|----------------------------------------------------------------------------*/

.jp-RenderedHTMLCommon {
  color: var(--jp-content-font-color1);
  font-family: var(--jp-content-font-family);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);

  /* Give a bit more R padding on Markdown text to keep line lengths reasonable */
  padding-right: 20px;
}

.jp-RenderedHTMLCommon em {
  font-style: italic;
}

.jp-RenderedHTMLCommon strong {
  font-weight: bold;
}

.jp-RenderedHTMLCommon u {
  text-decoration: underline;
}

.jp-RenderedHTMLCommon a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* Headings */

.jp-RenderedHTMLCommon h1,
.jp-RenderedHTMLCommon h2,
.jp-RenderedHTMLCommon h3,
.jp-RenderedHTMLCommon h4,
.jp-RenderedHTMLCommon h5,
.jp-RenderedHTMLCommon h6 {
  line-height: var(--jp-content-heading-line-height);
  font-weight: var(--jp-content-heading-font-weight);
  font-style: normal;
  margin: var(--jp-content-heading-margin-top) 0
    var(--jp-content-heading-margin-bottom) 0;
}

.jp-RenderedHTMLCommon h1:first-child,
.jp-RenderedHTMLCommon h2:first-child,
.jp-RenderedHTMLCommon h3:first-child,
.jp-RenderedHTMLCommon h4:first-child,
.jp-RenderedHTMLCommon h5:first-child,
.jp-RenderedHTMLCommon h6:first-child {
  margin-top: calc(0.5 * var(--jp-content-heading-margin-top));
}

.jp-RenderedHTMLCommon h1:last-child,
.jp-RenderedHTMLCommon h2:last-child,
.jp-RenderedHTMLCommon h3:last-child,
.jp-RenderedHTMLCommon h4:last-child,
.jp-RenderedHTMLCommon h5:last-child,
.jp-RenderedHTMLCommon h6:last-child {
  margin-bottom: calc(0.5 * var(--jp-content-heading-margin-bottom));
}

.jp-RenderedHTMLCommon h1 {
  font-size: var(--jp-content-font-size5);
}

.jp-RenderedHTMLCommon h2 {
  font-size: var(--jp-content-font-size4);
}

.jp-RenderedHTMLCommon h3 {
  font-size: var(--jp-content-font-size3);
}

.jp-RenderedHTMLCommon h4 {
  font-size: var(--jp-content-font-size2);
}

.jp-RenderedHTMLCommon h5 {
  font-size: var(--jp-content-font-size1);
}

.jp-RenderedHTMLCommon h6 {
  font-size: var(--jp-content-font-size0);
}

/* Lists */

/* stylelint-disable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon ul:not(.list-inline),
.jp-RenderedHTMLCommon ol:not(.list-inline) {
  padding-left: 2em;
}

.jp-RenderedHTMLCommon ul {
  list-style: disc;
}

.jp-RenderedHTMLCommon ul ul {
  list-style: square;
}

.jp-RenderedHTMLCommon ul ul ul {
  list-style: circle;
}

.jp-RenderedHTMLCommon ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol ol {
  list-style: upper-alpha;
}

.jp-RenderedHTMLCommon ol ol ol {
  list-style: lower-alpha;
}

.jp-RenderedHTMLCommon ol ol ol ol {
  list-style: lower-roman;
}

.jp-RenderedHTMLCommon ol ol ol ol ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol,
.jp-RenderedHTMLCommon ul {
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon ul ul,
.jp-RenderedHTMLCommon ul ol,
.jp-RenderedHTMLCommon ol ul,
.jp-RenderedHTMLCommon ol ol {
  margin-bottom: 0;
}

/* stylelint-enable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon hr {
  color: var(--jp-border-color2);
  background-color: var(--jp-border-color1);
  margin-top: 1em;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon > pre {
  margin: 1.5em 2em;
}

.jp-RenderedHTMLCommon pre,
.jp-RenderedHTMLCommon code {
  border: 0;
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  line-height: var(--jp-code-line-height);
  padding: 0;
  white-space: pre-wrap;
}

.jp-RenderedHTMLCommon :not(pre) > code {
  background-color: var(--jp-layout-color2);
  padding: 1px 5px;
}

/* Tables */

.jp-RenderedHTMLCommon table {
  border-collapse: collapse;
  border-spacing: 0;
  border: none;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  table-layout: fixed;
  margin-left: auto;
  margin-bottom: 1em;
  margin-right: auto;
}

.jp-RenderedHTMLCommon thead {
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  vertical-align: bottom;
}

.jp-RenderedHTMLCommon td,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon tr {
  vertical-align: middle;
  padding: 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}

.jp-RenderedMarkdown.jp-RenderedHTMLCommon td,
.jp-RenderedMarkdown.jp-RenderedHTMLCommon th {
  max-width: none;
}

:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon td,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon th,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon tr {
  text-align: right;
}

.jp-RenderedHTMLCommon th {
  font-weight: bold;
}

.jp-RenderedHTMLCommon tbody tr:nth-child(odd) {
  background: var(--jp-layout-color0);
}

.jp-RenderedHTMLCommon tbody tr:nth-child(even) {
  background: var(--jp-rendermime-table-row-background);
}

.jp-RenderedHTMLCommon tbody tr:hover {
  background: var(--jp-rendermime-table-row-hover-background);
}

.jp-RenderedHTMLCommon p {
  text-align: left;
  margin: 0;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon img {
  -moz-force-broken-image-icon: 1;
}

/* Restrict to direct children as other images could be nested in other content. */
.jp-RenderedHTMLCommon > img {
  display: block;
  margin-left: 0;
  margin-right: 0;
  margin-bottom: 1em;
}

/* Change color behind transparent images if they need it... */
[data-jp-theme-light='false'] .jp-RenderedImage img.jp-needs-light-background {
  background-color: var(--jp-inverse-layout-color1);
}

[data-jp-theme-light='true'] .jp-RenderedImage img.jp-needs-dark-background {
  background-color: var(--jp-inverse-layout-color1);
}

.jp-RenderedHTMLCommon img,
.jp-RenderedImage img,
.jp-RenderedHTMLCommon svg,
.jp-RenderedSVG svg {
  max-width: 100%;
  height: auto;
}

.jp-RenderedHTMLCommon img.jp-mod-unconfined,
.jp-RenderedImage img.jp-mod-unconfined,
.jp-RenderedHTMLCommon svg.jp-mod-unconfined,
.jp-RenderedSVG svg.jp-mod-unconfined {
  max-width: none;
}

.jp-RenderedHTMLCommon .alert {
  padding: var(--jp-notebook-padding);
  border: var(--jp-border-width) solid transparent;
  border-radius: var(--jp-border-radius);
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon .alert-info {
  color: var(--jp-info-color0);
  background-color: var(--jp-info-color3);
  border-color: var(--jp-info-color2);
}

.jp-RenderedHTMLCommon .alert-info hr {
  border-color: var(--jp-info-color3);
}

.jp-RenderedHTMLCommon .alert-info > p:last-child,
.jp-RenderedHTMLCommon .alert-info > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-warning {
  color: var(--jp-warn-color0);
  background-color: var(--jp-warn-color3);
  border-color: var(--jp-warn-color2);
}

.jp-RenderedHTMLCommon .alert-warning hr {
  border-color: var(--jp-warn-color3);
}

.jp-RenderedHTMLCommon .alert-warning > p:last-child,
.jp-RenderedHTMLCommon .alert-warning > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-success {
  color: var(--jp-success-color0);
  background-color: var(--jp-success-color3);
  border-color: var(--jp-success-color2);
}

.jp-RenderedHTMLCommon .alert-success hr {
  border-color: var(--jp-success-color3);
}

.jp-RenderedHTMLCommon .alert-success > p:last-child,
.jp-RenderedHTMLCommon .alert-success > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-danger {
  color: var(--jp-error-color0);
  background-color: var(--jp-error-color3);
  border-color: var(--jp-error-color2);
}

.jp-RenderedHTMLCommon .alert-danger hr {
  border-color: var(--jp-error-color3);
}

.jp-RenderedHTMLCommon .alert-danger > p:last-child,
.jp-RenderedHTMLCommon .alert-danger > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon blockquote {
  margin: 1em 2em;
  padding: 0 1em;
  border-left: 5px solid var(--jp-border-color2);
}

a.jp-InternalAnchorLink {
  visibility: hidden;
  margin-left: 8px;
  color: var(--md-blue-800);
}

h1:hover .jp-InternalAnchorLink,
h2:hover .jp-InternalAnchorLink,
h3:hover .jp-InternalAnchorLink,
h4:hover .jp-InternalAnchorLink,
h5:hover .jp-InternalAnchorLink,
h6:hover .jp-InternalAnchorLink {
  visibility: visible;
}

.jp-RenderedHTMLCommon kbd {
  background-color: var(--jp-rendermime-table-row-background);
  border: 1px solid var(--jp-border-color0);
  border-bottom-color: var(--jp-border-color2);
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
  display: inline-block;
  font-size: var(--jp-ui-font-size0);
  line-height: 1em;
  padding: 0.2em 0.5em;
}

/* Most direct children of .jp-RenderedHTMLCommon have a margin-bottom of 1.0.
 * At the bottom of cells this is a bit too much as there is also spacing
 * between cells. Going all the way to 0 gets too tight between markdown and
 * code cells.
 */
.jp-RenderedHTMLCommon > *:last-child {
  margin-bottom: 0.5em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-cursor-backdrop {
  position: fixed;
  width: 200px;
  height: 200px;
  margin-top: -100px;
  margin-left: -100px;
  will-change: transform;
  z-index: 100;
}

.lm-mod-drag-image {
  will-change: transform;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-lineFormSearch {
  padding: 4px 12px;
  background-color: var(--jp-layout-color2);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
  font-size: var(--jp-ui-font-size1);
}

.jp-lineFormCaption {
  font-size: var(--jp-ui-font-size0);
  line-height: var(--jp-ui-font-size1);
  margin-top: 4px;
  color: var(--jp-ui-font-color0);
}

.jp-baseLineForm {
  border: none;
  border-radius: 0;
  position: absolute;
  background-size: 16px;
  background-repeat: no-repeat;
  background-position: center;
  outline: none;
}

.jp-lineFormButtonContainer {
  top: 4px;
  right: 8px;
  height: 24px;
  padding: 0 12px;
  width: 12px;
}

.jp-lineFormButtonIcon {
  top: 0;
  right: 0;
  background-color: var(--jp-brand-color1);
  height: 100%;
  width: 100%;
  box-sizing: border-box;
  padding: 4px 6px;
}

.jp-lineFormButton {
  top: 0;
  right: 0;
  background-color: transparent;
  height: 100%;
  width: 100%;
  box-sizing: border-box;
}

.jp-lineFormWrapper {
  overflow: hidden;
  padding: 0 8px;
  border: 1px solid var(--jp-border-color0);
  background-color: var(--jp-input-active-background);
  height: 22px;
}

.jp-lineFormWrapperFocusWithin {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-lineFormInput {
  background: transparent;
  width: 200px;
  height: 100%;
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  line-height: 28px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-JSONEditor {
  display: flex;
  flex-direction: column;
  width: 100%;
}

.jp-JSONEditor-host {
  flex: 1 1 auto;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  background: var(--jp-layout-color0);
  min-height: 50px;
  padding: 1px;
}

.jp-JSONEditor.jp-mod-error .jp-JSONEditor-host {
  border-color: red;
  outline-color: red;
}

.jp-JSONEditor-header {
  display: flex;
  flex: 1 0 auto;
  padding: 0 0 0 12px;
}

.jp-JSONEditor-header label {
  flex: 0 0 auto;
}

.jp-JSONEditor-commitButton {
  height: 16px;
  width: 16px;
  background-size: 18px;
  background-repeat: no-repeat;
  background-position: center;
}

.jp-JSONEditor-host.jp-mod-focused {
  background-color: var(--jp-input-active-background);
  border: 1px solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

.jp-Editor.jp-mod-dropTarget {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/
.jp-DocumentSearch-input {
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  font-size: var(--jp-ui-font-size1);
  background-color: var(--jp-layout-color0);
  font-family: var(--jp-ui-font-family);
  padding: 2px 1px;
  resize: none;
}

.jp-DocumentSearch-overlay {
  position: absolute;
  background-color: var(--jp-toolbar-background);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  border-left: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  top: 0;
  right: 0;
  z-index: 7;
  min-width: 405px;
  padding: 2px;
  font-size: var(--jp-ui-font-size1);

  --jp-private-document-search-button-height: 20px;
}

.jp-DocumentSearch-overlay button {
  background-color: var(--jp-toolbar-background);
  outline: 0;
}

.jp-DocumentSearch-overlay button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-overlay button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-overlay-row {
  display: flex;
  align-items: center;
  margin-bottom: 2px;
}

.jp-DocumentSearch-button-content {
  display: inline-block;
  cursor: pointer;
  box-sizing: border-box;
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-button-content svg {
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-input-wrapper {
  border: var(--jp-border-width) solid var(--jp-border-color0);
  display: flex;
  background-color: var(--jp-layout-color0);
  margin: 2px;
}

.jp-DocumentSearch-input-wrapper:focus-within {
  border-color: var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper {
  all: initial;
  overflow: hidden;
  display: inline-block;
  border: none;
  box-sizing: border-box;
}

.jp-DocumentSearch-toggle-wrapper {
  width: 14px;
  height: 14px;
}

.jp-DocumentSearch-button-wrapper {
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
}

.jp-DocumentSearch-toggle-wrapper:focus,
.jp-DocumentSearch-button-wrapper:focus {
  outline: var(--jp-border-width) solid
    var(--jp-cell-editor-active-border-color);
  outline-offset: -1px;
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper,
.jp-DocumentSearch-button-content:focus {
  outline: none;
}

.jp-DocumentSearch-toggle-placeholder {
  width: 5px;
}

.jp-DocumentSearch-input-button::before {
  display: block;
  padding-top: 100%;
}

.jp-DocumentSearch-input-button-off {
  opacity: var(--jp-search-toggle-off-opacity);
}

.jp-DocumentSearch-input-button-off:hover {
  opacity: var(--jp-search-toggle-hover-opacity);
}

.jp-DocumentSearch-input-button-on {
  opacity: var(--jp-search-toggle-on-opacity);
}

.jp-DocumentSearch-index-counter {
  padding-left: 10px;
  padding-right: 10px;
  user-select: none;
  min-width: 35px;
  display: inline-block;
}

.jp-DocumentSearch-up-down-wrapper {
  display: inline-block;
  padding-right: 2px;
  margin-left: auto;
  white-space: nowrap;
}

.jp-DocumentSearch-spacer {
  margin-left: auto;
}

.jp-DocumentSearch-up-down-wrapper button {
  outline: 0;
  border: none;
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
  vertical-align: middle;
  margin: 1px 5px 2px;
}

.jp-DocumentSearch-up-down-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-up-down-button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-filter-button {
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-filter-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled:hover {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-search-options {
  padding: 0 8px;
  margin-left: 3px;
  width: 100%;
  display: grid;
  justify-content: start;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  justify-items: stretch;
}

.jp-DocumentSearch-search-filter-disabled {
  color: var(--jp-ui-font-color2);
}

.jp-DocumentSearch-search-filter {
  display: flex;
  align-items: center;
  user-select: none;
}

.jp-DocumentSearch-regex-error {
  color: var(--jp-error-color0);
}

.jp-DocumentSearch-replace-button-wrapper {
  overflow: hidden;
  display: inline-block;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color0);
  margin: auto 2px;
  padding: 1px 4px;
  height: calc(var(--jp-private-document-search-button-height) + 2px);
}

.jp-DocumentSearch-replace-button-wrapper:focus {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-replace-button {
  display: inline-block;
  text-align: center;
  cursor: pointer;
  box-sizing: border-box;
  color: var(--jp-ui-font-color1);

  /* height - 2 * (padding of wrapper) */
  line-height: calc(var(--jp-private-document-search-button-height) - 2px);
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-replace-button:focus {
  outline: none;
}

.jp-DocumentSearch-replace-wrapper-class {
  margin-left: 14px;
  display: flex;
}

.jp-DocumentSearch-replace-toggle {
  border: none;
  background-color: var(--jp-toolbar-background);
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-replace-toggle:hover {
  background-color: var(--jp-layout-color2);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.cm-editor {
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  border: 0;
  border-radius: 0;
  height: auto;

  /* Changed to auto to autogrow */
}

.cm-editor pre {
  padding: 0 var(--jp-code-padding);
}

.jp-CodeMirrorEditor[data-type='inline'] .cm-dialog {
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
}

.jp-CodeMirrorEditor {
  cursor: text;
}

/* When zoomed out 67% and 33% on a screen of 1440 width x 900 height */
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width1) solid
      var(--jp-editor-cursor-color);
  }
}

/* When zoomed out less than 33% */
@media screen and (min-width: 4320px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width2) solid
      var(--jp-editor-cursor-color);
  }
}

.cm-editor.jp-mod-readOnly .cm-cursor {
  display: none;
}

.jp-CollaboratorCursor {
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: none;
  border-bottom: 3px solid;
  background-clip: content-box;
  margin-left: -5px;
  margin-right: -5px;
}

.cm-searching,
.cm-searching span {
  /* `.cm-searching span`: we need to override syntax highlighting */
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.cm-searching::selection,
.cm-searching span::selection {
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.jp-current-match > .cm-searching,
.jp-current-match > .cm-searching span,
.cm-searching > .jp-current-match,
.cm-searching > .jp-current-match span {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.jp-current-match > .cm-searching::selection,
.cm-searching > .jp-current-match::selection,
.jp-current-match > .cm-searching span::selection {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.cm-trailingspace {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAsElEQVQIHQGlAFr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7+r3zKmT0/+pk9P/7+r3zAAAAAAAAAAABAAAAAAAAAAA6OPzM+/q9wAAAAAA6OPzMwAAAAAAAAAAAgAAAAAAAAAAGR8NiRQaCgAZIA0AGR8NiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQyoYJ/SY80UAAAAASUVORK5CYII=);
  background-position: center left;
  background-repeat: repeat-x;
}

.jp-CollaboratorCursor-hover {
  position: absolute;
  z-index: 1;
  transform: translateX(-50%);
  color: white;
  border-radius: 3px;
  padding-left: 4px;
  padding-right: 4px;
  padding-top: 1px;
  padding-bottom: 1px;
  text-align: center;
  font-size: var(--jp-ui-font-size1);
  white-space: nowrap;
}

.jp-CodeMirror-ruler {
  border-left: 1px dashed var(--jp-border-color2);
}

/* Styles for shared cursors (remote cursor locations and selected ranges) */
.jp-CodeMirrorEditor .cm-ySelectionCaret {
  position: relative;
  border-left: 1px solid black;
  margin-left: -1px;
  margin-right: -1px;
  box-sizing: border-box;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret > .cm-ySelectionInfo {
  white-space: nowrap;
  position: absolute;
  top: -1.15em;
  padding-bottom: 0.05em;
  left: -1px;
  font-size: 0.95em;
  font-family: var(--jp-ui-font-family);
  font-weight: bold;
  line-height: normal;
  user-select: none;
  color: white;
  padding-left: 2px;
  padding-right: 2px;
  z-index: 101;
  transition: opacity 0.3s ease-in-out;
}

.jp-CodeMirrorEditor .cm-ySelectionInfo {
  transition-delay: 0.7s;
  opacity: 0;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret:hover > .cm-ySelectionInfo {
  opacity: 1;
  transition-delay: 0s;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MimeDocument {
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-filebrowser-button-height: 28px;
  --jp-private-filebrowser-button-width: 48px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FileBrowser .jp-SidePanel-content {
  display: flex;
  flex-direction: column;
}

.jp-FileBrowser-toolbar.jp-Toolbar {
  flex-wrap: wrap;
  row-gap: 12px;
  border-bottom: none;
  height: auto;
  margin: 8px 12px 0;
  box-shadow: none;
  padding: 0;
  justify-content: flex-start;
}

.jp-FileBrowser-Panel {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
}

.jp-BreadCrumbs {
  flex: 0 0 auto;
  margin: 8px 12px;
}

.jp-BreadCrumbs-item {
  margin: 0 2px;
  padding: 0 2px;
  border-radius: var(--jp-border-radius);
  cursor: pointer;
}

.jp-BreadCrumbs-item:hover {
  background-color: var(--jp-layout-color2);
}

.jp-BreadCrumbs-item:first-child {
  margin-left: 0;
}

.jp-BreadCrumbs-item.jp-mod-dropTarget {
  background-color: var(--jp-brand-color2);
  opacity: 0.7;
}

/*-----------------------------------------------------------------------------
| Buttons
|----------------------------------------------------------------------------*/

.jp-FileBrowser-toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  padding-left: 0;
  padding-right: 2px;
  align-items: center;
  height: unset;
}

.jp-FileBrowser-toolbar > .jp-Toolbar-item .jp-ToolbarButtonComponent {
  width: 40px;
}

/*-----------------------------------------------------------------------------
| Other styles
|----------------------------------------------------------------------------*/

.jp-FileDialog.jp-mod-conflict input {
  color: var(--jp-error-color1);
}

.jp-FileDialog .jp-new-name-title {
  margin-top: 12px;
}

.jp-LastModified-hidden {
  display: none;
}

.jp-FileSize-hidden {
  display: none;
}

.jp-FileBrowser .lm-AccordionPanel > h3:first-child {
  display: none;
}

/*-----------------------------------------------------------------------------
| DirListing
|----------------------------------------------------------------------------*/

.jp-DirListing {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  outline: 0;
}

.jp-DirListing-header {
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  align-items: center;
  overflow: hidden;
  border-top: var(--jp-border-width) solid var(--jp-border-color2);
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
}

.jp-DirListing-headerItem {
  padding: 4px 12px 2px;
  font-weight: 500;
}

.jp-DirListing-headerItem:hover {
  background: var(--jp-layout-color2);
}

.jp-DirListing-headerItem.jp-id-name {
  flex: 1 0 84px;
}

.jp-DirListing-headerItem.jp-id-modified {
  flex: 0 0 112px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-DirListing-headerItem.jp-id-filesize {
  flex: 0 0 75px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-id-narrow {
  display: none;
  flex: 0 0 5px;
  padding: 4px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
  color: var(--jp-border-color2);
}

.jp-DirListing-narrow .jp-id-narrow {
  display: block;
}

.jp-DirListing-narrow .jp-id-modified,
.jp-DirListing-narrow .jp-DirListing-itemModified {
  display: none;
}

.jp-DirListing-headerItem.jp-mod-selected {
  font-weight: 600;
}

/* increase specificity to override bundled default */
.jp-DirListing-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  list-style-type: none;
  overflow: auto;
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-content mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.jp-DirListing-content .jp-DirListing-item.jp-mod-selected mark {
  color: var(--jp-ui-inverse-font-color0);
}

/* Style the directory listing content when a user drops a file to upload */
.jp-DirListing.jp-mod-native-drop .jp-DirListing-content {
  outline: 5px dashed rgba(128, 128, 128, 0.5);
  outline-offset: -10px;
  cursor: copy;
}

.jp-DirListing-item {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px 12px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-DirListing-checkboxWrapper {
  /* Increases hit area of checkbox. */
  padding: 4px;
}

.jp-DirListing-header
  .jp-DirListing-checkboxWrapper
  + .jp-DirListing-headerItem {
  padding-left: 4px;
}

.jp-DirListing-content .jp-DirListing-checkboxWrapper {
  position: relative;
  left: -4px;
  margin: -4px 0 -4px -8px;
}

.jp-DirListing-checkboxWrapper.jp-mod-visible {
  visibility: visible;
}

/* For devices that support hovering, hide checkboxes until hovered, selected...
*/
@media (hover: hover) {
  .jp-DirListing-checkboxWrapper {
    visibility: hidden;
  }

  .jp-DirListing-item:hover .jp-DirListing-checkboxWrapper,
  .jp-DirListing-item.jp-mod-selected .jp-DirListing-checkboxWrapper {
    visibility: visible;
  }
}

.jp-DirListing-item[data-is-dot] {
  opacity: 75%;
}

.jp-DirListing-item.jp-mod-selected {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.jp-DirListing-item.jp-mod-dropTarget {
  background: var(--jp-brand-color3);
}

.jp-DirListing-item:hover:not(.jp-mod-selected) {
  background: var(--jp-layout-color2);
}

.jp-DirListing-itemIcon {
  flex: 0 0 20px;
  margin-right: 4px;
}

.jp-DirListing-itemText {
  flex: 1 0 64px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  user-select: none;
}

.jp-DirListing-itemText:focus {
  outline-width: 2px;
  outline-color: var(--jp-inverse-layout-color1);
  outline-style: solid;
  outline-offset: 1px;
}

.jp-DirListing-item.jp-mod-selected .jp-DirListing-itemText:focus {
  outline-color: var(--jp-layout-color1);
}

.jp-DirListing-itemModified {
  flex: 0 0 125px;
  text-align: right;
}

.jp-DirListing-itemFileSize {
  flex: 0 0 90px;
  text-align: right;
}

.jp-DirListing-editor {
  flex: 1 0 64px;
  outline: none;
  border: none;
  color: var(--jp-ui-font-color1);
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-item.jp-mod-running .jp-DirListing-itemIcon::before {
  color: var(--jp-success-color1);
  content: '\25CF';
  font-size: 8px;
  position: absolute;
  left: -8px;
}

.jp-DirListing-item.jp-mod-running.jp-mod-selected
  .jp-DirListing-itemIcon::before {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-DirListing-item.lm-mod-drag-image,
.jp-DirListing-item.jp-mod-selected.lm-mod-drag-image {
  font-size: var(--jp-ui-font-size1);
  padding-left: 4px;
  margin-left: 4px;
  width: 160px;
  background-color: var(--jp-ui-inverse-font-color2);
  box-shadow: var(--jp-elevation-z2);
  border-radius: 0;
  color: var(--jp-ui-font-color1);
  transform: translateX(-40%) translateY(-58%);
}

.jp-Document {
  min-width: 120px;
  min-height: 120px;
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Main OutputArea
| OutputArea has a list of Outputs
|----------------------------------------------------------------------------*/

.jp-OutputArea {
  overflow-y: auto;
}

.jp-OutputArea-child {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-OutputPrompt {
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-outprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
  opacity: var(--jp-cell-prompt-opacity);

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-OutputArea-prompt {
  display: table-cell;
  vertical-align: top;
}

.jp-OutputArea-output {
  display: table-cell;
  width: 100%;
  height: auto;
  overflow: auto;
  user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
  -ms-user-select: text;
}

.jp-OutputArea .jp-RenderedText {
  padding-left: 1ch;
}

/**
 * Prompt overlay.
 */

.jp-OutputArea-promptOverlay {
  position: absolute;
  top: 0;
  width: var(--jp-cell-prompt-width);
  height: 100%;
  opacity: 0.5;
}

.jp-OutputArea-promptOverlay:hover {
  background: var(--jp-layout-color2);
  box-shadow: inset 0 0 1px var(--jp-inverse-layout-color0);
  cursor: zoom-out;
}

.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay:hover {
  cursor: zoom-in;
}

/**
 * Isolated output.
 */
.jp-OutputArea-output.jp-mod-isolated {
  width: 100%;
  display: block;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated {
  position: relative;
}

body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/* pre */

.jp-OutputArea-output pre {
  border: none;
  margin: 0;
  padding: 0;
  overflow-x: auto;
  overflow-y: auto;
  word-break: break-all;
  word-wrap: break-word;
  white-space: pre-wrap;
}

/* tables */

.jp-OutputArea-output.jp-RenderedHTMLCommon table {
  margin-left: 0;
  margin-right: 0;
}

/* description lists */

.jp-OutputArea-output dl,
.jp-OutputArea-output dt,
.jp-OutputArea-output dd {
  display: block;
}

.jp-OutputArea-output dl {
  width: 100%;
  overflow: hidden;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dt {
  font-weight: bold;
  float: left;
  width: 20%;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dd {
  float: left;
  width: 80%;
  padding: 0;
  margin: 0;
}

.jp-TrimmedOutputs pre {
  background: var(--jp-layout-color3);
  font-size: calc(var(--jp-code-font-size) * 1.4);
  text-align: center;
  text-transform: uppercase;
}

/* Hide the gutter in case of
 *  - nested output areas (e.g. in the case of output widgets)
 *  - mirrored output areas
 */
.jp-OutputArea .jp-OutputArea .jp-OutputArea-prompt {
  display: none;
}

/* Hide empty lines in the output area, for instance due to cleared widgets */
.jp-OutputArea-prompt:empty {
  padding: 0;
  border: 0;
}

/*-----------------------------------------------------------------------------
| executeResult is added to any Output-result for the display of the object
| returned by a cell
|----------------------------------------------------------------------------*/

.jp-OutputArea-output.jp-OutputArea-executeResult {
  margin-left: 0;
  width: 100%;
}

/* Text output with the Out[] prompt needs a top padding to match the
 * alignment of the Out[] prompt itself.
 */
.jp-OutputArea-executeResult .jp-RenderedText.jp-OutputArea-output {
  padding-top: var(--jp-code-padding);
  border-top: var(--jp-border-width) solid transparent;
}

/*-----------------------------------------------------------------------------
| The Stdin output
|----------------------------------------------------------------------------*/

.jp-Stdin-prompt {
  color: var(--jp-content-font-color0);
  padding-right: var(--jp-code-padding);
  vertical-align: baseline;
  flex: 0 0 auto;
}

.jp-Stdin-input {
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  color: inherit;
  background-color: inherit;
  width: 42%;
  min-width: 200px;

  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;

  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0 0.25em;
  margin: 0 0.25em;
  flex: 0 0 70%;
}

.jp-Stdin-input::placeholder {
  opacity: 0;
}

.jp-Stdin-input:focus {
  box-shadow: none;
}

.jp-Stdin-input:focus::placeholder {
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Output Area View
|----------------------------------------------------------------------------*/

.jp-LinkedOutputView .jp-OutputArea {
  height: 100%;
  display: block;
}

.jp-LinkedOutputView .jp-OutputArea-output:only-child {
  height: 100%;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

@media print {
  .jp-OutputArea-child {
    break-inside: avoid-page;
  }
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-OutputPrompt {
    display: table-row;
    text-align: left;
  }

  .jp-OutputArea-child .jp-OutputArea-output {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }
}

/* Trimmed outputs warning */
.jp-TrimmedOutputs > a {
  margin: 10px;
  text-decoration: none;
  cursor: pointer;
}

.jp-TrimmedOutputs > a:hover {
  text-decoration: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Table of Contents
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toc-active-width: 4px;
}

.jp-TableOfContents {
  display: flex;
  flex-direction: column;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  height: 100%;
}

.jp-TableOfContents-placeholder {
  text-align: center;
}

.jp-TableOfContents-placeholderContent {
  color: var(--jp-content-font-color2);
  padding: 8px;
}

.jp-TableOfContents-placeholderContent > h3 {
  margin-bottom: var(--jp-content-heading-margin-bottom);
}

.jp-TableOfContents .jp-SidePanel-content {
  overflow-y: auto;
}

.jp-TableOfContents-tree {
  margin: 4px;
}

.jp-TableOfContents ol {
  list-style-type: none;
}

/* stylelint-disable-next-line selector-max-type */
.jp-TableOfContents li > ol {
  /* Align left border with triangle icon center */
  padding-left: 11px;
}

.jp-TableOfContents-content {
  /* left margin for the active heading indicator */
  margin: 0 0 0 var(--jp-private-toc-active-width);
  padding: 0;
  background-color: var(--jp-layout-color1);
}

.jp-tocItem {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-tocItem-heading {
  display: flex;
  cursor: pointer;
}

.jp-tocItem-heading:hover {
  background-color: var(--jp-layout-color2);
}

.jp-tocItem-content {
  display: block;
  padding: 4px 0;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow-x: hidden;
}

.jp-tocItem-collapser {
  height: 20px;
  margin: 2px 2px 0;
  padding: 0;
  background: none;
  border: none;
  cursor: pointer;
}

.jp-tocItem-collapser:hover {
  background-color: var(--jp-layout-color3);
}

/* Active heading indicator */

.jp-tocItem-heading::before {
  content: ' ';
  background: transparent;
  width: var(--jp-private-toc-active-width);
  height: 24px;
  position: absolute;
  left: 0;
  border-radius: var(--jp-border-radius);
}

.jp-tocItem-heading.jp-tocItem-active::before {
  background-color: var(--jp-brand-color1);
}

.jp-tocItem-heading:hover.jp-tocItem-active::before {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapser {
  flex: 0 0 var(--jp-cell-collapser-width);
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
  border-radius: var(--jp-border-radius);
  opacity: 1;
}

.jp-Collapser-child {
  display: block;
  width: 100%;
  box-sizing: border-box;

  /* height: 100% doesn't work because the height of its parent is computed from content */
  position: absolute;
  top: 0;
  bottom: 0;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Hiding collapsers in print mode.

Note: input and output wrappers have "display: block" propery in print mode.
*/

@media print {
  .jp-Collapser {
    display: none;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Header/Footer
|----------------------------------------------------------------------------*/

/* Hidden by zero height by default */
.jp-CellHeader,
.jp-CellFooter {
  height: 0;
  width: 100%;
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Input
|----------------------------------------------------------------------------*/

/* All input areas */
.jp-InputArea {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-InputArea-editor {
  display: table-cell;
  overflow: hidden;
  vertical-align: top;

  /* This is the non-active, default styling */
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  background: var(--jp-cell-editor-background);
}

.jp-InputPrompt {
  display: table-cell;
  vertical-align: top;
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-inprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  opacity: var(--jp-cell-prompt-opacity);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-InputArea-editor {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }

  .jp-InputPrompt {
    display: table-row;
    text-align: left;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Placeholder {
  display: table;
  table-layout: fixed;
  width: 100%;
}

.jp-Placeholder-prompt {
  display: table-cell;
  box-sizing: border-box;
}

.jp-Placeholder-content {
  display: table-cell;
  padding: 4px 6px;
  border: 1px solid transparent;
  border-radius: 0;
  background: none;
  box-sizing: border-box;
  cursor: pointer;
}

.jp-Placeholder-contentContainer {
  display: flex;
}

.jp-Placeholder-content:hover,
.jp-InputPlaceholder > .jp-Placeholder-content:hover {
  border-color: var(--jp-layout-color3);
}

.jp-Placeholder-content .jp-MoreHorizIcon {
  width: 32px;
  height: 16px;
  border: 1px solid transparent;
  border-radius: var(--jp-border-radius);
}

.jp-Placeholder-content .jp-MoreHorizIcon:hover {
  border: 1px solid var(--jp-border-color1);
  box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.25);
  background-color: var(--jp-layout-color0);
}

.jp-PlaceholderText {
  white-space: nowrap;
  overflow-x: hidden;
  color: var(--jp-inverse-layout-color3);
  font-family: var(--jp-code-font-family);
}

.jp-InputPlaceholder > .jp-Placeholder-content {
  border-color: var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Private CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-cell-scrolling-output-offset: 5px;
}

/*-----------------------------------------------------------------------------
| Cell
|----------------------------------------------------------------------------*/

.jp-Cell {
  padding: var(--jp-cell-padding);
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Common input/output
|----------------------------------------------------------------------------*/

.jp-Cell-inputWrapper,
.jp-Cell-outputWrapper {
  display: flex;
  flex-direction: row;
  padding: 0;
  margin: 0;

  /* Added to reveal the box-shadow on the input and output collapsers. */
  overflow: visible;
}

/* Only input/output areas inside cells */
.jp-Cell-inputArea,
.jp-Cell-outputArea {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Collapser
|----------------------------------------------------------------------------*/

/* Make the output collapser disappear when there is not output, but do so
 * in a manner that leaves it in the layout and preserves its width.
 */
.jp-Cell.jp-mod-noOutputs .jp-Cell-outputCollapser {
  border: none !important;
  background: transparent !important;
}

.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputCollapser {
  min-height: var(--jp-cell-collapser-min-height);
}

/*-----------------------------------------------------------------------------
| Output
|----------------------------------------------------------------------------*/

/* Put a space between input and output when there IS output */
.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputWrapper {
  margin-top: 5px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea {
  overflow-y: auto;
  max-height: 24em;
  margin-left: var(--jp-private-cell-scrolling-output-offset);
  resize: vertical;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea[style*='height'] {
  max-height: unset;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea::after {
  content: ' ';
  box-shadow: inset 0 0 6px 2px rgb(0 0 0 / 30%);
  width: 100%;
  height: 100%;
  position: sticky;
  bottom: 0;
  top: 0;
  margin-top: -50%;
  float: left;
  display: block;
  pointer-events: none;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-child {
  padding-top: 6px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-prompt {
  width: calc(
    var(--jp-cell-prompt-width) - var(--jp-private-cell-scrolling-output-offset)
  );
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay {
  left: calc(-1 * var(--jp-private-cell-scrolling-output-offset));
}

/*-----------------------------------------------------------------------------
| CodeCell
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| MarkdownCell
|----------------------------------------------------------------------------*/

.jp-MarkdownOutput {
  display: table-cell;
  width: 100%;
  margin-top: 0;
  margin-bottom: 0;
  padding-left: var(--jp-code-padding);
}

.jp-MarkdownOutput.jp-RenderedHTMLCommon {
  overflow: auto;
}

/* collapseHeadingButton (show always if hiddenCellsButton is _not_ shown) */
.jp-collapseHeadingButton {
  display: flex;
  min-height: var(--jp-cell-collapser-min-height);
  font-size: var(--jp-code-font-size);
  position: absolute;
  background-color: transparent;
  background-size: 25px;
  background-repeat: no-repeat;
  background-position-x: center;
  background-position-y: top;
  background-image: var(--jp-icon-caret-down);
  right: 0;
  top: 0;
  bottom: 0;
}

.jp-collapseHeadingButton.jp-mod-collapsed {
  background-image: var(--jp-icon-caret-right);
}

/*
 set the container font size to match that of content
 so that the nested collapse buttons have the right size
*/
.jp-MarkdownCell .jp-InputPrompt {
  font-size: var(--jp-content-font-size1);
}

/*
  Align collapseHeadingButton with cell top header
  The font sizes are identical to the ones in packages/rendermime/style/base.css
*/
.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='1'] {
  font-size: var(--jp-content-font-size5);
  background-position-y: calc(0.3 * var(--jp-content-font-size5));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='2'] {
  font-size: var(--jp-content-font-size4);
  background-position-y: calc(0.3 * var(--jp-content-font-size4));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='3'] {
  font-size: var(--jp-content-font-size3);
  background-position-y: calc(0.3 * var(--jp-content-font-size3));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='4'] {
  font-size: var(--jp-content-font-size2);
  background-position-y: calc(0.3 * var(--jp-content-font-size2));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='5'] {
  font-size: var(--jp-content-font-size1);
  background-position-y: top;
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='6'] {
  font-size: var(--jp-content-font-size0);
  background-position-y: top;
}

/* collapseHeadingButton (show only on (hover,active) if hiddenCellsButton is shown) */
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-collapseHeadingButton {
  display: none;
}

.jp-Notebook.jp-mod-showHiddenCellsButton
  :is(.jp-MarkdownCell:hover, .jp-mod-active)
  .jp-collapseHeadingButton {
  display: flex;
}

/* showHiddenCellsButton (only show if jp-mod-showHiddenCellsButton is set, which
is a consequence of the showHiddenCellsButton option in Notebook Settings)*/
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton {
  margin-left: calc(var(--jp-cell-prompt-width) + 2 * var(--jp-code-padding));
  margin-top: var(--jp-code-padding);
  border: 1px solid var(--jp-border-color2);
  background-color: var(--jp-border-color3) !important;
  color: var(--jp-content-font-color0) !important;
  display: flex;
}

.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton:hover {
  background-color: var(--jp-border-color2) !important;
}

.jp-showHiddenCellsButton {
  display: none;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Using block instead of flex to allow the use of the break-inside CSS property for
cell outputs.
*/

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-notebook-toolbar-padding: 2px 5px 2px 2px;
}

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-NotebookPanel-toolbar {
  padding: var(--jp-notebook-toolbar-padding);

  /* disable paint containment from lumino 2.0 default strict CSS containment */
  contain: style size !important;
}

.jp-Toolbar-item.jp-Notebook-toolbarCellType .jp-select-wrapper.jp-mod-focused {
  border: none;
  box-shadow: none;
}

.jp-Notebook-toolbarCellTypeDropdown select {
  height: 24px;
  font-size: var(--jp-ui-font-size1);
  line-height: 14px;
  border-radius: 0;
  display: block;
}

.jp-Notebook-toolbarCellTypeDropdown span {
  top: 5px !important;
}

.jp-Toolbar-responsive-popup {
  position: absolute;
  height: fit-content;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-end;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: var(--jp-notebook-toolbar-padding);
  z-index: 1;
  right: 0;
  top: 0;
}

.jp-Toolbar > .jp-Toolbar-responsive-opener {
  margin-left: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-Notebook-ExecutionIndicator {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 9997;
}

.jp-Notebook-ExecutionIndicator-tooltip {
  visibility: hidden;
  height: auto;
  width: max-content;
  width: -moz-max-content;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color1);
  text-align: justify;
  border-radius: 6px;
  padding: 0 5px;
  position: fixed;
  display: table;
}

.jp-Notebook-ExecutionIndicator-tooltip.up {
  transform: translateX(-50%) translateY(-100%) translateY(-32px);
}

.jp-Notebook-ExecutionIndicator-tooltip.down {
  transform: translateX(calc(-100% + 16px)) translateY(5px);
}

.jp-Notebook-ExecutionIndicator-tooltip.hidden {
  display: none;
}

.jp-Notebook-ExecutionIndicator:hover .jp-Notebook-ExecutionIndicator-tooltip {
  visibility: visible;
}

.jp-Notebook-ExecutionIndicator span {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  color: var(--jp-ui-font-color1);
  line-height: 24px;
  display: block;
}

.jp-Notebook-ExecutionIndicator-progress-bar {
  display: flex;
  justify-content: center;
  height: 100%;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*
 * Execution indicator
 */
.jp-tocItem-content::after {
  content: '';

  /* Must be identical to form a circle */
  width: 12px;
  height: 12px;
  background: none;
  border: none;
  position: absolute;
  right: 0;
}

.jp-tocItem-content[data-running='0']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background: none;
}

.jp-tocItem-content[data-running='1']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background-color: var(--jp-inverse-layout-color3);
}

.jp-tocItem-content[data-running='0'],
.jp-tocItem-content[data-running='1'] {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Notebook-footer {
  height: 27px;
  margin-left: calc(
    var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
      var(--jp-cell-padding)
  );
  width: calc(
    100% -
      (
        var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
          var(--jp-cell-padding) + var(--jp-cell-padding)
      )
  );
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  color: var(--jp-ui-font-color3);
  margin-top: 6px;
  background: none;
  cursor: pointer;
}

.jp-Notebook-footer:focus {
  border-color: var(--jp-cell-editor-active-border-color);
}

/* For devices that support hovering, hide footer until hover */
@media (hover: hover) {
  .jp-Notebook-footer {
    opacity: 0;
  }

  .jp-Notebook-footer:focus,
  .jp-Notebook-footer:hover {
    opacity: 1;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Imports
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-side-by-side-output-size: 1fr;
  --jp-side-by-side-resized-cell: var(--jp-side-by-side-output-size);
  --jp-private-notebook-dragImage-width: 304px;
  --jp-private-notebook-dragImage-height: 36px;
  --jp-private-notebook-selected-color: var(--md-blue-400);
  --jp-private-notebook-active-color: var(--md-green-400);
}

/*-----------------------------------------------------------------------------
| Notebook
|----------------------------------------------------------------------------*/

/* stylelint-disable selector-max-class */

.jp-NotebookPanel {
  display: block;
  height: 100%;
}

.jp-NotebookPanel.jp-Document {
  min-width: 240px;
  min-height: 120px;
}

.jp-Notebook {
  padding: var(--jp-notebook-padding);
  outline: none;
  overflow: auto;
  background: var(--jp-layout-color0);
}

.jp-Notebook.jp-mod-scrollPastEnd::after {
  display: block;
  content: '';
  min-height: var(--jp-notebook-scroll-padding);
}

.jp-MainAreaWidget-ContainStrict .jp-Notebook * {
  contain: strict;
}

.jp-Notebook .jp-Cell {
  overflow: visible;
}

.jp-Notebook .jp-Cell .jp-InputPrompt {
  cursor: move;
}

/*-----------------------------------------------------------------------------
| Notebook state related styling
|
| The notebook and cells each have states, here are the possibilities:
|
| - Notebook
|   - Command
|   - Edit
| - Cell
|   - None
|   - Active (only one can be active)
|   - Selected (the cells actions are applied to)
|   - Multiselected (when multiple selected, the cursor)
|   - No outputs
|----------------------------------------------------------------------------*/

/* Command or edit modes */

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-InputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-OutputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

/* cell is active */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser {
  background: var(--jp-brand-color1);
}

/* cell is dirty */
.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt {
  color: var(--jp-warn-color1);
}

.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt::before {
  color: var(--jp-warn-color1);
  content: '•';
}

.jp-Notebook .jp-Cell.jp-mod-active.jp-mod-dirty .jp-Collapser {
  background: var(--jp-warn-color1);
}

/* collapser is hovered */
.jp-Notebook .jp-Cell .jp-Collapser:hover {
  box-shadow: var(--jp-elevation-z2);
  background: var(--jp-brand-color1);
  opacity: var(--jp-cell-collapser-not-active-hover-opacity);
}

/* cell is active and collapser is hovered */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser:hover {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/* Command mode */

.jp-Notebook.jp-mod-commandMode .jp-Cell.jp-mod-selected {
  background: var(--jp-notebook-multiselected-color);
}

.jp-Notebook.jp-mod-commandMode
  .jp-Cell.jp-mod-active.jp-mod-selected:not(.jp-mod-multiSelected) {
  background: transparent;
}

/* Edit mode */

.jp-Notebook.jp-mod-editMode .jp-Cell.jp-mod-active .jp-InputArea-editor {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-cell-editor-active-background);
}

/*-----------------------------------------------------------------------------
| Notebook drag and drop
|----------------------------------------------------------------------------*/

.jp-Notebook-cell.jp-mod-dropSource {
  opacity: 0.5;
}

.jp-Notebook-cell.jp-mod-dropTarget,
.jp-Notebook.jp-mod-commandMode
  .jp-Notebook-cell.jp-mod-active.jp-mod-selected.jp-mod-dropTarget {
  border-top-color: var(--jp-private-notebook-selected-color);
  border-top-style: solid;
  border-top-width: 2px;
}

.jp-dragImage {
  display: block;
  flex-direction: row;
  width: var(--jp-private-notebook-dragImage-width);
  height: var(--jp-private-notebook-dragImage-height);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
  overflow: visible;
}

.jp-dragImage-singlePrompt {
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

.jp-dragImage .jp-dragImage-content {
  flex: 1 1 auto;
  z-index: 2;
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  line-height: var(--jp-code-line-height);
  padding: var(--jp-code-padding);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background-color);
  color: var(--jp-content-font-color3);
  text-align: left;
  margin: 4px 4px 4px 0;
}

.jp-dragImage .jp-dragImage-prompt {
  flex: 0 0 auto;
  min-width: 36px;
  color: var(--jp-cell-inprompt-font-color);
  padding: var(--jp-code-padding);
  padding-left: 12px;
  font-family: var(--jp-cell-prompt-font-family);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: 1.9;
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
}

.jp-dragImage-multipleBack {
  z-index: -1;
  position: absolute;
  height: 32px;
  width: 300px;
  top: 8px;
  left: 8px;
  background: var(--jp-layout-color2);
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

/*-----------------------------------------------------------------------------
| Cell toolbar
|----------------------------------------------------------------------------*/

.jp-NotebookTools {
  display: block;
  min-width: var(--jp-sidebar-min-width);
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
    * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  overflow: auto;
}

.jp-ActiveCellTool {
  padding: 12px 0;
  display: flex;
}

.jp-ActiveCellTool-Content {
  flex: 1 1 auto;
}

.jp-ActiveCellTool .jp-ActiveCellTool-CellContent {
  background: var(--jp-cell-editor-background);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  min-height: 29px;
}

.jp-ActiveCellTool .jp-InputPrompt {
  min-width: calc(var(--jp-cell-prompt-width) * 0.75);
}

.jp-ActiveCellTool-CellContent > pre {
  padding: 5px 4px;
  margin: 0;
  white-space: normal;
}

.jp-MetadataEditorTool {
  flex-direction: column;
  padding: 12px 0;
}

.jp-RankedPanel > :not(:first-child) {
  margin-top: 12px;
}

.jp-KeySelector select.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: var(--jp-border-width) solid var(--jp-border-color1);
}

.jp-KeySelector label,
.jp-MetadataEditorTool label,
.jp-NumberSetter label {
  line-height: 1.4;
}

.jp-NotebookTools .jp-select-wrapper {
  margin-top: 4px;
  margin-bottom: 0;
}

.jp-NumberSetter input {
  width: 100%;
  margin-top: 4px;
}

.jp-NotebookTools .jp-Collapse {
  margin-top: 16px;
}

/*-----------------------------------------------------------------------------
| Presentation Mode (.jp-mod-presentationMode)
|----------------------------------------------------------------------------*/

.jp-mod-presentationMode .jp-Notebook {
  --jp-content-font-size1: var(--jp-content-presentation-font-size1);
  --jp-code-font-size: var(--jp-code-presentation-font-size);
}

.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-InputPrompt,
.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-OutputPrompt {
  flex: 0 0 110px;
}

/*-----------------------------------------------------------------------------
| Side-by-side Mode (.jp-mod-sideBySide)
|----------------------------------------------------------------------------*/
.jp-mod-sideBySide.jp-Notebook .jp-Notebook-cell {
  margin-top: 3em;
  margin-bottom: 3em;
  margin-left: 5%;
  margin-right: 5%;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell {
  display: grid;
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-output-size)
    );
  grid-template-rows: auto minmax(0, 1fr) auto;
  grid-template-areas:
    'header header header'
    'input handle output'
    'footer footer footer';
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell.jp-mod-resizedCell {
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-resized-cell)
    );
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellHeader {
  grid-area: header;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-inputWrapper {
  grid-area: input;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-outputWrapper {
  /* overwrite the default margin (no vertical separation needed in side by side move */
  margin-top: 0;
  grid-area: output;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellFooter {
  grid-area: footer;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle {
  grid-area: handle;
  user-select: none;
  display: block;
  height: 100%;
  cursor: ew-resize;
  padding: 0 var(--jp-cell-padding);
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle::after {
  content: '';
  display: block;
  background: var(--jp-border-color2);
  height: 100%;
  width: 5px;
}

.jp-mod-sideBySide.jp-Notebook
  .jp-CodeCell.jp-mod-resizedCell
  .jp-CellResizeHandle::after {
  background: var(--jp-border-color0);
}

.jp-CellResizeHandle {
  display: none;
}

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Cell-Placeholder {
  padding-left: 55px;
}

.jp-Cell-Placeholder-wrapper {
  background: #fff;
  border: 1px solid;
  border-color: #e5e6e9 #dfe0e4 #d0d1d5;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  margin: 10px 15px;
}

.jp-Cell-Placeholder-wrapper-inner {
  padding: 15px;
  position: relative;
}

.jp-Cell-Placeholder-wrapper-body {
  background-repeat: repeat;
  background-size: 50% auto;
}

.jp-Cell-Placeholder-wrapper-body div {
  background: #f6f7f8;
  background-image: -webkit-linear-gradient(
    left,
    #f6f7f8 0%,
    #edeef1 20%,
    #f6f7f8 40%,
    #f6f7f8 100%
  );
  background-repeat: no-repeat;
  background-size: 800px 104px;
  height: 104px;
  position: absolute;
  right: 15px;
  left: 15px;
  top: 15px;
}

div.jp-Cell-Placeholder-h1 {
  top: 20px;
  height: 20px;
  left: 15px;
  width: 150px;
}

div.jp-Cell-Placeholder-h2 {
  left: 15px;
  top: 50px;
  height: 10px;
  width: 100px;
}

div.jp-Cell-Placeholder-content-1,
div.jp-Cell-Placeholder-content-2,
div.jp-Cell-Placeholder-content-3 {
  left: 15px;
  right: 15px;
  height: 10px;
}

div.jp-Cell-Placeholder-content-1 {
  top: 100px;
}

div.jp-Cell-Placeholder-content-2 {
  top: 120px;
}

div.jp-Cell-Placeholder-content-3 {
  top: 140px;
}

</style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
The following CSS variables define the main, public API for styling JupyterLab.
These variables should be used by all plugins wherever possible. In other
words, plugins should not define custom colors, sizes, etc unless absolutely
necessary. This enables users to change the visual theme of JupyterLab
by changing these variables.

Many variables appear in an ordered sequence (0,1,2,3). These sequences
are designed to work well together, so for example, `--jp-border-color1` should
be used with `--jp-layout-color1`. The numbers have the following meanings:

* 0: super-primary, reserved for special emphasis
* 1: primary, most important under normal situations
* 2: secondary, next most important under normal situations
* 3: tertiary, next most important under normal situations

Throughout JupyterLab, we are mostly following principles from Google's
Material Design when selecting colors. We are not, however, following
all of MD as it is not optimized for dense, information rich UIs.
*/

:root {
  /* Elevation
   *
   * We style box-shadows using Material Design's idea of elevation. These particular numbers are taken from here:
   *
   * https://github.com/material-components/material-components-web
   * https://material-components-web.appspot.com/elevation.html
   */

  --jp-shadow-base-lightness: 0;
  --jp-shadow-umbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.2
  );
  --jp-shadow-penumbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.14
  );
  --jp-shadow-ambient-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.12
  );
  --jp-elevation-z0: none;
  --jp-elevation-z1: 0 2px 1px -1px var(--jp-shadow-umbra-color),
    0 1px 1px 0 var(--jp-shadow-penumbra-color),
    0 1px 3px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z2: 0 3px 1px -2px var(--jp-shadow-umbra-color),
    0 2px 2px 0 var(--jp-shadow-penumbra-color),
    0 1px 5px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z4: 0 2px 4px -1px var(--jp-shadow-umbra-color),
    0 4px 5px 0 var(--jp-shadow-penumbra-color),
    0 1px 10px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z6: 0 3px 5px -1px var(--jp-shadow-umbra-color),
    0 6px 10px 0 var(--jp-shadow-penumbra-color),
    0 1px 18px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z8: 0 5px 5px -3px var(--jp-shadow-umbra-color),
    0 8px 10px 1px var(--jp-shadow-penumbra-color),
    0 3px 14px 2px var(--jp-shadow-ambient-color);
  --jp-elevation-z12: 0 7px 8px -4px var(--jp-shadow-umbra-color),
    0 12px 17px 2px var(--jp-shadow-penumbra-color),
    0 5px 22px 4px var(--jp-shadow-ambient-color);
  --jp-elevation-z16: 0 8px 10px -5px var(--jp-shadow-umbra-color),
    0 16px 24px 2px var(--jp-shadow-penumbra-color),
    0 6px 30px 5px var(--jp-shadow-ambient-color);
  --jp-elevation-z20: 0 10px 13px -6px var(--jp-shadow-umbra-color),
    0 20px 31px 3px var(--jp-shadow-penumbra-color),
    0 8px 38px 7px var(--jp-shadow-ambient-color);
  --jp-elevation-z24: 0 11px 15px -7px var(--jp-shadow-umbra-color),
    0 24px 38px 3px var(--jp-shadow-penumbra-color),
    0 9px 46px 8px var(--jp-shadow-ambient-color);

  /* Borders
   *
   * The following variables, specify the visual styling of borders in JupyterLab.
   */

  --jp-border-width: 1px;
  --jp-border-color0: var(--md-grey-400);
  --jp-border-color1: var(--md-grey-400);
  --jp-border-color2: var(--md-grey-300);
  --jp-border-color3: var(--md-grey-200);
  --jp-inverse-border-color: var(--md-grey-600);
  --jp-border-radius: 2px;

  /* UI Fonts
   *
   * The UI font CSS variables are used for the typography all of the JupyterLab
   * user interface elements that are not directly user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-ui-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-ui-font-scale-factor: 1.2;
  --jp-ui-font-size0: 0.83333em;
  --jp-ui-font-size1: 13px; /* Base font size */
  --jp-ui-font-size2: 1.2em;
  --jp-ui-font-size3: 1.44em;
  --jp-ui-font-family: system-ui, -apple-system, blinkmacsystemfont, 'Segoe UI',
    helvetica, arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
    'Segoe UI Symbol';

  /*
   * Use these font colors against the corresponding main layout colors.
   * In a light theme, these go from dark to light.
   */

  /* Defaults use Material Design specification */
  --jp-ui-font-color0: rgba(0, 0, 0, 1);
  --jp-ui-font-color1: rgba(0, 0, 0, 0.87);
  --jp-ui-font-color2: rgba(0, 0, 0, 0.54);
  --jp-ui-font-color3: rgba(0, 0, 0, 0.38);

  /*
   * Use these against the brand/accent/warn/error colors.
   * These will typically go from light to darker, in both a dark and light theme.
   */

  --jp-ui-inverse-font-color0: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color1: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color2: rgba(255, 255, 255, 0.7);
  --jp-ui-inverse-font-color3: rgba(255, 255, 255, 0.5);

  /* Content Fonts
   *
   * Content font variables are used for typography of user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-content-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-content-line-height: 1.6;
  --jp-content-font-scale-factor: 1.2;
  --jp-content-font-size0: 0.83333em;
  --jp-content-font-size1: 14px; /* Base font size */
  --jp-content-font-size2: 1.2em;
  --jp-content-font-size3: 1.44em;
  --jp-content-font-size4: 1.728em;
  --jp-content-font-size5: 2.0736em;

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-content-presentation-font-size1: 17px;
  --jp-content-heading-line-height: 1;
  --jp-content-heading-margin-top: 1.2em;
  --jp-content-heading-margin-bottom: 0.8em;
  --jp-content-heading-font-weight: 500;

  /* Defaults use Material Design specification */
  --jp-content-font-color0: rgba(0, 0, 0, 1);
  --jp-content-font-color1: rgba(0, 0, 0, 0.87);
  --jp-content-font-color2: rgba(0, 0, 0, 0.54);
  --jp-content-font-color3: rgba(0, 0, 0, 0.38);
  --jp-content-link-color: var(--md-blue-900);
  --jp-content-font-family: system-ui, -apple-system, blinkmacsystemfont,
    'Segoe UI', helvetica, arial, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol';

  /*
   * Code Fonts
   *
   * Code font variables are used for typography of code and other monospaces content.
   */

  --jp-code-font-size: 13px;
  --jp-code-line-height: 1.3077; /* 17px for 13px base */
  --jp-code-padding: 5px; /* 5px for 13px base, codemirror highlighting needs integer px value */
  --jp-code-font-family-default: menlo, consolas, 'DejaVu Sans Mono', monospace;
  --jp-code-font-family: var(--jp-code-font-family-default);

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-code-presentation-font-size: 16px;

  /* may need to tweak cursor width if you change font size */
  --jp-code-cursor-width0: 1.4px;
  --jp-code-cursor-width1: 2px;
  --jp-code-cursor-width2: 4px;

  /* Layout
   *
   * The following are the main layout colors use in JupyterLab. In a light
   * theme these would go from light to dark.
   */

  --jp-layout-color0: white;
  --jp-layout-color1: white;
  --jp-layout-color2: var(--md-grey-200);
  --jp-layout-color3: var(--md-grey-400);
  --jp-layout-color4: var(--md-grey-600);

  /* Inverse Layout
   *
   * The following are the inverse layout colors use in JupyterLab. In a light
   * theme these would go from dark to light.
   */

  --jp-inverse-layout-color0: #111;
  --jp-inverse-layout-color1: var(--md-grey-900);
  --jp-inverse-layout-color2: var(--md-grey-800);
  --jp-inverse-layout-color3: var(--md-grey-700);
  --jp-inverse-layout-color4: var(--md-grey-600);

  /* Brand/accent */

  --jp-brand-color0: var(--md-blue-900);
  --jp-brand-color1: var(--md-blue-700);
  --jp-brand-color2: var(--md-blue-300);
  --jp-brand-color3: var(--md-blue-100);
  --jp-brand-color4: var(--md-blue-50);
  --jp-accent-color0: var(--md-green-900);
  --jp-accent-color1: var(--md-green-700);
  --jp-accent-color2: var(--md-green-300);
  --jp-accent-color3: var(--md-green-100);

  /* State colors (warn, error, success, info) */

  --jp-warn-color0: var(--md-orange-900);
  --jp-warn-color1: var(--md-orange-700);
  --jp-warn-color2: var(--md-orange-300);
  --jp-warn-color3: var(--md-orange-100);
  --jp-error-color0: var(--md-red-900);
  --jp-error-color1: var(--md-red-700);
  --jp-error-color2: var(--md-red-300);
  --jp-error-color3: var(--md-red-100);
  --jp-success-color0: var(--md-green-900);
  --jp-success-color1: var(--md-green-700);
  --jp-success-color2: var(--md-green-300);
  --jp-success-color3: var(--md-green-100);
  --jp-info-color0: var(--md-cyan-900);
  --jp-info-color1: var(--md-cyan-700);
  --jp-info-color2: var(--md-cyan-300);
  --jp-info-color3: var(--md-cyan-100);

  /* Cell specific styles */

  --jp-cell-padding: 5px;
  --jp-cell-collapser-width: 8px;
  --jp-cell-collapser-min-height: 20px;
  --jp-cell-collapser-not-active-hover-opacity: 0.6;
  --jp-cell-editor-background: var(--md-grey-100);
  --jp-cell-editor-border-color: var(--md-grey-300);
  --jp-cell-editor-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-cell-editor-active-background: var(--jp-layout-color0);
  --jp-cell-editor-active-border-color: var(--jp-brand-color1);
  --jp-cell-prompt-width: 64px;
  --jp-cell-prompt-font-family: var(--jp-code-font-family-default);
  --jp-cell-prompt-letter-spacing: 0;
  --jp-cell-prompt-opacity: 1;
  --jp-cell-prompt-not-active-opacity: 0.5;
  --jp-cell-prompt-not-active-font-color: var(--md-grey-700);

  /* A custom blend of MD grey and blue 600
   * See https://meyerweb.com/eric/tools/color-blend/#546E7A:1E88E5:5:hex */
  --jp-cell-inprompt-font-color: #307fc1;

  /* A custom blend of MD grey and orange 600
   * https://meyerweb.com/eric/tools/color-blend/#546E7A:F4511E:5:hex */
  --jp-cell-outprompt-font-color: #bf5b3d;

  /* Notebook specific styles */

  --jp-notebook-padding: 10px;
  --jp-notebook-select-background: var(--jp-layout-color1);
  --jp-notebook-multiselected-color: var(--md-blue-50);

  /* The scroll padding is calculated to fill enough space at the bottom of the
  notebook to show one single-line cell (with appropriate padding) at the top
  when the notebook is scrolled all the way to the bottom. We also subtract one
  pixel so that no scrollbar appears if we have just one single-line cell in the
  notebook. This padding is to enable a 'scroll past end' feature in a notebook.
  */
  --jp-notebook-scroll-padding: calc(
    100% - var(--jp-code-font-size) * var(--jp-code-line-height) -
      var(--jp-code-padding) - var(--jp-cell-padding) - 1px
  );

  /* Rendermime styles */

  --jp-rendermime-error-background: #fdd;
  --jp-rendermime-table-row-background: var(--md-grey-100);
  --jp-rendermime-table-row-hover-background: var(--md-light-blue-50);

  /* Dialog specific styles */

  --jp-dialog-background: rgba(0, 0, 0, 0.25);

  /* Console specific styles */

  --jp-console-padding: 10px;

  /* Toolbar specific styles */

  --jp-toolbar-border-color: var(--jp-border-color1);
  --jp-toolbar-micro-height: 8px;
  --jp-toolbar-background: var(--jp-layout-color1);
  --jp-toolbar-box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.24);
  --jp-toolbar-header-margin: 4px 4px 0 4px;
  --jp-toolbar-active-background: var(--md-grey-300);

  /* Statusbar specific styles */

  --jp-statusbar-height: 24px;

  /* Input field styles */

  --jp-input-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-input-active-background: var(--jp-layout-color1);
  --jp-input-hover-background: var(--jp-layout-color1);
  --jp-input-background: var(--md-grey-100);
  --jp-input-border-color: var(--jp-inverse-border-color);
  --jp-input-active-border-color: var(--jp-brand-color1);
  --jp-input-active-box-shadow-color: rgba(19, 124, 189, 0.3);

  /* General editor styles */

  --jp-editor-selected-background: #d9d9d9;
  --jp-editor-selected-focused-background: #d7d4f0;
  --jp-editor-cursor-color: var(--jp-ui-font-color0);

  /* Code mirror specific styles */

  --jp-mirror-editor-keyword-color: #008000;
  --jp-mirror-editor-atom-color: #88f;
  --jp-mirror-editor-number-color: #080;
  --jp-mirror-editor-def-color: #00f;
  --jp-mirror-editor-variable-color: var(--md-grey-900);
  --jp-mirror-editor-variable-2-color: rgb(0, 54, 109);
  --jp-mirror-editor-variable-3-color: #085;
  --jp-mirror-editor-punctuation-color: #05a;
  --jp-mirror-editor-property-color: #05a;
  --jp-mirror-editor-operator-color: #a2f;
  --jp-mirror-editor-comment-color: #408080;
  --jp-mirror-editor-string-color: #ba2121;
  --jp-mirror-editor-string-2-color: #708;
  --jp-mirror-editor-meta-color: #a2f;
  --jp-mirror-editor-qualifier-color: #555;
  --jp-mirror-editor-builtin-color: #008000;
  --jp-mirror-editor-bracket-color: #997;
  --jp-mirror-editor-tag-color: #170;
  --jp-mirror-editor-attribute-color: #00c;
  --jp-mirror-editor-header-color: blue;
  --jp-mirror-editor-quote-color: #090;
  --jp-mirror-editor-link-color: #00c;
  --jp-mirror-editor-error-color: #f00;
  --jp-mirror-editor-hr-color: #999;

  /*
    RTC user specific colors.
    These colors are used for the cursor, username in the editor,
    and the icon of the user.
  */

  --jp-collaborator-color1: #ffad8e;
  --jp-collaborator-color2: #dac83d;
  --jp-collaborator-color3: #72dd76;
  --jp-collaborator-color4: #00e4d0;
  --jp-collaborator-color5: #45d4ff;
  --jp-collaborator-color6: #e2b1ff;
  --jp-collaborator-color7: #ff9de6;

  /* Vega extension styles */

  --jp-vega-background: white;

  /* Sidebar-related styles */

  --jp-sidebar-min-width: 250px;

  /* Search-related styles */

  --jp-search-toggle-off-opacity: 0.5;
  --jp-search-toggle-hover-opacity: 0.8;
  --jp-search-toggle-on-opacity: 1;
  --jp-search-selected-match-background-color: rgb(245, 200, 0);
  --jp-search-selected-match-color: black;
  --jp-search-unselected-match-background-color: var(
    --jp-inverse-layout-color0
  );
  --jp-search-unselected-match-color: var(--jp-ui-inverse-font-color0);

  /* Icon colors that work well with light or dark backgrounds */
  --jp-icon-contrast-color0: var(--md-purple-600);
  --jp-icon-contrast-color1: var(--md-green-600);
  --jp-icon-contrast-color2: var(--md-pink-600);
  --jp-icon-contrast-color3: var(--md-blue-600);

  /* Button colors */
  --jp-accept-color-normal: var(--md-blue-700);
  --jp-accept-color-hover: var(--md-blue-800);
  --jp-accept-color-active: var(--md-blue-900);
  --jp-warn-color-normal: var(--md-red-700);
  --jp-warn-color-hover: var(--md-red-800);
  --jp-warn-color-active: var(--md-red-900);
  --jp-reject-color-normal: var(--md-grey-600);
  --jp-reject-color-hover: var(--md-grey-700);
  --jp-reject-color-active: var(--md-grey-800);

  /* File or activity icons and switch semantic variables */
  --jp-jupyter-icon-color: #f37626;
  --jp-notebook-icon-color: #f37626;
  --jp-json-icon-color: var(--md-orange-700);
  --jp-console-icon-background-color: var(--md-blue-700);
  --jp-console-icon-color: white;
  --jp-terminal-icon-background-color: var(--md-grey-800);
  --jp-terminal-icon-color: var(--md-grey-200);
  --jp-text-editor-icon-color: var(--md-grey-700);
  --jp-inspector-icon-color: var(--md-grey-700);
  --jp-switch-color: var(--md-grey-400);
  --jp-switch-true-position-color: var(--md-orange-900);
}
</style>
<style type="text/css">
/* Force rendering true colors when outputing to pdf */
* {
  -webkit-print-color-adjust: exact;
}

/* Misc */
a.anchor-link {
  display: none;
}

/* Input area styling */
.jp-InputArea {
  overflow: hidden;
}

.jp-InputArea-editor {
  overflow: hidden;
}

.cm-editor.cm-s-jupyter .highlight pre {
/* weird, but --jp-code-padding defined to be 5px but 4px horizontal padding is hardcoded for pre.cm-line */
  padding: var(--jp-code-padding) 4px;
  margin: 0;

  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  color: inherit;

}

.jp-OutputArea-output pre {
  line-height: inherit;
  font-family: inherit;
}

.jp-RenderedText pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
}

/* Hiding the collapser by default */
.jp-Collapser {
  display: none;
}

@page {
    margin: 0.5in; /* Margin for each printed piece of paper */
}

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}
</style>
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<!-- End of mathjax configuration --><script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      maxEdges: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        let { svg } = await mermaid.render(id, raw, el);
        svg = cleanMermaidSvg(svg);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }


    /**
     * Post-process to ensure mermaid diagrams contain only valid SVG and XHTML.
     */
    function cleanMermaidSvg(svg) {
      return svg.replace(RE_VOID_ELEMENT, replaceVoidElement);
    }


    /**
     * A regular expression for all void elements, which may include attributes and
     * a slash.
     *
     * @see https://developer.mozilla.org/en-US/docs/Glossary/Void_element
     *
     * Of these, only `<br>` is generated by Mermaid in place of `\n`,
     * but _any_ "malformed" tag will break the SVG rendering entirely.
     */
    const RE_VOID_ELEMENT =
      /<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;

    /**
     * Ensure a void element is closed with a slash, preserving any attributes.
     */
    function replaceVoidElement(match, tag, rest) {
      rest = rest.trim();
      if (!rest.endsWith('/')) {
        rest = `${rest} /`;
      }
      return `<${tag} ${rest}>`;
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
</script>
<style>
  .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details > pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary > pre {
    display: inline-block;
    white-space: normal;
  }
</style>
<!-- End of mermaid configuration --></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="Big-Data-Modeling-and-Management-Assigment---Homework-1"><strong>Big Data Modeling and Management Assigment - Homework 1</strong><a class="anchor-link" href="#Big-Data-Modeling-and-Management-Assigment---Homework-1">¶</a></h1>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="Submission"><strong>Submission</strong><a class="anchor-link" href="#Submission">¶</a></h1><p>GROUP NUMBER: <strong>5</strong></p>
<p>GROUP MEMBERS:</p>
<table>
<thead>
<tr>
<th style="text-align:center">STUDENT NAME</th>
<th style="text-align:center">STUDENT NUMBER</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Alexandre Gonçalves</td>
<td style="text-align:center">20240738</td>
</tr>
<tr>
<td style="text-align:center">André Silvestre</td>
<td style="text-align:center">20240502</td>
</tr>
<tr>
<td style="text-align:center">Filipa Pereira</td>
<td style="text-align:center">20240509</td>
</tr>
<tr>
<td style="text-align:center">João Henriques</td>
<td style="text-align:center">20240499</td>
</tr>
<tr>
<td style="text-align:center">Umeima Mahomed</td>
<td style="text-align:center">20240543</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="%F0%9F%8D%BA-The-Beer-project--%F0%9F%8D%BA"><strong>🍺 The Beer project  🍺</strong><a class="anchor-link" href="#%F0%9F%8D%BA-The-Beer-project--%F0%9F%8D%BA">¶</a></h2><p>As it was shown in classes, graph databases are a natural way of navegating related information. For this first project we will be taking a graph database to analyse beer and breweries!</p>
<p>The project datasets are based on <a href="https://www.kaggle.com/ehallmar/beers-breweries-and-beer-reviews">kaggle</a>, released by Evan Hallmark.</p>
<h3 id="Problem-description"><strong>Problem description</strong><a class="anchor-link" href="#Problem-description">¶</a></h3><p>Imagine you are working in the Data Management department of Analytics company.
Explore the database via python neo4j connector and/or the graphical tool in the NEO4J webpage. Answer the questions while adjusting the database to meet the needs of your colleagues.
Please record and keep track of your database changes, and submit the file with all cells run and with the output shown.</p>
<h3 id="Questions"><strong>Questions</strong><a class="anchor-link" href="#Questions">¶</a></h3><ol>
<li>Explore the database: get familiar with current schema, elements and other important database parameters. [1 point]</li>
<li>Adjust the database and mention reasoning behind: e.g. clean errors, remove redundancies, adjust schema as necessary. Visualize the final version of database schema. [4 points]</li>
<li>Analytics department requires the following information for the biweekly reporting: [5 points]<ol>
<li>How many reviews has the beer with the most reviews?</li>
<li>Which three users wrote the most reviews about beers?</li>
<li>Find all beers that are described with following words: 'fruit', 'complex', 'nutty', 'dark'.</li>
<li>Which top three breweries produce the largest variety of beer styles?</li>
<li>Which country produces the most beer styles?</li>
</ol>
</li>
<li>Market Analysis department in your company accesses and updates the trends data on the daily basis. Given that, consider how you need to optimize the database and its performance so that the following queries are efficient. Measure performance to communicate your improvements using PROFILE before final query. Answer the following: [4 points]<ol>
<li>Using ABV score, find five strongest beers, display their ABV score and the corresponding brewery? Keep in mind that the strongest known beer is Snake Venom, and deal with the error entries in the database.</li>
<li>Using the answer from question 2, find the top 5 distict beer styles with the highest average score of smell + feel that were reviewed by the third most productive user. Keep in mind that cleaning the database earlier should ensure correct results.</li>
</ol>
</li>
<li>Answer <strong>two out of four</strong> of the following questions using Graph Algorithms (gds): [NB: make sure to clear the graph before using it again] For the quarterly report, Analytics department the follownig information. [6 points]<ol>
<li>Which two countries are most similiar when it comes to their top five most produced Beer styles?</li>
<li>Which beer is the most popular when considering the number of users who reviewed it?</li>
<li>Users are connected together by their reviews of beers, taking into consideration the "smell" score they assign as a weight, how many communities are formed from these relationships? How many users are in the three largest communities?</li>
<li>Which user is the most influential when it comes to reviews of distinct beers by style?</li>
</ol>
</li>
</ol>
<h3 id="Groups"><strong>Groups</strong><a class="anchor-link" href="#Groups">¶</a></h3><p>Groups should have 4 people maximum. Please mark which group you are here: <a href="https://shorturl.at/zE0QP">https://shorturl.at/zE0QP</a></p>
<h3 id="Submission"><strong>Submission</strong><a class="anchor-link" href="#Submission">¶</a></h3><p>The code used to produce the results and to-the-point explations should be uploaded to moodle. They should have a clear reference to the group, either on the file name or on the document itself. Preferably one Jupyter notebook per group.</p>
<p>Delivery date: Until the <strong>midnight of March 18, 2025</strong></p>
<h3 id="Evaluation"><strong>Evaluation</strong><a class="anchor-link" href="#Evaluation">¶</a></h3><p>This will be 20% of the final grade.<br/>
Each solution will be evaluated on 2 components: correctness of results and efficiency of the query (based on database schema).<br/>
All code will go through plagiarism automated checks. Groups with the same code will undergo investigation.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Loading-the-Database"><strong>Loading the Database</strong><a class="anchor-link" href="#Loading-the-Database">¶</a></h2><p>Be sure that you <strong>don't have</strong> the neo4j docker container from the classes running (you can Stop it in the desktop app or with the command "<code>docker stop Neo4JLab</code>")</p>
<p>The default container does not have any data whatsoever, we will have to load a database into our docker image:</p>
<ul>
<li>Download and unzip the <code>Neo4JHWData</code> file provided in Moodle.</li>
<li>Copy the path of the <code>Neo4JHWData</code> folder of the unziped file, e.g. <code>C:/PATH/Neo4JHWData/data</code>.</li>
<li>Download and unzip the <code>Neo4JPlugins</code> file provided in Moodle.</li>
<li>Copy the path of the <code>Neo4JPlugins</code> folder of the unziped file, e.g. <code>C:/PATH/Neo4Jplugins</code>.</li>
<li>Change the code below accordingly. As you might have noticed, you do not have a user called <code>nunoa</code>, please use the appropriate path that you got from the previous step. Be sure that you have a neo4j docker container running: \</li>
</ul>
<p><code>docker run --name Neo4JHW2025 -p 7474:7474 -p 7687:7687 -d -v "c:\PATH\Neo4JPlugins":/plugins -v "c:\PATH\Neo4JHWData\data":/data --env NEO4J_AUTH=neo4j/test --env NEO4J_dbms_connector_https_advertised__address="localhost:7473" --env NEO4J_dbms_connector_http_advertised__address="localhost:7474" --env NEO4J_dbms_connector_bolt_advertised__address="localhost:7687" --env NEO4J_dbms_security_procedures_unrestricted=gds.* --env NEO4J_dbms_security_procedures_allowlist="gds.*" neo4j:4.4.5</code></p>
<ul>
<li>Since Neo4j is trying to recognize a new database folder, this might take a bit (let's say 3 minutes), so don't worry.</li>
</ul>
<p>If the neo4j browser fails to load gds plugins, run the following in the Command Prompt before creating the container again:
<code>// Remove stopped containers // docker container prune -f // Remove unused images // docker image prune -a -f // Remove unused volumes // docker volume prune -f // Remove unused networks // docker network prune -f // Remove all unused resources in one command // docker system prune -a -f</code></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">neo4j</span> <span class="kn">import</span> <span class="n">GraphDatabase</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="c1"># Extra</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>               <span class="c1"># For data manipulation</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                <span class="c1"># For numerical operations</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>             <span class="c1"># Progress bar</span>
<span class="kn">import</span> <span class="nn">time</span>                       <span class="c1"># For calculating time of execution</span>

<span class="c1"># Disable FutureWarning messages</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">NEO4J_URI</span><span class="o">=</span><span class="s2">"neo4j://localhost:7687"</span>
<span class="n">NEO4J_USERNAME</span><span class="o">=</span><span class="s2">"neo4j"</span>
<span class="n">NEO4J_PASSWORD</span><span class="o">=</span><span class="s2">"test"</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">GraphDatabase</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="n">NEO4J_URI</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">NEO4J_USERNAME</span><span class="p">,</span> <span class="n">NEO4J_PASSWORD</span><span class="p">),</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>    
    <span class="k">with</span> <span class="n">driver</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">"neo4j"</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_read</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tx</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)),</span> <span class="n">query</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">driver</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">"neo4j"</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="c1"># Write transactions allow the driver to handle retries and transient errors</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_write</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tx</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)),</span> <span class="n">query</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="%F0%9F%91%A8%E2%80%8D%F0%9F%92%BB-Answering-the-questions"><strong>👨‍💻 Answering the questions</strong><a class="anchor-link" href="#%F0%9F%91%A8%E2%80%8D%F0%9F%92%BB-Answering-the-questions">¶</a></h1><h2 id="1.-Explore-the-database"><strong>1. Explore the database</strong><a class="anchor-link" href="#1.-Explore-the-database">¶</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1. Explore the database: get familiar with current schema, elements and other important database parameters. [1 point]</span>

<span class="c1"># 1.1. Get the labels of all nodes in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.labels()</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Labels of all nodes in the database:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Labels of all nodes in the database:
[&lt;Record label='COUNTRIES'&gt;,
 &lt;Record label='CITIES'&gt;,
 &lt;Record label='BREWERIES'&gt;,
 &lt;Record label='BEERS'&gt;,
 &lt;Record label='REVIEWS'&gt;,
 &lt;Record label='STYLE'&gt;,
 &lt;Record label='USER'&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>This query retrieves all distinct labels used across the nodes in the database. The output shows the different categories of entities represented in our graph (e.g., <strong><code>COUNTRIES</code></strong>, <strong><code>BEERS</code></strong>, <strong><code>USER</code></strong>, etc).</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.2. Get the relationship types in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.relationshipTypes()</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Relationship types in the database:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Relationship types in the database:
[&lt;Record relationshipType='REVIEWED'&gt;,
 &lt;Record relationshipType='BREWED'&gt;,
 &lt;Record relationshipType='IN'&gt;,
 &lt;Record relationshipType='HAS_STYLE'&gt;,
 &lt;Record relationshipType='POSTED'&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>This query identifies all the different relationship types present in the graph. Knowing the relationship types helps understand how the entities are connected, giving an overview of the graph's structure (e.g., <strong><code>REVIEWED</code></strong>, <strong><code>BREWED</code></strong>, <strong><code>HAS_STYLE</code></strong>, etc).</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.3. Get the number of nodes in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n)</span>
<span class="s2">    RETURN count(n) as count</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record count=3215489&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.4. Get the number of relationships in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH ()-[r]-&gt;()</span>
<span class="s2">    RETURN count(r) as count</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record count=5856205&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In total we have $3\;215\;489$ nodes and $5\;856\;205$ relationships.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.5. Get the number of nodes per label in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n)</span>
<span class="s2">    RETURN labels(n) as label, count(n) as count</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record label=['COUNTRIES'] count=400&gt;,
 &lt;Record label=['CITIES'] count=23330&gt;,
 &lt;Record label=['BREWERIES'] count=100694&gt;,
 &lt;Record label=['BEERS'] count=417746&gt;,
 &lt;Record label=['REVIEWS'] count=2549252&gt;,
 &lt;Record label=['STYLE'] count=113&gt;,
 &lt;Record label=['USER'] count=123935&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>With this query we can see that we have $7$ different types of nodes in the database: <strong><code>COUNTRIES</code></strong> with $400$ nodes, <strong><code>CITIES</code></strong> with $23\;330$ nodes, <strong><code>BREWERIES</code></strong> with $100\;694$ nodes, <strong><code>BEERS</code></strong> with $417\;746$ nodes, <strong><code>REVIEWS</code></strong> with $2\;549\;252$ nodes, <strong><code>STYLE</code></strong> with $113$ nodes and <strong><code>USER</code></strong> with $123\;935$ nodes.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.6. Get the number of relationships per type in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH ()-[r]-&gt;()</span>
<span class="s2">    RETURN type(r) as type, count(r) as NumberOfRelationships</span>
<span class="s2">    ORDER BY NumberOfRelationships DESC</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record type='POSTED' NumberOfRelationships=2538044&gt;,
 &lt;Record type='REVIEWED' NumberOfRelationships=2537991&gt;,
 &lt;Record type='BREWED' NumberOfRelationships=358873&gt;,
 &lt;Record type='HAS_STYLE' NumberOfRelationships=358873&gt;,
 &lt;Record type='IN' NumberOfRelationships=62424&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We also have $5$ different types of relationships in the database: <strong><code>POSTED</code></strong> with $2\;538\;044$ relationships, <strong><code>REVIEWED</code></strong> with $2\;537\;991$ relationships, <strong><code>BREWED</code></strong> with $358\;873$ relationships, <strong><code>HAS_STYLE</code></strong> with $358\;873$ relationships and <strong><code>IN</code></strong> with $62\;424$ relationships.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.7. For each node label, get a list of properties and their types</span>

<span class="c1"># This query uses the built-in procedure db.schema.nodeTypeProperties() available in Neo4j 4.x+</span>
<span class="c1"># It returns, for each node label (nodeType), each property (propertyName) and its type(s) (propertyTypes)</span>
<span class="c1"># Source: https://neo4j.com/docs/operations-manual/current/procedures/#procedure_db_schema_nodetypeproperties</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.schema.nodeTypeProperties() YIELD nodeType, propertyName, propertyTypes, mandatory</span>
<span class="s2">    RETURN nodeType, propertyName, propertyTypes, mandatory</span>
<span class="s2">    ORDER BY nodeType, propertyName</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Properties and types for each node label:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node Label: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'nodeType'</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | Property: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'propertyName'</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | Type(s): </span><span class="si">{</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">'propertyTypes'</span><span class="p">])</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | Mandatory: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'mandatory'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Properties and types for each node label:
Node Label: :`BEERS`        | Property: abv             | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: availability    | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: brewery_id      | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: id              | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: notes           | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: retired         | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: state           | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: id              | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: notes           | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: state           | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: types           | Type(s): String               | Mandatory: True
Node Label: :`CITIES`       | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`COUNTRIES`    | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: beer_id         | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: date            | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: feel            | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: id              | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: look            | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: overall         | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: score           | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: smell           | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: taste           | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: text            | Type(s): String               | Mandatory: True
Node Label: :`STYLE`        | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`USER`         | Property: name            | Type(s): String               | Mandatory: True
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.7.1. Get a example of 1 node for each label</span>

<span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/subqueries/collect/</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n)</span>
<span class="s2">    WITH DISTINCT labels(n) AS label, collect(n) AS nodes     // For each node, get its labels and collect the node itself</span>
<span class="s2">    RETURN label, nodes[0] AS exampleNode                     // Return the label and an example (1st node of the list) for each label</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Example of 1 node for each label:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node Label: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Node: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'exampleNode'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Example of 1 node for each label:
Node Label: ['COUNTRIES'] | Node: &lt;Node element_id='0' labels=frozenset({'COUNTRIES'}) properties={'name': 'BE'}&gt;
Node Label: ['CITIES'] | Node: &lt;Node element_id='200' labels=frozenset({'CITIES'}) properties={'name': 'Erpe-Mere'}&gt;
Node Label: ['BREWERIES'] | Node: &lt;Node element_id='11865' labels=frozenset({'BREWERIES'}) properties={'types': 'Brewery', 'notes': 'No notes at this time.', 'name': 'Brouwerij Danny', 'id': '19730', 'state': 'nan'}&gt;
Node Label: ['BEERS'] | Node: &lt;Node element_id='62212' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': '7.3', 'name': 'Olde Cogitator', 'retired': 'f', 'state': 'CA', 'id': '202522', 'availability': ' Rotating', 'brewery_id': '2199'}&gt;
Node Label: ['REVIEWS'] | Node: &lt;Node element_id='421086' labels=frozenset({'REVIEWS'}) properties={'date': '2017-12-21', 'score': '4.5', 'taste': '4.5', 'feel': '4.5', 'overall': '4.5', 'beer_id': '125646', 'text': '\xa0\xa0', 'id': '1', 'smell': '4.5', 'look': '4.5'}&gt;
Node Label: ['STYLE'] | Node: &lt;Node element_id='9494213' labels=frozenset({'STYLE'}) properties={'name': 'English Oatmeal Stout'}&gt;
Node Label: ['USER'] | Node: &lt;Node element_id='9494326' labels=frozenset({'USER'}) properties={'name': 'bluejacket74'}&gt;
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>All <strong>properties of the nodes</strong> are in <strong><code>strings</code></strong> format, so we will have to convert them to the correct format in order to make the queries more efficient.</li>
</ul>
<p><strong>List of Properties to convert:</strong></p>
<ul>
<li><strong><code>id</code></strong> and <strong><code>beer_id</code></strong>/<strong><code>brewery_id</code></strong> in <strong><code>BEERS</code></strong>, <strong><code>BREWERIES</code></strong> and <strong><code>REVIEWS</code></strong> nodes to <strong><code>int</code></strong>.</li>
<li><strong><code>abv</code></strong> in <strong><code>BEERS</code></strong> nodes to <strong><code>float</code></strong>.</li>
<li><strong><code>score</code></strong>, <strong><code>taste</code></strong>, <strong><code>feel</code></strong>, <strong><code>overall</code></strong>, <strong><code>smell</code></strong> and <strong><code>look</code></strong> in <strong><code>REVIEWS</code></strong> nodes to <strong><code>float</code></strong>.</li>
<li><strong><code>date</code></strong> in <strong><code>REVIEWS</code></strong> nodes to <strong><code>date</code></strong></li>
<li><strong><code>retired</code></strong> in <strong><code>BEERS</code></strong> nodes to <strong><code>boolean</code></strong></li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.8. For each relationship type, get a list of properties and their types (relTypeProperties)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.schema.relTypeProperties() YIELD relType, propertyName, propertyTypes</span>
<span class="s2">    RETURN relType, propertyName, propertyTypes</span>
<span class="s2">    ORDER BY relType, propertyName</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Properties and types for each relationship type:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Relationship Type:"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"relType"</span><span class="p">],</span> <span class="s2">"| Property:"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"propertyName"</span><span class="p">],</span> <span class="s2">"| Type(s):"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"propertyTypes"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Properties and types for each relationship type:
Relationship Type: :`BREWED` | Property: None | Type(s): None
Relationship Type: :`HAS_STYLE` | Property: None | Type(s): None
Relationship Type: :`IN` | Property: None | Type(s): None
Relationship Type: :`POSTED` | Property: None | Type(s): None
Relationship Type: :`REVIEWED` | Property: None | Type(s): None
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>All <strong>relationships</strong> don't have any properties.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.9. For each pair of nodes, print the connection and its direction</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (a)-[r]-&gt;(b)</span>
<span class="s2">    WITH DISTINCT head(labels(a)) AS StartLabel, type(r) AS Relationship, head(labels(b)) AS EndLabel</span>
<span class="s2">    RETURN StartLabel, Relationship, EndLabel</span>
<span class="s2">    ORDER BY StartLabel, Relationship, EndLabel</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Schema of connections (node label - relationship -&gt; node label):"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">"StartLabel"</span><span class="p">],</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"Relationship"</span><span class="p">],</span> <span class="s2">"-&gt;"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"EndLabel"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Schema of connections (node label - relationship -&gt; node label):
BEERS - HAS_STYLE -&gt; STYLE
BEERS - REVIEWED -&gt; REVIEWS
BREWERIES - BREWED -&gt; BEERS
BREWERIES - IN -&gt; CITIES
CITIES - IN -&gt; COUNTRIES
REVIEWS - POSTED -&gt; USER
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.9.1. Get the number of relationships associated with each connections (node label - relationship -&gt; node label)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n)-[r]-&gt;(m)</span>
<span class="s2">    RETURN labels(n) as node1, type(r) as relationship, labels(m) as node2, count(r) as NumberOfRelationships</span>
<span class="s2">    ORDER BY NumberOfRelationships DESC</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record node1=['REVIEWS'] relationship='POSTED' node2=['USER'] NumberOfRelationships=2538044&gt;,
 &lt;Record node1=['BEERS'] relationship='REVIEWED' node2=['REVIEWS'] NumberOfRelationships=2537991&gt;,
 &lt;Record node1=['BREWERIES'] relationship='BREWED' node2=['BEERS'] NumberOfRelationships=358873&gt;,
 &lt;Record node1=['BEERS'] relationship='HAS_STYLE' node2=['STYLE'] NumberOfRelationships=358873&gt;,
 &lt;Record node1=['BREWERIES'] relationship='IN' node2=['CITIES'] NumberOfRelationships=50347&gt;,
 &lt;Record node1=['CITIES'] relationship='IN' node2=['COUNTRIES'] NumberOfRelationships=12077&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="%F0%9F%A7%AE-Summary-of-the-Database-Schema"><strong>🧮 Summary of the Database Schema</strong><a class="anchor-link" href="#%F0%9F%A7%AE-Summary-of-the-Database-Schema">¶</a></h4><center>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"><strong>Node Labels</strong></th>
<th style="text-align:left"><strong>Properties</strong></th>
<th style="text-align:center"><strong>Total number of nodes</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><code>COUNTRIES</code></td>
<td style="text-align:left">name</td>
<td style="text-align:center">$400$</td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><code>CITIES</code></td>
<td style="text-align:left">name</td>
<td style="text-align:center">$23\;330$</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><code>BREWERIES</code></td>
<td style="text-align:left">notes, types, id, name, state</td>
<td style="text-align:center">$100\;694$</td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><code>BEERS</code></td>
<td style="text-align:left">notes, abv, name, state, id, retired, availability, brewery_id</td>
<td style="text-align:center">$417\;746$</td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><code>REVIEWS</code></td>
<td style="text-align:left">text, smell, look, taste, feel, overall, beer_id, id, date, score</td>
<td style="text-align:center">$2\;549\;252$</td>
</tr>
<tr>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><code>STYLE</code></td>
<td style="text-align:left">name</td>
<td style="text-align:center">$113$</td>
</tr>
<tr>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><code>USER</code></td>
<td style="text-align:left">name</td>
<td style="text-align:center">$123\;935$</td>
</tr>
</tbody>
</table>
<p><br/><br/></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"><strong>Relationship Types</strong></th>
<th style="text-align:center"><strong>Total number of relationships</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><code>POSTED</code></td>
<td style="text-align:center">$2\;538\;044$</td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><code>REVIEWED</code></td>
<td style="text-align:center">$2\;537\;991$</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><code>BREWED</code></td>
<td style="text-align:center">$358\;873$</td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><code>HAS_STYLE</code></td>
<td style="text-align:center">$358\;873$</td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><code>IN</code></td>
<td style="text-align:center">$62\;424$</td>
</tr>
</tbody>
</table>
</center>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [48]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.10 Visualize the schema of the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // What is related, and how</span>
<span class="s2">    CALL db.schema.visualization()</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Schema visualization:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Schema visualization:
[&lt;Record nodes=[&lt;Node element_id='-5' labels=frozenset({'REVIEWS'}) properties={'name': 'REVIEWS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-4' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-1' labels=frozenset({'COUNTRIES'}) properties={'name': 'COUNTRIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-3' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-6' labels=frozenset({'STYLE'}) properties={'name': 'STYLE', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-2' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-7' labels=frozenset({'USER'}) properties={'name': 'USER', 'indexes': ['name'], 'constraints': []}&gt;] relationships=[&lt;Relationship element_id='-1' nodes=(&lt;Node element_id='-4' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-5' labels=frozenset({'REVIEWS'}) properties={'name': 'REVIEWS', 'indexes': ['id'], 'constraints': []}&gt;) type='REVIEWED' properties={}&gt;, &lt;Relationship element_id='-2' nodes=(&lt;Node element_id='-3' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-4' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;) type='BREWED' properties={}&gt;, &lt;Relationship element_id='-3' nodes=(&lt;Node element_id='-2' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-1' labels=frozenset({'COUNTRIES'}) properties={'name': 'COUNTRIES', 'indexes': ['name'], 'constraints': []}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='-6' nodes=(&lt;Node element_id='-3' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-2' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='-4' nodes=(&lt;Node element_id='-2' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-2' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='-5' nodes=(&lt;Node element_id='-3' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-1' labels=frozenset({'COUNTRIES'}) properties={'name': 'COUNTRIES', 'indexes': ['name'], 'constraints': []}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='-7' nodes=(&lt;Node element_id='-4' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-6' labels=frozenset({'STYLE'}) properties={'name': 'STYLE', 'indexes': ['name'], 'constraints': []}&gt;) type='HAS_STYLE' properties={}&gt;, &lt;Relationship element_id='-8' nodes=(&lt;Node element_id='-5' labels=frozenset({'REVIEWS'}) properties={'name': 'REVIEWS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-7' labels=frozenset({'USER'}) properties={'name': 'USER', 'indexes': ['name'], 'constraints': []}&gt;) type='POSTED' properties={}&gt;]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<blockquote>
<p>Running the previous query in <strong><code>http://localhost:7474/browser/</code></strong> we get the following output:</p>
</blockquote>
<center><img alt="No description has been provided for this image" src="./img/graph_withoutCleaning.svg" width="500"/></center>
<center><b>Image 1 | </b> Original Graph Schema.</center><br/><br/>
<p><strong>NOTE:</strong> Although the relationship <strong><code>IN</code></strong> between <strong><code>CITIES</code></strong> and itself and between <strong><code>BREWERIES</code></strong> and <strong><code>COUNTRIES</code></strong> is shown in the image, it is not present in the database as we can see in the previous query (<strong>1.9.</strong>).</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.11 Get a description of the database</span>
<span class="c1">#      Source of the query: http://localhost:7474/browser/ &gt; Favorites &gt; Sample Scripts &gt; Data Profiling &gt; What kind of nodes exist</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // What kind of nodes exist</span>
<span class="s2">    // Sample some nodes, reporting on property and relationship counts per node.</span>
<span class="s2">    MATCH (n) </span>
<span class="s2">    RETURN</span>
<span class="s2">        DISTINCT labels(n),</span>
<span class="s2">            count(*) AS NodeCount,</span>
<span class="s2">            avg(size(keys(n))) as Avg_PropertyCount,</span>
<span class="s2">            min(size(keys(n))) as Min_PropertyCount,</span>
<span class="s2">            max(size(keys(n))) as Max_PropertyCount,</span>
<span class="s2">            avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,</span>
<span class="s2">            min(size( (n)-[]-() ) ) as Min_RelationshipCount,</span>
<span class="s2">            max(size( (n)-[]-() ) ) as Max_RelationshipCount</span>
<span class="s2">"""</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="c1"># Convert the result to Pandas DataFrame for better visualization</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"labels(n)"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Node Label"</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Description of the database:"</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: A pattern expression should only be used in order to test the existence of a pattern. It should therefore only be used in contexts that evaluate to a boolean, e.g. inside the function exists() or in a WHERE-clause. All other uses are deprecated and should be replaced by a pattern comprehension.} {position: line: 12, column: 23, offset: 447} for query: '\n    // What kind of nodes exist\n    // Sample some nodes, reporting on property and relationship counts per node.\n    MATCH (n) \n    RETURN\n        DISTINCT labels(n),\n            count(*) AS NodeCount,\n            avg(size(keys(n))) as Avg_PropertyCount,\n            min(size(keys(n))) as Min_PropertyCount,\n            max(size(keys(n))) as Max_PropertyCount,\n            avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,\n            min(size( (n)-[]-() ) ) as Min_RelationshipCount,\n            max(size( (n)-[]-() ) ) as Max_RelationshipCount\n'
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: A pattern expression should only be used in order to test the existence of a pattern. It should therefore only be used in contexts that evaluate to a boolean, e.g. inside the function exists() or in a WHERE-clause. All other uses are deprecated and should be replaced by a pattern comprehension.} {position: line: 11, column: 23, offset: 385} for query: '\n    // What kind of nodes exist\n    // Sample some nodes, reporting on property and relationship counts per node.\n    MATCH (n) \n    RETURN\n        DISTINCT labels(n),\n            count(*) AS NodeCount,\n            avg(size(keys(n))) as Avg_PropertyCount,\n            min(size(keys(n))) as Min_PropertyCount,\n            max(size(keys(n))) as Max_PropertyCount,\n            avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,\n            min(size( (n)-[]-() ) ) as Min_RelationshipCount,\n            max(size( (n)-[]-() ) ) as Max_RelationshipCount\n'
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: A pattern expression should only be used in order to test the existence of a pattern. It should therefore only be used in contexts that evaluate to a boolean, e.g. inside the function exists() or in a WHERE-clause. All other uses are deprecated and should be replaced by a pattern comprehension.} {position: line: 13, column: 23, offset: 509} for query: '\n    // What kind of nodes exist\n    // Sample some nodes, reporting on property and relationship counts per node.\n    MATCH (n) \n    RETURN\n        DISTINCT labels(n),\n            count(*) AS NodeCount,\n            avg(size(keys(n))) as Avg_PropertyCount,\n            min(size(keys(n))) as Min_PropertyCount,\n            max(size(keys(n))) as Max_PropertyCount,\n            avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,\n            min(size( (n)-[]-() ) ) as Min_RelationshipCount,\n            max(size( (n)-[]-() ) ) as Max_RelationshipCount\n'
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Description of the database:
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[49]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>NodeCount</th>
<th>Avg_PropertyCount</th>
<th>Min_PropertyCount</th>
<th>Max_PropertyCount</th>
<th>Avg_RelationshipCount</th>
<th>Min_RelationshipCount</th>
<th>Max_RelationshipCount</th>
</tr>
<tr>
<th>Node Label</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>[COUNTRIES]</th>
<td>400</td>
<td>1.0</td>
<td>1</td>
<td>1</td>
<td>30.192500</td>
<td>0</td>
<td>4959</td>
</tr>
<tr>
<th>[CITIES]</th>
<td>23330</td>
<td>1.0</td>
<td>1</td>
<td>1</td>
<td>2.675697</td>
<td>0</td>
<td>513</td>
</tr>
<tr>
<th>[BREWERIES]</th>
<td>100694</td>
<td>5.0</td>
<td>5</td>
<td>5</td>
<td>4.063996</td>
<td>0</td>
<td>1230</td>
</tr>
<tr>
<th>[BEERS]</th>
<td>417746</td>
<td>8.0</td>
<td>8</td>
<td>8</td>
<td>7.793580</td>
<td>0</td>
<td>4835</td>
</tr>
<tr>
<th>[REVIEWS]</th>
<td>2549252</td>
<td>10.0</td>
<td>10</td>
<td>10</td>
<td>1.991186</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<th>[STYLE]</th>
<td>113</td>
<td>1.0</td>
<td>1</td>
<td>1</td>
<td>3175.867257</td>
<td>1</td>
<td>44719</td>
</tr>
<tr>
<th>[USER]</th>
<td>123935</td>
<td>1.0</td>
<td>1</td>
<td>1</td>
<td>20.478832</td>
<td>0</td>
<td>3756</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><p><strong>Orphan/Isolated Nodes</strong>: Nodes with <strong>relationship count of 0</strong> are considered orphan nodes, meaning they are not connected to any other nodes in the graph. These nodes may represent incomplete data or entities that have not yet been linked to the rest of the dataset.</p>
<ul>
<li>In this database, there are orphan nodes of type <code>COUNTRIES</code>, <code>CITIES</code>, <code>BREWERIES</code>, <code>BEERS</code>, <code>REVIEWS</code>, and <code>USER</code>. This will be analyzed later in the cleaning process.</li>
</ul>
</li>
<li><p><strong><code>Min_PropertyCount</code> and <code>Max_PropertyCount</code></strong>: The consistency in <code>Min_PropertyCount</code> and <code>Max_PropertyCount</code> across all labels suggests that each node type has a uniform set of properties.</p>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 1.12 Get a summary statistics of each property for each node label in the database</span>
<span class="c1">#     Source of the query: https://neo4j.com/blog/developer/data-profiling-holistic-view-neo4j/</span>
<span class="c1">#                          https://neo4j.com/docs/cypher-manual/current/functions/aggregating/</span>
<span class="c1">#                          https://neo4j.com/docs/cypher-manual/current/queries/case/</span>
<span class="c1">#                          https://neo4j.com/docs/cypher-manual/current/functions/string/</span>

<span class="c1"># Get all properties for each node label</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.schema.nodeTypeProperties() YIELD nodeType, propertyName</span>
<span class="s2">    WITH nodeType, propertyName</span>
<span class="s2">    ORDER BY nodeType, propertyName</span>
<span class="s2">    RETURN nodeType, propertyName</span>
<span class="s2">"""</span>
<span class="n">properties_result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="c1"># Initialize a list to store statistics</span>
<span class="n">stats_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate over each property and calculate statistics</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">properties_result</span><span class="p">):</span>
    <span class="n">nodeType</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">'nodeType'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'`'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">':'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>  <span class="c1"># Remove backticks and ':'</span>
    <span class="n">propertyName</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">'propertyName'</span><span class="p">]</span>
    
    <span class="c1"># Construct query for each property</span>
    <span class="k">if</span> <span class="n">propertyName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'notes'</span><span class="p">,</span> <span class="s1">'state'</span><span class="p">,</span> <span class="s1">'availability'</span><span class="p">,</span> <span class="s1">'retired'</span><span class="p">,</span> <span class="s1">'types'</span><span class="p">,</span> <span class="s1">'date'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">]:</span>
        <span class="c1"># String properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS count,</span>
<span class="s2">                COUNT(DISTINCT n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS distinctCount,</span>
<span class="s2">                '-' AS mean,</span>
<span class="s2">                '-' AS min,</span>
<span class="s2">                '-' AS max,</span>
<span class="s2">                COUNT(CASE WHEN n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NULL OR n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> = '' OR toLower(trim(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">)) IN ['nan', 'null', 'none', ' '] THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Numeric properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            WITH n, toFloat(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS value</span>
<span class="s2">            WHERE n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NOT NULL</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(value) AS count,</span>
<span class="s2">                COUNT(DISTINCT value) AS distinctCount,</span>
<span class="s2">                AVG(value) AS mean,</span>
<span class="s2">                MIN(value) AS min,</span>
<span class="s2">                MAX(value) AS max,</span>
<span class="s2">                COUNT(CASE WHEN n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NULL OR n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> = '' OR toLower(trim(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">)) IN ['nan', 'null', 'none', ''] THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">stats_result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">stats_query</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stats_result</span><span class="p">:</span>
            <span class="n">stats_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error processing </span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">stats_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Node'</span><span class="p">,</span> <span class="s1">'Property'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">,</span> <span class="s1">'Distinct Count'</span><span class="p">,</span> 
                                       <span class="s1">'Mean'</span><span class="p">,</span> <span class="s1">'Min'</span><span class="p">,</span> <span class="s1">'Max'</span><span class="p">,</span> <span class="s1">'Missing Count'</span><span class="p">])</span>                          <span class="c1"># Convert the list to a DataFrame</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'Missing Count (%)'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Missing Count'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>                                     <span class="c1"># Calculate the percentage of missing values</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">'Node'</span><span class="p">,</span> <span class="s1">'Property'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                                        <span class="c1"># Set the index to Node and Property (Hierarchical Indexing)</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                                                            <span class="c1"># Fill NaN values with 0</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'</span><span class="si">{:,.0f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span>
              <span class="s1">'</span><span class="si">{:,.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span>
              <span class="n">x</span>
<span class="p">)</span>                                                                                                                     <span class="c1"># Format the DataFrame for better visualization</span>
<span class="n">df</span> 

<span class="c1">## Time of Execution: 2m (1st query) + 07min 38s (2nd query) = 9m 38s</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>100%|██████████| 27/27 [08:38&lt;00:00, 19.21s/it]
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[50]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Count</th>
<th>Distinct Count</th>
<th>Mean</th>
<th>Min</th>
<th>Max</th>
<th>Missing Count</th>
<th>Missing Count (%)</th>
</tr>
<tr>
<th>Node</th>
<th>Property</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="8" valign="top">BEERS</th>
<th>abv</th>
<td>372718</td>
<td>939</td>
<td>6.53</td>
<td>0.01</td>
<td>100</td>
<td>45028</td>
<td>12.08</td>
</tr>
<tr>
<th>availability</th>
<td>417746</td>
<td>20</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>brewery_id</th>
<td>417746</td>
<td>16569</td>
<td>24 592.84</td>
<td>1</td>
<td>54 144</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>id</th>
<td>417746</td>
<td>358873</td>
<td>189 196.88</td>
<td>3</td>
<td>374 406</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>name</th>
<td>417746</td>
<td>298567</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>notes</th>
<td>417746</td>
<td>48313</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>55</td>
<td>0.01</td>
</tr>
<tr>
<th>retired</th>
<td>417746</td>
<td>2</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>state</th>
<td>417746</td>
<td>68</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>70831</td>
<td>16.96</td>
</tr>
<tr>
<th rowspan="5" valign="top">BREWERIES</th>
<th>id</th>
<td>100694</td>
<td>50347</td>
<td>27 870.51</td>
<td>1</td>
<td>54 156</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>name</th>
<td>100694</td>
<td>45245</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>notes</th>
<td>100694</td>
<td>3271</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>170</td>
<td>0.17</td>
</tr>
<tr>
<th>state</th>
<td>100694</td>
<td>68</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>22542</td>
<td>22.39</td>
</tr>
<tr>
<th>types</th>
<td>100694</td>
<td>30</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>CITIES</th>
<th>name</th>
<td>23330</td>
<td>11665</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>2</td>
<td>0.01</td>
</tr>
<tr>
<th>COUNTRIES</th>
<th>name</th>
<td>400</td>
<td>200</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>2</td>
<td>0.50</td>
</tr>
<tr>
<th rowspan="10" valign="top">REVIEWS</th>
<th>beer_id</th>
<td>2549252</td>
<td>189645</td>
<td>77 459.01</td>
<td>3</td>
<td>373 128</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>date</th>
<td>2549252</td>
<td>6379</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>feel</th>
<td>1484819</td>
<td>17</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>1064433</td>
<td>71.69</td>
</tr>
<tr>
<th>id</th>
<td>2549252</td>
<td>2546141</td>
<td>4 517 442.86</td>
<td>1</td>
<td>9 073 127</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>look</th>
<td>1484819</td>
<td>17</td>
<td>3.95</td>
<td>1</td>
<td>5</td>
<td>1064433</td>
<td>71.69</td>
</tr>
<tr>
<th>overall</th>
<td>1484819</td>
<td>17</td>
<td>3.92</td>
<td>1</td>
<td>5</td>
<td>1064433</td>
<td>71.69</td>
</tr>
<tr>
<th>score</th>
<td>2549252</td>
<td>401</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>smell</th>
<td>1484819</td>
<td>17</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>1064433</td>
<td>71.69</td>
</tr>
<tr>
<th>taste</th>
<td>1484819</td>
<td>17</td>
<td>3.92</td>
<td>1</td>
<td>5</td>
<td>1064433</td>
<td>71.69</td>
</tr>
<tr>
<th>text</th>
<td>2549252</td>
<td>814333</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>STYLE</th>
<th>name</th>
<td>113</td>
<td>113</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.88</td>
</tr>
<tr>
<th>USER</th>
<th>name</th>
<td>123935</td>
<td>123935</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div class="alert alert-block alert-info" style="color: white; background-color: rgb(110, 3, 3); border: 0px; -moz-border-radius: 10px; -webkit-border-radius: 10px;">
<h4 id="%F0%9F%96%BC%EF%B8%8F-Statistical-Analysis-of-the-Database"><strong>🖼️ Statistical Analysis of the Database</strong><a class="anchor-link" href="#%F0%9F%96%BC%EF%B8%8F-Statistical-Analysis-of-the-Database">¶</a></h4></div>
<p><strong>BEERS</strong></p>
<ul>
<li><strong><code>abv</code></strong>: According to <a href="https://www.hopsandhopes.nl/en/beers/snake-venom">Hops &amp; Hopes (2025)</a> the world's strongest beer is <strong>Snake Venom</strong> with <strong>67.5% ABV</strong>. We can see that the <strong>maximum</strong> value in the database is <strong>100</strong>, so we will need to verify the beers with more than <strong>67.5% ABV</strong>.</li>
<li><strong><code>availability</code></strong> have <strong>$20$</strong> different values.</li>
<li><strong><code>brewery_id</code></strong>: In total we have <strong>$417\;746$</strong> brewery_ids, but <strong>$16\;569$</strong> distinct brewery_ids. It is possible that some breweries have more than one beer.</li>
<li><strong><code>id</code></strong>: In total we have <strong>$417\;746$</strong> ids, but <strong>$358\;873$</strong> distinct ids. We need to check the duplicates.</li>
<li><strong><code>name</code></strong>: In total we have <strong>$417\;746$</strong> names, but <strong>$298\;567$</strong> distinct names. It is possible that some beers have the same name.</li>
<li><strong><code>notes</code></strong>: In total we have <strong>$417\;746$</strong> notes, but <strong>$48\;313$</strong> distinct notes. Same as the <strong><code>name</code></strong> property, it is possible that some beers have the same notes.</li>
<li><strong><code>retired</code></strong> have <strong>$2$</strong> different values - <strong><code>True</code></strong> and <strong><code>False</code></strong>.</li>
<li><strong><code>state</code></strong> have <strong>$68$</strong> different values.</li>
</ul>
<p><strong>BREWERIES</strong></p>
<ul>
<li><strong><code>id</code></strong>: In total we have <strong>$100\;694$</strong> ids, but <strong>$50\;347$</strong> distinct ids. As in <strong><code>BEERS.id</code></strong>, we need to check the duplicates.</li>
<li><strong><code>name</code></strong>: In total we have <strong>$100\;694$</strong> names, but <strong>$45\;245$</strong> distinct names. We need to check the duplicates.</li>
<li><strong><code>notes</code></strong>: In total we have <strong>$100\;694$</strong> notes, but <strong>$3\;271$</strong> distinct notes. Same as the <strong><code>name</code></strong> property, it is possible that some breweries have the same notes.</li>
<li><strong><code>state</code></strong> have <strong>$68$</strong> different values (the same as in <strong><code>BEERS</code></strong>).</li>
<li><strong><code>types</code></strong> have <strong>$30$</strong> different values.</li>
</ul>
<p><strong>CITIES</strong></p>
<ul>
<li><strong><code>name</code></strong>: In total we have <strong>$23\;330$</strong> names, but <strong>$11\;665$</strong> distinct names. We need to check the duplicates.</li>
</ul>
<p><strong>COUNTRIES</strong></p>
<ul>
<li><strong><code>name</code></strong>: In total we have <strong>$400$</strong> names, but <strong>$200$</strong> distinct names. We need to check the duplicates.</li>
</ul>
<p><strong>REVIEWS</strong></p>
<ul>
<li><strong><code>beer_id</code></strong>: In total we have <strong>$2\;549\;252$</strong> beer_ids, but <strong>$189\;645$</strong> distinct beer_ids. It is possible that some beers have more than one review.</li>
<li><strong><code>date</code></strong>: We need to convert this property to <strong><code>date</code></strong> format.</li>
<li><strong><code>feel</code></strong>, <strong><code>look</code></strong>, <strong><code>overall</code></strong>, <strong><code>smell</code></strong>, <strong><code>taste</code></strong> and <strong><code>score</code></strong>: We need to convert these properties to <strong><code>float</code></strong> format, but we can see that the values are already clean, because the <strong><code>Min</code></strong> and <strong><code>Max</code></strong> values are between <strong>$1$</strong> and <strong>$5$</strong>.</li>
<li><strong><code>id</code></strong>: In total we have <strong>$2\;549\;252$</strong> ids, but <strong>$2\;546\;141$</strong> distinct ids. We need to check the duplicates.</li>
<li><strong><code>text</code></strong>: In total we have <strong>$2\;549\;252$</strong> texts, but <strong>$814\;333$</strong> distinct texts. It is possible that some reviews have the same text.</li>
</ul>
<p><strong>STYLE</strong></p>
<ul>
<li><strong><code>name</code></strong>: In total we have <strong>$113$</strong> names and distinct names, so we don't need to check the duplicates.</li>
</ul>
<p><strong>USER</strong></p>
<ul>
<li><strong><code>name</code></strong>: In total we have <strong>$123\;935$</strong> names and distinct names, so we don't need to check the duplicates.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="2.-Adjust-the-database"><strong>2. Adjust the database</strong><a class="anchor-link" href="#2.-Adjust-the-database">¶</a></h2><ul>
<li>Adjust the database and mention reasoning behind:<ul>
<li>Clean errors,</li>
<li>Remove redundancies,</li>
<li>Adjust schema as necessary</li>
<li>Visualize the final version of database schema. [4 points]</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2. Adjust the database and mention reasoning behind: </span>
<span class="c1">#    e.g. clean errors, remove redundancies, adjust schema as necessary. </span>
<span class="c1"># Visualize the final version of database schema. [4 points]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="2.1.-%F0%9F%94%A2%F0%9F%94%A0-Adjust-the-data-types"><strong>2.1. 🔢🔠 Adjust the data types</strong><a class="anchor-link" href="#2.1.-%F0%9F%94%A2%F0%9F%94%A0-Adjust-the-data-types">¶</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>To improve query performance and data integrity, it is crucial to convert properties storing IDs into an appropriate numerical type.</p>
<ul>
<li>This operation includes converting:<ul>
<li>The <code>brewery_id</code> and <code>id</code> properties of the <code>BEERS</code> nodes, <code>id</code> of the <code>BREWERIES</code> nodes, and <code>beer_id</code> and <code>id</code> properties of the <code>REVIEWS</code> nodes.</li>
<li>The <code>abv</code>, <code>score</code>, <code>taste</code>, <code>feel</code>, <code>overall</code>, <code>smell</code>, and <code>look</code> properties of the <code>BEERS</code> and <code>REVIEWS</code> nodes will be converted to <code>float</code> type.</li>
<li>The <code>date</code> property of the <code>REVIEWS</code> nodes will be converted to a <code>date</code> type.</li>
<li>The <code>retired</code> property of the <code>BEERS</code> nodes will be converted to a <code>boolean</code> type.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.1. Convert BEERS.brewery_id, BEERS.id, BREWERIES.id, REVIEWS.beer_id, REVIEWS.id to integer</span>
<span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/clauses/set/</span>

<span class="c1"># Convert BEERS.brewery_id and BEERS.id to integer</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BEERS)</span>
<span class="s2">    SET n.brewery_id = toInteger(n.brewery_id)</span>
<span class="s2">    SET n.id = toInteger(n.id);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># Convert BREWERIES.id to integer</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BREWERIES)</span>
<span class="s2">    SET n.id = toInteger(n.id);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># # Convert REVIEWS.beer_id and REVIEWS.id to integer</span>
<span class="c1"># query = """</span>
<span class="c1">#     MATCH (n:REVIEWS)</span>
<span class="c1">#     SET n.beer_id = toInteger(n.beer_id)</span>
<span class="c1">#     SET n.id = toInteger(n.id)</span>
<span class="c1"># """</span>
<span class="c1"># result = execute_write(driver, query)</span>
<span class="c1"># pprint(result)</span>

<span class="c1"># {code: Neo.DatabaseError.Statement.ExecutionFailed} {message: Java heap space}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
[]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><strong>When we ran the previous query commented above, the following error was raised:</strong></p>
<pre><code>DatabaseError                             Traceback (most recent call last)
....
DatabaseError: {code: Neo.DatabaseError.Statement.ExecutionFailed} {message: Java heap space}


Transaction failed and will be retried in 0.8927118089735324s (There is not enough memory to perform the current task. Please try increasing 'dbms.memory.heap.max_size' in the neo4j configuration (normally in 'conf/neo4j.conf' or, if you are using Neo4j Desktop, found through the user interface) or if you are running an embedded installation increase the heap by using '-Xmx' command line flag, and then restart the database.)
</code></pre>
<blockquote>
<p>To solve this problem we try to <a href="https://stackoverflow.com/questions/36676748/neo4j-java-heap-space-error-after-query-exectuion-with-create-unique-statement"><strong>increase the heap size</strong></a> of the database, but we still get the same error. So after some research we create a function with help of the <strong><code>AI</code></strong> to *<strong>Batch Processing</strong>* the writing in the database.</p>
</blockquote>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Source: X. (2025). Grok 3 Beta — The Age of Reasoning Agents (Mar 07 version)[Large Language Model]. X.ai. https://x.ai/blog/grok-3</span>
<span class="c1">#         Mistral. (2025). Le Chat - Mistral AI (Mar 07 version)[Large Language Model]. Mistral.ai. https://chat.mistral.ai/</span>

<span class="k">def</span> <span class="nf">execute_batch_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">node_label</span><span class="p">,</span> <span class="n">operation_clause</span><span class="p">,</span> <span class="n">total_nodes</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100_000</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Processing batches"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Process write operations in batches for a given node label.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - driver: Neo4j driver instance.</span>
<span class="sd">    - node_label: String, the label of nodes to process (e.g., 'REVIEWS', 'BEERS').</span>
<span class="sd">    - operation_clause: String, the Cypher clause to execute on matched nodes (e.g., 'SET n.prop = value').</span>
<span class="sd">    - total_nodes: Integer, total number of nodes to process.</span>
<span class="sd">    - batch_size: Integer, number of nodes per batch (default: 100,000).</span>
<span class="sd">    - desc: String, description for tqdm progress bar (default: 'Processing batches').</span>

<span class="sd">    Returns:</span>
<span class="sd">    - None (prints progress and errors if any).</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_nodes</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Processing batch from offset </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">batch_size</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        
        <span class="c1"># Base query template with SKIP and LIMIT integREVIEWED correctly</span>
        <span class="n">batch_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">node_label</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            WITH n</span>
<span class="s2">            SKIP </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s2"> LIMIT </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span>
<span class="s2">            </span><span class="si">{</span><span class="n">operation_clause</span><span class="si">}</span>
<span class="s2">            RETURN COUNT(*)</span>
<span class="s2">        """</span>
        <span class="c1"># print(batch_query.strip())  # Show the query for debugging</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">batch_query</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error at offset </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Total node counts from your exploration (1.5)</span>
<span class="n">total_reviews</span> <span class="o">=</span> <span class="mi">2_549_252</span>
<span class="n">operation_clause</span> <span class="o">=</span> <span class="s2">"SET n.beer_id = toInteger(n.beer_id), n.id = toInteger(n.id)"</span>
<span class="n">execute_batch_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s2">"REVIEWS"</span><span class="p">,</span> <span class="n">operation_clause</span><span class="p">,</span> <span class="n">total_reviews</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Converting REVIEWS ids to integer"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:   0%|          | 0/26 [00:00&lt;?, ?it/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 0 to 100000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:   4%|▍         | 1/26 [00:10&lt;04:12, 10.10s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 100000 to 200000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:   8%|▊         | 2/26 [00:15&lt;02:49,  7.08s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 200000 to 300000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  12%|█▏        | 3/26 [00:29&lt;03:58, 10.36s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 300000 to 400000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  15%|█▌        | 4/26 [00:36&lt;03:16,  8.94s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 400000 to 500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  19%|█▉        | 5/26 [00:42&lt;02:51,  8.14s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 500000 to 600000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  23%|██▎       | 6/26 [00:59&lt;03:40, 11.04s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 600000 to 700000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  27%|██▋       | 7/26 [01:05&lt;03:01,  9.53s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 700000 to 800000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  31%|███       | 8/26 [01:12&lt;02:34,  8.56s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 800000 to 900000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  35%|███▍      | 9/26 [01:18&lt;02:14,  7.91s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 900000 to 1000000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  38%|███▊      | 10/26 [01:34&lt;02:46, 10.44s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1000000 to 1100000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  42%|████▏     | 11/26 [01:41&lt;02:20,  9.39s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1100000 to 1200000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  46%|████▌     | 12/26 [01:49&lt;02:01,  8.68s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1200000 to 1300000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  50%|█████     | 13/26 [01:56&lt;01:46,  8.19s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1300000 to 1400000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  54%|█████▍    | 14/26 [02:12&lt;02:07, 10.60s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1400000 to 1500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  58%|█████▊    | 15/26 [02:19&lt;01:45,  9.61s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1500000 to 1600000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  62%|██████▏   | 16/26 [02:26&lt;01:27,  8.71s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1600000 to 1700000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  65%|██████▌   | 17/26 [02:32&lt;01:11,  7.92s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1700000 to 1800000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  69%|██████▉   | 18/26 [02:47&lt;01:21, 10.23s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1800000 to 1900000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  73%|███████▎  | 19/26 [02:53&lt;01:02,  8.89s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1900000 to 2000000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  77%|███████▋  | 20/26 [03:00&lt;00:48,  8.15s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2000000 to 2100000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  81%|████████  | 21/26 [03:06&lt;00:37,  7.55s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2100000 to 2200000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  85%|████████▍ | 22/26 [03:20&lt;00:38,  9.69s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2200000 to 2300000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  88%|████████▊ | 23/26 [03:27&lt;00:26,  8.70s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2300000 to 2400000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  92%|█████████▏| 24/26 [03:33&lt;00:16,  8.00s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2400000 to 2500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer:  96%|█████████▌| 25/26 [03:40&lt;00:07,  7.56s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2500000 to 2600000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS ids to integer: 100%|██████████| 26/26 [03:52&lt;00:00,  8.96s/it]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BEERS)</span>
<span class="s2">    RETURN n.brewery_id, n.id</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BREWERIES)</span>
<span class="s2">    RETURN n.id</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:REVIEWS)</span>
<span class="s2">    RETURN n.beer_id, n.id</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record n.brewery_id=2199 n.id=202522&gt;,
 &lt;Record n.brewery_id=18604 n.id=82352&gt;,
 &lt;Record n.brewery_id=44306 n.id=214879&gt;,
 &lt;Record n.brewery_id=4378 n.id=320009&gt;,
 &lt;Record n.brewery_id=44617 n.id=246438&gt;]
[&lt;Record n.id=19730&gt;,
 &lt;Record n.id=32541&gt;,
 &lt;Record n.id=44736&gt;,
 &lt;Record n.id=23372&gt;,
 &lt;Record n.id=35328&gt;]
[&lt;Record n.beer_id=125646 n.id=1&gt;,
 &lt;Record n.beer_id=125646 n.id=2&gt;,
 &lt;Record n.beer_id=125646 n.id=3&gt;,
 &lt;Record n.beer_id=125646 n.id=4&gt;,
 &lt;Record n.beer_id=125646 n.id=6&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.1. Convert BEERS.abv, REVIEWS.look, REVIEWS.overall, REVIEWS.score, REVIEWS.smell, REVIEWS.taste to float</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BEERS)</span>
<span class="s2">    SET n.abv = toFloat(n.abv);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># query = """</span>
<span class="c1">#     MATCH (n:REVIEWS)</span>
<span class="c1">#     SET n.feel = toFloat(n.feel)</span>
<span class="c1">#     SET n.look = toFloat(n.look)</span>
<span class="c1">#     SET n.overall = toFloat(n.overall)</span>
<span class="c1">#     SET n.score = toFloat(n.score)</span>
<span class="c1">#     SET n.smell = toFloat(n.smell)</span>
<span class="c1">#     SET n.taste = toFloat(n.taste)</span>
<span class="c1"># """</span>
<span class="c1"># result = execute_write(driver, query)</span>
<span class="c1"># pprint(result)                                      # Original query failed due to Java heap space error</span>

<span class="c1"># Total node counts from your exploration (1.5)</span>
<span class="n">total_reviews</span> <span class="o">=</span> <span class="mi">2_549_252</span>

<span class="c1"># Convert REVIEWS properties to float in batches</span>
<span class="n">operation_clause</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    SET n.feel = toFloat(n.feel),</span>
<span class="s2">        n.look = toFloat(n.look), </span>
<span class="s2">        n.overall = toFloat(n.overall), </span>
<span class="s2">        n.score = toFloat(n.score), </span>
<span class="s2">        n.smell = toFloat(n.smell), </span>
<span class="s2">        n.taste = toFloat(n.taste)</span>
<span class="s2">"""</span>
<span class="n">execute_batch_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s2">"REVIEWS"</span><span class="p">,</span> <span class="n">operation_clause</span><span class="p">,</span> <span class="n">total_reviews</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">250_000</span><span class="p">,</span>  <span class="n">desc</span><span class="o">=</span><span class="s2">"Converting REVIEWS properties to float"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:   0%|          | 0/11 [00:00&lt;?, ?it/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 0 to 250000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:   9%|▉         | 1/11 [00:32&lt;05:22, 32.29s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 250000 to 500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  18%|█▊        | 2/11 [00:55&lt;04:00, 26.78s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 500000 to 750000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  27%|██▋       | 3/11 [01:25&lt;03:46, 28.29s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 750000 to 1000000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  36%|███▋      | 4/11 [01:44&lt;02:54, 24.89s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1000000 to 1250000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  45%|████▌     | 5/11 [02:14&lt;02:39, 26.59s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1250000 to 1500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  55%|█████▍    | 6/11 [02:48&lt;02:24, 28.93s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1500000 to 1750000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  64%|██████▎   | 7/11 [03:08&lt;01:44, 26.10s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1750000 to 2000000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  73%|███████▎  | 8/11 [03:39&lt;01:23, 27.86s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2000000 to 2250000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  82%|████████▏ | 9/11 [03:59&lt;00:50, 25.16s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2250000 to 2500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float:  91%|█████████ | 10/11 [04:31&lt;00:27, 27.27s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2500000 to 2750000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS properties to float: 100%|██████████| 11/11 [04:36&lt;00:00, 25.10s/it]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BEERS)</span>
<span class="s2">    RETURN n.abv</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:REVIEWS)</span>
<span class="s2">    RETURN n.look, n.overall, n.score, n.smell, n.taste</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record n.abv=7.3&gt;,
 &lt;Record n.abv=10.4&gt;,
 &lt;Record n.abv=4.0&gt;,
 &lt;Record n.abv=8.7&gt;,
 &lt;Record n.abv=5.1&gt;]
[&lt;Record n.look=4.5 n.overall=4.5 n.score=4.5 n.smell=4.5 n.taste=4.5&gt;,
 &lt;Record n.look=4.75 n.overall=4.75 n.score=4.75 n.smell=4.75 n.taste=4.75&gt;,
 &lt;Record n.look=4.75 n.overall=4.5 n.score=4.58 n.smell=4.75 n.taste=4.5&gt;,
 &lt;Record n.look=4.25 n.overall=4.25 n.score=4.31 n.smell=4.5 n.taste=4.25&gt;,
 &lt;Record n.look=4.75 n.overall=4.75 n.score=4.69 n.smell=4.5 n.taste=4.75&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.1. Convert REVIEWS.date to date format</span>
<span class="c1">#      Source: https://neo4j.com/developer/kb/neo4j-string-to-date/</span>

<span class="c1"># Confirm that the date format is in the correct format (YYYY-MM-DD)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:REVIEWS)</span>
<span class="s2">    WITH n.date AS date</span>
<span class="s2">    RETURN DISTINCT date</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record date='2017-12-21'&gt;,
 &lt;Record date='2017-12-20'&gt;,
 &lt;Record date='2017-12-19'&gt;,
 &lt;Record date='2017-12-10'&gt;,
 &lt;Record date='2017-12-09'&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Total node counts from your exploration (1.5)</span>
<span class="n">total_reviews</span> <span class="o">=</span> <span class="mi">2_549_252</span>

<span class="c1"># Convert REVIEWS.date to date format in batches</span>
<span class="n">operation_clause</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    SET n.date = date(n.date)</span>
<span class="s2">"""</span>
<span class="n">execute_batch_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s2">"REVIEWS"</span><span class="p">,</span> <span class="n">operation_clause</span><span class="p">,</span> <span class="n">total_reviews</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">250_000</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Converting REVIEWS date to date format"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:   0%|          | 0/11 [00:00&lt;?, ?it/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 0 to 250000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:   9%|▉         | 1/11 [00:09&lt;01:33,  9.31s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 250000 to 500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  18%|█▊        | 2/11 [00:15&lt;01:04,  7.22s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 500000 to 750000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  27%|██▋       | 3/11 [00:23&lt;01:00,  7.56s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 750000 to 1000000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  36%|███▋      | 4/11 [00:29&lt;00:50,  7.22s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1000000 to 1250000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  45%|████▌     | 5/11 [00:35&lt;00:39,  6.63s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1250000 to 1500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  55%|█████▍    | 6/11 [00:41&lt;00:32,  6.48s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1500000 to 1750000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  64%|██████▎   | 7/11 [00:58&lt;00:39,  9.90s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 1750000 to 2000000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  73%|███████▎  | 8/11 [01:04&lt;00:25,  8.65s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2000000 to 2250000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  82%|████████▏ | 9/11 [01:12&lt;00:16,  8.41s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2250000 to 2500000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format:  91%|█████████ | 10/11 [01:20&lt;00:08,  8.49s/it]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Processing batch from offset 2500000 to 2750000
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Converting REVIEWS date to date format: 100%|██████████| 11/11 [01:22&lt;00:00,  7.54s/it]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [60]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:REVIEWS)</span>
<span class="s2">    RETURN n.date</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record n.date=neo4j.time.Date(2017, 12, 21)&gt;,
 &lt;Record n.date=neo4j.time.Date(2017, 12, 21)&gt;,
 &lt;Record n.date=neo4j.time.Date(2017, 12, 20)&gt;,
 &lt;Record n.date=neo4j.time.Date(2017, 12, 20)&gt;,
 &lt;Record n.date=neo4j.time.Date(2017, 12, 19)&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [61]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Convert BEERS.retired to boolean format</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:BEERS)</span>
<span class="s2">    SET r.retired = CASE </span>
<span class="s2">            WHEN toLower(trim(r.retired)) = 't' THEN true </span>
<span class="s2">            WHEN toLower(trim(r.retired)) = 'f' THEN false </span>
<span class="s2">            ELSE r.retired</span>
<span class="s2">        END </span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n:BEERS)</span>
<span class="s2">    RETURN n.retired</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record n.retired=False&gt;,
 &lt;Record n.retired=False&gt;,
 &lt;Record n.retired=True&gt;,
 &lt;Record n.retired=False&gt;,
 &lt;Record n.retired=False&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [63]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Re-run the statistics query (1.7 &amp; 1.12) to get the updated schema after the data type conversions</span>

<span class="c1"># Get all properties for each node label</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.schema.nodeTypeProperties() </span>
<span class="s2">    YIELD nodeType, propertyName, propertyTypes, mandatory </span>
<span class="s2">    WITH nodeType, propertyName, propertyTypes, mandatory </span>
<span class="s2">    ORDER BY nodeType, propertyName </span>
<span class="s2">    RETURN nodeType, propertyName, propertyTypes, mandatory</span>
<span class="s2">"""</span>
<span class="n">properties_result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Properties and types for each node label:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">properties_result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node Label: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'nodeType'</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | Property: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'propertyName'</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | Type(s): </span><span class="si">{</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">'propertyTypes'</span><span class="p">])</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | Mandatory: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'mandatory'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Properties and types for each node label:
Node Label: :`BEERS`        | Property: abv             | Type(s): Double               | Mandatory: False
Node Label: :`BEERS`        | Property: availability    | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: brewery_id      | Type(s): Long                 | Mandatory: True
Node Label: :`BEERS`        | Property: id              | Type(s): Long                 | Mandatory: True
Node Label: :`BEERS`        | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: notes           | Type(s): String               | Mandatory: True
Node Label: :`BEERS`        | Property: retired         | Type(s): Boolean              | Mandatory: True
Node Label: :`BEERS`        | Property: state           | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: id              | Type(s): Long                 | Mandatory: True
Node Label: :`BREWERIES`    | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: notes           | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: state           | Type(s): String               | Mandatory: True
Node Label: :`BREWERIES`    | Property: types           | Type(s): String               | Mandatory: True
Node Label: :`CITIES`       | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`COUNTRIES`    | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`REVIEWS`      | Property: beer_id         | Type(s): Long                 | Mandatory: True
Node Label: :`REVIEWS`      | Property: date            | Type(s): Date                 | Mandatory: True
Node Label: :`REVIEWS`      | Property: feel            | Type(s): Double               | Mandatory: False
Node Label: :`REVIEWS`      | Property: id              | Type(s): Long                 | Mandatory: True
Node Label: :`REVIEWS`      | Property: look            | Type(s): Double               | Mandatory: False
Node Label: :`REVIEWS`      | Property: overall         | Type(s): Double               | Mandatory: False
Node Label: :`REVIEWS`      | Property: score           | Type(s): Double               | Mandatory: True
Node Label: :`REVIEWS`      | Property: smell           | Type(s): Double               | Mandatory: False
Node Label: :`REVIEWS`      | Property: taste           | Type(s): Double               | Mandatory: False
Node Label: :`REVIEWS`      | Property: text            | Type(s): String               | Mandatory: True
Node Label: :`STYLE`        | Property: name            | Type(s): String               | Mandatory: True
Node Label: :`USER`         | Property: name            | Type(s): String               | Mandatory: True
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>After converting the properties to the correct data types, we can see that the *<strong>Mandatory Properties</strong>* are different from the previous query. This means that we have missing values in the properties that we converted. We will have to check the missing values for other properties.<ul>
<li>Besides that, when we have missing values or mismatched data types, it implies that the property is <strong>not mandatory</strong>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [64]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">Summary statistics of each property for each node label in the database:"</span><span class="p">)</span>

<span class="c1"># Initialize a list to store statistics</span>
<span class="n">stats_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate over each property and calculate statistics</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">properties_result</span><span class="p">):</span>
    <span class="n">nodeType</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">'nodeType'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'`'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">':'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>  <span class="c1"># Remove backticks and ':'</span>
    <span class="n">propertyName</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">'propertyName'</span><span class="p">]</span>
    
    <span class="c1"># Construct query for each property</span>
    <span class="k">if</span> <span class="n">propertyName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'notes'</span><span class="p">,</span> <span class="s1">'state'</span><span class="p">,</span> <span class="s1">'availability'</span><span class="p">,</span> <span class="s1">'types'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">]:</span>
        <span class="c1"># String properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS count,</span>
<span class="s2">                COUNT(DISTINCT n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS distinctCount,</span>
<span class="s2">                '-' AS mean,</span>
<span class="s2">                '-' AS min,</span>
<span class="s2">                '-' AS max,</span>
<span class="s2">                COUNT(CASE WHEN n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NULL OR n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> = '' OR toLower(trim(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">)) IN ['nan', 'null', 'none', ' '] THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    <span class="k">elif</span> <span class="n">propertyName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'retired'</span><span class="p">,</span> <span class="s1">'date'</span><span class="p">]:</span>
        <span class="c1"># Boolean &amp; Date properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS count,</span>
<span class="s2">                COUNT(DISTINCT n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS distinctCount,</span>
<span class="s2">                '-' AS mean,</span>
<span class="s2">                '-' AS min,</span>
<span class="s2">                '-' AS max,</span>
<span class="s2">                COUNT(CASE WHEN n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NULL THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Numeric properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            WITH n, n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> AS value</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(value) AS count,</span>
<span class="s2">                COUNT(DISTINCT value) AS distinctCount,</span>
<span class="s2">                AVG(value) AS mean,</span>
<span class="s2">                MIN(value) AS min,</span>
<span class="s2">                MAX(value) AS max,</span>
<span class="s2">                COUNT(CASE WHEN value IS NULL THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">stats_result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">stats_query</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stats_result</span><span class="p">:</span>
            <span class="n">stats_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error processing </span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">stats_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Node'</span><span class="p">,</span> <span class="s1">'Property'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">,</span> <span class="s1">'Distinct Count'</span><span class="p">,</span> 
                                       <span class="s1">'Mean'</span><span class="p">,</span> <span class="s1">'Min'</span><span class="p">,</span> <span class="s1">'Max'</span><span class="p">,</span> <span class="s1">'Missing Count'</span><span class="p">])</span>                          <span class="c1"># Convert the list to a DataFrame</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'Missing Count (%)'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Missing Count'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>                                     <span class="c1"># Calculate the percentage of missing values</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">'Node'</span><span class="p">,</span> <span class="s1">'Property'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                                        <span class="c1"># Set the index to Node and Property (Hierarchical Indexing)</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                                                            <span class="c1"># Fill NaN values with 0</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'</span><span class="si">{:,.0f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span>
              <span class="s1">'</span><span class="si">{:,.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span>
              <span class="n">x</span>
<span class="p">)</span>                                                                                                                     <span class="c1"># Format the DataFrame for better visualization</span>
<span class="n">df</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

Summary statistics of each property for each node label in the database:
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>100%|██████████| 27/27 [08:25&lt;00:00, 18.71s/it]
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[64]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Count</th>
<th>Distinct Count</th>
<th>Mean</th>
<th>Min</th>
<th>Max</th>
<th>Missing Count</th>
<th>Missing Count (%)</th>
</tr>
<tr>
<th>Node</th>
<th>Property</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="8" valign="top">BEERS</th>
<th>abv</th>
<td>372718</td>
<td>939</td>
<td>6.53</td>
<td>0.01</td>
<td>100</td>
<td>45028</td>
<td>12.08</td>
</tr>
<tr>
<th>availability</th>
<td>417746</td>
<td>20</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>brewery_id</th>
<td>417746</td>
<td>16569</td>
<td>24 592.84</td>
<td>1</td>
<td>54144</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>id</th>
<td>417746</td>
<td>358873</td>
<td>189 196.88</td>
<td>3</td>
<td>374406</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>name</th>
<td>417746</td>
<td>298567</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>notes</th>
<td>417746</td>
<td>48313</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>55</td>
<td>0.01</td>
</tr>
<tr>
<th>retired</th>
<td>417746</td>
<td>2</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>state</th>
<td>417746</td>
<td>68</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>70831</td>
<td>16.96</td>
</tr>
<tr>
<th rowspan="5" valign="top">BREWERIES</th>
<th>id</th>
<td>100694</td>
<td>50347</td>
<td>27 870.51</td>
<td>1</td>
<td>54156</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>name</th>
<td>100694</td>
<td>45245</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>notes</th>
<td>100694</td>
<td>3271</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>170</td>
<td>0.17</td>
</tr>
<tr>
<th>state</th>
<td>100694</td>
<td>68</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>22542</td>
<td>22.39</td>
</tr>
<tr>
<th>types</th>
<td>100694</td>
<td>30</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>CITIES</th>
<th>name</th>
<td>23330</td>
<td>11665</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>2</td>
<td>0.01</td>
</tr>
<tr>
<th>COUNTRIES</th>
<th>name</th>
<td>400</td>
<td>200</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>2</td>
<td>0.50</td>
</tr>
<tr>
<th rowspan="10" valign="top">REVIEWS</th>
<th>beer_id</th>
<td>2549252</td>
<td>189645</td>
<td>77 459.01</td>
<td>3</td>
<td>373128</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>date</th>
<td>2549252</td>
<td>6379</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>feel</th>
<td>1484819</td>
<td>17</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>1064452</td>
<td>71.69</td>
</tr>
<tr>
<th>id</th>
<td>2549252</td>
<td>2546141</td>
<td>4 517 442.86</td>
<td>1</td>
<td>9073127</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>look</th>
<td>1484819</td>
<td>17</td>
<td>3.95</td>
<td>1</td>
<td>5</td>
<td>1064452</td>
<td>71.69</td>
</tr>
<tr>
<th>overall</th>
<td>1484819</td>
<td>17</td>
<td>3.92</td>
<td>1</td>
<td>5</td>
<td>1064452</td>
<td>71.69</td>
</tr>
<tr>
<th>score</th>
<td>2549252</td>
<td>401</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>smell</th>
<td>1484819</td>
<td>17</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>1064452</td>
<td>71.69</td>
</tr>
<tr>
<th>taste</th>
<td>1484819</td>
<td>17</td>
<td>3.92</td>
<td>1</td>
<td>5</td>
<td>1064452</td>
<td>71.69</td>
</tr>
<tr>
<th>text</th>
<td>2549252</td>
<td>814333</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>STYLE</th>
<th>name</th>
<td>113</td>
<td>113</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.88</td>
</tr>
<tr>
<th>USER</th>
<th>name</th>
<td>123935</td>
<td>123935</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="2.2.-%F0%9F%94%84%EF%B8%8F-Find-Duplicate-Nodes"><strong>2.2. 🔄️ Find Duplicate Nodes</strong><a class="anchor-link" href="#2.2.-%F0%9F%94%84%EF%B8%8F-Find-Duplicate-Nodes">¶</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>For each <strong>node label</strong>, we will find the <strong>duplicates</strong> based on the <strong><code>id</code></strong> property (or <strong><code>name</code></strong> for the ones that don't have an <strong><code>id</code></strong> property). We will then check if both duplicates have the same relationships. The summary of this analysis is presented in the last cell of this section.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [65]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2. Find duplicate nodes if any (BEERS)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find duplicate BEERS nodes</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, count(b) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN beerId, count</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate BEERS nodes</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, count(b) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(beerId) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record beerId=214879 count=2&gt;,
 &lt;Record beerId=8036 count=2&gt;,
 &lt;Record beerId=265827 count=2&gt;,
 &lt;Record beerId=110318 count=2&gt;,
 &lt;Record beerId=138971 count=2&gt;,
 &lt;Record beerId=199068 count=2&gt;,
 &lt;Record beerId=80010 count=2&gt;,
 &lt;Record beerId=55175 count=2&gt;,
 &lt;Record beerId=55 count=2&gt;,
 &lt;Record beerId=354484 count=2&gt;]
[&lt;Record totalDuplicates=58873&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In total we have $58\;873$ duplicate <strong><code>BEERS</code></strong> ($\frac{58\;873}{417\;746} \approx 14.1\%$)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [66]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify if the duplicate nodes have same relationships</span>
<span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/clauses/optional-match/</span>
<span class="c1">#         https://neo4j.com/docs/cypher-manual/current/clauses/unwind/</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, count(b) AS count, collect(b) AS nodes</span>
<span class="s2">    // Consider only the duplicate nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH beerId, nodes</span>
<span class="s2">    // Unwind the nodes (transform a list into individual rows) </span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH beerId, node1, node2</span>
<span class="s2">    // Compare the nodes</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH beerId, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    RETURN beerId, id(node1) AS id1, id(node2) AS id2, rels1, rels2</span>
<span class="s2">    LIMIT 2</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, count(b) AS count, collect(b) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH beerId, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH beerId, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH beerId, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    // Count how many cases</span>
<span class="s2">    RETURN count(beerId) AS totalCases</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record beerId=214879 id1=62214 id2=9721475 rels1=[&lt;Relationship element_id='9494215' nodes=(&lt;Node element_id='62214' labels=frozenset() properties={}&gt;, &lt;Node element_id='9494215' labels=frozenset() properties={}&gt;) type='HAS_STYLE' properties={}&gt;, &lt;Relationship element_id='9072917' nodes=(&lt;Node element_id='13515' labels=frozenset() properties={}&gt;, &lt;Node element_id='62214' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;] rels2=[]&gt;,
 &lt;Record beerId=214879 id1=9721475 id2=62214 rels1=[] rels2=[&lt;Relationship element_id='9494215' nodes=(&lt;Node element_id='62214' labels=frozenset() properties={}&gt;, &lt;Node element_id='9494215' labels=frozenset() properties={}&gt;) type='HAS_STYLE' properties={}&gt;, &lt;Relationship element_id='9072917' nodes=(&lt;Node element_id='13515' labels=frozenset() properties={}&gt;, &lt;Node element_id='62214' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;]&gt;]
[&lt;Record totalCases=117746&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Here we try to see if the duplicate <strong><code>Beer.ID</code></strong> instances have duplicated relationships.</p>
<ul>
<li><p>Let's focus on the first case to better understand the situation. We have two nodes with <code>beerId=214879 (id1=62214 and id2=9721475)</code>. One of these nodes has two relationships (<strong><code>HAS_STYLE</code></strong> and <strong><code>BREWED</code></strong>), while the other has none, indicating a data inconsistency.</p>
</li>
<li><p>Similar to this example, there are more cases. Specifically, there are $58\;873$ instances where <strong><code>BEER.id</code></strong> is duplicated, and in all these cases, the duplicate nodes have different relationships.</p>
</li>
</ul>
<p><strong>Note:</strong> In this code we do not consider relationship properties since they do not exist.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [67]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2 Find duplicate nodes if any (BREWERIES)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find duplicate BREWERIES nodes</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH b.id AS breweryId, b.name AS breweryName, count(b) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN breweryId, breweryName, count</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate BREWERIES nodes</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH b.id AS breweryId, count(b) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(breweryId) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record breweryId=19730 breweryName='Brouwerij Danny' count=2&gt;,
 &lt;Record breweryId=32541 breweryName='Coachella Valley Brewing Co' count=2&gt;,
 &lt;Record breweryId=44736 breweryName="Beef 'O' Brady's" count=2&gt;,
 &lt;Record breweryId=23372 breweryName='Broadway Wine Merchant' count=2&gt;,
 &lt;Record breweryId=35328 breweryName='Brighton Beer Dispensary (DUPLICATE)' count=2&gt;,
 &lt;Record breweryId=31561 breweryName="Teddy's Tavern" count=2&gt;,
 &lt;Record breweryId=35975 breweryName='Modus Operandi Brewing Co.' count=2&gt;,
 &lt;Record breweryId=5618 breweryName='Hops! Beer Restaurant &amp; Pizza' count=2&gt;,
 &lt;Record breweryId=30916 breweryName="Kelly's Cellars" count=2&gt;,
 &lt;Record breweryId=41278 breweryName='The Other End' count=2&gt;]
[&lt;Record totalDuplicates=50347&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In total we have $50\; 347$ duplicate <strong><code>BREWERIES</code></strong> ($\frac{50\;347}{100\;694} \approx 50\%$)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify if the duplicate nodes have same relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH b.id AS breweryId, count(b) AS count, collect(b) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH breweryId, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH breweryId, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH breweryId, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    RETURN breweryId, id(node1) AS id1, id(node2) AS id2, rels1, rels2</span>
<span class="s2">    LIMIT 2</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH b.id AS breweryId, count(b) AS count, collect(b) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH breweryId, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH breweryId, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH breweryId, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    // Count how many cases</span>
<span class="s2">    RETURN count(breweryId) AS totalCases</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record breweryId=19730 id1=11865 id2=9671126 rels1=[&lt;Relationship element_id='9431789' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='200' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='9254060' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='243356' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;, &lt;Relationship element_id='9165745' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='155042' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;, &lt;Relationship element_id='9108729' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='98026' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;] rels2=[]&gt;,
 &lt;Record breweryId=19730 id1=9671126 id2=11865 rels1=[] rels2=[&lt;Relationship element_id='9431789' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='200' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='9254060' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='243356' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;, &lt;Relationship element_id='9165745' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='155042' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;, &lt;Relationship element_id='9108729' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='98026' labels=frozenset() properties={}&gt;) type='BREWED' properties={}&gt;]&gt;]
[&lt;Record totalCases=100694&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [69]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2. Find duplicate nodes if any (COUNTRIES)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find duplicate COUNTRIES nodes</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WITH c.name AS countryName, count(c) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN countryName, count</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate COUNTRIES nodes</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WITH c.name AS countryName, count(c) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(countryName) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record countryName='BE' count=2&gt;,
 &lt;Record countryName='US' count=2&gt;,
 &lt;Record countryName='GB' count=2&gt;,
 &lt;Record countryName='AU' count=2&gt;,
 &lt;Record countryName='IT' count=2&gt;,
 &lt;Record countryName='CA' count=2&gt;,
 &lt;Record countryName='GR' count=2&gt;,
 &lt;Record countryName='FR' count=2&gt;,
 &lt;Record countryName='AT' count=2&gt;,
 &lt;Record countryName='ES' count=2&gt;]
[&lt;Record totalDuplicates=200&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In total we have $200$ duplicate <strong><code>COUNTRIES</code></strong> ($\frac{200}{400} = 50\%$)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [70]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Additional checking: Making sure if the ISO codes are real/valid</span>
<span class="c1"># Source: https://www.iban.com/country-codes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        MATCH (c:COUNTRIES)</span>
<span class="s2">        WHERE NOT c.code IN ['AD', 'AE', 'AF', 'AG', 'AI', 'AL', 'AM', 'AO', 'AQ', 'AR', 'AS', 'AT', 'AU', 'AW', </span>
<span class="s2">            'AX', 'AZ', 'BA', 'BB', 'BD', 'BE', 'BF', 'BG', 'BH', 'BI', 'BJ', 'BL', 'BM', 'BN', 'BO', 'BQ', 'BR', </span>
<span class="s2">            'BS', 'BT', 'BV', 'BW', 'BY', 'BZ', 'CA', 'CC', 'CD', 'CF', 'CG', 'CH', 'CI', 'CK', 'CL', 'CM', 'CN', </span>
<span class="s2">            'CO', 'CR', 'CU', 'CV', 'CW', 'CX', 'CY', 'CZ', 'DE', 'DJ', 'DK', 'DM', 'DO', 'DZ', 'EC', 'EE', 'EG', </span>
<span class="s2">            'EH', 'ER', 'ES', 'ET', 'FI', 'FJ', 'FK', 'FM', 'FO', 'FR', 'GA', 'GB', 'GD', 'GE', 'GF', 'GG', 'GH', </span>
<span class="s2">            'GI', 'GL', 'GM', 'GN', 'GP', 'GQ', 'GR', 'GS', 'GT', 'GU', 'GW', 'GY', 'HK', 'HM', 'HN', 'HR', 'HT', </span>
<span class="s2">            'HU', 'ID', 'IE', 'IL', 'IM', 'IN', 'IO', 'IQ', 'IR', 'IS', 'IT', 'JE', 'JM', 'JO', 'JP', 'KE', 'KG', </span>
<span class="s2">            'KH', 'KI', 'KM', 'KN', 'KP', 'KR', 'KW', 'KY', 'KZ', 'LA', 'LB', 'LC', 'LI', 'LK', 'LR', 'LS', 'LT', </span>
<span class="s2">            'LU', 'LV', 'LY', 'MA', 'MC', 'MD', 'ME', 'MF', 'MG', 'MH', 'MK', 'ML', 'MM', 'MN', 'MO', 'MP', 'MQ', </span>
<span class="s2">            'MR', 'MS', 'MT', 'MU', 'MV', 'MW', 'MX', 'MY', 'MZ', 'NA', 'NC', 'NE', 'NF', 'NG', 'NI', 'NL', 'NO', </span>
<span class="s2">            'NP', 'NR', 'NU', 'NZ', 'OM', 'PA', 'PE', 'PF', 'PG', 'PH', 'PK', 'PL', 'PM', 'PN', 'PR', 'PS', 'PT', </span>
<span class="s2">            'PW', 'PY', 'QA', 'RE', 'RO', 'RS', 'RU', 'RW', 'SA', 'SB', 'SC', 'SD', 'SE', 'SG', 'SH', 'SI', 'SJ', </span>
<span class="s2">            'SK', 'SL', 'SM', 'SN', 'SO', 'SR', 'SS', 'ST', 'SV', 'SX', 'SY', 'SZ', 'TC', 'TD', 'TF', 'TG', 'TH', </span>
<span class="s2">            'TJ', 'TK', 'TL', 'TM', 'TN', 'TO', 'TR', 'TT', 'TV', 'TW', 'TZ', 'UA', 'UG', 'UM', 'US', 'UY', 'UZ', </span>
<span class="s2">            'VA', 'VC', 'VE', 'VG', 'VI', 'VN', 'VU', 'WF', 'WS', 'YE', 'YT', 'ZA', 'ZM', 'ZW']</span>
<span class="s2">        RETURN c.name</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>The format used for the country's name is based on the <a href="https://www.iban.com/country-codes" target="_blank">Alpha-2 nomenclature</a>.</li>
<li>With the previous query we can see that all <strong><code>COUNTRIE.name</code> are valid codes</strong>.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [71]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># # Verify if the duplicate nodes have same relationships</span>
<span class="c1"># query = """</span>
<span class="c1">#     // Verify if the duplicate nodes have the same relationships</span>
<span class="c1">#     MATCH (c:COUNTRIES)</span>
<span class="c1">#     WITH c.name AS countryName, count(c) AS count, collect(c) AS nodes</span>
<span class="c1">#     WHERE count &gt; 1</span>
<span class="c1">#     WITH countryName, nodes</span>
<span class="c1">#     UNWIND nodes AS node1</span>
<span class="c1">#     UNWIND nodes AS node2</span>
<span class="c1">#     WITH countryName, node1, node2</span>
<span class="c1">#     WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="c1">#     // Collect relationships for each node</span>
<span class="c1">#     OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="c1">#     OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="c1">#     WITH countryName, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="c1">#     // Compare relationships</span>
<span class="c1">#     WHERE rels1 &lt;&gt; rels2</span>
<span class="c1">#     RETURN countryName, id(node1) AS id1, id(node2) AS id2, rels1, rels2</span>
<span class="c1">#     LIMIT 1</span>
<span class="c1"># """</span>
<span class="c1"># result = execute_read(driver, query)</span>
<span class="c1"># pprint(result)                                                                        # Large Output</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WITH c.name AS countryName, count(c) AS count, collect(c) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH countryName, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH countryName, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH countryName, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    // Count how many cases</span>
<span class="s2">    RETURN count(countryName) AS totalCases</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalCases=400&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [72]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2. Find duplicate nodes if any (CITIES)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find duplicate CITIES nodes</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH c.name AS cityName, count(c) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN cityName, count</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate CITIES nodes</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH c.name AS cityName, count(c) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(cityName) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record cityName='Erpe-Mere' count=2&gt;,
 &lt;Record cityName='Thousand Palms' count=2&gt;,
 &lt;Record cityName='Plant City' count=2&gt;,
 &lt;Record cityName='Oklahoma City' count=2&gt;,
 &lt;Record cityName='Brighton' count=2&gt;,
 &lt;Record cityName='Seattle' count=2&gt;,
 &lt;Record cityName='Mona Vale' count=2&gt;,
 &lt;Record cityName='Riccione (RN)' count=2&gt;,
 &lt;Record cityName='Belfast' count=2&gt;,
 &lt;Record cityName='Destin' count=2&gt;]
[&lt;Record totalDuplicates=11665&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In total we have $11\; 665$ duplicate <strong><code>CITIES</code></strong> ($\frac{11\;665}{23\;330} = 50\%$)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [73]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify if the duplicate nodes have same relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH c.name AS cityName, count(c) AS count, collect(c) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH cityName, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH cityName, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH cityName, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    RETURN cityName, id(node1) AS id1, id(node2) AS id2, rels1, rels2</span>
<span class="s2">    LIMIT 2</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH c.name AS cityName, count(c) AS count, collect(c) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH cityName, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH cityName, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH cityName, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    // Count how many cases</span>
<span class="s2">    RETURN count(cityName) AS totalCases</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record cityName='Erpe-Mere' id1=200 id2=9659461 rels1=[&lt;Relationship element_id='9482136' nodes=(&lt;Node element_id='200' labels=frozenset() properties={}&gt;, &lt;Node element_id='0' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='9458134' nodes=(&lt;Node element_id='38210' labels=frozenset() properties={}&gt;, &lt;Node element_id='200' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='9431789' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='200' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;] rels2=[]&gt;,
 &lt;Record cityName='Erpe-Mere' id1=9659461 id2=200 rels1=[] rels2=[&lt;Relationship element_id='9482136' nodes=(&lt;Node element_id='200' labels=frozenset() properties={}&gt;, &lt;Node element_id='0' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='9458134' nodes=(&lt;Node element_id='38210' labels=frozenset() properties={}&gt;, &lt;Node element_id='200' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='9431789' nodes=(&lt;Node element_id='11865' labels=frozenset() properties={}&gt;, &lt;Node element_id='200' labels=frozenset() properties={}&gt;) type='IN' properties={}&gt;]&gt;]
[&lt;Record totalCases=23330&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [74]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2. Find duplicate nodes if any (STYLES &amp; USERS)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate STYLES nodes</span>
<span class="s2">    MATCH (s:STYLES)</span>
<span class="s2">    WITH s.name AS styleName, count(s) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(styleName) AS totalDuplicatesStyles</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate USER nodes</span>
<span class="s2">    MATCH (u:USER)</span>
<span class="s2">    WITH u.name AS userName, count(u) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(userName) AS totalDuplicatesUsers</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalDuplicatesStyles=0&gt;]
[&lt;Record totalDuplicatesUsers=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>As we already saw in the *<strong>Statistical Analysis of the Database</strong><em>, we don't have any duplicate </em><em><code>STYLE</code></em>* and <strong><code>USER</code></strong> nodes.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [75]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2. Find duplicate nodes if any (REVIEWS)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find duplicate REVIEWS nodes</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH r.id AS reviewId, count(r) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN reviewId, count</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Find the total number of duplicate REVIEWS nodes</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH r.id AS reviewId, count(r) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(reviewId) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record reviewId=6 count=2&gt;,
 &lt;Record reviewId=12 count=2&gt;,
 &lt;Record reviewId=28 count=2&gt;,
 &lt;Record reviewId=32 count=2&gt;,
 &lt;Record reviewId=45 count=2&gt;,
 &lt;Record reviewId=60 count=2&gt;,
 &lt;Record reviewId=86 count=2&gt;,
 &lt;Record reviewId=90 count=2&gt;,
 &lt;Record reviewId=92 count=2&gt;,
 &lt;Record reviewId=107 count=2&gt;]
[&lt;Record totalDuplicates=3111&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In total we have $3\; 111$ duplicate <strong><code>REVIEWS</code></strong> ($\frac{3\;111}{2\;549\;252} \approx 0.1\%$)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [76]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify if the duplicate nodes have same relationships (REVIEWS)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH r.id AS reviewId, count(r) AS count, collect(r) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH reviewId, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH reviewId, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH reviewId, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    RETURN reviewId, id(node1) AS id1, id(node2) AS id2, rels1, rels2</span>
<span class="s2">    LIMIT 2</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Verify if the duplicate nodes have the same relationships</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH r.id AS reviewId, count(r) AS count, collect(r) AS nodes</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    WITH reviewId, nodes</span>
<span class="s2">    UNWIND nodes AS node1</span>
<span class="s2">    UNWIND nodes AS node2</span>
<span class="s2">    WITH reviewId, node1, node2</span>
<span class="s2">    WHERE id(node1) &lt;&gt; id(node2)</span>
<span class="s2">    // Collect relationships for each node</span>
<span class="s2">    OPTIONAL MATCH (node1)-[r1]-()</span>
<span class="s2">    OPTIONAL MATCH (node2)-[r2]-()</span>
<span class="s2">    WITH reviewId, node1, node2, collect(r1) AS rels1, collect(r2) AS rels2</span>
<span class="s2">    // Compare relationships</span>
<span class="s2">    WHERE rels1 &lt;&gt; rels2</span>
<span class="s2">    // Count how many cases</span>
<span class="s2">    RETURN count(reviewId) AS totalCases</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record reviewId=6 id1=421091 id2=10080352 rels1=[&lt;Relationship element_id='9853094' nodes=(&lt;Node element_id='421091' labels=frozenset() properties={}&gt;, &lt;Node element_id='9494332' labels=frozenset() properties={}&gt;) type='POSTED' properties={}&gt;, &lt;Relationship element_id='14' nodes=(&lt;Node element_id='384103' labels=frozenset() properties={}&gt;, &lt;Node element_id='421091' labels=frozenset() properties={}&gt;) type='REVIEWED' properties={}&gt;] rels2=[]&gt;,
 &lt;Record reviewId=6 id1=10080352 id2=421091 rels1=[] rels2=[&lt;Relationship element_id='9853094' nodes=(&lt;Node element_id='421091' labels=frozenset() properties={}&gt;, &lt;Node element_id='9494332' labels=frozenset() properties={}&gt;) type='POSTED' properties={}&gt;, &lt;Relationship element_id='14' nodes=(&lt;Node element_id='384103' labels=frozenset() properties={}&gt;, &lt;Node element_id='421091' labels=frozenset() properties={}&gt;) type='REVIEWED' properties={}&gt;]&gt;]
[&lt;Record totalCases=6222&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Summary-Table-of-Duplicate-Nodes"><strong>Summary Table of Duplicate Nodes</strong><a class="anchor-link" href="#Summary-Table-of-Duplicate-Nodes">¶</a></h5><center>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Nodes</strong></th>
<th style="text-align:center"><strong>Total</strong></th>
<th style="text-align:center"><strong>Duplicates</strong></th>
<th style="text-align:center"><strong>Percentage</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong><code>BEERS</code></strong></td>
<td style="text-align:center">417,746</td>
<td style="text-align:center">58,873</td>
<td style="text-align:center">14.1%</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>BREWERIES</code></strong></td>
<td style="text-align:center">100,694</td>
<td style="text-align:center">50,347</td>
<td style="text-align:center">50.0%</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>COUNTRIES</code></strong></td>
<td style="text-align:center">400</td>
<td style="text-align:center">200</td>
<td style="text-align:center">50.0%</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>CITIES</code></strong></td>
<td style="text-align:center">23,330</td>
<td style="text-align:center">11,665</td>
<td style="text-align:center">50.0%</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>STYLE</code></strong></td>
<td style="text-align:center">113</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.0%</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>USER</code></strong></td>
<td style="text-align:center">123,935</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.0%</td>
</tr>
<tr>
<td style="text-align:center"><strong><code>REVIEWS</code></strong></td>
<td style="text-align:center">2,549,252</td>
<td style="text-align:center">3,111</td>
<td style="text-align:center">0.1%</td>
</tr>
</tbody>
</table>
</center>
<ul>
<li><strong><code>BREWERIES</code></strong>, <strong><code>COUNTRIES</code></strong>, and <strong><code>CITIES</code></strong> show a $50\%$ duplication rate, suggesting potential redundancy in location-based data.</li>
<li><strong><code>BEERS</code></strong> show a $14.1\%$ duplication rate and <strong><code>REVIEWS</code></strong> has $0.1\%$ duplicates, likely due to duplicate records in user-generated content.</li>
<li><strong><code>STYLE</code></strong> and <strong><code>USER</code></strong> are the only labels without duplicates nodes.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="2.2.1.-%F0%9F%97%91%EF%B8%8F-Remove-Duplicate-Nodes"><strong>2.2.1. 🗑️ Remove Duplicate Nodes</strong><a class="anchor-link" href="#2.2.1.-%F0%9F%97%91%EF%B8%8F-Remove-Duplicate-Nodes">¶</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="1st-Case-of-Duplicate-Nodes-(One-Node-with-Relationships-and-the-Other-Without)"><strong>1st Case of Duplicate Nodes</strong> (One Node with Relationships and the Other Without)<a class="anchor-link" href="#1st-Case-of-Duplicate-Nodes-(One-Node-with-Relationships-and-the-Other-Without)">¶</a></h5><blockquote>
<p>After identifying the duplicate nodes, we <strong>collects the relationships</strong> for the node to <strong>keep</strong> and checks if the duplicate nodes have any relationships. <strong>Nodes with no relationships are deleted.</strong></p>
</blockquote>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [77]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Test the code </span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""MATCH (b:BEERS) WITH b.id AS beerId, count(b) AS count WHERE count &gt; 1 RETURN beerId, count LIMIT 1"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>                           <span class="c1"># beerId=214879</span>

<span class="c1"># Compare relationships of the duplicate node beerId=214879 as we did before</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WHERE b.id = 214879</span>
<span class="s2">    OPTIONAL MATCH (b)-[r1]-()</span>
<span class="s2">    RETURN b, collect(r1) AS rels</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>                           <span class="c1"># Node element_id='9721475' dont have relationships</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record beerId=214879 count=2&gt;]
[&lt;Record b=&lt;Node element_id='62214' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': 4.0, 'name': 'Scottish Right', 'retired': True, 'state': 'IN', 'id': 214879, 'brewery_id': 44306, 'availability': ' Year-round'}&gt; rels=[&lt;Relationship element_id='9494215' nodes=(&lt;Node element_id='62214' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': 4.0, 'name': 'Scottish Right', 'retired': True, 'state': 'IN', 'id': 214879, 'brewery_id': 44306, 'availability': ' Year-round'}&gt;, &lt;Node element_id='9494215' labels=frozenset() properties={}&gt;) type='HAS_STYLE' properties={}&gt;, &lt;Relationship element_id='9072917' nodes=(&lt;Node element_id='13515' labels=frozenset() properties={}&gt;, &lt;Node element_id='62214' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': 4.0, 'name': 'Scottish Right', 'retired': True, 'state': 'IN', 'id': 214879, 'brewery_id': 44306, 'availability': ' Year-round'}&gt;) type='BREWED' properties={}&gt;]&gt;,
 &lt;Record b=&lt;Node element_id='9721475' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': 4.0, 'name': 'Scottish Right', 'retired': True, 'state': 'IN', 'id': 214879, 'brewery_id': 44306, 'availability': ' Year-round'}&gt; rels=[]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [78]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, collect(b) AS nodes</span>
<span class="s2">    WHERE size(nodes) &gt; 1</span>
<span class="s2">    WITH beerId, nodes[0] AS keepNode, nodes[1..] AS deleteNodes</span>
<span class="s2">    </span>
<span class="s2">    // Collect relationships of the node to keep</span>
<span class="s2">    OPTIONAL MATCH (keepNode)-[rKeep]-&gt;(target)</span>
<span class="s2">    WITH beerId, keepNode, deleteNodes, collect(rKeep) AS keepRels, collect(target) AS keepTargets</span>
<span class="s2">    OPTIONAL MATCH (source)-[rKeepIn]-&gt;(keepNode)</span>
<span class="s2">    WITH beerId, keepNode, deleteNodes, keepRels, keepTargets, collect(rKeepIn) AS keepRelsIn, collect(source) AS keepSources</span>
<span class="s2">    </span>
<span class="s2">    // Process each node to delete</span>
<span class="s2">    UNWIND deleteNodes AS delNode</span>
<span class="s2">    </span>
<span class="s2">    // Collect relationships of the node to delete</span>
<span class="s2">    OPTIONAL MATCH (delNode)-[rDel]-&gt;(delTarget)</span>
<span class="s2">    WITH beerId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         collect(rDel) AS delRels, collect(delTarget) AS delTargets</span>
<span class="s2">    OPTIONAL MATCH (delSource)-[rDelIn]-&gt;(delNode)</span>
<span class="s2">    WITH beerId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         delRels, delTargets, collect(rDelIn) AS delRelsIn, collect(delSource) AS delSources</span>
<span class="s2">    </span>
<span class="s2">    // Only proceed if delNode has no relationships and keepNode has some</span>
<span class="s2">    WHERE size(delRels) = 0 AND size(delRelsIn) = 0 AND (size(keepRels) &gt; 0 OR size(keepRelsIn) &gt; 0)</span>
<span class="s2">   </span>
<span class="s2">    // For debugging: return what was kept and deleted</span>
<span class="s2">    RETURN beerId, keepNode, delNode</span>
<span class="s2">    LIMIT 1                                          // Limit for testing</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Nodes to keep and delete:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">"Beer ID:"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"beerId"</span><span class="p">])</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">"Keep Node:"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"keepNode"</span><span class="p">])</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">"Delete Node:"</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s2">"delNode"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nodes to keep and delete:
Beer ID: 214879
Keep Node: &lt;Node element_id='62214' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': 4.0, 'name': 'Scottish Right', 'retired': True, 'state': 'IN', 'id': 214879, 'brewery_id': 44306, 'availability': ' Year-round'}&gt;
Delete Node: &lt;Node element_id='9721475' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'abv': 4.0, 'name': 'Scottish Right', 'retired': True, 'state': 'IN', 'id': 214879, 'brewery_id': 44306, 'availability': ' Year-round'}&gt;
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [79]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2.1.1. (BEERS - Duplicate property: id) - Merge duplicates and delete nodes with no relationships </span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, collect(b) AS nodes</span>
<span class="s2">    WHERE size(nodes) &gt; 1</span>
<span class="s2">    WITH beerId, nodes[0] AS keepNode, nodes[1..] AS deleteNodes</span>
<span class="s2">    </span>
<span class="s2">    // Collect relationships of the node to keep</span>
<span class="s2">    OPTIONAL MATCH (keepNode)-[rKeep]-&gt;(target)</span>
<span class="s2">    WITH beerId, keepNode, deleteNodes, collect(rKeep) AS keepRels, collect(target) AS keepTargets</span>
<span class="s2">    OPTIONAL MATCH (source)-[rKeepIn]-&gt;(keepNode)</span>
<span class="s2">    WITH beerId, keepNode, deleteNodes, keepRels, keepTargets, collect(rKeepIn) AS keepRelsIn, collect(source) AS keepSources</span>
<span class="s2">    </span>
<span class="s2">    // Process each node to delete</span>
<span class="s2">    UNWIND deleteNodes AS delNode</span>
<span class="s2">    </span>
<span class="s2">    // Collect relationships of the node to delete</span>
<span class="s2">    OPTIONAL MATCH (delNode)-[rDel]-&gt;(delTarget)</span>
<span class="s2">    WITH beerId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         collect(rDel) AS delRels, collect(delTarget) AS delTargets</span>
<span class="s2">    OPTIONAL MATCH (delSource)-[rDelIn]-&gt;(delNode)</span>
<span class="s2">    WITH beerId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         delRels, delTargets, collect(rDelIn) AS delRelsIn, collect(delSource) AS delSources</span>
<span class="s2">    </span>
<span class="s2">    // Only proceed if delNode has no relationships and keepNode has some</span>
<span class="s2">    WHERE size(delRels) = 0 AND size(delRelsIn) = 0 AND (size(keepRels) &gt; 0 OR size(keepRelsIn) &gt; 0)</span>
<span class="s2">    </span>
<span class="s2">    // Delete the node with no relationships</span>
<span class="s2">    DELETE delNode</span>
<span class="s2">    </span>
<span class="s2">    // For debugging: return what was kept and deleted</span>
<span class="s2">    // RETURN beerId, keepNode, delNode</span>
<span class="s2">    // LIMIT 1                                          // Limit for testing</span>
<span class="s2">    </span>
<span class="s2">    // Return the number of nodes deleted</span>
<span class="s2">    RETURN count(delNode) AS nodesDeleted   </span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record nodesDeleted=58873&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [80]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check if all BEERS nodes have relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH count(b) AS totalNodes</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WHERE EXISTS { (b)-[]-() }</span>
<span class="s2">    RETURN count(b) AS totalNodesWithRelationships, totalNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithRelationships=358873 totalNodes=358873&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<blockquote>
<p>After deleting $58\;873$ duplicate <strong><code>BEERS</code></strong> nodes, we decided to check if all the remaining $358\;873$ nodes have relationships. As we can see from the query above, they do.</p>
</blockquote>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [81]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH b.id AS beerId, count(b) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(beerId) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalDuplicates=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [82]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2.1.2. (BREWERIES - Duplicate property: id) - Merge duplicates and delete nodes with no relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH b.id AS breweryId, collect(b) AS nodes</span>
<span class="s2">    WHERE size(nodes) &gt; 1</span>
<span class="s2">    WITH breweryId, nodes[0] AS keepNode, nodes[1..] AS deleteNodes</span>
<span class="s2">    // Collect relationships of the node to keep</span>
<span class="s2">    OPTIONAL MATCH (keepNode)-[rKeep]-&gt;(target)</span>
<span class="s2">    WITH breweryId, keepNode, deleteNodes, collect(rKeep) AS keepRels, collect(target) AS keepTargets</span>
<span class="s2">    OPTIONAL MATCH (source)-[rKeepIn]-&gt;(keepNode)</span>
<span class="s2">    WITH breweryId, keepNode, deleteNodes, keepRels, keepTargets, collect(rKeepIn) AS keepRelsIn, collect(source) AS keepSources</span>
<span class="s2">    // Process each node to delete</span>
<span class="s2">    UNWIND deleteNodes AS delNode</span>
<span class="s2">    // Collect relationships of the node to delete</span>
<span class="s2">    OPTIONAL MATCH (delNode)-[rDel]-&gt;(delTarget)</span>
<span class="s2">    WITH breweryId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         collect(rDel) AS delRels, collect(delTarget) AS delTargets</span>
<span class="s2">    OPTIONAL MATCH (delSource)-[rDelIn]-&gt;(delNode)</span>
<span class="s2">    WITH breweryId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         delRels, delTargets, collect(rDelIn) AS delRelsIn, collect(delSource) AS delSources</span>
<span class="s2">    // Only proceed if delNode has no relationships and keepNode has some</span>
<span class="s2">    WHERE size(delRels) = 0 AND size(delRelsIn) = 0 AND (size(keepRels) &gt; 0 OR size(keepRelsIn) &gt; 0)</span>
<span class="s2">    // Delete the node with no relationships</span>
<span class="s2">    DELETE delNode</span>
<span class="s2">    // Return the number of nodes deleted</span>
<span class="s2">    RETURN count(delNode) AS nodesDeleted</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"BREWERIES duplicates removed (no relationships):"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>BREWERIES duplicates removed (no relationships):
[&lt;Record nodesDeleted=50347&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [83]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check if all BREWERIES nodes have relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH count(b) AS totalNodes</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WHERE EXISTS { (b)-[]-() }</span>
<span class="s2">    RETURN count(b) AS totalNodesWithRelationships, totalNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithRelationships=50347 totalNodes=50347&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [84]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    WITH b.id AS breweryId, count(b) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(breweryId) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalDuplicates=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [85]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2.1.3. (CITIES - Duplicate property: name) - Merge duplicates and delete nodes with no relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH c.name AS cityName, collect(c) AS nodes</span>
<span class="s2">    WHERE size(nodes) &gt; 1</span>
<span class="s2">    WITH cityName, nodes[0] AS keepNode, nodes[1..] AS deleteNodes</span>
<span class="s2">    // Collect relationships of the node to keep</span>
<span class="s2">    OPTIONAL MATCH (keepNode)-[rKeep]-&gt;(target)</span>
<span class="s2">    WITH cityName, keepNode, deleteNodes, collect(rKeep) AS keepRels, collect(target) AS keepTargets</span>
<span class="s2">    OPTIONAL MATCH (source)-[rKeepIn]-&gt;(keepNode)</span>
<span class="s2">    WITH cityName, keepNode, deleteNodes, keepRels, keepTargets, collect(rKeepIn) AS keepRelsIn, collect(source) AS keepSources</span>
<span class="s2">    // Process each node to delete</span>
<span class="s2">    UNWIND deleteNodes AS delNode</span>
<span class="s2">    // Collect relationships of the node to delete</span>
<span class="s2">    OPTIONAL MATCH (delNode)-[rDel]-&gt;(delTarget)</span>
<span class="s2">    WITH cityName, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         collect(rDel) AS delRels, collect(delTarget) AS delTargets</span>
<span class="s2">    OPTIONAL MATCH (delSource)-[rDelIn]-&gt;(delNode)</span>
<span class="s2">    WITH cityName, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         delRels, delTargets, collect(rDelIn) AS delRelsIn, collect(delSource) AS delSources</span>
<span class="s2">    // Only proceed if delNode has no relationships and keepNode has some</span>
<span class="s2">    WHERE size(delRels) = 0 AND size(delRelsIn) = 0 AND (size(keepRels) &gt; 0 OR size(keepRelsIn) &gt; 0)</span>
<span class="s2">    // Delete the node with no relationships</span>
<span class="s2">    DELETE delNode</span>
<span class="s2">    // Return the number of nodes deleted</span>
<span class="s2">    RETURN count(delNode) AS nodesDeleted</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"CITIES duplicates removed (no relationships):"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>CITIES duplicates removed (no relationships):
[&lt;Record nodesDeleted=11665&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [86]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check if all CITIES nodes have relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH count(c) AS totalNodes</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WHERE EXISTS { (c)-[]-() }</span>
<span class="s2">    RETURN count(c) AS totalNodesWithRelationships, totalNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)</span>
<span class="s2">    WITH c.name AS cityName, count(c) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(cityName) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithRelationships=11665 totalNodes=11665&gt;]
[&lt;Record totalDuplicates=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [87]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2.1.4. (COUNTRIES - Duplicate property: name) - Merge duplicates and delete nodes with no relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WITH c.name AS countryName, collect(c) AS nodes</span>
<span class="s2">    WHERE size(nodes) &gt; 1</span>
<span class="s2">    WITH countryName, nodes[0] AS keepNode, nodes[1..] AS deleteNodes</span>
<span class="s2">    // Collect relationships of the node to keep</span>
<span class="s2">    OPTIONAL MATCH (keepNode)-[rKeep]-&gt;(target)</span>
<span class="s2">    WITH countryName, keepNode, deleteNodes, collect(rKeep) AS keepRels, collect(target) AS keepTargets</span>
<span class="s2">    OPTIONAL MATCH (source)-[rKeepIn]-&gt;(keepNode)</span>
<span class="s2">    WITH countryName, keepNode, deleteNodes, keepRels, keepTargets, collect(rKeepIn) AS keepRelsIn, collect(source) AS keepSources</span>
<span class="s2">    // Process each node to delete</span>
<span class="s2">    UNWIND deleteNodes AS delNode</span>
<span class="s2">    // Collect relationships of the node to delete</span>
<span class="s2">    OPTIONAL MATCH (delNode)-[rDel]-&gt;(delTarget)</span>
<span class="s2">    WITH countryName, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         collect(rDel) AS delRels, collect(delTarget) AS delTargets</span>
<span class="s2">    OPTIONAL MATCH (delSource)-[rDelIn]-&gt;(delNode)</span>
<span class="s2">    WITH countryName, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         delRels, delTargets, collect(rDelIn) AS delRelsIn, collect(delSource) AS delSources</span>
<span class="s2">    // Only proceed if delNode has no relationships and keepNode has some</span>
<span class="s2">    WHERE size(delRels) = 0 AND size(delRelsIn) = 0 AND (size(keepRels) &gt; 0 OR size(keepRelsIn) &gt; 0)</span>
<span class="s2">    // Delete the node with no relationships</span>
<span class="s2">    DELETE delNode</span>
<span class="s2">    // Return the number of nodes deleted</span>
<span class="s2">    RETURN count(delNode) AS nodesDeleted</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"COUNTRIES duplicates removed (no relationships):"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>COUNTRIES duplicates removed (no relationships):
[&lt;Record nodesDeleted=200&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [88]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check if all COUNTRIES nodes have relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WITH count(c) AS totalNodes</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WHERE EXISTS { (c)-[]-() }</span>
<span class="s2">    RETURN count(c) AS totalNodesWithRelationships, totalNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WITH c.name AS countryName, count(c) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(countryName) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithRelationships=200 totalNodes=200&gt;]
[&lt;Record totalDuplicates=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [89]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.2.1.5. (REVIEWS - Duplicate property: id) - Merge duplicates and delete nodes with no relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH r.id AS reviewId, collect(r) AS nodes</span>
<span class="s2">    WHERE size(nodes) &gt; 1</span>
<span class="s2">    WITH reviewId, nodes[0] AS keepNode, nodes[1..] AS deleteNodes</span>
<span class="s2">    // Collect relationships of the node to keep</span>
<span class="s2">    OPTIONAL MATCH (keepNode)-[rKeep]-&gt;(target)</span>
<span class="s2">    WITH reviewId, keepNode, deleteNodes, collect(rKeep) AS keepRels, collect(target) AS keepTargets</span>
<span class="s2">    OPTIONAL MATCH (source)-[rKeepIn]-&gt;(keepNode)</span>
<span class="s2">    WITH reviewId, keepNode, deleteNodes, keepRels, keepTargets, collect(rKeepIn) AS keepRelsIn, collect(source) AS keepSources</span>
<span class="s2">    // Process each node to delete</span>
<span class="s2">    UNWIND deleteNodes AS delNode</span>
<span class="s2">    // Collect relationships of the node to delete</span>
<span class="s2">    OPTIONAL MATCH (delNode)-[rDel]-&gt;(delTarget)</span>
<span class="s2">    WITH reviewId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         collect(rDel) AS delRels, collect(delTarget) AS delTargets</span>
<span class="s2">    OPTIONAL MATCH (delSource)-[rDelIn]-&gt;(delNode)</span>
<span class="s2">    WITH reviewId, keepNode, delNode, keepRels, keepTargets, keepRelsIn, keepSources,</span>
<span class="s2">         delRels, delTargets, collect(rDelIn) AS delRelsIn, collect(delSource) AS delSources</span>
<span class="s2">    // Only proceed if delNode has no relationships and keepNode has some</span>
<span class="s2">    WHERE size(delRels) = 0 AND size(delRelsIn) = 0 AND (size(keepRels) &gt; 0 OR size(keepRelsIn) &gt; 0)</span>
<span class="s2">    // Delete the node with no relationships</span>
<span class="s2">    DELETE delNode</span>
<span class="s2">    // Return the number of nodes deleted</span>
<span class="s2">    RETURN count(delNode) AS nodesDeleted</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"REVIEWS duplicates removed (no relationships):"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>REVIEWS duplicates removed (no relationships):
[&lt;Record nodesDeleted=3111&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [90]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check if all REVIEWS nodes have relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH count(r) AS totalNodes</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE EXISTS { (r)-[]-() }</span>
<span class="s2">    RETURN count(r) AS totalNodesWithRelationships, totalNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WITH r.id AS reviewId, count(r) AS count</span>
<span class="s2">    WHERE count &gt; 1</span>
<span class="s2">    RETURN count(reviewId) AS totalDuplicates</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithRelationships=2538044 totalNodes=2546160&gt;]
[&lt;Record totalDuplicates=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [92]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># [&lt;Record totalNodesWithRelationships=2538044 totalNodes=2546160&gt;] - There are REVIEW nodes without relationships</span>
<span class="c1"># Nodes without relationships: 2,546,160 - 2,538,044 = 8,116.</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Count and sample REVIEWS nodes without relationships</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    </span>
<span class="s2">    // Filter only the nodes without relationships</span>
<span class="s2">    WHERE NOT EXISTS { (r)-[]-() }</span>
<span class="s2">    </span>
<span class="s2">    // Count and collect the nodes</span>
<span class="s2">    WITH count(r) AS nodesWithoutRelationships, collect(r) AS nodes</span>
<span class="s2">    </span>
<span class="s2">    // Sample 5 nodes for inspection and return the count            | Source: https://stackoverflow.com/questions/19075817/retrieving-subset-of-array-list-on-neo4j-node-property</span>
<span class="s2">    RETURN nodesWithoutRelationships, nodes[0..5] AS sampleNodes        </span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record nodesWithoutRelationships=8116 sampleNodes=[&lt;Node element_id='921375' labels=frozenset() properties={}&gt;, &lt;Node element_id='921921' labels=frozenset() properties={}&gt;, &lt;Node element_id='922467' labels=frozenset() properties={}&gt;, &lt;Node element_id='923013' labels=frozenset() properties={}&gt;, &lt;Node element_id='923559' labels=frozenset() properties={}&gt;]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>There are a total of <strong>$8\;116$ Orphan <code>REVIEW</code> nodes</strong> which will be removed below</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [93]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Remove the nodes from the previous query</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Remove REVIEWS nodes without relationships</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE NOT EXISTS { (r)-[]-() }</span>
<span class="s2">    DETACH DELETE r</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [94]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check if nodes of REVIEWS without relationships were removed</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE NOT EXISTS { (r)-[]-() }</span>
<span class="s2">    RETURN count(r) AS totalNodesWithoutRelationships</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithoutRelationships=19&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We were unable to delete <strong>19 orphan nodes</strong>. The reasons for this will be analyzed in the next section.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<blockquote>
<p>Since all duplicated nodes are the *<strong>1st Case</strong>* (one node with relationships and the other without), we don't need to check other combinations of duplicates. E.g., since all duplicates are <strong>orphan nodes</strong> (i.e do not have any relationship), removing the duplicates only implies removing the orphan nodes. Therefore, no further duplicate checks were necessary.</p>
</blockquote>
<ul>
<li>We deleted <strong>$58\;873$</strong> duplicate <strong><code>BEERS</code></strong> nodes.</li>
<li>We deleted <strong>$50\;347$</strong> duplicate <strong><code>BREWERIES</code></strong> nodes.</li>
<li>We deleted <strong>$200$</strong> duplicate <strong><code>COUNTRIES</code></strong> nodes.</li>
<li>We deleted <strong>$11\;665$</strong> duplicate <strong><code>CITIES</code></strong> nodes.</li>
<li>We deleted <strong>$3\;111$</strong> duplicate <strong><code>REVIEWS</code></strong> nodes.</li>
<li>We didn't delete any duplicate <strong><code>STYLE</code></strong> or <strong><code>USER</code></strong> nodes.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="2.3-Detect-and-Remove-Errors"><strong>2.3 Detect and Remove Errors</strong><a class="anchor-link" href="#2.3-Detect-and-Remove-Errors">¶</a></h3><p>In this section, we will check for errors in the database. We will look for the following types of errors:</p>
<ul>
<li><strong>Nodes without labels</strong>: We will check if there are any nodes without labels.</li>
<li><strong>Nodes without relationships</strong>: We will check if there are any nodes without relationships.</li>
<li><strong>Invalid <code>abv</code> values</strong>: We will check if there are any beers with an <code>abv</code> value greater than <strong>67.5%</strong>.</li>
</ul>
<p><strong>Note</strong>: We don't need to check <strong><code>score</code></strong>, <strong><code>taste</code></strong>, <strong><code>feel</code></strong>, <strong><code>overall</code></strong>, <strong><code>smell</code></strong> and <strong><code>look</code></strong> properties because we already converted them to <strong><code>float</code></strong> and the values are between <strong>$1$</strong> and <strong>$5$</strong>, based on the statistical analysis (<strong>Section 2.1.</strong>)</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [95]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.3.1. Nodes without labels</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (n)</span>
<span class="s2">    WHERE isEmpty(labels(n))</span>
<span class="s2">    WITH count(n) AS totalNodesWithoutLabels, collect(n) AS nodes</span>
<span class="s2">    RETURN totalNodesWithoutLabels, nodes[0..5] AS sampleNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nodes without labels - Count and 5 examples:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Nodes without labels - Count and 5 examples:
[&lt;Record totalNodesWithoutLabels=0 sampleNodes=[]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We don't have any nodes without labels.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [96]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Re-do the query 1.11 to see Min_RelationshipCount and Max_RelationshipCount</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // What kind of nodes exist</span>
<span class="s2">    // Sample some nodes, reporting on property and relationship counts per node.</span>
<span class="s2">    MATCH (n)</span>
<span class="s2">    RETURN</span>
<span class="s2">    DISTINCT labels(n),</span>
<span class="s2">    count(*) AS NodeCount,</span>
<span class="s2">    avg(size(keys(n))) as Avg_PropertyCount,</span>
<span class="s2">    min(size(keys(n))) as Min_PropertyCount,</span>
<span class="s2">    max(size(keys(n))) as Max_PropertyCount,</span>
<span class="s2">    avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,</span>
<span class="s2">    min(size( (n)-[]-() ) ) as Min_RelationshipCount,</span>
<span class="s2">    max(size( (n)-[]-() ) ) as Max_RelationshipCount</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"labels(n)"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"Node Label"</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: A pattern expression should only be used in order to test the existence of a pattern. It should therefore only be used in contexts that evaluate to a boolean, e.g. inside the function exists() or in a WHERE-clause. All other uses are deprecated and should be replaced by a pattern comprehension.} {position: line: 11, column: 15, offset: 340} for query: '\n    // What kind of nodes exist\n    // Sample some nodes, reporting on property and relationship counts per node.\n    MATCH (n)\n    RETURN\n    DISTINCT labels(n),\n    count(*) AS NodeCount,\n    avg(size(keys(n))) as Avg_PropertyCount,\n    min(size(keys(n))) as Min_PropertyCount,\n    max(size(keys(n))) as Max_PropertyCount,\n    avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,\n    min(size( (n)-[]-() ) ) as Min_RelationshipCount,\n    max(size( (n)-[]-() ) ) as Max_RelationshipCount\n'
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: A pattern expression should only be used in order to test the existence of a pattern. It should therefore only be used in contexts that evaluate to a boolean, e.g. inside the function exists() or in a WHERE-clause. All other uses are deprecated and should be replaced by a pattern comprehension.} {position: line: 12, column: 15, offset: 394} for query: '\n    // What kind of nodes exist\n    // Sample some nodes, reporting on property and relationship counts per node.\n    MATCH (n)\n    RETURN\n    DISTINCT labels(n),\n    count(*) AS NodeCount,\n    avg(size(keys(n))) as Avg_PropertyCount,\n    min(size(keys(n))) as Min_PropertyCount,\n    max(size(keys(n))) as Max_PropertyCount,\n    avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,\n    min(size( (n)-[]-() ) ) as Min_RelationshipCount,\n    max(size( (n)-[]-() ) ) as Max_RelationshipCount\n'
Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: A pattern expression should only be used in order to test the existence of a pattern. It should therefore only be used in contexts that evaluate to a boolean, e.g. inside the function exists() or in a WHERE-clause. All other uses are deprecated and should be replaced by a pattern comprehension.} {position: line: 13, column: 15, offset: 448} for query: '\n    // What kind of nodes exist\n    // Sample some nodes, reporting on property and relationship counts per node.\n    MATCH (n)\n    RETURN\n    DISTINCT labels(n),\n    count(*) AS NodeCount,\n    avg(size(keys(n))) as Avg_PropertyCount,\n    min(size(keys(n))) as Min_PropertyCount,\n    max(size(keys(n))) as Max_PropertyCount,\n    avg(size( (n)-[]-() ) ) as Avg_RelationshipCount,\n    min(size( (n)-[]-() ) ) as Min_RelationshipCount,\n    max(size( (n)-[]-() ) ) as Max_RelationshipCount\n'
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[96]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>NodeCount</th>
<th>Avg_PropertyCount</th>
<th>Min_PropertyCount</th>
<th>Max_PropertyCount</th>
<th>Avg_RelationshipCount</th>
<th>Min_RelationshipCount</th>
<th>Max_RelationshipCount</th>
</tr>
<tr>
<th>Node Label</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>[COUNTRIES]</th>
<td>200</td>
<td>1.000000</td>
<td>1</td>
<td>1</td>
<td>60.385000</td>
<td>1</td>
<td>4959</td>
</tr>
<tr>
<th>[CITIES]</th>
<td>11665</td>
<td>1.000000</td>
<td>1</td>
<td>1</td>
<td>5.351393</td>
<td>2</td>
<td>513</td>
</tr>
<tr>
<th>[BREWERIES]</th>
<td>50347</td>
<td>5.000000</td>
<td>5</td>
<td>5</td>
<td>8.127992</td>
<td>1</td>
<td>1230</td>
</tr>
<tr>
<th>[BEERS]</th>
<td>358873</td>
<td>7.891892</td>
<td>7</td>
<td>8</td>
<td>9.072115</td>
<td>2</td>
<td>4835</td>
</tr>
<tr>
<th>[REVIEWS]</th>
<td>2538044</td>
<td>7.910826</td>
<td>5</td>
<td>10</td>
<td>1.999979</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<th>[STYLE]</th>
<td>113</td>
<td>1.000000</td>
<td>1</td>
<td>1</td>
<td>3175.867257</td>
<td>1</td>
<td>44719</td>
</tr>
<tr>
<th>[USER]</th>
<td>123935</td>
<td>1.000000</td>
<td>1</td>
<td>1</td>
<td>20.478832</td>
<td>0</td>
<td>3756</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Comments-%7C-Errors"><strong>Comments | Errors</strong><a class="anchor-link" href="#Comments-%7C-Errors">¶</a></h5><ul>
<li><strong><code>Min_RelationshipCount</code></strong>:<ul>
<li>After removing duplicates, the <code>Min_RelationshipCount</code> increased for some node labels, indicating that some nodes with fewer properties were duplicates and have been removed.</li>
<li>However, there are still <code>USER</code> nodes with no relationships (<code>Min_RelationshipCount = 0</code>). This suggests that while duplicates were addressed, some nodes remain unconnected in the graph.</li>
<li>The <code>Min_RelationshipCount</code> for <code>REVIEWS</code> should be <strong>0</strong> since <strong>some orphan nodes remain</strong>. However, it shows a <code>Min_RelationshipCount</code> of <strong>1</strong>, indicating that 19 orphan nodes were deleted. We need to investigate the cause of their inconsistency.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [97]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.3 - Nodes without relationships (ALL)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (wr)</span>
<span class="s2">    WHERE NOT EXISTS { (wr)-[]-() }</span>
<span class="s2">    RETURN count(wr) AS totalNodesWithoutRelationships</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithoutRelationships=17290&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [98]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.3 - Nodes without relationships (REVIEWS)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Count and sample REVIEW nodes without relationships</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE NOT EXISTS { (r)-[]-() }</span>
<span class="s2">    WITH count(r) AS totalReviewsWithoutRelationships, r</span>
<span class="s2">    RETURN totalReviewsWithoutRelationships, r</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"REVIEW nodes without relationships"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>REVIEW nodes without relationships
[&lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='921375' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='921921' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='922467' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='923013' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='923559' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='924105' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='924651' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='925197' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='925743' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='926289' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='926835' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='927381' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='927927' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='928473' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='929019' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='929565' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='930111' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='930657' labels=frozenset() properties={}&gt;&gt;,
 &lt;Record totalReviewsWithoutRelationships=1 r=&lt;Node element_id='931203' labels=frozenset() properties={}&gt;&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>After searching for the <strong><code>REVIEW</code></strong> nodes without relationships, we found <strong>19</strong> nodes. All this nodes don't have properties (except the <strong><code>&lt;id&gt;</code></strong> property associated to each node in <em>Neo4J</em>). So we will try delete them.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [99]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to remove REVIEW nodes without relationships and without properties</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE NOT EXISTS((r)-[]-()) AND size(keys(r)) = 0</span>
<span class="s2">    DELETE r</span>
<span class="s2">    RETURN count(r) AS totalNodesDeleted</span>
<span class="s2">"""</span>

<span class="c1"># Execute the query</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total REVIEW nodes deleted (without relationships and properties): </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'totalNodesDeleted'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error removing REVIEW nodes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Total REVIEW nodes deleted (without relationships and properties): 19
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [100]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify if nodes of REVIEWS without relationships were removed</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Check if REVIEW nodes without relationships were removed</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE NOT EXISTS { (r)-[]-() }</span>
<span class="s2">    RETURN count(r) AS totalNodesWithoutRelationships</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithoutRelationships=19&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>For some reason, we can't delete the <strong><code>REVIEW</code></strong> nodes without relationships. We will try to delete this nodes doing a <strong><code>MATCH</code></strong> with the <strong><code>&lt;id&gt;</code></strong> property of the nodes.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [101]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># - Query to remove REVIEW nodes without relationships and without properties (2nd try - Using &lt;id&gt; property)</span>

<span class="n">list_of_ids_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'921375'</span><span class="p">,</span> <span class="s1">'921921'</span><span class="p">,</span> <span class="s1">'922467'</span><span class="p">,</span> <span class="s1">'923013'</span><span class="p">,</span> <span class="s1">'923559'</span><span class="p">,</span> <span class="s1">'924105'</span><span class="p">,</span> <span class="s1">'924651'</span><span class="p">,</span> <span class="s1">'925197'</span><span class="p">,</span> <span class="s1">'925743'</span><span class="p">,</span> <span class="s1">'926289'</span><span class="p">,</span> 
                         <span class="s1">'926835'</span><span class="p">,</span> <span class="s1">'927381'</span><span class="p">,</span> <span class="s1">'927927'</span><span class="p">,</span> <span class="s1">'928473'</span><span class="p">,</span> <span class="s1">'929019'</span><span class="p">,</span> <span class="s1">'929565'</span><span class="p">,</span> <span class="s1">'930111'</span><span class="p">,</span> <span class="s1">'930657'</span><span class="p">,</span> <span class="s1">'931203'</span><span class="p">]</span>

<span class="c1"># Iterate over the list of IDs to remove</span>
<span class="k">for</span> <span class="n">review_id</span> <span class="ow">in</span> <span class="n">list_of_ids_to_remove</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">        MATCH (r:REVIEWS)</span>
<span class="s2">        WHERE id(r) = </span><span class="si">{</span><span class="n">review_id</span><span class="si">}</span>
<span class="s2">        DELETE r</span>
<span class="s2">        RETURN count(r) AS totalNodesDeleted</span>
<span class="s2">    """</span>
    <span class="c1"># Execute the query</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total REVIEW nodes deleted (without relationships and properties): </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'totalNodesDeleted'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error removing REVIEW nodes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
Total REVIEW nodes deleted (without relationships and properties): 0
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [102]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify if nodes of REVIEWS without relationships were removed</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Check if REVIEW nodes without relationships were removed</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    WHERE NOT EXISTS { (r)-[]-() }</span>
<span class="s2">    RETURN count(r) AS totalNodesWithoutRelationships</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesWithoutRelationships=19&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [103]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to remove REVIEW nodes without relationships and without properties (3rd try - Match all nodes without relationships and not considering USER nodes)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>

<span class="s2">    // Find all nodes without relationships</span>
<span class="s2">    MATCH (wr)</span>
<span class="s2">    WHERE NOT EXISTS((wr)-[]-())</span>
<span class="s2">    </span>
<span class="s2">    // Exclude USER nodes</span>
<span class="s2">    MATCH (wr)</span>
<span class="s2">    WHERE NOT wr:USER</span>
<span class="s2">    </span>
<span class="s2">    // Remove the nodes</span>
<span class="s2">    // DELETE wr                                // Before deleting, we test the query to see how many nodes will be deleted</span>
<span class="s2">    </span>
<span class="s2">    // Return the number of nodes deleted</span>
<span class="s2">    RETURN count(wr) AS totalNodesDeleted</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalNodesDeleted=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<blockquote>
<p>After try 3 different ways to delete the <strong><code>REVIEW</code></strong> nodes without relationships, we still have <strong>$19$</strong> nodes.</p>
</blockquote>
<ul>
<li>Since this nodes will not be counted in the queries, we will leave them in the database. The most likely explanation is that these nodes are "ghost" nodes—although they were deleted, they still appear in the database.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [104]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.3. USER nodes without relationships </span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Count and sample USER nodes without relationships</span>
<span class="s2">    MATCH (u:USER)</span>
<span class="s2">    WHERE NOT EXISTS { (u)-[]-() }</span>
<span class="s2">    WITH count(u) AS totalUsersWithoutRelationships, collect(u) AS userNodes</span>
<span class="s2">    RETURN totalUsersWithoutRelationships, userNodes[0..5] AS sampleUserNodes</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"USER nodes without relationships - Count and 5 examples:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>USER nodes without relationships - Count and 5 examples:
[&lt;Record totalUsersWithoutRelationships=17290 sampleUserNodes=[&lt;Node element_id='9494578' labels=frozenset({'USER'}) properties={'name': 'Rick_Ereth'}&gt;, &lt;Node element_id='9495077' labels=frozenset({'USER'}) properties={'name': 'matttyt'}&gt;, &lt;Node element_id='9495143' labels=frozenset({'USER'}) properties={'name': 'ChaBrah'}&gt;, &lt;Node element_id='9495174' labels=frozenset({'USER'}) properties={'name': 'bbc0202'}&gt;, &lt;Node element_id='9495303' labels=frozenset({'USER'}) properties={'name': 'Kbenoit16'}&gt;]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>Since we don't know the exact origin of this data and where/how it was obtained, it might make sense for there to be <strong><code>USERS</code></strong> with no reviews (e.g., users who have created an account on the data retrieval page, but have never done a <strong><code>REVIEW</code></strong>). So, <strong>we will not remove these nodes</strong>.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><strong><code>abv</code></strong>: According to <a href="https://www.hopsandhopes.nl/en/beers/snake-venom">Hops &amp; Hopes (2025)</a> the world's strongest beer is <strong>Snake Venom</strong> with <strong>67.5% ABV</strong>.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [105]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.3. BEERS.abv greater than 67.5</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    </span>
<span class="s2">    // Filter invalid ABV values</span>
<span class="s2">    WHERE b.abv &gt; 67.5 OR b.abv &lt; 0</span>
<span class="s2">    RETURN b.name, b.abv</span>
<span class="s2">    ORDER BY b.abv DESC</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record b.name="Earache: World's Shortest Album" b.abv=100.0&gt;,
 &lt;Record b.name='Radiohead - OK Computer' b.abv=100.0&gt;,
 &lt;Record b.name='water' b.abv=100.0&gt;,
 &lt;Record b.name='Dark Reckoning' b.abv=80.0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Checking the <strong><code>BEERS</code></strong> node, we found that there are some beers with <strong><code>abv</code></strong> greater than <strong>$67.5$</strong>. After observing that cases, we found that the names of the beers are <strong><code>Earache: World's Shortest Album</code></strong> and <strong><code>Dark Reckoning</code></strong>, <strong><code>Radiohead - OK Computer</code></strong> and <strong><code>water</code></strong> and we researched about them and found that they are not beers, so <strong>we will remove them</strong>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [106]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.3. Remove nodes with BEERS.abv greater than 67.5</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WHERE b.abv &gt; 67.5 OR b.abv &lt; 0</span>
<span class="s2">    DETACH DELETE b</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [107]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes </span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Count the number of BEERS nodes with abv &gt; 67.5 and return the total and a sample</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WHERE b.abv &gt; 67.5</span>
<span class="s2">    WITH count(b) AS totalBeers, collect(b) AS beers</span>
<span class="s2">    RETURN totalBeers, beers[0..5] AS sampleBeers</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBeers=0 sampleBeers=[]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="2.4.-%F0%9F%A7%B9-Remove-Missing-Values"><strong>2.4. 🧹 Remove Missing Values</strong><a class="anchor-link" href="#2.4.-%F0%9F%A7%B9-Remove-Missing-Values">¶</a></h3><p>In this section, we check for missing values in the database. In our view, it makes sense to clean this data to fully leverage one of the key <strong>advantages</strong> of NoSQL graph databases like <strong>Neo4j</strong>: *<strong>flexibility</strong>*.</p>
<p>Unlike relational databases, where each row must conform to a predefined schema, graph databases allow nodes to have a variable number of properties. This flexibility can, in theory, optimize storage by reducing unnecessary data.</p>
<p>Considering this flexibility, after identifying a node with missing properties instead of deleting the entire node we have just deleted the property missing.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [108]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/clauses/remove/</span>

<span class="c1"># 2.4 - Re-run the query 1.12 (Before Missing Values Handling)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">Summary statistics of each property for each node label in the database (After Cleaning):"</span><span class="p">)</span>

<span class="c1"># Initialize a list to store statistics</span>
<span class="n">stats_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate over each property and calculate statistics</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">properties_result</span><span class="p">):</span>
    <span class="n">nodeType</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">'nodeType'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'`'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">':'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>  <span class="c1"># Remove backticks and ':'</span>
    <span class="n">propertyName</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s1">'propertyName'</span><span class="p">]</span>
    
    <span class="c1"># Construct query for each property</span>
    <span class="k">if</span> <span class="n">propertyName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'notes'</span><span class="p">,</span> <span class="s1">'state'</span><span class="p">,</span> <span class="s1">'availability'</span><span class="p">,</span> <span class="s1">'types'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">]:</span>
        <span class="c1"># String properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS count,</span>
<span class="s2">                COUNT(DISTINCT n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS distinctCount,</span>
<span class="s2">                '-' AS mean,</span>
<span class="s2">                '-' AS min,</span>
<span class="s2">                '-' AS max,</span>
<span class="s2">                COUNT(CASE WHEN n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NULL OR n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> = '' OR toLower(trim(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">)) IN ['nan', 'null', 'none', '', ' '] THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    <span class="k">elif</span> <span class="n">propertyName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'retired'</span><span class="p">,</span> <span class="s1">'date'</span><span class="p">]:</span>
        <span class="c1"># Boolean &amp; Date properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS count,</span>
<span class="s2">                COUNT(DISTINCT n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">) AS distinctCount,</span>
<span class="s2">                '-' AS mean,</span>
<span class="s2">                '-' AS min,</span>
<span class="s2">                '-' AS max,</span>
<span class="s2">                COUNT(CASE WHEN n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> IS NULL THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Numeric properties</span>
        <span class="n">stats_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            WITH n, n.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2"> AS value</span>
<span class="s2">            RETURN</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">' AS nodeType,</span>
<span class="s2">                '</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">' AS propertyName,</span>
<span class="s2">                COUNT(value) AS count,</span>
<span class="s2">                COUNT(DISTINCT value) AS distinctCount,</span>
<span class="s2">                AVG(value) AS mean,</span>
<span class="s2">                MIN(value) AS min,</span>
<span class="s2">                MAX(value) AS max,</span>
<span class="s2">                COUNT(CASE WHEN value IS NULL THEN 1 ELSE NULL END) AS missingCount</span>
<span class="s2">        """</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">stats_result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">stats_query</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stats_result</span><span class="p">:</span>
            <span class="n">stats_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error processing </span><span class="si">{</span><span class="n">nodeType</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">propertyName</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">stats_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Node'</span><span class="p">,</span> <span class="s1">'Property'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">,</span> <span class="s1">'Distinct Count'</span><span class="p">,</span> 
                                       <span class="s1">'Mean'</span><span class="p">,</span> <span class="s1">'Min'</span><span class="p">,</span> <span class="s1">'Max'</span><span class="p">,</span> <span class="s1">'Missing Count'</span><span class="p">])</span>                          <span class="c1"># Convert the list to a DataFrame</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'Missing Count (%)'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Missing Count'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>                                     <span class="c1"># Calculate the percentage of missing values</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">'Node'</span><span class="p">,</span> <span class="s1">'Property'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                                        <span class="c1"># Set the index to Node and Property (Hierarchical Indexing)</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                                                            <span class="c1"># Fill NaN values with 0</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">'</span><span class="si">{:,.0f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span>
              <span class="s1">'</span><span class="si">{:,.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span>
              <span class="n">x</span>
<span class="p">)</span>                                                                                                                     <span class="c1"># Format the DataFrame for better visualization</span>
<span class="n">df</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

Summary statistics of each property for each node label in the database (After Cleaning):
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>100%|██████████| 27/27 [07:46&lt;00:00, 17.28s/it]
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[108]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Count</th>
<th>Distinct Count</th>
<th>Mean</th>
<th>Min</th>
<th>Max</th>
<th>Missing Count</th>
<th>Missing Count (%)</th>
</tr>
<tr>
<th>Node</th>
<th>Property</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="8" valign="top">BEERS</th>
<th>abv</th>
<td>320072</td>
<td>937</td>
<td>6.53</td>
<td>0.01</td>
<td>67.50</td>
<td>38797</td>
<td>12.12</td>
</tr>
<tr>
<th>availability</th>
<td>358869</td>
<td>20</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>brewery_id</th>
<td>358869</td>
<td>16569</td>
<td>24 597.39</td>
<td>1</td>
<td>54144</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>id</th>
<td>358869</td>
<td>358869</td>
<td>189 239.20</td>
<td>3</td>
<td>374406</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>name</th>
<td>358869</td>
<td>298564</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>notes</th>
<td>358869</td>
<td>48313</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>46</td>
<td>0.01</td>
</tr>
<tr>
<th>retired</th>
<td>358869</td>
<td>2</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>state</th>
<td>358869</td>
<td>68</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>60726</td>
<td>16.92</td>
</tr>
<tr>
<th rowspan="5" valign="top">BREWERIES</th>
<th>id</th>
<td>50347</td>
<td>50347</td>
<td>27 870.51</td>
<td>1</td>
<td>54156</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>name</th>
<td>50347</td>
<td>45245</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>notes</th>
<td>50347</td>
<td>3271</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>85</td>
<td>0.17</td>
</tr>
<tr>
<th>state</th>
<td>50347</td>
<td>68</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>11271</td>
<td>22.39</td>
</tr>
<tr>
<th>types</th>
<td>50347</td>
<td>30</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>CITIES</th>
<th>name</th>
<td>11665</td>
<td>11665</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.01</td>
</tr>
<tr>
<th>COUNTRIES</th>
<th>name</th>
<td>200</td>
<td>200</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.50</td>
</tr>
<tr>
<th rowspan="10" valign="top">REVIEWS</th>
<th>beer_id</th>
<td>2538044</td>
<td>189395</td>
<td>77 311.79</td>
<td>3</td>
<td>373128</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>date</th>
<td>2538044</td>
<td>6379</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>feel</th>
<td>1477561</td>
<td>17</td>
<td>3.88</td>
<td>1</td>
<td>5</td>
<td>1060502</td>
<td>71.77</td>
</tr>
<tr>
<th>id</th>
<td>2538044</td>
<td>2538044</td>
<td>4 537 303.98</td>
<td>1</td>
<td>9073127</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>look</th>
<td>1477561</td>
<td>17</td>
<td>3.95</td>
<td>1</td>
<td>5</td>
<td>1060502</td>
<td>71.77</td>
</tr>
<tr>
<th>overall</th>
<td>1477561</td>
<td>17</td>
<td>3.92</td>
<td>1</td>
<td>5</td>
<td>1060502</td>
<td>71.77</td>
</tr>
<tr>
<th>score</th>
<td>2538044</td>
<td>401</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>smell</th>
<td>1477561</td>
<td>17</td>
<td>3.89</td>
<td>1</td>
<td>5</td>
<td>1060502</td>
<td>71.77</td>
</tr>
<tr>
<th>taste</th>
<td>1477561</td>
<td>17</td>
<td>3.92</td>
<td>1</td>
<td>5</td>
<td>1060502</td>
<td>71.77</td>
</tr>
<tr>
<th>text</th>
<td>2538044</td>
<td>812239</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>19</td>
<td>0.00</td>
</tr>
<tr>
<th>STYLE</th>
<th>name</th>
<td>113</td>
<td>113</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.88</td>
</tr>
<tr>
<th>USER</th>
<th>name</th>
<td>123935</td>
<td>123935</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>Even after removal of duplicated nodes, we still have properties of nodes that are missing. We <strong>will remove these properties</strong>.</li>
</ul>
<p><strong>Note:</strong> <strong><code>BEER.name</code></strong> <strong>Count</strong> is different from <strong>Distinct Count</strong> because beers with same name can be produced in different ways. Different breweries may produce distinct beers that happen to share the same name.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [109]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># List of nodes and properties with missing values</span>
<span class="n">missing_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"BEERS"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"abv"</span><span class="p">,</span> <span class="s2">"state"</span><span class="p">,</span> <span class="s2">"notes"</span><span class="p">],</span>
    <span class="s2">"BREWERIES"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"notes"</span><span class="p">,</span> <span class="s2">"state"</span><span class="p">],</span>
    <span class="s2">"CITIES"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">],</span>
    <span class="s2">"COUNTRIES"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">],</span>
    <span class="s2">"REVIEWS"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"beer_id"</span><span class="p">,</span> <span class="s2">"date"</span><span class="p">,</span> <span class="s2">"feel"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">,</span> <span class="s2">"look"</span><span class="p">,</span> <span class="s2">"overall"</span><span class="p">,</span> <span class="s2">"score"</span><span class="p">,</span> <span class="s2">"smell"</span><span class="p">,</span> <span class="s2">"taste"</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">],</span>
    <span class="s2">"STYLE"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">],</span>
    <span class="s2">"USER"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"name"</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Dictionary to store how many nodes had properties removed</span>
<span class="n">nodes_updated_count</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Iterate over each node type and property to remove the missing property values</span>
<span class="k">for</span> <span class="n">node_type</span><span class="p">,</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">missing_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="nb">property</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
        <span class="c1"># Handle STRING properties</span>
        <span class="k">if</span> <span class="nb">property</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'notes'</span><span class="p">,</span> <span class="s1">'state'</span><span class="p">,</span> <span class="s1">'availability'</span><span class="p">,</span> <span class="s1">'types'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">]:</span>  
            <span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/functions/scalar/#functions-coalesce</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> IS NULL OR n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> = '' OR toLower(trim(COALESCE(n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2">, ''))) IN ['nan', 'null', 'none', '', 'n/a', 'na']"</span>
        <span class="c1"># Handle NUMERIC properties (Double, Long)</span>
        <span class="k">elif</span> <span class="nb">property</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'abv'</span><span class="p">,</span> <span class="s1">'beer_id'</span><span class="p">,</span> <span class="s1">'score'</span><span class="p">,</span> <span class="s1">'feel'</span><span class="p">,</span> <span class="s1">'look'</span><span class="p">,</span> <span class="s1">'overall'</span><span class="p">,</span> <span class="s1">'smell'</span><span class="p">,</span> <span class="s1">'taste'</span><span class="p">]:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> IS NULL"</span>
        <span class="c1"># Handle DATE properties</span>
        <span class="k">elif</span> <span class="nb">property</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">]:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> IS NULL"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># Skip unknown property types</span>

        <span class="c1"># Query to count affected nodes</span>
        <span class="n">count_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">node_type</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            WHERE </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span>
<span class="s2">            RETURN count(n) AS nodesUpdated</span>
<span class="s2">        """</span>

        <span class="c1"># Execute count query</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">count_result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">count_query</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">count_result</span> <span class="ow">and</span> <span class="n">count_result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'nodesUpdated'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">affected_nodes</span> <span class="o">=</span> <span class="n">count_result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'nodesUpdated'</span><span class="p">]</span>

                <span class="c1"># Query to remove the property</span>
                <span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/clauses/remove/</span>
                <span class="n">remove_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">                    MATCH (n:</span><span class="si">{</span><span class="n">node_type</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">                    WHERE </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span>
<span class="s2">                    REMOVE n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span>
<span class="s2">                """</span>
                
                <span class="c1"># Execute remove query</span>
                <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">remove_query</span><span class="p">)</span>

                <span class="c1"># Store the count of affected nodes</span>
                <span class="k">if</span> <span class="n">node_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_updated_count</span><span class="p">:</span>
                    <span class="n">nodes_updated_count</span><span class="p">[</span><span class="n">node_type</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">nodes_updated_count</span><span class="p">[</span><span class="n">node_type</span><span class="p">]</span> <span class="o">+=</span> <span class="n">affected_nodes</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error processing </span><span class="si">{</span><span class="n">node_type</span><span class="si">}</span><span class="s2"> nodes with missing </span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Print summary of changes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Summary of nodes where properties were removed:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">nodes_updated_count</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Label: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">, Nodes Updated: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Summary of nodes where properties were removed:
Label: BEERS, Nodes Updated: 99569
Label: BREWERIES, Nodes Updated: 11356
Label: CITIES, Nodes Updated: 1
Label: COUNTRIES, Nodes Updated: 1
Label: REVIEWS, Nodes Updated: 5302586
Label: STYLE, Nodes Updated: 1
Label: USER, Nodes Updated: 1
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Count the remaining missing values for each property after cleanup and return an example node</span>
<span class="k">for</span> <span class="n">node_type</span><span class="p">,</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">missing_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="nb">property</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            // Count the number of nodes with missing values for the property and return 1 example node</span>
<span class="s2">            MATCH (n:</span><span class="si">{</span><span class="n">node_type</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">            WHERE n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> IS NULL OR n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2"> = ''</span>
<span class="s2">            RETURN count(n) AS missingCount, collect(n)[0] AS exampleNode</span>
<span class="s2">        """</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node Type: </span><span class="si">{</span><span class="n">node_type</span><span class="si">}</span><span class="s2">, Property: </span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2">, Missing Count: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'missingCount'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Example Node: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'exampleNode'</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Node Type: BEERS, Property: abv, Missing Count: 38797
Node Type: BEERS, Property: state, Missing Count: 60726
Node Type: BEERS, Property: notes, Missing Count: 46
Example Node: &lt;Node element_id='83399' labels=frozenset({'BEERS'}) properties={'abv': 6.7, 'name': 'The Bubble', 'retired': True, 'id': 281066, 'state': 'IL', 'availability': ' Limited (brewed once)', 'brewery_id': 18006}&gt; 

Node Type: BREWERIES, Property: notes, Missing Count: 85
Node Type: BREWERIES, Property: state, Missing Count: 11271
Example Node: &lt;Node element_id='11865' labels=frozenset({'BREWERIES'}) properties={'types': 'Brewery', 'notes': 'No notes at this time.', 'name': 'Brouwerij Danny', 'id': 19730}&gt; 

Node Type: CITIES, Property: name, Missing Count: 1
Example Node: &lt;Node element_id='656' labels=frozenset({'CITIES'}) properties={}&gt; 

Node Type: COUNTRIES, Property: name, Missing Count: 1
Example Node: &lt;Node element_id='133' labels=frozenset({'COUNTRIES'}) properties={}&gt; 

Node Type: REVIEWS, Property: beer_id, Missing Count: 19
Node Type: REVIEWS, Property: date, Missing Count: 19
Node Type: REVIEWS, Property: feel, Missing Count: 1060502
Node Type: REVIEWS, Property: id, Missing Count: 19
Node Type: REVIEWS, Property: look, Missing Count: 1060502
Node Type: REVIEWS, Property: overall, Missing Count: 1060502
Node Type: REVIEWS, Property: score, Missing Count: 19
Node Type: REVIEWS, Property: smell, Missing Count: 1060502
Node Type: REVIEWS, Property: taste, Missing Count: 1060502
Node Type: REVIEWS, Property: text, Missing Count: 19
Example Node: &lt;Node element_id='921375' labels=frozenset() properties={}&gt; 

Node Type: STYLE, Property: name, Missing Count: 1
Example Node: &lt;Node element_id='9494325' labels=frozenset({'STYLE'}) properties={}&gt; 

Node Type: USER, Property: name, Missing Count: 1
Example Node: &lt;Node element_id='9502520' labels=frozenset({'USER'}) properties={}&gt; 

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>As we can see from the output above all the properties with missing values that we removed in the removal step are still present in the nodes. *<strong>Does this mean that our process was unsuccessful?</strong>*<ul>
<li>No because when remove from a node due to missing values, that property will no longer exist in that node. However, when we check for missing values in the property, it will still appear as "missing" because it no longer exists in those nodes.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [111]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check one node of the label BEERS to see if the property abv was removed</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WHERE b.abv IS NULL</span>
<span class="s2">    RETURN b</span>
<span class="s2">    LIMIT 1</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record b=&lt;Node element_id='62233' labels=frozenset({'BEERS'}) properties={'notes': 'No notes at this time.', 'name': 'Cerveza India', 'retired': True, 'id': 15645, 'brewery_id': 846, 'availability': ' Year-round'}&gt;&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="2.5.-%F0%9F%93%8A-Change-Schema"><strong>2.5. 📊 Change Schema</strong><a class="anchor-link" href="#2.5.-%F0%9F%93%8A-Change-Schema">¶</a></h3><p>In this section, we will change the schema of the database to make it more efficient and to better represent the relationships between the nodes.</p>
<p><strong>Questions</strong>:</p>
<p>Based on the analysis of the database, we still have some questions that need to be answered:</p>
<ul>
<li>One <code>USER</code> can write multiple <code>REVIEWS</code>?</li>
<li>One <code>REVIEW</code> can be written by multiple <code>USER</code>?</li>
<li>One <code>REVIEW</code> can be about multiple <code>BEER</code>?</li>
<li>One <code>BEER</code> can have multiple <code>STYLE</code>?</li>
<li>Each <code>BREWERY.state</code> has the same values as <code>BEER.state</code>?</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [112]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'One `USER` can write multiple `REVIEWS`'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (u:USER)&lt;-[:POSTED]-(r:REVIEWS)</span>
<span class="s2">    WITH u, count(r) AS reviewCount</span>
<span class="s2">    WHERE reviewCount &gt; 1</span>
<span class="s2">    RETURN count(u) AS totalUsersWithMultipleReviews</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalUsersWithMultipleReviews=67818&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We have <strong>$67\;818$ users that wrote multiple reviews</strong>.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [113]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'One `USER` can write multiple `REVIEWS` for the same `BEER`'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (u:USER)&lt;-[:POSTED]-(r:REVIEWS)&lt;-[:REVIEWED]-(b:BEERS)</span>
<span class="s2">    WITH u, b, count(r) AS reviewCount</span>
<span class="s2">    WHERE reviewCount &gt; 1</span>
<span class="s2">    RETURN count(u) AS totalUsersWithMultipleReviewsForSameBeer</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalUsersWithMultipleReviewsForSameBeer=140&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We have <strong>$140$ users that wrote multiple reviews for the same beer</strong>.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [114]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'One `REVIEW` can be written by multiple `USER`'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (u:USER)&lt;-[:POSTED]-(r:REVIEWS)</span>
<span class="s2">    WITH r, count(u) AS userCount</span>
<span class="s2">    WHERE userCount &gt; 1</span>
<span class="s2">    RETURN count(r) AS totalReviewsWithMultipleUsers</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalReviewsWithMultipleUsers=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We don't have <strong>the same review written by multiple users</strong>.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [115]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'One `REVIEW` can be about multiple `BEER`'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)&lt;-[:REVIEWED]-(b:BEERS)</span>
<span class="s2">    WITH r, count(b) AS beerCount</span>
<span class="s2">    WHERE beerCount &gt; 1</span>
<span class="s2">    RETURN count(r) AS totalReviewsWithMultipleBeers</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalReviewsWithMultipleBeers=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We don't have <strong>the same review reviewing multiple beers</strong>.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [116]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'One `BEER` can have multiple `STYLE`'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">    WITH b, count(s) AS styleCount</span>
<span class="s2">    WHERE styleCount &gt; 1</span>
<span class="s2">    RETURN count(b) AS totalBeersWithMultipleStyles</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBeersWithMultipleStyles=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>We don't have <strong>the same beer with multiple styles</strong>.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Schema-Adjustments-Considerations"><strong>Schema Adjustments Considerations</strong><a class="anchor-link" href="#Schema-Adjustments-Considerations">¶</a></h4><h5 id="Dealing-with-REVIEWS-label"><strong>Dealing with <code>REVIEWS</code> label</strong><a class="anchor-link" href="#Dealing-with-REVIEWS-label">¶</a></h5><blockquote>
<p>After these considerations and verifications, we will create a new relationship between <code>USER</code> and <code>BEER</code> nodes, called <strong><code>RATED</code></strong>.</p>
</blockquote>
<p>This relationship aims to create a shorter path between <strong><code>USER</code></strong> and <strong><code>BEER</code></strong> nodes, reducing the current 2-hop path (<code>USER -[:POSTED]-&gt; REVIEWS -[:REVIEWED]-&gt; BEER</code>) to a single hop. We will merge <code>REVIEWS</code> nodes in the <code>USER</code> and <code>BEER</code> nodes, creating a direct <code>USER -[:RATED]-&gt; BEERS</code> relationship with <strong>review properties</strong> (<code>score</code>, <code>date</code>, etc.) as relationship properties (So instead of having a node label called <code>REVIEWS</code>, we now have a relationship with the properties from this node, therefore, reducing a node in between <strong><code>USER</code></strong> and <strong><code>BEER</code></strong>). This change will make subsequent queries — such as finding beers REVIEWED by a user or simplified queries like <em>Which beers has a user reviewed?</em> — more efficient and performant by minimizing traversals across the $2.5M$ <strong><code>REVIEWS</code></strong> nodes.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><strong>For Comparison:</strong></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [117]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Before Optimization (Using the Longer Path)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    PROFILE</span>
<span class="s2">    MATCH (u:USER)&lt;-[:POSTED]-(r:REVIEWS)&lt;-[:REVIEWED]-(b:BEERS)</span>
<span class="s2">    RETURN COUNT(*)</span>
<span class="s2">    LIMIT 1000</span>
<span class="s2">"""</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>                                <span class="c1"># Start timer</span>
<span class="n">result_before</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">time_before</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>                  <span class="c1"># Calculate execution time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Before Optimization: </span><span class="si">{</span><span class="n">result_before</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> (Execution Time: </span><span class="si">{</span><span class="n">time_before</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Before Optimization: &lt;Record COUNT(*)=2537991&gt; (Execution Time: 410.36 seconds)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Now implementing changes mentioned above:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [118]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1: Count total REVIEWS for verification</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    RETURN count(r) AS totalReviews</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">total_reviews</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'totalReviews'</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total REVIEWS before processing: </span><span class="si">{</span><span class="n">total_reviews</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>             <span class="c1"># 2_538_063 - 19 (nodes without relations) = 2_538_044</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Total REVIEWS before processing: 2538063
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [119]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 2: Create RATED relationship and delete REVIEWS in batches using CALL {} IN TRANSACTIONS</span>
    
<span class="c1"># Source: https://neo4j.com/docs/cypher-manual/current/clauses/merge/#merge-merge-on-a-relationship</span>
<span class="c1">#         https://neo4j.com/docs/cypher-manual/current/functions/scalar/#functions-coalesce</span>
<span class="c1">#         https://neo4j.com/developer/kb/large-delete-transaction-best-practices-in-neo4j/</span>

<span class="k">def</span> <span class="nf">execute_write_implicit</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Execute a query in an implicit transaction using session.run().</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - driver: Neo4j driver instance.</span>
<span class="sd">    - query: String, the Cypher query to execute.</span>
<span class="sd">    Returns:</span>
<span class="sd">    - Result of the query.</span>
<span class="sd">    """</span>
    <span class="k">with</span> <span class="n">driver</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">"neo4j"</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="c1"># Consume the result and return the first record</span>
        <span class="n">records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">records</span> <span class="k">else</span> <span class="p">{}</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        // Match all REVIEW paths</span>
<span class="s2">        MATCH (u:USER)&lt;-[:POSTED]-(r:REVIEWS)&lt;-[:REVIEWED]-(b:BEERS)</span>
<span class="s2">        CALL {</span>
<span class="s2">            // Process each path in batches of 10,000 rows</span>
<span class="s2">            WITH u, r, b</span>
<span class="s2">            </span>
<span class="s2">            // Create the RATED relationship</span>
<span class="s2">            MERGE (u)-[rev:RATED]-&gt;(b)</span>
<span class="s2">            </span>
<span class="s2">            // Set properties conditionally only if they exist and are not null</span>
<span class="s2">            SET</span>
<span class="s2">                rev.id = COALESCE(r.id, rev.id),</span>
<span class="s2">                rev.beer_id = COALESCE(r.beer_id, rev.beer_id),</span>
<span class="s2">                rev.date = COALESCE(r.date, rev.date),</span>
<span class="s2">                rev.feel = COALESCE(r.feel, rev.feel),</span>
<span class="s2">                rev.look = COALESCE(r.look, rev.look),</span>
<span class="s2">                rev.overall = COALESCE(r.overall, rev.overall),</span>
<span class="s2">                rev.score = COALESCE(r.score, rev.score),</span>
<span class="s2">                rev.smell = COALESCE(r.smell, rev.smell),</span>
<span class="s2">                rev.taste = COALESCE(r.taste, rev.taste),</span>
<span class="s2">                rev.text = COALESCE(r.text, rev.text)</span>
<span class="s2">            </span>
<span class="s2">            // Count the number of RATED relationships created</span>
<span class="s2">            RETURN count(rev) AS createdRelationships</span>
<span class="s2">            </span>
<span class="s2">        } IN TRANSACTIONS OF 10000 ROWS</span>
<span class="s2">        </span>
<span class="s2">        // Aggregate totals across all transactions</span>
<span class="s2">        RETURN sum(createdRelationships) AS totalCreated</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_write_implicit</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">total_processed</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">'totalCreated'</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total RATED relationships created: </span><span class="si">{</span><span class="n">total_processed</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error during transaction: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>                             <span class="c1">## Time of Execution: 47min 32s</span>

<span class="c1">## Total RATED relationships created: 2537991 == Number of REVIEWED relationships 2537991</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Total RATED relationships created: 2537991
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [120]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 2.0.: Check how many REVIEWS are not connected to BEER</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)-[:POSTED]-&gt;(u:USER)</span>
<span class="s2">    WHERE NOT (r)&lt;-[:REVIEWED]-(:BEERS)</span>
<span class="s2">    RETURN count(r) AS totalReviewsNotConnectedToBeer</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1">## [&lt;Record totalReviewsNotConnectedToBeer=53&gt;] - There are 53 REVIEW nodes not connected to BEER nodes</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: Coercion of list to boolean is deprecated. Please consider using `NOT isEmpty(...)` instead.} {position: line: 3, column: 19, offset: 57} for query: '\n    MATCH (r:REVIEWS)-[:POSTED]-&gt;(u:USER)\n    WHERE NOT (r)&lt;-[:REVIEWED]-(:BEERS)\n    RETURN count(r) AS totalReviewsNotConnectedToBeer\n'
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalReviewsNotConnectedToBeer=53&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>The difference between the <strong><code>RATED</code></strong> relationships ($2\;537\;991$) created and the <strong><code>REVIEWS</code></strong> before processing ($2\;538\;063$) is due to having <strong><code>REVIEWS</code></strong> that are not connected to any <strong><code>BEER</code></strong>, which corresponds to <strong>53 nodes</strong>, with the added <strong>19 orphan <code>REVIEWS</code> nodes</strong> that we were not able to remove before.</li>
</ul>
$$ 2\;538\;063 - 2\;537\;991 = 72  \;\; \Leftrightarrow \;\;  (53+19=72)$$
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [121]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 2.1.: Check if the RATED relationships were created correctly</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (u:USER)-[r:RATED]-&gt;(b:BEERS)</span>
<span class="s2">    RETURN r</span>
<span class="s2">    LIMIT 1</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record r=&lt;Relationship element_id='762' nodes=(&lt;Node element_id='9494326' labels=frozenset() properties={}&gt;, &lt;Node element_id='138164' labels=frozenset() properties={}&gt;) type='RATED' properties={'date': neo4j.time.Date(2009, 7, 18), 'score': 4.3, 'taste': 4.5, 'overall': 4.5, 'feel': 4.0, 'beer_id': 2557, 'text': "\xa0\xa0 750 ml capped and corked bottle, cork says bottled in 2008. Served in a snifter, the beer pours a reddish/pink color with about a 1/2 inch pink head. Head retention is very good, lacing is decent. Aroma is mostly tart and sweet raspberries, but there's some funk in there too. The taste is pretty much the same as the aroma, except that the tart and sweet raspberries and funk are all pretty balanced with no one flavor overpowering the others. There's also a nice lingering tartness. Mouthfeel/body is medium, it's a bit thick and is well carbonated. Drinkability is pretty good, it's refreshing and it's very easy and enjoyable to drink. Overall I think this is a pretty good beer, it's a good example of what a fruit lambic should be. \xa0", 'id': 3498192, 'smell': 4.0, 'look': 4.0}&gt;&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<blockquote>
</blockquote>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [123]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># This code chunk refers to our trial of removing the REVIEWS nodes and relationships POSTED and REVIEWED, using a batch approach.</span>

<span class="c1"># Step 3: Delete REVIEWS nodes in batches using CALL {} IN TRANSACTIONS and count deletions </span>
<span class="c1"># try:</span>
<span class="c1">#     query = """</span>
<span class="c1">#         // Match all REVIEWS nodes</span>
<span class="c1">#         MATCH (r:REVIEWS)</span>
        
<span class="c1">#         // Delete REVIEWS nodes in batches of 10,000 rows</span>
<span class="c1">#         CALL {</span>
<span class="c1">#             WITH r</span>
<span class="c1">#             // Delete the REVIEW node and its relationships</span>
<span class="c1">#             DETACH DELETE r</span>
<span class="c1">#             // Count the number of deleted REVIEWS nodes</span>
<span class="c1">#             RETURN count(r) AS deletedReviews</span>
<span class="c1">#         } IN TRANSACTIONS OF 10000 ROWS</span>
        
<span class="c1">#         // Aggregate totals across all transactions</span>
<span class="c1">#         RETURN sum(deletedReviews) AS totalDeleted</span>
<span class="c1">#     """</span>
<span class="c1">#     result = execute_write_implicit(driver, query)</span>
<span class="c1">#     total_deleted = result['totalDeleted']</span>
<span class="c1">#     print(f"Total REVIEWS deleted: {total_deleted}")</span>
<span class="c1"># except Exception as e:</span>
<span class="c1">#     print(f"Error during REVIEWS deletion: {e}")</span>
    
<span class="c1">## After deleting 2538063 - 2418063 = 120,000 REVIEWS nodes:</span>
<span class="c1">## Error during REVIEWS deletion: {code: Neo.DatabaseError.Statement.ExecutionFailed} {message: Unable to complete transaction.}</span>

<span class="c1"># Source: https://neo4j.com/developer/kb/large-delete-transaction-best-practices-in-neo4j/</span>
<span class="c1"># For nodes with many relationships or widely varying degrees of nodes a single DETACH DELETE can still exceed the transaction heap boundaries. </span>
<span class="c1"># In these cases it’s better to delete the relationships first and then the nodes in batches. Here is an example for Neo4j 4.4.x and later</span>

<span class="c1"># # Step 3.1.: Try first deleting the relationships and then the nodes in batches (only BEERS - "REVIEWED" -&gt; REVIEWS)</span>
<span class="c1"># total_relationships_deleted = 0</span>
<span class="c1"># try:</span>
<span class="c1">#     query = """</span>
<span class="c1">#         // Match all relationships of REVIEWS nodes</span>
<span class="c1">#         MATCH (b:BEERS)-[rel:REVIEWED]-&gt;(r:REVIEWS)</span>
<span class="c1">#         CALL {</span>
<span class="c1">#             WITH rel</span>
<span class="c1">#             // Delete the relationship</span>
<span class="c1">#             DELETE rel</span>
<span class="c1">#             // Count the number of deleted relationships</span>
<span class="c1">#             RETURN count(rel) AS deletedRels</span>
<span class="c1">#         } IN TRANSACTIONS OF 10000 ROWS</span>
<span class="c1">#         // Aggregate totals across all transactions</span>
<span class="c1">#         RETURN sum(deletedRels) AS totalDeletedRels</span>
<span class="c1">#     """</span>
<span class="c1">#     result = execute_write_implicit(driver, query)</span>
<span class="c1">#     total_relationships_deleted = result['totalDeletedRels']</span>
<span class="c1">#     print(f"Total relationships (REVIEWED) deleted: {total_relationships_deleted}")</span>
<span class="c1"># except Exception as e:</span>
<span class="c1">#     print(f"Error during relationship deletion: {e}")</span>

<span class="c1"># # Error during relationship deletion: {code: Neo.DatabaseError.Statement.ExecutionFailed} {message: Unable to complete transaction.} </span>
<span class="c1"># # Remaining REVIEWED relationships: 53000</span>

<span class="c1"># # Step 3.2.: Deleting the relationships and then the nodes in batches (REVIEWS - "POSTED" -&gt; USER)</span>
<span class="c1"># total_relationships_deleted = 0</span>
<span class="c1"># try:</span>
<span class="c1">#     query = """</span>
<span class="c1">#         // Match all relationships of REVIEWS nodes</span>
<span class="c1">#         MATCH (u:USER)&lt;-[rel:POSTED]-(r:REVIEWS)</span>
<span class="c1">#         CALL {</span>
<span class="c1">#             WITH rel</span>
<span class="c1">#             // Delete the relationship</span>
<span class="c1">#             DELETE rel</span>
<span class="c1">#             // Count the number of deleted relationships</span>
<span class="c1">#             RETURN count(rel) AS deletedRels</span>
<span class="c1">#         } IN TRANSACTIONS OF 10000 ROWS</span>
<span class="c1">#         // Aggregate totals across all transactions</span>
<span class="c1">#         RETURN sum(deletedRels) AS totalDeletedRels</span>
<span class="c1">#     """</span>
<span class="c1">#     result = execute_write_implicit(driver, query)</span>
<span class="c1">#     total_relationships_deleted = result['totalDeletedRels']</span>
<span class="c1">#     print(f"Total relationships (POSTED) deleted: {total_relationships_deleted}")</span>
<span class="c1"># except Exception as e:</span>
<span class="c1">#     print(f"Error during relationship deletion: {e}")</span>
    
<span class="c1"># ## Total relationships (POSTED) deleted: 2413044</span>
    
<span class="c1"># # Step 3.3.: Deleting the REVIEWS nodes in batches (only nodes without relationships)</span>
<span class="c1"># total_deleted = 0</span>
<span class="c1"># try:</span>
<span class="c1">#     query = """</span>
<span class="c1">#         // Match all REVIEWS nodes without relationships</span>
<span class="c1">#         MATCH (r:REVIEWS)</span>
<span class="c1">#         WHERE NOT (r)-[]-()</span>
<span class="c1">#         CALL {</span>
<span class="c1">#             WITH r</span>
<span class="c1">#             // Delete the REVIEW node (no relationships to detach)</span>
<span class="c1">#             DELETE r</span>
<span class="c1">#             // Count the number of deleted REVIEWS nodes</span>
<span class="c1">#             RETURN count(r) AS deletedReviews</span>
<span class="c1">#         } IN TRANSACTIONS OF 10000 ROWS</span>
<span class="c1">#         // Aggregate totals across all transactions</span>
<span class="c1">#         RETURN sum(deletedReviews) AS totalDeleted</span>
<span class="c1">#     """</span>
<span class="c1">#     result = execute_write_implicit(driver, query)</span>
<span class="c1">#     total_deleted = result['totalDeleted']</span>
<span class="c1">#     print(f"Total REVIEWS deleted: {total_deleted}")</span>
<span class="c1"># except Exception as e:</span>
<span class="c1">#     print(f"Error during REVIEWS deletion: {e}")</span>
    
<span class="c1"># ## Total REVIEWS deleted: 2_490_072 ( only REVIEWS nodes without relationships)</span>

<span class="c1"># # Step 3.4.: Deleting the REVIEWS nodes in batches (only nodes with relationships)</span>
<span class="c1"># total_deleted = 0</span>
<span class="c1"># try:</span>
<span class="c1">#     query = """</span>
<span class="c1">#         // Match all REVIEWS nodes with relationships</span>
<span class="c1">#         MATCH (r:REVIEWS)</span>
<span class="c1">#         WHERE (r)-[]-()</span>
<span class="c1">#         CALL {</span>
<span class="c1">#             WITH r</span>
<span class="c1">#             // Delete the REVIEW node and its relationships</span>
<span class="c1">#             DETACH DELETE r</span>
<span class="c1">#             // Count the number of deleted REVIEWS nodes</span>
<span class="c1">#             RETURN count(r) AS deletedReviews</span>
<span class="c1">#         } IN TRANSACTIONS OF 10000 ROWS</span>
<span class="c1">#         // Aggregate totals across all transactions</span>
<span class="c1">#         RETURN sum(deletedReviews) AS totalDeleted</span>
<span class="c1">#     """</span>
<span class="c1">#     result = execute_write_implicit(driver, query)</span>
<span class="c1">#     total_deleted = result['totalDeleted']</span>
<span class="c1">#     print(f"Total REVIEWS deleted: {total_deleted}")</span>
<span class="c1"># except Exception as e:</span>
<span class="c1">#     print(f"Error during REVIEWS deletion: {e}")</span>
    
<span class="c1"># ## Error during REVIEWS deletion: {code: Neo.DatabaseError.Statement.ExecutionFailed} {message: Unable to complete transaction.}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [124]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 4: Verify if all REVIEWS nodes were deleted</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (r:REVIEWS)</span>
<span class="s2">    RETURN count(r) AS totalReviews</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalReviews=48010&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [125]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 5: Check for remaining REVIEWS nodes</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        MATCH (r:REVIEWS)</span>
<span class="s2">        RETURN count(r) AS remainingReviews</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">remaining_reviews</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'remainingReviews'</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Remaining REVIEWS nodes after deletion: </span><span class="si">{</span><span class="n">remaining_reviews</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error checking remaining REVIEWS nodes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Remaining REVIEWS nodes after deletion: 48010
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [126]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the relationships created</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (u:USER)-[r:RATED]-&gt;(b:BEERS)</span>
<span class="s2">    RETURN count(r) AS totalRatings</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalRatings=2537753&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [127]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># After Optimization (Using Shortcut Relationship)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    PROFILE</span>
<span class="s2">    MATCH (u:USER)-[r:RATED]-&gt;(b:BEERS)</span>
<span class="s2">    RETURN COUNT(r)</span>
<span class="s2">"""</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  <span class="c1"># Start timer</span>
<span class="n">result_after</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">time_after</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>  <span class="c1"># Calculate execution time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"After Optimization: </span><span class="si">{</span><span class="n">result_after</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> (Execution Time: </span><span class="si">{</span><span class="n">time_after</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds)"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>After Optimization: &lt;Record COUNT(r)=2537753&gt; (Execution Time: 1.18 seconds)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><p>The query after optimization was faster and we were able to reduce from $410.36$ seconds to $1.18$ seconds. Therefore, we were successful in optimizing the database.</p>
</li>
<li><p>Regarding the difference in the number of relationships created, since applying this change in the dataset, we suggest that it may be related to the problem of not being able to delete the <strong><code>REVIEWS</code></strong> nodes completely. This may be also a consequence of how the database was created.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Additional-considerations-regarding-data-base-structure-changes"><strong>Additional considerations regarding data base structure changes</strong><a class="anchor-link" href="#Additional-considerations-regarding-data-base-structure-changes">¶</a></h5><p><strong>1. Possibility of converting labels to properties</strong></p>
<ul>
<li>During the analysis of the database structure, we noted some labels that could potentially be reduced to a property in another label. In particularly, transforming the label <strong><code>STYLE</code></strong> into a <strong><code>BEER</code></strong> property.</li>
<li>As each <strong><code>BEER</code></strong> only has a single <strong><code>STYLE</code></strong> and there are no orphaned STYLE nodes, applying this change would provide a few advantages like the simplification of the database, allow for faster querying and reduce redundancy. Additionally, it would allow us to take full advantage of the flexibility provided by the NEO4J graph database.</li>
<li>However, after considering the cons associated with this transformation, we decided against it. The main reason being that this change would pose a challenge to the application of graph algorithms as many of these require explicit node relationships for the graph projection.</li>
<li>Hence implementing this type of changes could make it harder to run the graph algorithms required to answer the questions posed by the business in the component 5 of the assignment.</li>
</ul>
<p><strong>2. Possibility of converting properties to labels</strong></p>
<ul>
<li>We also considered the possibility of converting some properties into labels. For example, the <strong>state</strong> property of the <strong><code>BEER</code></strong> label could be converted into a label.</li>
<li>However, this change would not be beneficial for the business as it would not provide any advantages in terms of query performance or graph algorithms considering the questions asked by the business in the components 5 or 3 of the assignment.</li>
<li>Hence implementing these changes would increase graph complexity while potentially leading to redundant relationships.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Dealing-with-the-STATE-property"><strong>Dealing with the <code>STATE</code> property</strong><a class="anchor-link" href="#Dealing-with-the-STATE-property">¶</a></h5>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Now we will perform a few quality checks.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [128]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'Every `BREWERIES` has only 1 `COUNTRY` associated with it'</span>
<span class="c1"># Useful to see if there are BREWERIES with the same name for cities in multiple countries</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BREWERIES)-[:IN]-&gt;(c:CITIES)-[:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    WITH b, count(co) AS countryCount</span>
<span class="s2">    WHERE countryCount &gt; 1</span>
<span class="s2">    RETURN count(b) AS totalBreweriesWithMultipleCountries, collect(b.name)[0..2] AS breweriesWithMultipleCountries</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBreweriesWithMultipleCountries=6700 breweriesWithMultipleCountries=['Les Bières Du Chat Noir', "Ceven'ale"]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [129]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'Every `BREWERIES` has only 1 `CITY` associated with it'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BREWERIES)-[:IN]-&gt;(c:CITIES)</span>
<span class="s2">    WITH b, count(c) AS cityCount</span>
<span class="s2">    WHERE cityCount &gt; 1</span>
<span class="s2">    RETURN count(b) AS totalBreweriesWithMultipleCities, collect(b.name)[0..2] AS breweriesWithMultipleCities</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBreweriesWithMultipleCities=0 breweriesWithMultipleCities=[]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [130]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'Every `CITIES` has only 1 `COUNTRY` associated with it'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(c2:COUNTRIES)</span>
<span class="s2">    WITH c, count(c2) AS countryCount</span>
<span class="s2">    WHERE countryCount &gt; 1</span>
<span class="s2">    RETURN count(c) AS totalCitiesWithMultipleCountries, collect(c.name)[0..2] AS citiesWithMultipleCountries</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalCitiesWithMultipleCountries=344 citiesWithMultipleCountries=['Rosières', 'Nieuwpoort']&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [131]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'Every `CITIES` has only 1 `COUNTRY` associated with it' (Without None)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    WITH c, count(co) AS countryCount, co</span>
<span class="s2">    WHERE countryCount &gt; 1 AND co.name IS NOT NULL</span>
<span class="s2">    RETURN count(c) AS totalCitiesWithMultipleCountries, collect(c.name)[0..2] AS citiesWithMultipleCountries</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalCitiesWithMultipleCountries=0 citiesWithMultipleCountries=[]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [132]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1: Count total BREWERIES for verification</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BREWERIES)</span>
<span class="s2">    RETURN count(b) AS totalBreweries</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">total_breweries</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'totalBreweries'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total BREWERIES before processing: </span><span class="si">{</span><span class="n">total_breweries</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>                                        <span class="c1"># Output: 50_347</span>


<span class="c1"># Count the number of COUNTRIES nodes with a BREWERIES relationship</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Count the number of COUNTRIES nodes with a BREWERIES relationship</span>
<span class="s2">    MATCH (c:COUNTRIES)&lt;-[:IN]-(:CITIES)&lt;-[:IN]-(:BREWERIES)</span>
<span class="s2">    RETURN COUNT(c) AS totalCountriesWithBreweries</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total COUNTRIES with BREWERIES relationship: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'totalCountriesWithBreweries'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>     <span class="c1"># Output: 59_796 - 50_347 = 9_449 </span>
                                                                                                      <span class="c1"># (BREWERIES with more than 1 CITY - more than 1 COUNTRY)</span>
                                                                                                      
<span class="c1"># Count the number of COUNTRIES nodes with a CITIES relationship</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Count the number of COUNTRIES nodes with a CITIES relationship</span>
<span class="s2">    MATCH (c:COUNTRIES)&lt;-[:IN]-(:CITIES)</span>
<span class="s2">    RETURN COUNT(c) AS totalCountriesWithCities</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total COUNTRIES with CITIES relationship: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'totalCountriesWithCities'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>           <span class="c1"># Output: 12077                                                                                                    </span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Total BREWERIES before processing: 50347
Total COUNTRIES with BREWERIES relationship: 59796
Total COUNTRIES with CITIES relationship: 12077
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><p>We considered the possibility of removing the <strong><code>state</code></strong> property from <strong><code>BEERS</code></strong> and also removing it from <strong><code>BREWERIES</code></strong>, placing it as a property of the <strong><code>IN</code></strong> relationship that connects <strong><code>CITIES</code></strong> to <strong><code>COUNTRIES</code></strong> (as we will check in the next queries).</p>
<ul>
<li><p>However, this alternative was not viable as it would result in a loss of information, since there are cities with the same name that belong to different countries, as can be seen in the example below.</p>
</li>
<li><p>Therefore, when trying to find the location of a <strong><code>BREWERY</code></strong>/<strong><code>BEER</code></strong>, it would not be possible to determine which of these two cases it would refer to.</p>
</li>
</ul>
</li>
</ul>
<br/>
<p>Running the following query:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to find cities with the same name but in different countries</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(co:COUNTRIES) </span>
<span class="s2">    WITH c, collect(co.name) AS countries </span>
<span class="s2">    WHERE size(countries) &gt; 1 </span>
<span class="s2">    RETURN c.name AS City, countries </span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record City='Brakel' countries=['BE', 'DE']&gt;,
 &lt;Record City='Linden' countries=['BE', 'US']&gt;,
 &lt;Record City=None countries=['BE', 'US', 'AU', 'IT', 'FR', 'ES', 'RU', 'CZ', 'NZ', 'BR', 'UA', 'IE', 'KY', 'SG', 'LT', 'CR', 'ET', 'CU']&gt;,
 &lt;Record City='Nieuwpoort' countries=['BE', 'NL']&gt;,
 &lt;Record City='Essen' countries=['BE', 'DE']&gt;,
 &lt;Record City='Charleroi' countries=['BE', 'US']&gt;,
 &lt;Record City='Halle' countries=['BE', 'DE']&gt;,
 &lt;Record City='Beloeil' countries=['BE', 'CA']&gt;,
 &lt;Record City='Nazareth' countries=['BE', 'US']&gt;,
 &lt;Record City='Waterloo' countries=['BE', 'US', 'CA']&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>We get the following result:</p>
<pre><code>"Waterloo" → ["BE", "US", "CA"]
```	

These cities are distinct: one is in **Belgium**, another in the **USA**, and another in **Canada**, all sharing the same name.&lt;br&gt;

And also:
</code></pre>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to find BEERS name and state brewed in Waterloo, US</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    WHERE c.name = "Waterloo" AND co.name = "US"</span>
<span class="s2">    MATCH (br:BREWERIES)-[:IN]-&gt;(c)</span>
<span class="s2">    MATCH (br)-[:BREWED]-&gt;(b:BEERS)</span>
<span class="s2">    RETURN b.name AS BeerName, b.state AS BeerState</span>
<span class="s2">    SKIP 250 LIMIT 1</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record BeerName='Blueberry Wheat' BeerState='IL'&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>We get this result:</p>
<pre><code>[&lt;Record BeerName='Blueberry Wheat' BeerState='IL'&gt;]
</code></pre>
<p>And for the following query:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to find the first beer brewed in Waterloo, CA</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    WHERE c.name = "Waterloo" AND co.name = "CA"</span>
<span class="s2">    MATCH (br:BREWERIES)-[:IN]-&gt;(c)</span>
<span class="s2">    MATCH (br)-[:BREWED]-&gt;(b:BEERS)</span>
<span class="s2">    RETURN b.name AS BeerName, b.state AS BeerState</span>
<span class="s2">    LIMIT 1</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record BeerName='Pumpkin Ale' BeerState='ON'&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>We get the result:</p>
<pre><code>[&lt;Record BeerName='Pumpkin Ale' BeerState='ON'&gt;]
</code></pre>
<blockquote>
<p>If the schema were altered as mentioned above, it would not be possible to determine whether the *<strong>Pumpkin Ale</strong>* mentioned here referred to, for example, the <strong><code>BEER</code></strong> from *<strong>Ontario, Canada</strong>* or *<strong>Illinois, USA</strong>*.</p>
</blockquote>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [133]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if `BEERS` have the same state as `BREWERIES`</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Collect distinct states from BEERS (including NULL as a value)</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WITH collect(DISTINCT b.state) AS beerStates</span>

<span class="s2">    // Collect distinct states from BREWERIES (including NULL as a value)</span>
<span class="s2">    MATCH (br:BREWERIES)</span>
<span class="s2">    WITH beerStates, collect(DISTINCT br.state) AS breweryStates</span>

<span class="s2">    // Compare the two sets</span>
<span class="s2">    RETURN </span>
<span class="s2">        // States in BEERS but not in BREWERIES</span>
<span class="s2">        [state IN beerStates WHERE NOT state IN breweryStates] AS onlyInBeers,</span>
<span class="s2">        // States in BREWERIES but not in BEERS</span>
<span class="s2">        [state IN breweryStates WHERE NOT state IN beerStates] AS onlyInBreweries,</span>
<span class="s2">        // States common to both</span>
<span class="s2">        [state IN beerStates WHERE state IN breweryStates] AS commonStates,</span>
<span class="s2">        // Check if the sets are identical</span>
<span class="s2">        size(beerStates) = size(breweryStates) AND size([state IN beerStates WHERE NOT state IN breweryStates]) = 0 AS areIdentical </span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record onlyInBeers=[] onlyInBreweries=[] commonStates=['CA', 'IN', 'WA', 'PA', 'AR', 'SK', 'QC', 'NC', 'NJ', 'MA', 'GA', 'CO', 'SD', 'WI', 'MN', 'IL', 'ON', 'FL', 'NH', 'OH', 'AB', 'GB6', 'NE', 'NY', 'TX', 'OR', 'KS', 'KY', 'LA', 'MI', 'AZ', 'NM', 'DE', 'VA', 'TN', 'MO', 'VT', 'HI', 'PE', 'BC', 'GB2', 'ND', 'DC', 'SC', 'UT', 'WV', 'GB7', 'CT', 'MD', 'NB', 'IA', 'NV', 'OK', 'ID', 'ME', 'NS', 'MT', 'AK', 'AL', 'GB5', 'WY', 'RI', 'MS', 'NL', 'MB', 'YT', 'NT'] areIdentical=True&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [134]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Alternative query to check if `BEERS` have the same state as `BREWERIES`</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (brewery:BREWERIES)-[:BREWED]-&gt;(beer:BEERS)</span>
<span class="s2">    WHERE NOT brewery.state = beer.state</span>
<span class="s2">    RETURN brewery.name AS Brewery, brewery.state AS BreweryState, </span>
<span class="s2">           beer.name AS Beer, beer.state AS BeerState</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>The queries above verify if the property <strong><code>state</code></strong> of <strong><code>BEERS</code></strong> is also a property of <strong><code>BREWERIES</code></strong> and if <strong><code>BEERS</code></strong> have the same state as <strong><code>BREWERIES</code></strong> respectively. We have concluded that all <strong><code>BEERS</code></strong> share the same <strong><code>state</code></strong> as the <strong><code>BREWERIES</code></strong>, so we can remove the <strong><code>state</code></strong> property from the <strong><code>BEERS</code></strong> nodes.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [135]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'Every `BEERS` has only 1 `BREWERIES` associated with it'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)-[:BREWED]-&gt;(br:BREWERIES)</span>
<span class="s2">    WITH b, count(br) AS breweryCount</span>
<span class="s2">    WHERE breweryCount &gt; 1</span>
<span class="s2">    RETURN count(b) AS totalBeersWithMultipleBreweries, collect(b.name)[0..2] AS beersWithMultipleBreweries</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBeersWithMultipleBreweries=0 beersWithMultipleBreweries=[]&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [136]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to check if 'Every `BREWERIES` has only 1 `BEERS` associated with it'</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)</span>
<span class="s2">    WITH br, count(b) AS beerCount</span>
<span class="s2">    WHERE beerCount &gt; 1</span>
<span class="s2">    RETURN count(br) AS totalBreweriesWithMultipleBeers, collect(br.name)[0..2] AS breweriesWithMultipleBeers</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBreweriesWithMultipleBeers=14694 breweriesWithMultipleBeers=['Brouwerij Danny', 'Coachella Valley Brewing Co']&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [137]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Remove the 'state' property from the BEERS nodes (it's redundant with the BREWERIES nodes)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    REMOVE b.state</span>
<span class="s2">    RETURN count(b) AS totalBeersUpdated</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBeersUpdated=358869&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [138]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Verify the changes</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Check if BEERS nodes have the 'state' property</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    WHERE EXISTS(b.state)</span>
<span class="s2">    RETURN count(b) AS totalBeersWithState</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">
<pre>Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: } {title: This feature is deprecated and will be removed in future versions.} {description: The property existence syntax `... exists(variable.property)` is deprecated, please use `variable.property IS NOT NULL` instead} {position: line: 4, column: 11, offset: 85} for query: "\n    // Check if BEERS nodes have the 'state' property\n    MATCH (b:BEERS)\n    WHERE EXISTS(b.state)\n    RETURN count(b) AS totalBeersWithState\n"
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record totalBeersWithState=0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Dealing-with-the-relationship-IN"><strong>Dealing with the relationship <code>IN</code></strong><a class="anchor-link" href="#Dealing-with-the-relationship-IN">¶</a></h5>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Just for clarification, rename the relationship between CITIES and COUNTRIES to BELONGS_TO</span>

<span class="c1"># Step 1: Count existing IN relationships between CITIES and COUNTRIES for verification </span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    RETURN count(*) AS originalInRelationships</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">original_count</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'originalInRelationships'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Original IN relationships between CITIES and COUNTRIES: </span><span class="si">{</span><span class="n">original_count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>                      <span class="c1"># Output: 12_077</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Original IN relationships between CITIES and COUNTRIES: 12077
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [140]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 2: Create new BELONGS_TO relationships and remove old IN relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // Rename the relationship between CITIES and COUNTRIES to BELONGS_TO</span>
<span class="s2">    MATCH (c:CITIES)-[r:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    MERGE (c)-[:BELONGS_TO]-&gt;(co)</span>
<span class="s2">    DELETE r</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [141]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 3: Verify no remaining IN relationships</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:CITIES)-[:IN]-&gt;(co:COUNTRIES)</span>
<span class="s2">    RETURN count(*) AS remainingInRelationships</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">remaining_count</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'remainingInRelationships'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Remaining IN relationships between CITIES and COUNTRIES: </span><span class="si">{</span><span class="n">remaining_count</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Remaining IN relationships between CITIES and COUNTRIES: 0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [142]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 2.5. Visualize the final schema</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    CALL db.schema.visualization()</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Final database schema visualized (node labels and relationships):</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nodes:"</span><span class="p">,</span> <span class="p">[</span><span class="n">record</span><span class="p">[</span><span class="s2">"nodes"</span><span class="p">]</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">result</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Relationships:"</span><span class="p">,</span> <span class="p">[</span><span class="n">record</span><span class="p">[</span><span class="s2">"relationships"</span><span class="p">]</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">result</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Final database schema visualized (node labels and relationships):

Nodes: [&lt;Node element_id='-12' labels=frozenset({'REVIEWS'}) properties={'name': 'REVIEWS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-11' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-8' labels=frozenset({'COUNTRIES'}) properties={'name': 'COUNTRIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-10' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-13' labels=frozenset({'STYLE'}) properties={'name': 'STYLE', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-9' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-14' labels=frozenset({'USER'}) properties={'name': 'USER', 'indexes': ['name'], 'constraints': []}&gt;]
Relationships: [&lt;Relationship element_id='-9' nodes=(&lt;Node element_id='-11' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-12' labels=frozenset({'REVIEWS'}) properties={'name': 'REVIEWS', 'indexes': ['id'], 'constraints': []}&gt;) type='REVIEWED' properties={}&gt;, &lt;Relationship element_id='-10' nodes=(&lt;Node element_id='-10' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-11' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;) type='BREWED' properties={}&gt;, &lt;Relationship element_id='-11' nodes=(&lt;Node element_id='-10' labels=frozenset({'BREWERIES'}) properties={'name': 'BREWERIES', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-9' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;) type='IN' properties={}&gt;, &lt;Relationship element_id='-13' nodes=(&lt;Node element_id='-14' labels=frozenset({'USER'}) properties={'name': 'USER', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-11' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;) type='RATED' properties={}&gt;, &lt;Relationship element_id='-14' nodes=(&lt;Node element_id='-9' labels=frozenset({'CITIES'}) properties={'name': 'CITIES', 'indexes': ['name'], 'constraints': []}&gt;, &lt;Node element_id='-8' labels=frozenset({'COUNTRIES'}) properties={'name': 'COUNTRIES', 'indexes': ['name'], 'constraints': []}&gt;) type='BELONGS_TO' properties={}&gt;, &lt;Relationship element_id='-12' nodes=(&lt;Node element_id='-11' labels=frozenset({'BEERS'}) properties={'name': 'BEERS', 'indexes': ['id'], 'constraints': []}&gt;, &lt;Node element_id='-13' labels=frozenset({'STYLE'}) properties={'name': 'STYLE', 'indexes': ['name'], 'constraints': []}&gt;) type='HAS_STYLE' properties={}&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<center><img alt="No description has been provided for this image" src="./img/graph_afterCleaningEdited.svg" width="1000"/></center>
<center><b>Image 2 | </b> Graph Schema After Cleaning</center><br/><br/>
<ul>
<li>As we can see in the image above, we have a different schema after cleaning the database. We have fewer label ($1$), nodes ($+2.5M$) and relationships ($+2.5M$), which will make the queries more efficient.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="3.-Analytics-department"><strong>3. Analytics department</strong><a class="anchor-link" href="#3.-Analytics-department">¶</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [143]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 3. Analytics department requires the following information for the biweekly reporting: [5 points]</span>
<span class="c1">#    3.1. How many reviews has the beer with the most reviews?</span>

<span class="c1"># OLD: Using the Long Path</span>
<span class="c1"># query = """</span>
<span class="c1">#     MATCH (b:BEERS)-[:REVIEWED]-&gt;(r:REVIEWS)</span>
<span class="c1">#     RETURN b.name AS BeerName, count(r) AS NumberOfReviews</span>
<span class="c1">#     ORDER BY NumberOfReviews DESC</span>
<span class="c1">#     LIMIT 1</span>
<span class="c1"># """</span>
<span class="c1"># result = execute_read(driver, query)</span>

<span class="c1">### The beer with the most reviews is: IPA with 8771 reviews.</span>

<span class="c1"># NEW: Using the Short Path (RATED relationship)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)&lt;-[r:RATED]-(:USER)</span>
<span class="s2">    RETURN b.name AS BeerName, count(r) AS NumberOfReviews</span>
<span class="s2">    ORDER BY NumberOfReviews DESC</span>
<span class="s2">    LIMIT 1</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\033</span><span class="s2">[1mThe beer with the most reviews is:</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"BeerName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"NumberOfReviews"</span><span class="p">],</span> <span class="s2">"reviews."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre><span class="ansi-bold">The beer with the most reviews is:</span> IPA with 8768 reviews.
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [144]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 3.2. Which three users wrote the most reviews about beers?</span>
<span class="c1">#           REVIEWS - POSTED -&gt; USER</span>
<span class="c1">#           BEERS - REVIEWED -&gt; REVIEWS</span>

<span class="c1"># OLD: Using the Long Path</span>
<span class="c1"># query = """</span>
<span class="c1">#     MATCH (r:BEERS)-[:REVIEWED]-&gt;(b:REVIEWS)-[:POSTED]-&gt;(u:USER)</span>
<span class="c1">#     RETURN u.name AS UserName, count(b) AS NumberOfReviews</span>
<span class="c1">#     ORDER BY NumberOfReviews DESC</span>
<span class="c1">#     LIMIT 3</span>
<span class="c1"># """</span>

<span class="c1">### The three users who wrote the most reviews are: </span>
<span class="c1">#  - 1st Sammy with 3756 reviews. </span>
<span class="c1">#  - 2nd acurtis with 3403 reviews. </span>
<span class="c1">#  - 3rd kylehay2004 with 3368 reviews.</span>

<span class="c1"># NEW: Using the Short Path (RATED relationship)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (u:USER)-[r:RATED]-&gt;(:BEERS)</span>
<span class="s2">    RETURN u.name AS UserName, count(r) AS NumberOfReviews</span>
<span class="s2">    ORDER BY NumberOfReviews DESC</span>
<span class="s2">    LIMIT 3</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The three users who wrote the most reviews are:"</span><span class="p">,</span> 
        <span class="s2">"</span><span class="se">\n</span><span class="s2"> - </span><span class="se">\033</span><span class="s2">[1m1st</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"UserName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"NumberOfReviews"</span><span class="p">],</span> <span class="s2">"reviews."</span><span class="p">,</span>
        <span class="s2">"</span><span class="se">\n</span><span class="s2"> - </span><span class="se">\033</span><span class="s2">[1m2nd</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"UserName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"NumberOfReviews"</span><span class="p">],</span> <span class="s2">"reviews."</span><span class="p">,</span>
        <span class="s2">"</span><span class="se">\n</span><span class="s2"> - </span><span class="se">\033</span><span class="s2">[1m3rd</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">"UserName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">"NumberOfReviews"</span><span class="p">],</span> <span class="s2">"reviews."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>The three users who wrote the most reviews are: 
 - <span class="ansi-bold">1st</span> Sammy with 3756 reviews. 
 - <span class="ansi-bold">2nd</span> acurtis with 3403 reviews. 
 - <span class="ansi-bold">3rd</span> kylehay2004 with 3368 reviews.
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [145]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#    3.3. Find all beers that are described with following words: 'fruit', 'complex', 'nutty', 'dark'.</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)</span>
<span class="s2">    </span>
<span class="s2">    // Filter the beers with the given words in the notes property (case-insensitive)</span>
<span class="s2">    WHERE toLower(b.notes) CONTAINS 'fruit' </span>
<span class="s2">         AND toLower(b.notes) CONTAINS 'complex' </span>
<span class="s2">         AND toLower(b.notes) CONTAINS 'nutty' </span>
<span class="s2">         AND toLower(b.notes) CONTAINS 'dark'</span>
<span class="s2">    </span>
<span class="s2">    // Return the beer name and description   </span>
<span class="s2">    RETURN b.name AS BeerName, b.notes AS Description</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Beers described with 'fruit', 'complex', 'nutty', and 'dark':"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">beer</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"-</span><span class="se">\033</span><span class="s2">[1m"</span><span class="p">,</span> <span class="n">beer</span><span class="p">[</span><span class="s2">"BeerName"</span><span class="p">],</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[0m:"</span><span class="p">,</span> <span class="n">beer</span><span class="p">[</span><span class="s2">"Description"</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> In total,"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="s2">"beers found."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Beers described with 'fruit', 'complex', 'nutty', and 'dark':
-<span class="ansi-bold"> Legalize Hemp Ale </span>: We utilized our wood fired oven to toast these hemp seeds, bringing out their nutty aroma and flavor. This toasty nutty aroma hits your nose above the glass, and coats the tongue with the first sip. The subtle but complex maltiness allows the hemp seeds to dominate but supports them with deep golden toffee notes. Finally, the dark fruit and molasses flavors of the Trappist style yeast lead to the finish. This ale was brewed to support the movement to legalize industrial hemp with Proposition 91 coming up for a vote this November. Legalize hemp for food, fuel, and fiber!
-<span class="ansi-bold"> Brother David's Belgian-style Double Ale </span>: Inspired by the classic Dubbels of Belgium, our Brother David’s Double has a dark brown body and aromas of warm cocoa, banana, and cloves. Specialty malts impart a toasted, nutty character and flavors of chocolate-covered cherries and candied fruits, while the subdued hop profile and Abbey yeast create spicy, herbal notes to compliment the warm, slightly sweet finish. Winner of a Gold Medal in the 2011 Great American Beer Festival™, Brother David’s Double is a truly complex and potent ale meant to be savored or shared with friends.

 In total, 2 beers found.
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [147]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#    3.4. Which top three breweries produce the largest variety of beer styles?</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (brewery:BREWERIES)-[:BREWED]-&gt;(beer:BEERS)-[:HAS_STYLE]-&gt;(style:STYLE)</span>
<span class="s2">    RETURN brewery.name AS BreweryName, count(DISTINCT style) AS StyleCount</span>
<span class="s2">    ORDER BY StyleCount DESC</span>
<span class="s2">    LIMIT 3</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The top three breweries with the largest variety of beer styles are:"</span><span class="p">,</span>
      <span class="s2">"</span><span class="se">\n</span><span class="s2"> - </span><span class="se">\033</span><span class="s2">[1m1st</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"BreweryName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"StyleCount"</span><span class="p">],</span> <span class="s2">"styles."</span><span class="p">,</span>
      <span class="s2">"</span><span class="se">\n</span><span class="s2"> - </span><span class="se">\033</span><span class="s2">[1m2nd</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"BreweryName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"StyleCount"</span><span class="p">],</span> <span class="s2">"styles."</span><span class="p">,</span>
      <span class="s2">"</span><span class="se">\n</span><span class="s2"> - </span><span class="se">\033</span><span class="s2">[1m3rd</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">"BreweryName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">"StyleCount"</span><span class="p">],</span> <span class="s2">"styles."</span><span class="p">)</span>

<span class="c1"># The top three breweries with the largest variety of beer styles are: </span>
<span class="c1">#  - 1st Iron Hill Brewery &amp; Restaurant with 94 styles. </span>
<span class="c1">#  - 2nd Rock Bottom Restaurant &amp; Brewery with 93 styles. </span>
<span class="c1">#  - 3rd Goose Island Beer Co. with 88 styles.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>The top three breweries with the largest variety of beer styles are: 
 - <span class="ansi-bold">1st</span> Iron Hill Brewery &amp; Restaurant with 94 styles. 
 - <span class="ansi-bold">2nd</span> Rock Bottom Restaurant &amp; Brewery with 93 styles. 
 - <span class="ansi-bold">3rd</span> Goose Island Beer Co. with 88 styles.
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [151]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#    3.5. Which country produces the most beer styles?</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">    WITH c, count(DISTINCT s) AS NumberOfStyles</span>
<span class="s2">    ORDER BY NumberOfStyles DESC</span>
<span class="s2">    LIMIT 1</span>
<span class="s2">    RETURN c.name AS CountryName, NumberOfStyles</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\033</span><span class="s2">[1mThe country producing the most beer styles is:</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"CountryName"</span><span class="p">],</span> <span class="s2">"with"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"NumberOfStyles"</span><span class="p">],</span> <span class="s2">"styles."</span><span class="p">)</span>

<span class="c1">### The country producing the most beer styles is: US with 113 styles.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre><span class="ansi-bold">The country producing the most beer styles is:</span> US with 113 styles.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="4.-Market-Analysis-department"><strong>4. Market Analysis department</strong><a class="anchor-link" href="#4.-Market-Analysis-department">¶</a></h2><p><strong>🚨 Note:</strong> The following results are influenced by the optimization steps that we have done before (such as dealing with duplicates, missing values).</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [152]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 4. Market Analysis department in your company accesses and updates the trends data on the daily basis. </span>
<span class="c1">#   Given that, consider how you need to optimize the database and its performance so that the following queries are efficient. </span>
<span class="c1">#   Measure performance to communicate your improvements using PROFILE before final query. Answer the following: [4 points]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Function to profile a query and print key performance metrics</span>
<span class="c1"># Source: https://neo4j.com/docs/api/python-driver/current/api.html</span>
<span class="k">def</span> <span class="nf">profile_query</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">driver</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            
            <span class="c1"># Clear the query cache</span>
            <span class="c1"># Source: https://neo4j.com/docs/operations-manual/current/configuration/configuration-settings/#config_db.logs.query.obfuscate_literals</span>
            <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"CALL db.clearQueryCaches()"</span><span class="p">)</span>
            
            <span class="c1"># Profile the query            </span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>  <span class="c1"># Capture query results</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>                  <span class="c1"># Get summary after consuming result</span>
            
            <span class="c1"># Extract all available summary metrics</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">"Description"</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
                <span class="s2">"ExecutionTimeMs"</span><span class="p">:</span> <span class="n">summary</span><span class="o">.</span><span class="n">result_available_after</span><span class="p">,</span>        <span class="c1"># Time to first result (ms)</span>
                <span class="s2">"TotalExecutionTimeMs"</span><span class="p">:</span> <span class="n">summary</span><span class="o">.</span><span class="n">result_consumed_after</span><span class="p">,</span>    <span class="c1"># Total time (ms)</span>
                <span class="s2">"RowsReturned"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>                                 <span class="c1"># Actual rows returned</span>
                <span class="c1"># "NodesCreated": summary.counters.nodes_created,                         # Not needed for read-only queries</span>
                <span class="c1"># "RelationshipsCreated": summary.counters.relationships_created,</span>
                <span class="c1"># "PropertiesSet": summary.counters.properties_set,</span>
                <span class="c1"># "LabelsAdded": summary.counters.labels_added</span>
            <span class="p">}</span>
            
            <span class="c1"># Print the metrics</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">🔹 </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> 🔹"</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Execution Time to First Result (ms): </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'ExecutionTimeMs'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total Execution Time (ms): </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'TotalExecutionTimeMs'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Rows Returned: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'RowsReturned'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="c1"># print(f"Nodes Created: {metrics['NodesCreated']}")</span>
            <span class="c1"># print(f"Relationships Created: {metrics['RelationshipsCreated']}")</span>
            <span class="c1"># print(f"Properties Set: {metrics['PropertiesSet']}")</span>
            <span class="c1"># print(f"Labels Added: {metrics['LabelsAdded']}")</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Note: Detailed PROFILE metrics (e.g., DbHits) are not available via Python driver. Use Neo4j Browser for full plan."</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">data</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error in </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{},</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Function to create a INDEX on a property</span>
<span class="c1"># https://neo4j.com/docs/cypher-manual/current/indexes/search-performance-indexes/managing-indexes/#list-indexes</span>
<span class="k">def</span> <span class="nf">create_index</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="nb">property</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"CREATE INDEX FOR (n:</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">) ON (n.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2">)"</span>  <span class="c1"># If we wanna remove it, see the index name in 'SHOW INDEXES' and 'DROP INDEX index_name' in Neo4j Browser</span>
        <span class="k">with</span> <span class="n">driver</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Index created for </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error creating index for </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>In order to display the <strong>PROFILE</strong> in the python output, we have chosen to use the <code>profile_query()</code> and <code>create_index()</code> functions to replace the chuck of code mentioned above.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#    4.1. Using ABV score, find 5 strongest beers, display their ABV score and the corresponding brewery? </span>
<span class="c1">#          Keep in mind that the strongest known beer is Snake Venom, and deal with the error entries in the database.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to find the 5 strongest beers by ABV score</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // PROFILE the query to find the 5 strongest beers by ABV score</span>
<span class="s2">    PROFILE </span>
<span class="s2">    MATCH (br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)                            // Match BREWERIES that BREWED BEERS</span>
<span class="s2">    WHERE b.abv &gt; 0 AND b.abv &lt;= 67.5 AND b.abv IS NOT NULL              // Filter out invalid ABV values (considering the highest valid ABV value)</span>
<span class="s2">    RETURN b.name AS beerName, b.abv AS abv, br.name AS breweryName      // Return beer name, ABV score, and brewery name</span>
<span class="s2">    ORDER BY b.abv DESC                                                  // Order by ABV score in descending order</span>
<span class="s2">    LIMIT 5                                                              // Limit to the top 5 strongest beers</span>
<span class="s2">"""</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Run before optimization (no index)</span>
<span class="n">before_metrics</span><span class="p">,</span> <span class="n">before_data</span> <span class="o">=</span> <span class="n">profile_query</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="s2">"BEFORE Optimization - Find Strongest Beers"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">1st Results:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">before_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
🔹 BEFORE Optimization - Find Strongest Beers 🔹
Execution Time to First Result (ms): 39
Total Execution Time (ms): 1967
Rows Returned: 5
Note: Detailed PROFILE metrics (e.g., DbHits) are not available via Python driver. Use Neo4j Browser for full plan.

1st Results:
[{'abv': 67.5, 'beerName': 'Snake Venom', 'breweryName': 'Brewmeister'},
 {'abv': 66.0, 'beerName': 'series 3', 'breweryName': 'Redline Brewhouse'},
 {'abv': 65.0, 'beerName': 'Armageddon', 'breweryName': 'Brewmeister'},
 {'abv': 60.0,
  'beerName': 'Start The Future',
  'breweryName': "Brouwerij 't Koelschip"},
 {'abv': 57.5,
  'beerName': 'Schorschbräu Schorschbock 57%',
  'breweryName': 'Schorschbräu'}]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create an index on the 'abv' property of BEERS nodes</span>
<span class="n">create_index</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"BEERS"</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s2">"abv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Index created for BEERS.abv
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Run after optimization (with index)</span>
<span class="n">after_metrics</span><span class="p">,</span> <span class="n">after_data</span> <span class="o">=</span> <span class="n">profile_query</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="s2">"AFTER Optimization - Find Strongest Beers"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">2nd Results:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">after_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
🔹 AFTER Optimization - Find Strongest Beers 🔹
Execution Time to First Result (ms): 35
Total Execution Time (ms): 4
Rows Returned: 5
Note: Detailed PROFILE metrics (e.g., DbHits) are not available via Python driver. Use Neo4j Browser for full plan.

2nd Results:
[{'abv': 67.5, 'beerName': 'Snake Venom', 'breweryName': 'Brewmeister'},
 {'abv': 66.0, 'beerName': 'series 3', 'breweryName': 'Redline Brewhouse'},
 {'abv': 65.0, 'beerName': 'Armageddon', 'breweryName': 'Brewmeister'},
 {'abv': 60.0,
  'beerName': 'Start The Future',
  'breweryName': "Brouwerij 't Koelschip"},
 {'abv': 57.5,
  'beerName': 'Schorschbräu Schorschbock 57%',
  'breweryName': 'Schorschbräu'}]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Print comparison</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">🔻 PERFORMANCE COMPARISON (4.1) 🔻"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">before_metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">"Description"</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">before_metrics</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2"> ➝ </span><span class="si">{</span><span class="n">after_metrics</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

🔻 PERFORMANCE COMPARISON (4.1) 🔻
ExecutionTimeMs: 39 ➝ 35
TotalExecutionTimeMs: 1967 ➝ 4
RowsReturned: 5 ➝ 5
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<center><img alt="No description has been provided for this image" src="./img/PROFILEPlan_4.1.png" width="700"/></center><br/>
<center><b>Image 3 | </b> Profile of the Query 4.1 Before and After Optimization.</center><br/><br/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Optimization-Analysis-of-Query-4.1"><strong>Optimization Analysis of Query 4.1</strong><a class="anchor-link" href="#Optimization-Analysis-of-Query-4.1">¶</a></h4><p>The optimization of query 4.1, which finds the 5 strongest beers by ABV score, shows a clear performance improvement when using the <strong><code>PROFILE</code></strong> command in Neo4j Browser.</p>
<p><strong>Before Optimization:</strong></p>
<ul>
<li>The "before" plan, without an index on <strong><code>b.abv</code></strong>, performed the following:<ul>
<li>Scanned all <strong>$358\;869$ </strong><code>BEERS</code>** nodes** using <code>NodeByLabelScan</code>.</li>
<li>Filtered <strong>$320\;072$ rows</strong> with <strong>$358\;869$ DbHits</strong> (database hits, representing the number of times the database was accessed).</li>
<li>Sorted the results using <strong>$88$MB of memory</strong>, totaling <strong>$717\;739$ DbHits</strong>.</li>
</ul>
</li>
</ul>
<p><strong>After Optimization:</strong></p>
<ul>
<li>After creating the index with <code>CREATE INDEX FOR (b:BEERS) ON (b.abv)</code>, the "after" plan utilized <code>NodeIndexSeekByRange</code>, resulting in:<ul>
<li>Reduced <strong>DbHits to just 31</strong> by directly fetching the top 5 rows in sorted order.</li>
</ul>
</li>
</ul>
<p><strong>Performance Improvement:</strong></p>
<ul>
<li><p>This reduction in DbHits—over <strong>99%</strong>—indicates fewer database accesses, leading to faster query execution.</p>
</li>
<li><p>The impact of indexes on query performance is detailed in Neo4j’s documentation on indexing for search performance <br/> (<strong>Source:</strong> <a href="https://neo4j.com/docs/cypher-manual/current/indexes/search-performance-indexes/using-indexes/#composite-indexes-property-order">https://neo4j.com/docs/cypher-manual/current/indexes/search-performance-indexes/using-indexes/#composite-indexes-property-order</a>).</p>
</li>
<li><p>Performance metrics from the Python script show:</p>
<ul>
<li><strong>ExecutionTimeMs</strong>: Decreased from <strong>39ms</strong> to <strong>35ms</strong> (time to first result).</li>
<li><strong>TotalExecutionTimeMs</strong>: Dropped from <strong>1967ms</strong> to <strong>4ms</strong> (total query time).</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#     4.2. Using the answer from question 2 </span>
<span class="c1">#               find the top 5 distict beer styles with </span>
<span class="c1">#               the highest average score of smell + feel </span>
<span class="c1">#               that were reviewed by the third most productive user. </span>
<span class="c1">#          Keep in mind that cleaning the database earlier should ensure correct results.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define the single query to use for both runs (using the optimized version)</span>
<span class="n">query_2</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    // PROFILE the query to find the top 5 distinct beer styles with the highest average smell + feel score</span>
<span class="s2">    PROFILE</span>
<span class="s2">    MATCH (u:USER {name: 'kylehay2004'})-[r:RATED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)       // Match the third most productive user's ratings of beers with styles</span>
<span class="s2">                                                                                            // named 'kylehay2004' based on 3.2</span>
<span class="s2">    WHERE r.smell IS NOT NULL AND r.feel IS NOT NULL                                        // Filter</span>
<span class="s2">    WITH s.name AS styleName, toFloat(r.smell) + toFloat(r.feel) AS smellFeel               // Calculate the sum of smell and feel scores</span>
<span class="s2">    RETURN styleName, AVG(smellFeel) AS avgSmellFeel                                        // Return the style name and average smell + feel score</span>
<span class="s2">    ORDER BY avgSmellFeel DESC                                                              // Order by the average score in descending order</span>
<span class="s2">    LIMIT 5                                                                                 // Limit to the top 5 styles</span>
<span class="s2">"""</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Run 4.2 before optimization</span>
<span class="n">before_metrics_2</span><span class="p">,</span> <span class="n">before_data_2</span> <span class="o">=</span> <span class="n">profile_query</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query_2</span><span class="p">,</span> <span class="s2">"BEFORE Optimization - Find Top Beer Styles by Smell + Feel"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">1st Results (4.2):"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">before_data_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
🔹 BEFORE Optimization - Find Top Beer Styles by Smell + Feel 🔹
Execution Time to First Result (ms): 50
Total Execution Time (ms): 142
Rows Returned: 5
Note: Detailed PROFILE metrics (e.g., DbHits) are not available via Python driver. Use Neo4j Browser for full plan.

1st Results (4.2):
[{'avgSmellFeel': 8.654761904761909, 'styleName': 'New England IPA'},
 {'avgSmellFeel': 8.546363636363635, 'styleName': 'American Imperial Stout'},
 {'avgSmellFeel': 8.5, 'styleName': 'Bière de Champagne / Bière Brut'},
 {'avgSmellFeel': 8.444444444444445, 'styleName': 'Belgian Fruit Lambic'},
 {'avgSmellFeel': 8.428571428571429, 'styleName': 'Belgian Gueuze'}]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create an index on the 'smell' and 'feel' properties of RATED relationships</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s2">"CREATE INDEX FOR ()-[r:RATED]-() ON (r.smell)"</span><span class="p">)</span>      <span class="c1"># Since RATED is a relationship, we need to create the index with other query</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Index created for RATED.smell"</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error creating index for RATED.smell </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
<span class="k">try</span><span class="p">:</span>
    <span class="n">execute_write</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s2">"CREATE INDEX FOR ()-[r:RATED]-() ON (r.feel)"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Index created for RATED.feel"</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error creating index for RATED.feel </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    
<span class="c1"># Create an index on the 'name' property of STYLE nodes and USER nodes   </span>
<span class="n">create_index</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"STYLE"</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s2">"name"</span><span class="p">)</span>
<span class="n">create_index</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"USER"</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s2">"name"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Index created for RATED.smell
Index created for RATED.feel
Index created for STYLE.name
Index created for USER.name
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Run 4.2 after optimization</span>
<span class="n">after_metrics_2</span><span class="p">,</span> <span class="n">after_data_2</span> <span class="o">=</span> <span class="n">profile_query</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query_2</span><span class="p">,</span> <span class="s2">"AFTER Optimization - Find Top Beer Styles by Smell + Feel"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">2nd Results (4.2):"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">after_data_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
🔹 AFTER Optimization - Find Top Beer Styles by Smell + Feel 🔹
Execution Time to First Result (ms): 91
Total Execution Time (ms): 20
Rows Returned: 5
Note: Detailed PROFILE metrics (e.g., DbHits) are not available via Python driver. Use Neo4j Browser for full plan.

2nd Results (4.2):
[{'avgSmellFeel': 8.654761904761909, 'styleName': 'New England IPA'},
 {'avgSmellFeel': 8.546363636363635, 'styleName': 'American Imperial Stout'},
 {'avgSmellFeel': 8.5, 'styleName': 'Bière de Champagne / Bière Brut'},
 {'avgSmellFeel': 8.444444444444445, 'styleName': 'Belgian Fruit Lambic'},
 {'avgSmellFeel': 8.428571428571429, 'styleName': 'Belgian Gueuze'}]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Print comparison for 4.2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">🔻 PERFORMANCE COMPARISON (4.2) 🔻"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">before_metrics_2</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">"Description"</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">before_metrics_2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2"> ➝ </span><span class="si">{</span><span class="n">after_metrics_2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>

🔻 PERFORMANCE COMPARISON (4.2) 🔻
ExecutionTimeMs: 50 ➝ 91
TotalExecutionTimeMs: 142 ➝ 20
RowsReturned: 5 ➝ 5
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Optimization-Analysis-of-Query-4.2"><strong>Optimization Analysis of Query 4.2</strong><a class="anchor-link" href="#Optimization-Analysis-of-Query-4.2">¶</a></h4><p>The optimization of query 4.2, which finds the top 5 distinct beer styles with the highest average <code>smell + feel</code> score for user *<strong>'kylehay2004'</strong>*, shows a performance improvement when using the <code>PROFILE</code> command in Neo4j Browser.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<center><img alt="No description has been provided for this image" src="./img/PROFILEPlan_4.2.png" width="700"/></center><br/>
<center><b>Image 4 | </b> Profile of the Query 4.2 Before and After Optimization.</center><br/><br/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><strong>Before Optimization:</strong></p>
<ul>
<li>The "before" plan, without indexes on <strong><code>USER.name</code></strong>, <strong><code>STYLE.name</code></strong>, <strong><code>RATED.smell</code></strong> and <strong><code>RATED.feel</code></strong>, performed the following:<ul>
<li>Used <code>NodebyLabelScan</code> on <strong><code>USER</code></strong>, fetching $123\;935$ row with <strong>$123 \; 936$ DbHits</strong></li>
<li>Filtered  <strong><code>USER.name</code></strong>, fetching $1$ row with <strong>$123 \; 935$ DbHits</strong>.</li>
<li>Expanded <code>[u]-[:RATED]-&gt;(b)</code> to $3\;368$ rows with <strong>$3\;369$ DbHits</strong>.</li>
<li>Filtered rows where <code>r.smell IS NOT NULL AND r.feel IS NOT NULL</code>, incurring <strong>$8\;006$ DbHits</strong> and processing $2\;319$ rows.</li>
<li>Filter by <strong><code>STYLE</code></strong>, adding <strong>$2\;319$ DbHits</strong> and return $2\;319$ rows.</li>
<li><code>Projection</code>, adding <strong>$2\;319$ DbHits</strong></li>
<li>The total <strong>DbHits</strong> used are <strong>$268\;522$</strong></li>
</ul>
</li>
</ul>
<p><strong>After Optimization:</strong></p>
<ul>
<li>After creating indexes with <code>CREATE INDEX FOR ()-[r:RATED]-() ON (r.smell)</code> and <code>CREATE INDEX FOR ()-[r:RATED]-() ON (r.feel)</code>, the "after" plan showed:<ul>
<li>Reduced <code>NodeIndexSeek</code> on <code>USER</code>, fetching $1$ row with <strong>$2$ DbHits</strong> (123,936 → 2)</li>
<li>Same <code>Filter</code>, <code>Expand</code> and <code>Projection</code> as <em>before optimization</em>.</li>
<li><strong>Total DbHits: $20\;653$</strong>.</li>
</ul>
</li>
</ul>
<p><strong>Performance Improvement:</strong></p>
<ul>
<li><p>This reduction in DbHits—over <strong>92%</strong>—indicates fewer database accesses, leading to faster query execution.</p>
</li>
<li><p>Performance metrics from the Python script show:</p>
<ul>
<li><p><strong>ExecutionTimeMs</strong>: Increased from <strong>50ms</strong> to <strong>91ms</strong> (time to first result).</p>
<ul>
<li>Possible reason: Before optimization, the query ran in about 50ms—likely because previous queries had already loaded the <strong><code>USER</code></strong>, <strong><code>RATED</code></strong>, <strong><code>BEERS</code></strong>, and <strong><code>STYLE</code></strong> data into the cache. When we cleared the cache using <code>CALL db.clearQueryCaches()</code>, the next run started with a "cold" cache, meaning it had to pull data from disk or load it into memory for the first row. Interestingly, after that initial overhead, the total execution time dropped to $20ms$, which shows that once the cache started warming up during streaming, the query ran much more efficiently.</li>
</ul>
</li>
<li><p><strong>TotalExecutionTimeMs</strong>: Dropped from <strong>142ms</strong> to <strong>20ms</strong> (total query time). <br/>(<strong>Source:</strong> <a href="https://stackoverflow.com/questions/60839183/what-is-difference-between-result-available-after-and-result-consumed-after">https://stackoverflow.com/questions/60839183/what-is-difference-between-result-available-after-and-result-consumed-after</a>).</p>
</li>
</ul>
</li>
</ul>
<br/>
<p><strong>Note:</strong> <code>EagerAggregation</code>, <code>Top</code>, and <code>ProduceResults</code> have the same value before and after the optimization because they are doing the same operation using the data already in memory.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="5.-Graph-Algorithms"><strong>5. Graph Algorithms</strong><a class="anchor-link" href="#5.-Graph-Algorithms">¶</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [162]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 5. Answer **two out of four** of the following questions using Graph Algorithms (gds): </span>
<span class="c1">#        [NB: make sure to clear the graph before using it again] For the quarterly report, Analytics department the following information. [6 points]</span>
<span class="c1">#     1. Which two countries are most similar when it comes to their top five most produced Beer styles?</span>
<span class="c1">#     2. Which beer is the most popular when considering the number of users who reviewed it? </span>
<span class="c1">#     3. Users are connected together by their reviews of beers, taking into consideration the "smell" score they assign as a weight, </span>
<span class="c1">#        how many communities are formed from these relationships? How many users are in the three largest communities? </span>
<span class="c1">#     4. Which user is the most influential when it comes to reviews of distinct beers by style?</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="5.1.-%F0%9F%8C%8D-Which-two-countries-are-most-similiar-when-it-comes-to-their-top-five-most-produced-Beer-styles?"><strong>5.1. 🌍 Which two countries are most similiar when it comes to their top five most produced Beer styles?</strong><a class="anchor-link" href="#5.1.-%F0%9F%8C%8D-Which-two-countries-are-most-similiar-when-it-comes-to-their-top-five-most-produced-Beer-styles?">¶</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div class="alert alert-block alert" style="background-color:rgb(255, 255, 255, 0); border: 0px; border-left: 10px solid rgb(31, 133, 194); padding: 10px; border-radius: 10px;">
<h4 id="Assumptions:"><strong>Assumptions</strong>:<a class="anchor-link" href="#Assumptions:">¶</a></h4><ol>
<li>Considering the that the question asks for the two <strong><code>COUNTRIES</code></strong> that are the most similar in relation to their top five most produced beer <strong><code>STYLES</code></strong>, we decided to filter all <strong><code>COUNTRIES</code></strong> with fewer than 5 beer <strong><code>STYLES</code></strong></li>
<li>This ensures that the similarity is only computed for <strong><code>COUNTRIES</code></strong> with a sufficiently diverse beer production.</li>
<li>This assumption will be analyzed in the section <strong>'Problem Assumptions'</strong> below</li>
</ol>
<h4 id="Query-Organization"><strong>Query Organization</strong><a class="anchor-link" href="#Query-Organization">¶</a></h4><p>This section refers to the steps taken to apply a similarity algorithm to solve the problem at hand</p>
<ol>
<li><p><strong>Clear Graph</strong>: Drops the existing graph to ensure a clean slate for the new graph projection.</p>
</li>
<li><p><strong>Create Graph</strong>:</p>
<ul>
<li>Our graph projects <strong><code>COUNTRIES</code></strong> and <strong><code>STYLE</code></strong> nodes where each <strong><code>COUNTRIES</code></strong> node is connected to its top 5 most produced beer <strong><code>STYLE</code></strong></li>
<li><strong><code>COUNTRIES</code></strong> with less than five styles were excluded and the relationship between each COUNTRY and STYLE nodes was weighted by the number of beers produced in each style ensuring a more robust similarity comparison</li>
<li>Our graph projection results in a total of 723 relationships</li>
</ul>
</li>
<li><p><strong>Validation of successful graph projection</strong>: Process to validate if relationships in our newly created graph were sucessfully created.</p>
</li>
<li><p><strong>Similarity Algorithm</strong>: Runs node similarity algorithm on <strong><code>CountryBeerStyleSimilarityGraph</code></strong> to find the two most similar countries in regards to their top 5 most produced beers</p>
</li>
<li><p>All these steps are available in the section <strong>'Node Similarity Algorithm'</strong> below</p>
</li>
</ol>
<h4 id="Node-Similarity-Algorithm"><a href="https://neo4j.com/docs/graph-data-science/current/algorithms/node-similarity/"><strong>Node Similarity Algorithm</strong></a><a class="anchor-link" href="#Node-Similarity-Algorithm">¶</a></h4><ul>
<li>The Node Similarity algorithm compares a set of nodes based on the nodes they are connected to using one of different metrics: Jaccard metric, Overlap coefficient and the Cosine Similarity score. In our case we are using the default metric: the Jaccard Metric:</li>
</ul>
$$J(A,B) = \frac{|A \cap B|}{|A \cup B|} = \frac{|A \cap B|}{|A| + |B| - |A \cap B|}$$<ul>
<li><p>In the context of our problem and to evaluate the similarity score between two contries, the algorithm will check the number of shared top 5 beer styles produced, weighting the similarity score based on the production volume of each style</p>
</li>
<li><p>This means that if two countries produce the same styles but in different proportions they will have a lower similarity score when compared to two countries that produce the same styles but in similar proportions</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Problem-Assumptions"><strong>Problem Assumptions</strong><a class="anchor-link" href="#Problem-Assumptions">¶</a></h5>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [164]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to search for the top 5 most produced beer styles per country (All countries)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">    WITH c, s, COUNT(b) AS beer_count</span>
<span class="s2">    ORDER BY c.name, beer_count DESC</span>
<span class="s2">    WITH c, COLLECT(s.name)[0..5] AS top_styles  // Get the top 5 styles per country</span>
<span class="s2">    RETURN c.name AS country, top_styles</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Top 5 Beer Styles per Country:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Country: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'country'</span><span class="p">]</span><span class="si">}</span><span class="s2">, Top Styles: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'top_styles'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Top 5 Beer Styles per Country:
Country: AD, Top Styles: ['American Blonde Ale', 'German Hefeweizen', 'English India Pale Ale (IPA)', 'Smoke Beer', 'German Doppelbock']
Country: AE, Top Styles: ['Low Alcohol Beer', 'German Helles']
Country: AG, Top Styles: ['American Pale Ale (APA)', 'Fruit and Field Beer', 'American Porter', 'American Light Lager', 'American Adjunct Lager']
Country: AL, Top Styles: ['European Pale Lager', 'Bohemian Pilsener', 'German Maibock', 'German Hefeweizen', 'German Märzen / Oktoberfest']
Country: AM, Top Styles: ['European Pale Lager', 'Smoke Beer', 'Munich Dunkel Lager', 'Bohemian Pilsener', 'American Pale Ale (APA)']
Country: AO, Top Styles: ['European Pale Lager']
Country: AR, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Wild Ale', 'American Amber / Red Ale']
Country: AT, Top Styles: ['German Hefeweizen', 'German Märzen / Oktoberfest', 'European Pale Lager', 'German Pilsner', 'German Kellerbier / Zwickelbier']
Country: AU, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Imperial IPA', 'Belgian Saison', 'American Imperial Stout']
Country: AW, Top Styles: ['American IPA', 'American Imperial IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale']
Country: AZ, Top Styles: ['European Pale Lager', 'European Dark Lager', 'Bohemian Pilsener', 'European Strong Lager', 'European Export / Dortmunder']
Country: BA, Top Styles: ['European Pale Lager', 'American IPA', 'European Dark Lager', 'American Stout', 'American Amber / Red Ale']
Country: BB, Top Styles: ['Fruit and Field Beer', 'English Sweet / Milk Stout', 'American Lager', 'American Adjunct Lager', 'English Extra Special / Strong Bitter (ESB)']
Country: BD, Top Styles: ['European Pale Lager']
Country: BE, Top Styles: ['Belgian Pale Ale', 'Belgian Strong Pale Ale', 'Belgian Tripel', 'Belgian Strong Dark Ale', 'American IPA']
Country: BF, Top Styles: ['European Pale Lager']
Country: BG, Top Styles: ['European Pale Lager', 'Fruit and Field Beer', 'American IPA', 'American Pale Ale (APA)', 'American Adjunct Lager']
Country: BJ, Top Styles: ['European Pale Lager']
Country: BM, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Porter', 'American Wild Ale']
Country: BO, Top Styles: ['American Adjunct Lager', 'Bohemian Pilsener', 'Munich Dunkel Lager', 'American Brown Ale', 'German Helles']
Country: BR, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Imperial IPA', 'German Hefeweizen', 'American Porter']
Country: BS, Top Styles: ['American IPA', 'American Stout', 'American Porter', 'American Pale Ale (APA)', 'American Amber / Red Ale']
Country: BT, Top Styles: ['American Adjunct Lager', 'German Hefeweizen', 'American Lager', 'American Malt Liquor', 'American Amber / Red Ale']
Country: BW, Top Styles: ['Low Alcohol Beer']
Country: BY, Top Styles: ['European Pale Lager', 'European Dark Lager', 'Baltic Porter', 'German Hefeweizen', 'Herb and Spice Beer']
Country: BZ, Top Styles: ['American IPA', 'Belgian Saison', 'American Pale Ale (APA)', 'American Blonde Ale', 'German Hefeweizen']
Country: CA, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Imperial IPA', 'American Wild Ale']
Country: CF, Top Styles: ['European Pale Lager']
Country: CG, Top Styles: ['European Pale Lager', 'Vienna Lager', 'Munich Dunkel Lager', 'European Dark Lager']
Country: CH, Top Styles: ['American Wild Ale', 'European Pale Lager', 'Belgian Saison', 'American IPA', 'French Bière de Garde']
Country: CI, Top Styles: ['European Pale Lager', 'German Bock', 'American Malt Liquor']
Country: CK, Top Styles: ['English Porter', 'English Pale Ale', 'American Lager']
Country: CL, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Imperial IPA', 'American Amber / Red Ale', 'American Imperial Stout']
Country: CM, Top Styles: ['European Pale Lager', 'European Dark Lager']
Country: CN, Top Styles: ['American Adjunct Lager', 'European Pale Lager', 'American IPA', 'American Pale Ale (APA)', 'American Stout']
Country: CO, Top Styles: ['American Adjunct Lager', 'Low Alcohol Beer', 'American Light Lager', 'English Brown Ale', 'American IPA']
Country: CR, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Porter', 'American Imperial IPA']
Country: CU, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale', 'American Imperial IPA']
Country: CV, Top Styles: ['European Dark Lager', 'American Adjunct Lager', 'European Strong Lager', 'European Pale Lager']
Country: CW, Top Styles: ['Fruit and Field Beer', 'Belgian Witbier', 'American Blonde Ale', 'German Märzen / Oktoberfest', 'English Brown Ale']
Country: CY, Top Styles: ['English Pale Ale', 'American Adjunct Lager', 'American IPA', 'German Pilsner', 'German Weizenbock']
Country: CZ, Top Styles: ['American IPA', 'Bohemian Pilsener', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale']
Country: DE, Top Styles: ['German Pilsner', 'German Hefeweizen', 'German Helles', 'German Kellerbier / Zwickelbier', 'German Märzen / Oktoberfest']
Country: DK, Top Styles: ['American IPA', 'American Imperial Stout', 'American Pale Ale (APA)', 'European Pale Lager', 'American Wild Ale']
Country: DM, Top Styles: ['American Adjunct Lager']
Country: DO, Top Styles: ['American Adjunct Lager', 'American Light Lager', 'American Amber / Red Lager', 'Bohemian Pilsener', 'Low Alcohol Beer']
Country: DZ, Top Styles: ['European Pale Lager', 'English Brown Ale', 'German Pilsner', 'American Strong Ale', 'American Light Lager']
Country: EC, Top Styles: ['American Pale Ale (APA)', 'American IPA', 'American Stout', 'American Blonde Ale', 'American Amber / Red Ale']
Country: EE, Top Styles: ['American IPA', 'American Imperial Stout', 'European Pale Lager', 'Baltic Porter', 'American Imperial IPA']
Country: EG, Top Styles: ['European Strong Lager', 'European Pale Lager', 'American Malt Liquor', 'German Hefeweizen', 'German Pilsner']
Country: ER, Top Styles: ['German Pilsner', 'American Adjunct Lager', 'Low Alcohol Beer', 'Foreign / Export Stout']
Country: ES, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Imperial IPA', 'American Amber / Red Ale', 'American Porter']
Country: ET, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale', 'American Imperial IPA']
Country: FI, Top Styles: ['European Pale Lager', 'American IPA', 'American Pale Ale (APA)', 'German Hefeweizen', 'German Pilsner']
Country: FJ, Top Styles: ['European Pale Lager', 'English Bitter', 'American Adjunct Lager', 'American Malt Liquor', 'American Blonde Ale']
Country: FM, Top Styles: ['American Amber / Red Lager', 'Berliner Weisse']
Country: FO, Top Styles: ['German Pilsner', 'European Pale Lager', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'English Pale Ale']
Country: FR, Top Styles: ['American IPA', 'Belgian Witbier', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'French Bière de Garde']
Country: GA, Top Styles: ['European Pale Lager']
Country: GB, Top Styles: ['American IPA', 'English Bitter', 'American Pale Ale (APA)', 'English Pale Ale', 'American Imperial IPA']
Country: GD, Top Styles: ['American Amber / Red Ale', 'American IPA', 'Belgian Witbier', 'American Blonde Ale', 'Belgian Tripel']
Country: GE, Top Styles: ['European Pale Lager', 'European Dark Lager', 'German Kellerbier / Zwickelbier', 'German Hefeweizen', 'Bohemian Pilsener']
Country: GF, Top Styles: ['Belgian Witbier', 'Belgian Pale Ale', 'American Stout', 'American Blonde Ale']
Country: GG, Top Styles: ['English Bitter', 'Winter Warmer', 'English Stout', 'American Adjunct Lager', 'English Dark Mild Ale']
Country: GH, Top Styles: ['European Pale Lager', 'American Adjunct Lager', 'Foreign / Export Stout', 'Herb and Spice Beer', 'Fruit and Field Beer']
Country: GL, Top Styles: ['European Pale Lager', 'German Pilsner', 'American Amber / Red Lager', 'Herb and Spice Beer', 'German Bock']
Country: GM, Top Styles: ['European Pale Lager', 'European Export / Dortmunder']
Country: GN, Top Styles: ['European Pale Lager']
Country: GP, Top Styles: ['European Pale Lager', 'American Lager']
Country: GQ, Top Styles: ['European Pale Lager']
Country: GR, Top Styles: ['American IPA', 'American Imperial Stout', 'Belgian Saison', 'American Wild Ale', 'Berliner Weisse']
Country: GT, Top Styles: ['American Adjunct Lager', 'American Light Lager', 'European Pale Lager', 'European Dark Lager', 'German Bock']
Country: GU, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'Smoke Porter', 'Herb and Spice Beer']
Country: GW, Top Styles: ['European Pale Lager']
Country: HK, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Witbier', 'American Wild Ale', 'Belgian Saison']
Country: HN, Top Styles: ['American Stout', 'American Adjunct Lager', 'English Porter', 'American Pale Ale (APA)', 'Irish Red Ale']
Country: HR, Top Styles: ['Fruit and Field Beer', 'European Pale Lager', 'American Pale Ale (APA)', 'American IPA', 'European Dark Lager']
Country: HT, Top Styles: ['American Brown Ale', 'American Adjunct Lager']
Country: HU, Top Styles: ['American IPA', 'European Pale Lager', 'Fruit and Field Beer', 'American Pale Ale (APA)', 'American Imperial IPA']
Country: ID, Top Styles: ['German Pilsner', 'English Stout', 'European Pale Lager', 'American Blonde Ale', 'American Lager']
Country: IE, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'American Porter', 'American Imperial IPA']
Country: IL, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'German Hefeweizen', 'Belgian Witbier', 'American Amber / Red Ale']
Country: IM, Top Styles: ['American Stout', 'American IPA', 'English Bitter', 'American Pale Ale (APA)', 'American Pale Wheat Ale']
Country: IN, Top Styles: ['American Adjunct Lager', 'European Pale Lager', 'European Strong Lager', 'Belgian Witbier', 'American Malt Liquor']
Country: IQ, Top Styles: ['European Pale Lager']
Country: IR, Top Styles: ['Low Alcohol Beer']
Country: IS, Top Styles: ['American IPA', 'American Imperial Stout', 'American Pale Ale (APA)', 'European Pale Lager', 'Fruit and Field Beer']
Country: IT, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Amber / Red Ale', 'Belgian Witbier']
Country: JE, Top Styles: ['German Maibock', 'German Eisbock', 'English Pale Ale', 'German Kellerbier / Zwickelbier', 'English India Pale Ale (IPA)']
Country: JM, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Imperial IPA', 'American Wild Ale']
Country: JO, Top Styles: ['American Malt Liquor', 'American Adjunct Lager', 'Winter Warmer', 'American Porter', 'English Pale Ale']
Country: JP, Top Styles: ['Japanese Happoshu', 'American IPA', 'Fruit and Field Beer', 'American Pale Ale (APA)', 'German Hefeweizen']
Country: KE, Top Styles: ['European Pale Lager', 'German Märzen / Oktoberfest', 'English Stout', 'German Pilsner', 'American Light Lager']
Country: KG, Top Styles: ['European Pale Lager', 'American Pale Wheat Ale', 'Irish Red Ale', 'Foreign / Export Stout', 'Bohemian Pilsener']
Country: KH, Top Styles: ['European Pale Lager', 'American IPA', 'Foreign / Export Stout', 'Belgian Witbier', 'American Adjunct Lager']
Country: KP, Top Styles: ['European Pale Lager', 'German Schwarzbier', 'European Dark Lager', 'Belgian Witbier', 'German Hefeweizen']
Country: KR, Top Styles: ['American Pale Ale (APA)', 'American IPA', 'American Stout', 'American Adjunct Lager', 'American Lager']
Country: KY, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale', 'American Imperial IPA']
Country: KZ, Top Styles: ['European Pale Lager', 'Bohemian Pilsener', 'European Dark Lager', 'European Strong Lager', 'German Hefeweizen']
Country: LA, Top Styles: ['American Adjunct Lager', 'American Lager', 'Herb and Spice Beer', 'Vienna Lager', 'Belgian Witbier']
Country: LB, Top Styles: ['Low Alcohol Beer', 'German Pilsner', 'Bohemian Pilsener', 'European Pale Lager', 'Fruit and Field Beer']
Country: LC, Top Styles: ['Fruit and Field Beer', 'Foreign / Export Stout', 'English Sweet / Milk Stout', 'European Pale Lager', 'American Adjunct Lager']
Country: LI, Top Styles: ['European Pale Lager', 'German Hefeweizen', 'Munich Dunkel Lager', 'English Sweet / Milk Stout', 'German Maibock']
Country: LK, Top Styles: ['American Malt Liquor', 'European Strong Lager', 'Foreign / Export Stout', 'European Pale Lager', 'American Adjunct Lager']
Country: LR, Top Styles: ['Belgian Strong Dark Ale', 'American IPA', 'American Pale Ale (APA)', 'American Stout', 'American Strong Ale']
Country: LS, Top Styles: ['American Adjunct Lager']
Country: LT, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'European Pale Lager', 'Belgian Saison', 'American Porter']
Country: LU, Top Styles: ['European Pale Lager', 'German Pilsner', 'Belgian Witbier', 'Munich Dunkel Lager', 'German Hefeweizen']
Country: LV, Top Styles: ['European Pale Lager', 'American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'Russian Kvass']
Country: LY, Top Styles: ['Low Alcohol Beer']
Country: MA, Top Styles: ['European Pale Lager', 'European Strong Lager', 'American Barleywine', 'Low Alcohol Beer']
Country: MC, Top Styles: ['German Pilsner', 'Herb and Spice Beer', 'Belgian Witbier', 'Fruit and Field Beer', 'Belgian Pale Ale']
Country: MD, Top Styles: ['European Pale Lager', 'American IPA', 'Russian Kvass', 'American Wild Ale', 'American Pale Ale (APA)']
Country: ME, Top Styles: ['European Pale Lager', 'Fruit and Field Beer', 'American Adjunct Lager', 'German Kellerbier / Zwickelbier', 'German Doppelbock']
Country: MG, Top Styles: ['Low Alcohol Beer', 'American Imperial Pilsner', 'American Amber / Red Lager', 'Belgian Witbier', 'American Amber / Red Ale']
Country: MK, Top Styles: ['European Pale Lager', 'German Pilsner', 'European Dark Lager', 'German Rauchbier', 'Fruit and Field Beer']
Country: MM, Top Styles: ['American Adjunct Lager', 'European Strong Lager', 'Foreign / Export Stout', 'English Stout', 'English Strong Ale']
Country: MN, Top Styles: ['Munich Dunkel Lager', 'European Pale Lager', 'Vienna Lager', 'German Pilsner', 'German Kellerbier / Zwickelbier']
Country: MO, Top Styles: ['European Pale Lager']
Country: MQ, Top Styles: ['American Light Lager', 'English Porter', 'German Hefeweizen', 'American Pale Wheat Ale', 'American Amber / Red Ale']
Country: MT, Top Styles: ['English Pale Ale', 'European Pale Lager', 'American Blonde Ale', 'English India Pale Ale (IPA)', 'Fruit and Field Beer']
Country: MU, Top Styles: ['American IPA', 'American Blonde Ale', 'German Märzen / Oktoberfest', 'European Strong Lager', 'European Pale Lager']
Country: MW, Top Styles: ['European Pale Lager', 'Vienna Lager', 'English Sweet / Milk Stout']
Country: MX, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Blonde Ale', 'American Adjunct Lager', 'American Amber / Red Ale']
Country: MY, Top Styles: ['European Pale Lager', 'Belgian Witbier', 'European Dark Lager', 'American Adjunct Lager', 'Foreign / Export Stout']
Country: MZ, Top Styles: ['American Adjunct Lager', 'European Pale Lager', 'Fruit and Field Beer', 'German Märzen / Oktoberfest']
Country: NC, Top Styles: ['European Pale Lager', 'American Lager', 'American Amber / Red Ale', 'Fruit and Field Beer']
Country: NE, Top Styles: ['European Pale Lager']
Country: NG, Top Styles: ['European Pale Lager', 'American Adjunct Lager', 'Foreign / Export Stout', 'Low Alcohol Beer', 'European Dark Lager']
Country: NI, Top Styles: ['American Blonde Ale', 'American Light Lager', 'European Pale Lager', 'American Adjunct Lager', 'American IPA']
Country: NL, Top Styles: ['American IPA', 'Russian Imperial Stout', 'American Imperial Stout', 'Belgian Saison', 'Belgian Tripel']
Country: NO, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Amber / Red Ale', 'American Imperial Stout']
Country: NP, Top Styles: ['European Pale Lager', 'American Malt Liquor', 'American Lager', 'American Light Lager', 'American Adjunct Lager']
Country: NZ, Top Styles: ['American IPA', 'American Imperial IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Imperial Stout']
Country: PA, Top Styles: ['American IPA', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'American Adjunct Lager', 'American Porter']
Country: PE, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'American Adjunct Lager', 'Belgian Saison']
Country: PF, Top Styles: ['European Pale Lager', 'American Adjunct Lager', 'American Amber / Red Lager', 'American Blonde Ale', 'Belgian Witbier']
Country: PG, Top Styles: ['European Pale Lager', 'Foreign / Export Stout', 'American Adjunct Lager', 'European Export / Dortmunder']
Country: PH, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Imperial IPA', 'American Wild Ale']
Country: PK, Top Styles: ['European Strong Lager', 'European Pale Lager']
Country: PL, Top Styles: ['European Pale Lager', 'American IPA', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'European Strong Lager']
Country: PR, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'American Blonde Ale', 'Fruit and Field Beer']
Country: PS, Top Styles: ['German Pilsner', 'Belgian Witbier', 'German Altbier', 'English Stout', 'Winter Warmer']
Country: PT, Top Styles: ['American IPA', 'German Hefeweizen', 'American Pale Ale (APA)', 'Belgian Saison', 'European Pale Lager']
Country: PW, Top Styles: ['American Stout', 'American Blonde Ale', 'British Barleywine', 'Irish Dry Stout', 'American Amber / Red Ale']
Country: PY, Top Styles: ['German Pilsner']
Country: RE, Top Styles: ['Fruit and Field Beer', 'American Amber / Red Ale', 'Belgian Witbier', 'Herb and Spice Beer', 'American Blonde Ale']
Country: RO, Top Styles: ['European Pale Lager', 'American IPA', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'German Pilsner']
Country: RS, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'European Pale Lager', 'Fruit and Field Beer', 'German Pilsner']
Country: RU, Top Styles: ['American IPA', 'European Pale Lager', 'American Pale Ale (APA)', 'American Imperial IPA', 'American Porter']
Country: RW, Top Styles: ['European Pale Lager', 'European Dark Lager']
Country: SB, Top Styles: ['European Pale Lager']
Country: SC, Top Styles: ['European Pale Lager', 'English Strong Ale']
Country: SE, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'European Pale Lager', 'Belgian Saison', 'American Imperial Stout']
Country: SG, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale', 'American Imperial IPA']
Country: SI, Top Styles: ['European Pale Lager', 'American IPA', 'Fruit and Field Beer', 'American Pale Ale (APA)', 'English Pale Ale']
Country: SK, Top Styles: ['Bohemian Pilsener', 'European Pale Lager', 'American IPA', 'European Dark Lager', 'American Adjunct Lager']
Country: SM, Top Styles: ['German Pilsner', 'American IPA', 'Smoke Beer', 'English Brown Ale', 'English Bitter']
Country: SN, Top Styles: ['European Pale Lager']
Country: SR, Top Styles: ['European Pale Lager', 'Fruit and Field Beer', 'American Adjunct Lager', 'Foreign / Export Stout']
Country: SS, Top Styles: ['American Adjunct Lager']
Country: ST, Top Styles: ['European Pale Lager']
Country: SV, Top Styles: ['American Light Lager', 'American Adjunct Lager', 'American Pale Wheat Ale', 'American Lager', 'Belgian Witbier']
Country: SX, Top Styles: ['Belgian Saison', 'American Amber / Red Ale', 'German Hefeweizen', 'English Bitter', 'American Barleywine']
Country: SY, Top Styles: ['German Hefeweizen', 'American IPA', 'European Pale Lager', 'American Adjunct Lager', 'American Porter']
Country: SZ, Top Styles: ['European Pale Lager', 'Vienna Lager', 'Low Alcohol Beer']
Country: TC, Top Styles: ['American Adjunct Lager', 'American Amber / Red Lager', 'English India Pale Ale (IPA)', 'Foreign / Export Stout', 'German Hefeweizen']
Country: TD, Top Styles: ['European Pale Lager']
Country: TG, Top Styles: ['German Pilsner', 'English Brown Ale', 'European Pale Lager']
Country: TH, Top Styles: ['American Adjunct Lager', 'European Pale Lager', 'American Lager', 'German Hefeweizen', 'American IPA']
Country: TJ, Top Styles: ['European Pale Lager']
Country: TM, Top Styles: ['European Pale Lager', 'Vienna Lager']
Country: TN, Top Styles: ['German Hefeweizen', 'Munich Dunkel Lager', 'German Helles', 'Low Alcohol Beer', 'European Pale Lager']
Country: TO, Top Styles: ['European Pale Lager', 'European Export / Dortmunder', 'European Dark Lager']
Country: TR, Top Styles: ['European Pale Lager', 'European Strong Lager', 'German Pilsner', 'German Hefeweizen', 'American IPA']
Country: TT, Top Styles: ['Herb and Spice Beer', 'American Adjunct Lager', 'English Sweet / Milk Stout', 'Low Alcohol Beer', 'European Dark Lager']
Country: TW, Top Styles: ['Fruit and Field Beer', 'German Hefeweizen', 'American Adjunct Lager', 'American Pale Ale (APA)', 'German Pilsner']
Country: TZ, Top Styles: ['European Pale Lager', 'American Adjunct Lager', 'English Stout', 'English Pale Ale', 'European Strong Lager']
Country: UA, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale', 'Belgian Saison']
Country: UG, Top Styles: ['European Pale Lager', 'American Adjunct Lager', 'European Strong Lager', 'American Lager', 'English Sweet / Milk Stout']
Country: US, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Imperial IPA', 'Belgian Saison', 'American Wild Ale']
Country: UY, Top Styles: ['American IPA', 'American Blonde Ale', 'American Porter', 'American Pale Ale (APA)', 'American Amber / Red Ale']
Country: UZ, Top Styles: ['European Pale Lager', 'German Pilsner', 'European Dark Lager', 'American Lager', 'American Light Lager']
Country: VC, Top Styles: ['American Adjunct Lager', 'Foreign / Export Stout']
Country: VE, Top Styles: ['American IPA', 'American Amber / Red Ale', 'American Imperial IPA', 'German Pilsner', 'American Blonde Ale']
Country: VG, Top Styles: ['American Lager', 'American Imperial IPA']
Country: VI, Top Styles: ['Fruit and Field Beer', 'American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale']
Country: VN, Top Styles: ['American IPA', 'American Adjunct Lager', 'Bohemian Pilsener', 'American Amber / Red Ale', 'American Pale Ale (APA)']
Country: VU, Top Styles: ['European Pale Lager', 'English Porter', 'English Bitter', 'American Blonde Ale', 'American Lager']
Country: WS, Top Styles: ['European Pale Lager', 'German Pilsner', 'European Strong Lager']
Country: YT, Top Styles: ['European Pale Lager']
Country: ZA, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'European Pale Lager', 'American Blonde Ale', 'American Amber / Red Ale']
Country: ZM, Top Styles: ['American Adjunct Lager', 'European Pale Lager']
Country: ZW, Top Styles: ['European Pale Lager', 'American Adjunct Lager', 'English Pale Ale', 'English Stout', 'English Bitter']
Country: None, Top Styles: ['American IPA', 'American Pale Ale (APA)', 'American Porter', 'American Amber / Red Ale', 'American Imperial IPA']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>After running this query, we noticed that <strong>a lot of countries produce less than 5 styles of beer</strong> (e.g Country PY only produce the German Pilsner style) and for that reason decided to investigate which countries produce less than 5 styles of beer and the total percentage below</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [166]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Existis countries with less than 5 beer styles produced?</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)</span>
<span class="s2">    WHERE c.name IS NOT NULL</span>
<span class="s2">    WITH COUNT(DISTINCT c) AS total_countries</span>

<span class="s2">    MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">    WITH c, COUNT(DISTINCT s) AS style_count, total_countries</span>
<span class="s2">    WHERE style_count &lt; 5</span>

<span class="s2">    WITH COUNT(DISTINCT c) AS low_style_countries, total_countries, </span>
<span class="s2">        COLLECT({country: c.name, style_count: style_count}) AS country_list</span>

<span class="s2">    RETURN low_style_countries, total_countries, </span>
<span class="s2">        ROUND((low_style_countries * 100.0) / total_countries, 2) AS percentage, </span>
<span class="s2">        country_list</span>
<span class="s2">"""</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="c1"># Print results</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Countries with &lt;5 Beer Styles: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'low_style_countries'</span><span class="p">]</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'total_countries'</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'percentage'</span><span class="p">]</span><span class="si">}</span><span class="s2">%)</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Detailed list:"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s1">'country_list'</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">country</span><span class="p">[</span><span class="s1">'country'</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">country</span><span class="p">[</span><span class="s1">'style_count'</span><span class="p">]</span><span class="si">}</span><span class="s2"> beer styles"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Countries with &lt;5 Beer Styles: 54 out of 199 (27.14%)

Detailed list:
IR: 1 beer styles
CG: 4 beer styles
AE: 2 beer styles
TD: 1 beer styles
WS: 3 beer styles
TO: 3 beer styles
ER: 4 beer styles
CK: 3 beer styles
VC: 2 beer styles
SR: 4 beer styles
NE: 1 beer styles
MZ: 4 beer styles
RW: 2 beer styles
NC: 4 beer styles
TM: 2 beer styles
SN: 1 beer styles
AO: 1 beer styles
MA: 4 beer styles
BF: 1 beer styles
GF: 4 beer styles
HT: 2 beer styles
DM: 1 beer styles
VG: 2 beer styles
CI: 3 beer styles
GP: 2 beer styles
ST: 1 beer styles
BW: 1 beer styles
SZ: 3 beer styles
SB: 1 beer styles
CM: 2 beer styles
LS: 1 beer styles
MO: 1 beer styles
SC: 2 beer styles
LY: 1 beer styles
CV: 4 beer styles
TJ: 1 beer styles
PG: 4 beer styles
SS: 1 beer styles
PK: 2 beer styles
YT: 1 beer styles
CF: 1 beer styles
GM: 2 beer styles
IQ: 1 beer styles
GQ: 1 beer styles
PY: 1 beer styles
BJ: 1 beer styles
GW: 1 beer styles
BD: 1 beer styles
GN: 1 beer styles
TG: 3 beer styles
FM: 2 beer styles
GA: 1 beer styles
MW: 3 beer styles
ZM: 2 beer styles
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>As we can see from the results above, around $27\%$ of <strong><code>COUNTRIES</code> produce less than 5 beer styles</strong>.</li>
</ul>
<blockquote>
<p>All these <strong><code>COUNTRIES</code></strong> will not be considered when determining the top two similar countries in regards to their top 5 beer styles produced.</p>
</blockquote>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [167]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Distinct beer styles produced by each country </span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">    WHERE c.name IS NOT NULL</span>
<span class="s2">    WITH c.name AS country, COLLECT(DISTINCT s.name) AS styles</span>
<span class="s2">    RETURN country, styles</span>
<span class="s2">    ORDER BY size(styles) DESC</span>
<span class="s2">"""</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Sample of Countries and Their Beer Styles:"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'country'</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'styles'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>
Sample of Countries and Their Beer Styles:
US: ['English Extra Special / Strong Bitter (ESB)', 'American Pale Ale (APA)', 'American Adjunct Lager', 'German Maibock', 'California Common / Steam Beer', 'German Märzen / Oktoberfest', 'American Porter', 'American IPA', 'English Bitter', 'Irish Dry Stout', 'German Hefeweizen', 'American Wild Ale', 'American Amber / Red Ale', 'American Imperial Stout', 'American Imperial IPA', 'English India Pale Ale (IPA)', 'Belgian Dubbel', 'German Kölsch', 'Belgian Quadrupel (Quad)', 'Scotch Ale / Wee Heavy', 'Belgian Saison', 'Winter Warmer', 'Belgian Tripel', 'American Black Ale', 'Rye Beer', 'American Strong Ale', 'American Amber / Red Lager', 'American Pale Wheat Ale', 'German Kellerbier / Zwickelbier', 'French Bière de Garde', 'German Helles', 'American Cream Ale', 'Herb and Spice Beer', 'English Sweet / Milk Stout', 'American Blonde Ale', 'Belgian Witbier', 'Irish Red Ale', 'Belgian Dark Ale', 'Fruit and Field Beer', 'Scottish Ale', 'Pumpkin Beer', 'English Brown Ale', 'Belgian Pale Ale', 'English Oatmeal Stout', 'American Light Lager', 'English Porter', 'German Pilsner', 'New England IPA', 'American Brown Ale', 'American Lager', 'American Imperial Porter', 'American Stout', 'Baltic Porter', 'Smoke Beer', 'Belgian IPA', 'Russian Imperial Stout', 'German Dunkelweizen', 'Belgian Strong Dark Ale', 'Vienna Lager', 'American Dark Wheat Ale', 'American Brut IPA', 'Berliner Weisse', 'English Pale Ale', 'Leipzig Gose', 'American Brett', 'English Dark Mild Ale', 'Belgian Gueuze', 'Smoke Porter', 'Chile Beer', 'German Altbier', 'Japanese Rice Lager', 'German Schwarzbier', 'Belgian Strong Pale Ale', 'American Barleywine', 'German Bock', 'German Weizenbock', 'English Stout', 'Belgian Fruit Lambic', 'German Doppelbock', 'German Rauchbier', 'British Barleywine', 'European Export / Dortmunder', 'Flanders Red Ale', 'American Imperial Pilsner', 'German Eisbock', 'Munich Dunkel Lager', 'Bohemian Pilsener', 'European Pale Lager', 'European Dark Lager', 'English Pale Mild Ale', 'English Old Ale', 'Belgian Blonde Ale', 'English Strong Ale', 'American Malt Liquor', 'Braggot', 'German Roggenbier', 'Scottish Gruit / Ancient Herbed Ale', 'Low Alcohol Beer', 'American Wheatwine Ale', 'American Imperial Red Ale', 'Foreign / Export Stout', 'German Kristalweizen', 'Russian Kvass', 'Flanders Oud Bruin', 'Bière de Champagne / Bière Brut', 'Robust Porter', 'Wild/Sour Beers', 'Finnish Sahti', 'European Strong Lager', 'Belgian Lambic', 'Belgian Faro', 'Japanese Happoshu']
CA: ['German Pilsner', 'English Porter', 'Belgian Pale Ale', 'English Bitter', 'English Pale Mild Ale', 'Scottish Ale', 'English Pale Ale', 'American Blonde Ale', 'Bohemian Pilsener', 'American Light Lager', 'American Imperial IPA', 'European Dark Lager', 'American Pale Ale (APA)', 'American Lager', 'Herb and Spice Beer', 'American IPA', 'German Kölsch', 'American Amber / Red Ale', 'Smoke Beer', 'American Stout', 'Belgian Witbier', 'American Porter', 'English Oatmeal Stout', 'Fruit and Field Beer', 'Belgian Dark Ale', 'American Cream Ale', 'Belgian Dubbel', 'German Rauchbier', 'Berliner Weisse', 'American Dark Wheat Ale', 'Chile Beer', 'English Brown Ale', 'English Old Ale', 'American Pale Wheat Ale', 'English Extra Special / Strong Bitter (ESB)', 'Russian Imperial Stout', 'English Stout', 'American Brown Ale', 'German Hefeweizen', 'Baltic Porter', 'American Amber / Red Lager', 'German Kellerbier / Zwickelbier', 'German Kristalweizen', 'German Dunkelweizen', 'German Schwarzbier', 'German Bock', 'American Adjunct Lager', 'German Helles', 'Belgian IPA', 'Vienna Lager', 'Pumpkin Beer', 'American Black Ale', 'American Imperial Stout', 'Belgian Quadrupel (Quad)', 'Belgian Saison', 'European Pale Lager', 'American Strong Ale', 'Belgian Tripel', 'American Wild Ale', 'English Sweet / Milk Stout', 'American Imperial Pilsner', 'American Barleywine', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Foreign / Export Stout', 'Belgian Strong Dark Ale', 'German Altbier', 'Munich Dunkel Lager', 'German Maibock', 'Rye Beer', 'German Doppelbock', 'German Märzen / Oktoberfest', 'Winter Warmer', 'New England IPA', 'Irish Red Ale', 'German Roggenbier', 'Irish Dry Stout', 'Belgian Blonde Ale', 'California Common / Steam Beer', 'Scotch Ale / Wee Heavy', 'Leipzig Gose', 'British Barleywine', 'Flanders Red Ale', 'European Strong Lager', 'Braggot', 'American Imperial Red Ale', 'English Dark Mild Ale', 'American Brut IPA', 'European Export / Dortmunder', 'Belgian Strong Pale Ale', 'Scottish Gruit / Ancient Herbed Ale', 'German Eisbock', 'Belgian Fruit Lambic', 'German Weizenbock', 'Flanders Oud Bruin', 'Russian Kvass', 'Finnish Sahti', 'Low Alcohol Beer', 'American Brett', 'Belgian Lambic', 'English Strong Ale', 'Smoke Porter', 'American Wheatwine Ale', 'Bière de Champagne / Bière Brut', 'Japanese Rice Lager', 'Robust Porter', 'American Malt Liquor', 'American Imperial Porter', 'Belgian Gueuze', 'Belgian Faro']
GB: ['American Pale Ale (APA)', 'Fruit and Field Beer', 'American Amber / Red Ale', 'English Porter', 'English Extra Special / Strong Bitter (ESB)', 'English Bitter', 'English Dark Mild Ale', 'American Imperial IPA', 'English Pale Ale', 'English India Pale Ale (IPA)', 'Vienna Lager', 'English Old Ale', 'English Brown Ale', 'American IPA', 'English Stout', 'English Strong Ale', 'American Blonde Ale', 'American Pale Wheat Ale', 'German Pilsner', 'American Imperial Pilsner', 'German Bock', 'Baltic Porter', 'Belgian Pale Ale', 'English Pale Mild Ale', 'Winter Warmer', 'American Stout', 'English Oatmeal Stout', 'Scottish Ale', 'Scotch Ale / Wee Heavy', 'German Hefeweizen', 'American Black Ale', 'Herb and Spice Beer', 'English Sweet / Milk Stout', 'Flanders Red Ale', 'Belgian Saison', 'American Imperial Stout', 'Rye Beer', 'American Brown Ale', 'Robust Porter', 'New England IPA', 'Irish Dry Stout', 'Bohemian Pilsener', 'Berliner Weisse', 'American Porter', 'Foreign / Export Stout', 'Pumpkin Beer', 'Belgian Fruit Lambic', 'Russian Imperial Stout', 'Belgian Dubbel', 'Belgian Witbier', 'French Bière de Garde', 'Belgian Blonde Ale', 'American Barleywine', 'Belgian Lambic', 'German Altbier', 'German Doppelbock', 'Belgian Strong Dark Ale', 'American Cream Ale', 'Flanders Oud Bruin', 'German Maibock', 'Belgian Dark Ale', 'American Light Lager', 'Belgian IPA', 'California Common / Steam Beer', 'German Schwarzbier', 'German Märzen / Oktoberfest', 'Irish Red Ale', 'Belgian Strong Pale Ale', 'German Helles', 'German Kölsch', 'American Brut IPA', 'Leipzig Gose', 'American Wild Ale', 'Belgian Tripel', 'American Amber / Red Lager', 'European Dark Lager', 'American Lager', 'British Barleywine', 'American Brett', 'American Strong Ale', 'Bière de Champagne / Bière Brut', 'German Rauchbier', 'European Pale Lager', 'American Imperial Red Ale', 'Munich Dunkel Lager', 'German Kellerbier / Zwickelbier', 'Smoke Porter', 'European Export / Dortmunder', 'American Adjunct Lager', 'Smoke Beer', 'German Dunkelweizen', 'Low Alcohol Beer', 'European Strong Lager', 'German Weizenbock', 'American Wheatwine Ale', 'Belgian Quadrupel (Quad)', 'German Eisbock', 'American Imperial Porter', 'Chile Beer', 'German Roggenbier', 'Scottish Gruit / Ancient Herbed Ale', 'American Malt Liquor', 'Braggot', 'Belgian Gueuze', 'German Kristalweizen', 'Russian Kvass', 'Japanese Happoshu', 'Japanese Rice Lager', 'American Dark Wheat Ale', 'Finnish Sahti']
AU: ['English Sweet / Milk Stout', 'German Kölsch', 'Fruit and Field Beer', 'American Brown Ale', 'American Pale Ale (APA)', 'American IPA', 'English Pale Ale', 'German Märzen / Oktoberfest', 'Russian Imperial Stout', 'European Pale Lager', 'Smoke Beer', 'Belgian Quadrupel (Quad)', 'American Porter', 'Belgian Fruit Lambic', 'Belgian IPA', 'Belgian Dubbel', 'Belgian Witbier', 'American Barleywine', 'American Amber / Red Ale', 'Belgian Tripel', 'Belgian Saison', 'American Wild Ale', 'Belgian Dark Ale', 'American Imperial Stout', 'German Hefeweizen', 'English Pale Mild Ale', 'English Stout', 'Vienna Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Blonde Ale', 'German Altbier', 'German Pilsner', 'American Pale Wheat Ale', 'English Brown Ale', 'German Rauchbier', 'American Adjunct Lager', 'Irish Red Ale', 'Bohemian Pilsener', 'American Black Ale', 'American Stout', 'Scottish Ale', 'English Porter', 'English Bitter', 'American Imperial IPA', 'Scotch Ale / Wee Heavy', 'Baltic Porter', 'American Lager', 'Rye Beer', 'English India Pale Ale (IPA)', 'Belgian Strong Pale Ale', 'Finnish Sahti', 'Herb and Spice Beer', 'European Dark Lager', 'American Amber / Red Lager', 'English Dark Mild Ale', 'Flanders Red Ale', 'Japanese Rice Lager', 'Foreign / Export Stout', 'American Strong Ale', 'German Maibock', 'Winter Warmer', 'German Weizenbock', 'Irish Dry Stout', 'Munich Dunkel Lager', 'German Bock', 'Smoke Porter', 'American Light Lager', 'American Wheatwine Ale', 'German Roggenbier', 'German Helles', 'Flanders Oud Bruin', 'Belgian Strong Dark Ale', 'Belgian Pale Ale', 'German Schwarzbier', 'German Dunkelweizen', 'Robust Porter', 'British Barleywine', 'English Oatmeal Stout', 'American Cream Ale', 'Scottish Gruit / Ancient Herbed Ale', 'American Dark Wheat Ale', 'California Common / Steam Beer', 'German Doppelbock', 'English Strong Ale', 'Pumpkin Beer', 'English Old Ale', 'French Bière de Garde', 'American Imperial Pilsner', 'European Export / Dortmunder', 'German Kellerbier / Zwickelbier', 'American Brett', 'Low Alcohol Beer', 'Belgian Lambic', 'American Imperial Red Ale', 'European Strong Lager', 'Braggot', 'Leipzig Gose', 'Berliner Weisse', 'Chile Beer', 'German Kristalweizen', 'American Brut IPA', 'New England IPA', 'German Eisbock', 'American Imperial Porter', 'Belgian Blonde Ale', 'Belgian Gueuze', 'American Malt Liquor', 'Bière de Champagne / Bière Brut', 'Russian Kvass']
BE: ['Belgian Tripel', 'American Imperial Stout', 'Belgian IPA', 'Belgian Strong Dark Ale', 'Belgian Strong Pale Ale', 'Belgian Quadrupel (Quad)', 'Belgian Saison', 'Belgian Dubbel', 'Fruit and Field Beer', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'Belgian Dark Ale', 'Belgian Blonde Ale', 'Belgian Gueuze', 'Belgian Lambic', 'Belgian Faro', 'English Oatmeal Stout', 'German Kristalweizen', 'American Blonde Ale', 'Low Alcohol Beer', 'Flanders Red Ale', 'Foreign / Export Stout', 'Vienna Lager', 'American Wild Ale', 'English Sweet / Milk Stout', 'Bohemian Pilsener', 'Belgian Witbier', 'English Pale Ale', 'Flanders Oud Bruin', 'European Pale Lager', 'German Pilsner', 'French Bière de Garde', 'German Bock', 'American Black Ale', 'Irish Dry Stout', 'Scottish Gruit / Ancient Herbed Ale', 'European Strong Lager', 'Scottish Ale', 'English India Pale Ale (IPA)', 'Scotch Ale / Wee Heavy', 'Herb and Spice Beer', 'American IPA', 'New England IPA', 'English Bitter', 'American Brown Ale', 'American Porter', 'German Hefeweizen', 'Pumpkin Beer', 'Chile Beer', 'American Imperial IPA', 'English Stout', 'American Amber / Red Ale', 'American Barleywine', 'Smoke Beer', 'American Adjunct Lager', 'European Export / Dortmunder', 'Russian Imperial Stout', 'American Lager', 'German Altbier', 'American Light Lager', 'English Strong Ale', 'German Doppelbock', 'Leipzig Gose', 'American Imperial Pilsner', 'American Stout', 'English Porter', 'German Kellerbier / Zwickelbier', 'American Pale Ale (APA)', 'German Weizenbock', 'American Wheatwine Ale', 'Winter Warmer', 'Berliner Weisse', 'Braggot', 'German Eisbock', 'British Barleywine', 'English Brown Ale', 'American Brett', 'Smoke Porter', 'California Common / Steam Beer', 'Bière de Champagne / Bière Brut', 'German Helles', 'German Märzen / Oktoberfest', 'American Imperial Porter', 'American Pale Wheat Ale', 'German Schwarzbier', 'American Strong Ale', 'Rye Beer', 'German Kölsch', 'English Old Ale', 'American Imperial Red Ale', 'Irish Red Ale', 'American Cream Ale', 'German Maibock', 'European Dark Lager', 'Baltic Porter', 'English Extra Special / Strong Bitter (ESB)', 'German Dunkelweizen', 'English Dark Mild Ale', 'American Dark Wheat Ale', 'Munich Dunkel Lager', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'English Pale Mild Ale', 'American Malt Liquor', 'Robust Porter', 'Finnish Sahti', 'American Brut IPA']
NZ: ['American IPA', 'Bohemian Pilsener', 'European Pale Lager', 'English Porter', 'American Pale Ale (APA)', 'American Adjunct Lager', 'Herb and Spice Beer', 'American Amber / Red Ale', 'Belgian Saison', 'Vienna Lager', 'German Pilsner', 'American Blonde Ale', 'American Porter', 'German Bock', 'English Dark Mild Ale', 'American Wild Ale', 'English Sweet / Milk Stout', 'American Imperial IPA', 'English Strong Ale', 'Fruit and Field Beer', 'English Pale Ale', 'Rye Beer', 'German Helles', 'English India Pale Ale (IPA)', 'English Brown Ale', 'American Stout', 'Belgian Witbier', 'English Stout', 'Chile Beer', 'American Pale Wheat Ale', 'English Oatmeal Stout', 'Smoke Beer', 'Belgian Strong Pale Ale', 'Scotch Ale / Wee Heavy', 'American Black Ale', 'German Schwarzbier', 'Belgian Tripel', 'Flanders Oud Bruin', 'English Old Ale', 'American Brown Ale', 'Belgian Dubbel', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'American Imperial Red Ale', 'Scottish Ale', 'Russian Imperial Stout', 'American Light Lager', 'Irish Red Ale', 'American Cream Ale', 'German Hefeweizen', 'German Kölsch', 'German Märzen / Oktoberfest', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'Low Alcohol Beer', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'Foreign / Export Stout', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'German Dunkelweizen', 'California Common / Steam Beer', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'British Barleywine', 'American Imperial Pilsner', 'French Bière de Garde', 'Munich Dunkel Lager', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti', 'German Eisbock', 'New England IPA', 'Bière de Champagne / Bière Brut', 'Scottish Gruit / Ancient Herbed Ale', 'Japanese Rice Lager', 'Japanese Happoshu', 'European Strong Lager']
RU: ['Leipzig Gose', 'English Pale Ale', 'English Stout', 'American IPA', 'Belgian Saison', 'European Pale Lager', 'European Dark Lager', 'Belgian Witbier', 'German Pilsner', 'German Helles', 'Bohemian Pilsener', 'Russian Kvass', 'Munich Dunkel Lager', 'Irish Red Ale', 'German Märzen / Oktoberfest', 'Vienna Lager', 'American Light Lager', 'American Adjunct Lager', 'American Imperial IPA', 'American Pale Wheat Ale', 'American Pale Ale (APA)', 'English Oatmeal Stout', 'English India Pale Ale (IPA)', 'German Weizenbock', 'English Sweet / Milk Stout', 'Fruit and Field Beer', 'English Porter', 'German Kellerbier / Zwickelbier', 'American Amber / Red Lager', 'American Malt Liquor', 'Herb and Spice Beer', 'Belgian Quadrupel (Quad)', 'Smoke Beer', 'Russian Imperial Stout', 'Low Alcohol Beer', 'German Schwarzbier', 'American Brown Ale', 'American Lager', 'American Porter', 'American Imperial Stout', 'Belgian Pale Ale', 'American Wild Ale', 'Flanders Oud Bruin', 'Rye Beer', 'New England IPA', 'Belgian Tripel', 'English Old Ale', 'Belgian Strong Dark Ale', 'American Amber / Red Ale', 'American Imperial Pilsner', 'Winter Warmer', 'Belgian Dark Ale', 'American Barleywine', 'English Extra Special / Strong Bitter (ESB)', 'Belgian Dubbel', 'Bière de Champagne / Bière Brut', 'European Strong Lager', 'American Strong Ale', 'Belgian IPA', 'Baltic Porter', 'British Barleywine', 'Berliner Weisse', 'American Stout', 'Belgian Strong Pale Ale', 'German Hefeweizen', 'English Bitter', 'German Doppelbock', 'German Rauchbier', 'Finnish Sahti', 'German Bock', 'English Brown Ale', 'German Kristalweizen', 'American Blonde Ale', 'Scottish Ale', 'English Pale Mild Ale', 'English Dark Mild Ale', 'Foreign / Export Stout', 'Belgian Blonde Ale', 'European Export / Dortmunder', 'English Strong Ale', 'American Black Ale', 'American Wheatwine Ale', 'French Bière de Garde', 'Irish Dry Stout', 'Braggot', 'Flanders Red Ale', 'German Altbier', 'Pumpkin Beer', 'Belgian Lambic', 'Smoke Porter', 'Scotch Ale / Wee Heavy', 'German Kölsch', 'American Imperial Porter', 'German Dunkelweizen', 'American Cream Ale', 'German Roggenbier', 'German Eisbock', 'Chile Beer', 'Belgian Gueuze', 'German Maibock', 'Belgian Fruit Lambic', 'California Common / Steam Beer', 'Scottish Gruit / Ancient Herbed Ale', 'American Imperial Red Ale', 'American Dark Wheat Ale', 'American Brett', 'Robust Porter', 'Japanese Rice Lager']
DK: ['American Imperial IPA', 'American IPA', 'Belgian Saison', 'Belgian Strong Dark Ale', 'American Porter', 'American Barleywine', 'British Barleywine', 'American Imperial Stout', 'American Pale Ale (APA)', 'Belgian Quadrupel (Quad)', 'Belgian Witbier', 'Winter Warmer', 'American Lager', 'Bière de Champagne / Bière Brut', 'American Pale Wheat Ale', 'Belgian Dark Ale', 'Belgian Tripel', 'American Amber / Red Ale', 'Belgian Strong Pale Ale', 'English Porter', 'English Extra Special / Strong Bitter (ESB)', 'Fruit and Field Beer', 'English Brown Ale', 'German Dunkelweizen', 'German Bock', 'English India Pale Ale (IPA)', 'California Common / Steam Beer', 'German Doppelbock', 'English Sweet / Milk Stout', 'English Stout', 'Bohemian Pilsener', 'Baltic Porter', 'German Hefeweizen', 'German Kellerbier / Zwickelbier', 'European Pale Lager', 'German Altbier', 'Herb and Spice Beer', 'Scottish Ale', 'American Stout', 'American Strong Ale', 'German Kölsch', 'American Black Ale', 'English Old Ale', 'German Weizenbock', 'Scotch Ale / Wee Heavy', 'American Brown Ale', 'New England IPA', 'Low Alcohol Beer', 'American Light Lager', 'European Export / Dortmunder', 'European Strong Lager', 'European Dark Lager', 'American Adjunct Lager', 'American Amber / Red Lager', 'Foreign / Export Stout', 'German Schwarzbier', 'Vienna Lager', 'Japanese Rice Lager', 'Belgian Blonde Ale', 'American Cream Ale', 'German Kristalweizen', 'English Strong Ale', 'German Märzen / Oktoberfest', 'German Pilsner', 'English Pale Ale', 'Belgian Pale Ale', 'German Maibock', 'German Eisbock', 'Belgian Fruit Lambic', 'Smoke Beer', 'Irish Red Ale', 'German Rauchbier', 'French Bière de Garde', 'Belgian Dubbel', 'Irish Dry Stout', 'English Oatmeal Stout', 'Munich Dunkel Lager', 'Russian Imperial Stout', 'American Wild Ale', 'Belgian IPA', 'Braggot', 'Leipzig Gose', 'American Imperial Red Ale', 'American Imperial Pilsner', 'Berliner Weisse', 'Smoke Porter', 'English Dark Mild Ale', 'American Dark Wheat Ale', 'Belgian Gueuze', 'American Wheatwine Ale', 'American Blonde Ale', 'Belgian Lambic', 'Flanders Oud Bruin', 'German Helles', 'American Imperial Porter', 'German Roggenbier', 'Rye Beer', 'Flanders Red Ale', 'American Malt Liquor', 'Robust Porter', 'Scottish Gruit / Ancient Herbed Ale', 'English Pale Mild Ale', 'American Brett', 'Belgian Faro', 'Pumpkin Beer', 'Chile Beer', 'English Bitter']
FR: ['Belgian Blonde Ale', 'Belgian IPA', 'American Pale Wheat Ale', 'American IPA', 'Belgian Pale Ale', 'French Bière de Garde', 'Belgian Dark Ale', 'Fruit and Field Beer', 'Herb and Spice Beer', 'American Pale Ale (APA)', 'American Imperial IPA', 'English Pale Ale', 'Belgian Strong Pale Ale', 'Belgian Dubbel', 'Belgian Witbier', 'English Brown Ale', 'Winter Warmer', 'American Brown Ale', 'American Blonde Ale', 'Belgian Saison', 'American Barleywine', 'Low Alcohol Beer', 'American Light Lager', 'English Stout', 'American Imperial Stout', 'Belgian Tripel', 'Bière de Champagne / Bière Brut', 'American Amber / Red Ale', 'German Kölsch', 'German Bock', 'European Pale Lager', 'German Pilsner', 'European Strong Lager', 'Munich Dunkel Lager', 'Scottish Ale', 'English Bitter', 'Smoke Beer', 'English India Pale Ale (IPA)', 'Belgian Lambic', 'Belgian Strong Dark Ale', 'European Dark Lager', 'English Sweet / Milk Stout', 'Pumpkin Beer', 'Russian Imperial Stout', 'English Porter', 'British Barleywine', 'American Black Ale', 'Flanders Red Ale', 'Scotch Ale / Wee Heavy', 'American Amber / Red Lager', 'Foreign / Export Stout', 'Berliner Weisse', 'English Extra Special / Strong Bitter (ESB)', 'English Oatmeal Stout', 'American Stout', 'American Porter', 'Baltic Porter', 'German Dunkelweizen', 'Robust Porter', 'Rye Beer', 'American Dark Wheat Ale', 'Flanders Oud Bruin', 'American Adjunct Lager', 'German Schwarzbier', 'German Hefeweizen', 'English Dark Mild Ale', 'American Wild Ale', 'Belgian Gueuze', 'Belgian Fruit Lambic', 'Irish Dry Stout', 'American Lager', 'New England IPA', 'Irish Red Ale', 'Belgian Quadrupel (Quad)', 'Bohemian Pilsener', 'Scottish Gruit / Ancient Herbed Ale', 'Vienna Lager', 'English Strong Ale', 'American Brut IPA', 'English Old Ale', 'Leipzig Gose', 'German Weizenbock', 'German Doppelbock', 'European Export / Dortmunder', 'German Maibock', 'American Cream Ale', 'American Wheatwine Ale', 'English Pale Mild Ale', 'California Common / Steam Beer', 'German Roggenbier', 'German Rauchbier', 'German Kellerbier / Zwickelbier', 'American Imperial Pilsner', 'American Imperial Red Ale', 'German Märzen / Oktoberfest', 'German Altbier', 'German Helles', 'American Strong Ale', 'Smoke Porter', 'Chile Beer', 'American Imperial Porter', 'American Brett', 'American Malt Liquor', 'German Kristalweizen', 'Braggot', 'Finnish Sahti', 'German Eisbock']
IT: ['European Pale Lager', 'German Doppelbock', 'German Pilsner', 'German Märzen / Oktoberfest', 'German Bock', 'American Imperial IPA', 'American Brown Ale', 'Belgian Dark Ale', 'Herb and Spice Beer', 'Belgian Strong Pale Ale', 'Belgian Strong Dark Ale', 'Smoke Beer', 'English India Pale Ale (IPA)', 'Belgian Saison', 'Belgian Witbier', 'Belgian Pale Ale', 'British Barleywine', 'German Kellerbier / Zwickelbier', 'German Helles', 'Fruit and Field Beer', 'German Hefeweizen', 'American Pale Ale (APA)', 'English Porter', 'American Blonde Ale', 'German Weizenbock', 'German Dunkelweizen', 'American Strong Ale', 'English Pale Mild Ale', 'American Amber / Red Ale', 'Belgian Dubbel', 'Winter Warmer', 'Belgian Lambic', 'American IPA', 'Irish Dry Stout', 'American Black Ale', 'German Kölsch', 'English Brown Ale', 'American Wild Ale', 'German Schwarzbier', 'American Brett', 'American Amber / Red Lager', 'American Imperial Pilsner', 'Leipzig Gose', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Pale Wheat Ale', 'English Pale Ale', 'Flanders Red Ale', 'Bière de Champagne / Bière Brut', 'English Stout', 'Foreign / Export Stout', 'English Strong Ale', 'English Bitter', 'German Rauchbier', 'Vienna Lager', 'Rye Beer', 'German Maibock', 'Bohemian Pilsener', 'English Old Ale', 'Pumpkin Beer', 'European Dark Lager', 'Belgian Tripel', 'English Oatmeal Stout', 'American Imperial Stout', 'Belgian Quadrupel (Quad)', 'Baltic Porter', 'Belgian Fruit Lambic', 'Munich Dunkel Lager', 'European Strong Lager', 'English Sweet / Milk Stout', 'German Roggenbier', 'Russian Imperial Stout', 'California Common / Steam Beer', 'American Porter', 'American Adjunct Lager', 'Braggot', 'Scottish Ale', 'Flanders Oud Bruin', 'Berliner Weisse', 'Scotch Ale / Wee Heavy', 'English Dark Mild Ale', 'Irish Red Ale', 'Low Alcohol Beer', 'Belgian Gueuze', 'American Stout', 'American Barleywine', 'French Bière de Garde', 'American Light Lager', 'American Imperial Porter', 'Japanese Rice Lager', 'Belgian Blonde Ale', 'Finnish Sahti', 'New England IPA', 'European Export / Dortmunder', 'Robust Porter', 'German Altbier', 'German Eisbock', 'Scottish Gruit / Ancient Herbed Ale', 'Belgian IPA', 'American Imperial Red Ale', 'American Cream Ale', 'Smoke Porter', 'Chile Beer', 'American Dark Wheat Ale', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen']
ES: ['German Pilsner', 'Irish Dry Stout', 'Belgian Dubbel', 'German Märzen / Oktoberfest', 'German Helles', 'American Pale Ale (APA)', 'English Pale Ale', 'Belgian Strong Pale Ale', 'Belgian Pale Ale', 'Belgian Quadrupel (Quad)', 'American Amber / Red Ale', 'Baltic Porter', 'Belgian Witbier', 'Bohemian Pilsener', 'German Dunkelweizen', 'English Extra Special / Strong Bitter (ESB)', 'American IPA', 'American Imperial IPA', 'Vienna Lager', 'Belgian Blonde Ale', 'American Stout', 'Fruit and Field Beer', 'American Imperial Stout', 'English Sweet / Milk Stout', 'English Porter', 'American Blonde Ale', 'Belgian Dark Ale', 'Irish Red Ale', 'Berliner Weisse', 'German Kölsch', 'Russian Imperial Stout', 'German Hefeweizen', 'Pumpkin Beer', 'American Brown Ale', 'English India Pale Ale (IPA)', 'English Brown Ale', 'Winter Warmer', 'Smoke Beer', 'American Porter', 'Belgian IPA', 'Belgian Strong Dark Ale', 'American Wild Ale', 'American Black Ale', 'Rye Beer', 'American Barleywine', 'American Cream Ale', 'English Pale Mild Ale', 'Scotch Ale / Wee Heavy', 'British Barleywine', 'German Rauchbier', 'American Imperial Pilsner', 'Low Alcohol Beer', 'English Stout', 'German Weizenbock', 'Belgian Tripel', 'American Strong Ale', 'English Strong Ale', 'English Bitter', 'Herb and Spice Beer', 'European Pale Lager', 'Belgian Saison', 'American Pale Wheat Ale', 'Scottish Ale', 'American Lager', 'French Bière de Garde', 'Leipzig Gose', 'German Eisbock', 'German Doppelbock', 'American Amber / Red Lager', 'English Oatmeal Stout', 'Flanders Oud Bruin', 'Belgian Gueuze', 'European Strong Lager', 'American Light Lager', 'Munich Dunkel Lager', 'Japanese Rice Lager', 'New England IPA', 'Belgian Fruit Lambic', 'American Adjunct Lager', 'German Schwarzbier', 'German Altbier', 'California Common / Steam Beer', 'European Export / Dortmunder', 'Chile Beer', 'German Bock', 'German Maibock', 'English Dark Mild Ale', 'German Roggenbier', 'American Wheatwine Ale', 'English Old Ale', 'Foreign / Export Stout', 'American Dark Wheat Ale', 'Braggot', 'American Brett', 'American Imperial Porter', 'American Brut IPA', 'American Imperial Red Ale', 'European Dark Lager', 'Smoke Porter', 'Belgian Lambic', 'Flanders Red Ale', 'German Kellerbier / Zwickelbier', 'American Malt Liquor', 'German Kristalweizen', 'Robust Porter', 'Finnish Sahti']
BR: ['American IPA', 'Bohemian Pilsener', 'American Imperial IPA', 'German Bock', 'English Stout', 'American Amber / Red Ale', 'American Pale Wheat Ale', 'Fruit and Field Beer', 'German Hefeweizen', 'American Stout', 'American Pale Ale (APA)', 'American Adjunct Lager', 'German Kölsch', 'American Amber / Red Lager', 'Irish Red Ale', 'Smoke Beer', 'American Barleywine', 'Belgian Dubbel', 'English India Pale Ale (IPA)', 'Scotch Ale / Wee Heavy', 'American Black Ale', 'Belgian Witbier', 'American Strong Ale', 'English Porter', 'Belgian Saison', 'Belgian Tripel', 'Rye Beer', 'German Märzen / Oktoberfest', 'American Imperial Stout', 'Russian Imperial Stout', 'British Barleywine', 'English Dark Mild Ale', 'Belgian Strong Pale Ale', 'American Blonde Ale', 'Vienna Lager', 'Belgian Gueuze', 'Bière de Champagne / Bière Brut', 'Berliner Weisse', 'Scottish Ale', 'German Schwarzbier', 'Pumpkin Beer', 'German Pilsner', 'American Lager', 'German Kellerbier / Zwickelbier', 'Belgian Quadrupel (Quad)', 'Munich Dunkel Lager', 'Belgian Pale Ale', 'Irish Dry Stout', 'Smoke Porter', 'English Extra Special / Strong Bitter (ESB)', 'English Pale Ale', 'Winter Warmer', 'English Oatmeal Stout', 'Herb and Spice Beer', 'American Brown Ale', 'Leipzig Gose', 'English Brown Ale', 'American Porter', 'California Common / Steam Beer', 'New England IPA', 'Belgian Strong Dark Ale', 'European Export / Dortmunder', 'American Cream Ale', 'Chile Beer', 'German Helles', 'German Maibock', 'German Doppelbock', 'English Sweet / Milk Stout', 'English Pale Mild Ale', 'German Dunkelweizen', 'German Roggenbier', 'Belgian IPA', 'German Rauchbier', 'American Wild Ale', 'Baltic Porter', 'American Wheatwine Ale', 'German Weizenbock', 'French Bière de Garde', 'European Pale Lager', 'Low Alcohol Beer', 'American Light Lager', 'English Old Ale', 'Belgian Dark Ale', 'American Brett', 'American Imperial Pilsner', 'German Altbier', 'Belgian Blonde Ale', 'American Malt Liquor', 'European Dark Lager', 'German Kristalweizen', 'English Strong Ale', 'American Brut IPA', 'Belgian Fruit Lambic', 'Foreign / Export Stout', 'Flanders Red Ale', 'American Imperial Porter', 'English Bitter', 'Flanders Oud Bruin', 'American Imperial Red Ale', 'American Dark Wheat Ale', 'Belgian Lambic', 'Braggot', 'Robust Porter', 'Finnish Sahti', 'European Strong Lager']
LT: ['German Kellerbier / Zwickelbier', 'Belgian Saison', 'English Stout', 'Herb and Spice Beer', 'European Pale Lager', 'Russian Kvass', 'German Hefeweizen', 'European Strong Lager', 'English Pale Mild Ale', 'Low Alcohol Beer', 'American Amber / Red Lager', 'Bohemian Pilsener', 'Fruit and Field Beer', 'Winter Warmer', 'English Pale Ale', 'European Dark Lager', 'American Adjunct Lager', 'Scottish Ale', 'English Sweet / Milk Stout', 'German Märzen / Oktoberfest', 'American IPA', 'European Export / Dortmunder', 'German Bock', 'German Pilsner', 'Belgian Dubbel', 'English Porter', 'American Blonde Ale', 'American Stout', 'Irish Dry Stout', 'Belgian Witbier', 'Vienna Lager', 'English Brown Ale', 'Smoke Beer', 'Belgian Quadrupel (Quad)', 'Russian Imperial Stout', 'German Kölsch', 'Finnish Sahti', 'English Old Ale', 'American Amber / Red Ale', 'American Imperial IPA', 'American Brown Ale', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'American Imperial Red Ale', 'American Porter', 'American Pale Ale (APA)', 'American Pale Wheat Ale', 'American Light Lager', 'Belgian Strong Pale Ale', 'Irish Red Ale', 'American Cream Ale', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'Foreign / Export Stout', 'English Oatmeal Stout', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Berliner Weisse', 'Chile Beer', 'German Dunkelweizen', 'California Common / Steam Beer', 'English Dark Mild Ale', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'German Schwarzbier', 'British Barleywine', 'American Imperial Pilsner', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Belgian Tripel', 'Munich Dunkel Lager', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Strong Ale', 'American Brett', 'Belgian Gueuze', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'New England IPA', 'Scottish Gruit / Ancient Herbed Ale']
UA: ['Belgian Saison', 'European Pale Lager', 'American Blonde Ale', 'German Hefeweizen', 'German Dunkelweizen', 'American Amber / Red Ale', 'Winter Warmer', 'American IPA', 'American Brown Ale', 'American Porter', 'German Märzen / Oktoberfest', 'English Bitter', 'Rye Beer', 'English Sweet / Milk Stout', 'Belgian IPA', 'American Black Ale', 'American Barleywine', 'California Common / Steam Beer', 'Scotch Ale / Wee Heavy', 'American Imperial IPA', 'American Imperial Pilsner', 'Irish Red Ale', 'American Lager', 'American Stout', 'American Strong Ale', 'German Kölsch', 'English Oatmeal Stout', 'American Imperial Stout', 'American Cream Ale', 'Russian Kvass', 'Fruit and Field Beer', 'Leipzig Gose', 'German Pilsner', 'American Pale Ale (APA)', 'Belgian Tripel', 'American Wild Ale', 'Belgian Dubbel', 'American Adjunct Lager', 'Belgian Lambic', 'English Brown Ale', 'Herb and Spice Beer', 'Belgian Strong Dark Ale', 'Finnish Sahti', 'American Pale Wheat Ale', 'Scottish Gruit / Ancient Herbed Ale', 'Irish Dry Stout', 'Belgian Strong Pale Ale', 'Belgian Pale Ale', 'Smoke Beer', 'Belgian Fruit Lambic', 'Belgian Witbier', 'English Extra Special / Strong Bitter (ESB)', 'Berliner Weisse', 'Robust Porter', 'Flanders Red Ale', 'Pumpkin Beer', 'Foreign / Export Stout', 'French Bière de Garde', 'American Wheatwine Ale', 'English Pale Ale', 'Low Alcohol Beer', 'German Maibock', 'English India Pale Ale (IPA)', 'Japanese Rice Lager', 'European Strong Lager', 'European Dark Lager', 'German Kellerbier / Zwickelbier', 'German Kristalweizen', 'Baltic Porter', 'Vienna Lager', 'Munich Dunkel Lager', 'European Export / Dortmunder', 'American Light Lager', 'Belgian Blonde Ale', 'German Bock', 'English Strong Ale', 'Belgian Quadrupel (Quad)', 'German Schwarzbier', 'German Doppelbock', 'Bohemian Pilsener', 'Russian Imperial Stout', 'German Rauchbier', 'German Helles', 'English Old Ale', 'American Imperial Red Ale', 'Scottish Ale', 'German Altbier', 'Belgian Dark Ale', 'German Weizenbock', 'Smoke Porter', 'Chile Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'British Barleywine', 'English Stout', 'Flanders Oud Bruin', 'German Roggenbier', 'American Amber / Red Lager', 'English Pale Mild Ale', 'American Brett', 'Belgian Gueuze', 'American Malt Liquor', 'Braggot']
DE: ['German Pilsner', 'Fruit and Field Beer', 'German Märzen / Oktoberfest', 'German Helles', 'Munich Dunkel Lager', 'German Hefeweizen', 'German Kellerbier / Zwickelbier', 'English India Pale Ale (IPA)', 'German Schwarzbier', 'British Barleywine', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'Belgian Pale Ale', 'Belgian Dark Ale', 'Belgian Tripel', 'Belgian Strong Pale Ale', 'Russian Imperial Stout', 'Belgian Dubbel', 'Belgian Blonde Ale', 'Belgian Witbier', 'Belgian Saison', 'Belgian IPA', 'Belgian Strong Dark Ale', 'Herb and Spice Beer', 'Irish Dry Stout', 'American Blonde Ale', 'European Pale Lager', 'German Altbier', 'Vienna Lager', 'German Maibock', 'German Dunkelweizen', 'European Export / Dortmunder', 'Low Alcohol Beer', 'American Wild Ale', 'American Amber / Red Ale', 'Leipzig Gose', 'German Kölsch', 'Berliner Weisse', 'Smoke Beer', 'American Lager', 'American IPA', 'American Pale Ale (APA)', 'American Imperial Stout', 'American Imperial IPA', 'Flanders Red Ale', 'English Porter', 'American Barleywine', 'Flanders Oud Bruin', 'Belgian Gueuze', 'American Stout', 'German Weizenbock', 'Russian Kvass', 'English Strong Ale', 'German Bock', 'English Sweet / Milk Stout', 'German Kristalweizen', 'American Black Ale', 'Baltic Porter', 'Pumpkin Beer', 'American Amber / Red Lager', 'German Eisbock', 'English Pale Ale', 'German Roggenbier', 'Japanese Rice Lager', 'New England IPA', 'American Brown Ale', 'Bière de Champagne / Bière Brut', 'German Rauchbier', 'American Pale Wheat Ale', 'Rye Beer', 'American Porter', 'English Dark Mild Ale', 'American Strong Ale', 'American Imperial Porter', 'Bohemian Pilsener', 'English Old Ale', 'English Brown Ale', 'American Cream Ale', 'Winter Warmer', 'American Brett', 'English Oatmeal Stout', 'American Imperial Pilsner', 'Irish Red Ale', 'English Stout', 'European Strong Lager', 'American Light Lager', 'Chile Beer', 'English Bitter', 'English Pale Mild Ale', 'European Dark Lager', 'English Extra Special / Strong Bitter (ESB)', 'Scottish Gruit / Ancient Herbed Ale', 'Scottish Ale', 'Smoke Porter', 'American Wheatwine Ale', 'American Adjunct Lager', 'French Bière de Garde', 'American Imperial Red Ale', 'California Common / Steam Beer', 'Braggot', 'American Brut IPA', 'Foreign / Export Stout', 'Scotch Ale / Wee Heavy', 'Belgian Lambic']
NL: ['American IPA', 'English Porter', 'Russian Imperial Stout', 'French Bière de Garde', 'British Barleywine', 'American Barleywine', 'English Dark Mild Ale', 'American Imperial Stout', 'Fruit and Field Beer', 'German Eisbock', 'American Porter', 'Baltic Porter', 'English Oatmeal Stout', 'American Pale Ale (APA)', 'Smoke Beer', 'New England IPA', 'Belgian Quadrupel (Quad)', 'American Imperial IPA', 'American Stout', 'English Sweet / Milk Stout', 'Belgian IPA', 'Scotch Ale / Wee Heavy', 'German Doppelbock', 'German Altbier', 'American Cream Ale', 'Belgian Dark Ale', 'Belgian Saison', 'English Strong Ale', 'Smoke Porter', 'German Hefeweizen', 'Belgian Blonde Ale', 'American Black Ale', 'American Pale Wheat Ale', 'Belgian Tripel', 'German Bock', 'American Lager', 'American Amber / Red Ale', 'German Dunkelweizen', 'Belgian Witbier', 'Belgian Strong Pale Ale', 'European Pale Lager', 'Foreign / Export Stout', 'German Maibock', 'American Adjunct Lager', 'English Pale Ale', 'American Wild Ale', 'Belgian Pale Ale', 'Belgian Strong Dark Ale', 'English India Pale Ale (IPA)', 'English Pale Mild Ale', 'American Blonde Ale', 'English Old Ale', 'English Extra Special / Strong Bitter (ESB)', 'Winter Warmer', 'English Brown Ale', 'Herb and Spice Beer', 'American Brown Ale', 'German Pilsner', 'German Kölsch', 'German Rauchbier', 'Flanders Oud Bruin', 'Bohemian Pilsener', 'Belgian Dubbel', 'German Weizenbock', 'English Bitter', 'American Light Lager', 'German Kellerbier / Zwickelbier', 'Pumpkin Beer', 'Rye Beer', 'American Imperial Porter', 'American Amber / Red Lager', 'Braggot', 'Low Alcohol Beer', 'European Strong Lager', 'European Dark Lager', 'European Export / Dortmunder', 'Berliner Weisse', 'Scottish Gruit / Ancient Herbed Ale', 'Leipzig Gose', 'California Common / Steam Beer', 'English Stout', 'Belgian Fruit Lambic', 'American Wheatwine Ale', 'American Strong Ale', 'German Märzen / Oktoberfest', 'Flanders Red Ale', 'German Schwarzbier', 'Robust Porter', 'American Brett', 'German Helles', 'German Kristalweizen', 'Belgian Lambic', 'Irish Red Ale', 'Irish Dry Stout', 'Belgian Gueuze', 'Vienna Lager', 'American Imperial Pilsner', 'Scottish Ale', 'Chile Beer', 'Munich Dunkel Lager', 'Finnish Sahti', 'Bière de Champagne / Bière Brut', 'American Malt Liquor', 'German Roggenbier']
CZ: ['Munich Dunkel Lager', 'Bohemian Pilsener', 'German Hefeweizen', 'Foreign / Export Stout', 'American Pale Ale (APA)', 'American Imperial IPA', 'American IPA', 'German Altbier', 'German Märzen / Oktoberfest', 'Baltic Porter', 'American Amber / Red Ale', 'Herb and Spice Beer', 'American Blonde Ale', 'English Stout', 'Smoke Beer', 'American Black Ale', 'English India Pale Ale (IPA)', 'American Brown Ale', 'Russian Imperial Stout', 'Vienna Lager', 'European Dark Lager', 'German Doppelbock', 'European Pale Lager', 'Belgian Pale Ale', 'German Rauchbier', 'American Wild Ale', 'Low Alcohol Beer', 'Belgian Dubbel', 'American Lager', 'English Oatmeal Stout', 'American Imperial Stout', 'English Sweet / Milk Stout', 'American Porter', 'Belgian Quadrupel (Quad)', 'Rye Beer', 'Fruit and Field Beer', 'European Strong Lager', 'American Pale Wheat Ale', 'American Barleywine', 'Bière de Champagne / Bière Brut', 'German Bock', 'Belgian Witbier', 'German Dunkelweizen', 'German Schwarzbier', 'American Light Lager', 'American Strong Ale', 'American Stout', 'Belgian Strong Dark Ale', 'American Amber / Red Lager', 'English Extra Special / Strong Bitter (ESB)', 'Belgian Blonde Ale', 'English Porter', 'Scottish Ale', 'Braggot', 'German Weizenbock', 'Irish Dry Stout', 'English Pale Ale', 'Scotch Ale / Wee Heavy', 'Berliner Weisse', 'Belgian Strong Pale Ale', 'German Pilsner', 'Belgian IPA', 'German Roggenbier', 'German Kristalweizen', 'German Maibock', 'American Imperial Pilsner', 'English Old Ale', 'English Brown Ale', 'American Imperial Red Ale', 'Irish Red Ale', 'American Cream Ale', 'German Kölsch', 'Belgian Saison', 'Belgian Dark Ale', 'Pumpkin Beer', 'Belgian Fruit Lambic', 'German Helles', 'Leipzig Gose', 'English Bitter', 'Smoke Porter', 'Winter Warmer', 'Chile Beer', 'California Common / Steam Beer', 'English Dark Mild Ale', 'American Dark Wheat Ale', 'American Imperial Porter', 'American Adjunct Lager', 'British Barleywine', 'French Bière de Garde', 'Belgian Tripel', 'Flanders Oud Bruin', 'Belgian Lambic', 'Flanders Red Ale', 'English Strong Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'Robust Porter', 'Finnish Sahti']
IE: ['American Blonde Ale', 'English Old Ale', 'American IPA', 'Herb and Spice Beer', 'Fruit and Field Beer', 'American Amber / Red Ale', 'American Imperial IPA', 'American Brown Ale', 'Belgian Dubbel', 'English Sweet / Milk Stout', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'English Brown Ale', 'American Imperial Red Ale', 'American Porter', 'Scottish Ale', 'German Pilsner', 'American Stout', 'American Pale Ale (APA)', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'German Bock', 'American Light Lager', 'Belgian Strong Pale Ale', 'Irish Red Ale', 'American Cream Ale', 'German Hefeweizen', 'German Kölsch', 'Belgian Witbier', 'German Märzen / Oktoberfest', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Saison', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'European Pale Lager', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'Low Alcohol Beer', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'English Pale Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'Foreign / Export Stout', 'English Oatmeal Stout', 'Smoke Beer', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'Bohemian Pilsener', 'Chile Beer', 'German Dunkelweizen', 'California Common / Steam Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'American Adjunct Lager', 'Vienna Lager', 'German Schwarzbier', 'British Barleywine', 'American Imperial Pilsner', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Belgian Tripel', 'English Stout', 'Munich Dunkel Lager', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Strong Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti', 'New England IPA', 'Scottish Gruit / Ancient Herbed Ale']
KY: ['American Blonde Ale', 'English Old Ale', 'American IPA', 'Herb and Spice Beer', 'Fruit and Field Beer', 'American Amber / Red Ale', 'American Imperial IPA', 'American Brown Ale', 'Belgian Dubbel', 'English Sweet / Milk Stout', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'English Brown Ale', 'American Imperial Red Ale', 'American Porter', 'Scottish Ale', 'German Pilsner', 'American Stout', 'American Pale Ale (APA)', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'German Bock', 'American Light Lager', 'Belgian Strong Pale Ale', 'Irish Red Ale', 'American Cream Ale', 'German Hefeweizen', 'German Kölsch', 'Belgian Witbier', 'German Märzen / Oktoberfest', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Saison', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'European Pale Lager', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'Low Alcohol Beer', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'English Pale Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'Foreign / Export Stout', 'English Oatmeal Stout', 'Smoke Beer', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'Bohemian Pilsener', 'Chile Beer', 'German Dunkelweizen', 'California Common / Steam Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'American Adjunct Lager', 'Vienna Lager', 'German Schwarzbier', 'British Barleywine', 'American Imperial Pilsner', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Belgian Tripel', 'English Stout', 'Munich Dunkel Lager', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Strong Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti', 'New England IPA', 'Scottish Gruit / Ancient Herbed Ale']
CR: ['American Brown Ale', 'Belgian Strong Pale Ale', 'English India Pale Ale (IPA)', 'American Amber / Red Ale', 'American Porter', 'English Pale Ale', 'American Pale Wheat Ale', 'American Blonde Ale', 'Herb and Spice Beer', 'American Pale Ale (APA)', 'German Dunkelweizen', 'American Stout', 'American Imperial Pilsner', 'Fruit and Field Beer', 'English Strong Ale', 'German Hefeweizen', 'German Pilsner', 'American IPA', 'German Bock', 'German Märzen / Oktoberfest', 'Belgian Saison', 'Belgian Witbier', 'American Imperial IPA', 'Foreign / Export Stout', 'English Old Ale', 'Belgian Dubbel', 'English Sweet / Milk Stout', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'English Brown Ale', 'American Imperial Red Ale', 'Scottish Ale', 'Russian Imperial Stout', 'American Light Lager', 'Irish Red Ale', 'American Cream Ale', 'German Kölsch', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'European Pale Lager', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'Low Alcohol Beer', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'English Oatmeal Stout', 'Smoke Beer', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'Bohemian Pilsener', 'Chile Beer', 'California Common / Steam Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'American Adjunct Lager', 'Vienna Lager', 'German Schwarzbier', 'British Barleywine', 'French Bière de Garde', 'Belgian Tripel', 'English Stout', 'Munich Dunkel Lager', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti', 'New England IPA']
SG: ['American Blonde Ale', 'English Old Ale', 'American IPA', 'Herb and Spice Beer', 'Fruit and Field Beer', 'American Amber / Red Ale', 'American Imperial IPA', 'American Brown Ale', 'Belgian Dubbel', 'English Sweet / Milk Stout', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'English Brown Ale', 'American Imperial Red Ale', 'American Porter', 'Scottish Ale', 'German Pilsner', 'American Stout', 'American Pale Ale (APA)', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'German Bock', 'American Light Lager', 'Belgian Strong Pale Ale', 'Irish Red Ale', 'American Cream Ale', 'German Hefeweizen', 'German Kölsch', 'Belgian Witbier', 'German Märzen / Oktoberfest', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Saison', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'European Pale Lager', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'Low Alcohol Beer', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'English Pale Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'Foreign / Export Stout', 'English Oatmeal Stout', 'Smoke Beer', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'Bohemian Pilsener', 'Chile Beer', 'German Dunkelweizen', 'California Common / Steam Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'American Adjunct Lager', 'Vienna Lager', 'German Schwarzbier', 'British Barleywine', 'American Imperial Pilsner', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Belgian Tripel', 'English Stout', 'Munich Dunkel Lager', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Strong Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti', 'European Strong Lager']
CU: ['German Schwarzbier', 'English Pale Ale', 'European Pale Lager', 'American Adjunct Lager', 'Low Alcohol Beer', 'American Blonde Ale', 'English Old Ale', 'American IPA', 'Herb and Spice Beer', 'Fruit and Field Beer', 'American Amber / Red Ale', 'American Imperial IPA', 'American Brown Ale', 'Belgian Dubbel', 'English Sweet / Milk Stout', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'English Brown Ale', 'American Imperial Red Ale', 'American Porter', 'Scottish Ale', 'German Pilsner', 'American Stout', 'American Pale Ale (APA)', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'German Bock', 'American Light Lager', 'Belgian Strong Pale Ale', 'Irish Red Ale', 'American Cream Ale', 'German Hefeweizen', 'German Kölsch', 'Belgian Witbier', 'German Märzen / Oktoberfest', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Saison', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'Foreign / Export Stout', 'English Oatmeal Stout', 'Smoke Beer', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'Bohemian Pilsener', 'Chile Beer', 'German Dunkelweizen', 'California Common / Steam Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'Vienna Lager', 'British Barleywine', 'American Imperial Pilsner', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Belgian Tripel', 'English Stout', 'Munich Dunkel Lager', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Strong Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'European Export / Dortmunder', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti']
ET: ['Munich Dunkel Lager', 'English Pale Ale', 'European Pale Lager', 'American Adjunct Lager', 'European Export / Dortmunder', 'American Blonde Ale', 'English Old Ale', 'American IPA', 'Herb and Spice Beer', 'Fruit and Field Beer', 'American Amber / Red Ale', 'American Imperial IPA', 'American Brown Ale', 'Belgian Dubbel', 'English Sweet / Milk Stout', 'Belgian Strong Dark Ale', 'American Imperial Stout', 'English Brown Ale', 'American Imperial Red Ale', 'American Porter', 'Scottish Ale', 'German Pilsner', 'American Stout', 'American Pale Ale (APA)', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'German Bock', 'American Light Lager', 'Belgian Strong Pale Ale', 'Irish Red Ale', 'American Cream Ale', 'German Hefeweizen', 'German Kölsch', 'Belgian Witbier', 'German Märzen / Oktoberfest', 'German Altbier', 'American Barleywine', 'Belgian IPA', 'Belgian Saison', 'Belgian Dark Ale', 'Pumpkin Beer', 'German Maibock', 'Belgian Pale Ale', 'Belgian Fruit Lambic', 'European Dark Lager', 'Low Alcohol Beer', 'German Helles', 'Baltic Porter', 'American Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Black Ale', 'Scotch Ale / Wee Heavy', 'American Wild Ale', 'Foreign / Export Stout', 'English Oatmeal Stout', 'Smoke Beer', 'Leipzig Gose', 'English Bitter', 'American Strong Ale', 'Irish Dry Stout', 'German Weizenbock', 'Rye Beer', 'Smoke Porter', 'Winter Warmer', 'Berliner Weisse', 'Bohemian Pilsener', 'Chile Beer', 'German Dunkelweizen', 'California Common / Steam Beer', 'English Dark Mild Ale', 'English Porter', 'American Dark Wheat Ale', 'American Imperial Porter', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'Vienna Lager', 'German Schwarzbier', 'British Barleywine', 'American Imperial Pilsner', 'English India Pale Ale (IPA)', 'French Bière de Garde', 'Belgian Tripel', 'English Stout', 'Flanders Oud Bruin', 'Belgian Lambic', 'German Roggenbier', 'German Rauchbier', 'American Amber / Red Lager', 'Belgian Blonde Ale', 'Flanders Red Ale', 'English Strong Ale', 'English Pale Mild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'Belgian Gueuze', 'American Malt Liquor', 'American Wheatwine Ale', 'German Kristalweizen', 'Braggot', 'Robust Porter', 'Finnish Sahti']
SE: ['English Bitter', 'American Porter', 'Herb and Spice Beer', 'American Pale Ale (APA)', 'English Stout', 'English Pale Ale', 'English Porter', 'American Amber / Red Ale', 'American IPA', 'European Dark Lager', 'English India Pale Ale (IPA)', 'British Barleywine', 'Low Alcohol Beer', 'European Pale Lager', 'Bohemian Pilsener', 'Smoke Beer', 'Winter Warmer', 'American Pale Wheat Ale', 'American Black Ale', 'American Imperial IPA', 'American Imperial Stout', 'Belgian Saison', 'Belgian Tripel', 'European Export / Dortmunder', 'Vienna Lager', 'German Kellerbier / Zwickelbier', 'American Brown Ale', 'European Strong Lager', 'German Pilsner', 'German Märzen / Oktoberfest', 'Fruit and Field Beer', 'German Eisbock', 'Baltic Porter', 'American Lager', 'California Common / Steam Beer', 'American Amber / Red Lager', 'American Dark Wheat Ale', 'New England IPA', 'Munich Dunkel Lager', 'American Light Lager', 'German Bock', 'American Imperial Pilsner', 'German Weizenbock', 'German Schwarzbier', 'English Strong Ale', 'English Oatmeal Stout', 'German Rauchbier', 'American Barleywine', 'Russian Imperial Stout', 'American Imperial Porter', 'Belgian Pale Ale', 'Flanders Oud Bruin', 'Belgian Dark Ale', 'Belgian Blonde Ale', 'American Blonde Ale', 'American Imperial Red Ale', 'American Adjunct Lager', 'German Hefeweizen', 'Belgian Quadrupel (Quad)', 'Berliner Weisse', 'Smoke Porter', 'American Wild Ale', 'Belgian Strong Dark Ale', 'Belgian Dubbel', 'Irish Dry Stout', 'Bière de Champagne / Bière Brut', 'American Strong Ale', 'Leipzig Gose', 'Belgian Fruit Lambic', 'Flanders Red Ale', 'Scottish Ale', 'Belgian Witbier', 'German Maibock', 'English Extra Special / Strong Bitter (ESB)', 'English Brown Ale', 'American Stout', 'Belgian Strong Pale Ale', 'French Bière de Garde', 'German Altbier', 'German Helles', 'German Kölsch', 'Foreign / Export Stout', 'Chile Beer', 'Belgian Lambic', 'English Sweet / Milk Stout', 'German Dunkelweizen', 'German Kristalweizen', 'English Dark Mild Ale', 'Irish Red Ale', 'Braggot', 'German Doppelbock', 'American Brett', 'Rye Beer', 'Belgian IPA', 'Scotch Ale / Wee Heavy', 'English Old Ale', 'Scottish Gruit / Ancient Herbed Ale', 'Finnish Sahti', 'English Pale Mild Ale', 'American Cream Ale', 'American Wheatwine Ale']
GR: ['European Pale Lager', 'American Pale Ale (APA)', 'American Blonde Ale', 'English India Pale Ale (IPA)', 'American Porter', 'American Imperial IPA', 'American Imperial Stout', 'American IPA', 'Belgian Pale Ale', 'Belgian Saison', 'American Stout', 'German Hefeweizen', 'American Strong Ale', 'European Dark Lager', 'American Imperial Pilsner', 'Bohemian Pilsener', 'Low Alcohol Beer', 'American Light Lager', 'English Bitter', 'German Schwarzbier', 'American Amber / Red Ale', 'Berliner Weisse', 'English Pale Ale', 'American Barleywine', 'German Pilsner', 'German Kellerbier / Zwickelbier', 'Belgian Dark Ale', 'Belgian Witbier', 'Baltic Porter', 'Scotch Ale / Wee Heavy', 'Smoke Porter', 'German Dunkelweizen', 'Fruit and Field Beer', 'Munich Dunkel Lager', 'American Lager', 'German Weizenbock', 'English Porter', 'Irish Dry Stout', 'Belgian Dubbel', 'American Brown Ale', 'Belgian Strong Dark Ale', 'European Export / Dortmunder', 'German Doppelbock', 'Scottish Ale', 'German Märzen / Oktoberfest', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'American Black Ale', 'Irish Red Ale', 'European Strong Lager', 'American Adjunct Lager', 'German Helles', 'Winter Warmer', 'Leipzig Gose', 'American Wild Ale', 'British Barleywine', 'Belgian IPA', 'Smoke Beer', 'Flanders Red Ale', 'Belgian Quadrupel (Quad)', 'Belgian Tripel', 'American Wheatwine Ale', 'American Malt Liquor', 'English Sweet / Milk Stout', 'Pumpkin Beer', 'English Oatmeal Stout', 'Japanese Rice Lager', 'English Old Ale', 'New England IPA', 'American Imperial Porter', 'English Brown Ale', 'German Kölsch', 'Flanders Oud Bruin', 'Braggot', 'German Altbier', 'American Cream Ale', 'Rye Beer', 'Herb and Spice Beer', 'English Strong Ale', 'Foreign / Export Stout', 'California Common / Steam Beer', 'Belgian Fruit Lambic', 'German Maibock', 'French Bière de Garde', 'Finnish Sahti', 'Russian Kvass', 'Vienna Lager', 'German Rauchbier', 'English Extra Special / Strong Bitter (ESB)', 'German Bock', 'Belgian Strong Pale Ale', 'American Imperial Red Ale', 'Belgian Blonde Ale', 'English Dark Mild Ale']
JP: ['German Pilsner', 'German Hefeweizen', 'American Amber / Red Ale', 'American Stout', 'German Altbier', 'European Dark Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Porter', 'English Porter', 'Bohemian Pilsener', 'American Strong Ale', 'American IPA', 'German Bock', 'German Weizenbock', 'Vienna Lager', 'American Lager', 'German Kölsch', 'English Brown Ale', 'German Schwarzbier', 'American Blonde Ale', 'Fruit and Field Beer', 'American Pale Ale (APA)', 'American Brown Ale', 'Japanese Rice Lager', 'German Helles', 'German Märzen / Oktoberfest', 'Munich Dunkel Lager', 'Pumpkin Beer', 'Low Alcohol Beer', 'American Amber / Red Lager', 'Belgian Witbier', 'American Adjunct Lager', 'European Pale Lager', 'European Export / Dortmunder', 'Japanese Happoshu', 'English Bitter', 'European Strong Lager', 'American Light Lager', 'English Sweet / Milk Stout', 'Belgian IPA', 'British Barleywine', 'Belgian Saison', 'Herb and Spice Beer', 'English Stout', 'American Pale Wheat Ale', 'Russian Imperial Stout', 'German Dunkelweizen', 'American Wheatwine Ale', 'English Pale Ale', 'German Rauchbier', 'Irish Dry Stout', 'American Imperial IPA', 'Leipzig Gose', 'Belgian Pale Ale', 'English India Pale Ale (IPA)', 'Belgian Blonde Ale', 'Irish Red Ale', 'Belgian Strong Dark Ale', 'German Doppelbock', 'Foreign / Export Stout', 'Belgian Tripel', 'American Imperial Porter', 'American Imperial Stout', 'Scotch Ale / Wee Heavy', 'New England IPA', 'American Imperial Red Ale', 'Belgian Fruit Lambic', 'Scottish Ale', 'English Old Ale', 'American Dark Wheat Ale', 'American Black Ale', 'American Barleywine', 'American Imperial Pilsner', 'German Maibock', 'English Oatmeal Stout', 'Smoke Beer', 'Baltic Porter', 'California Common / Steam Beer', 'Berliner Weisse', 'Belgian Strong Pale Ale', 'Rye Beer', 'Belgian Dubbel', 'English Pale Mild Ale', 'Winter Warmer', 'English Dark Mild Ale', 'American Wild Ale', 'Belgian Dark Ale', 'German Kristalweizen', 'American Malt Liquor', 'German Roggenbier', 'Belgian Lambic', 'American Cream Ale', 'German Eisbock', 'Smoke Porter']
PL: ['English Oatmeal Stout', 'American IPA', 'Belgian Saison', 'Foreign / Export Stout', 'American Stout', 'American Pale Wheat Ale', 'Belgian Witbier', 'German Pilsner', 'English Stout', 'Berliner Weisse', 'German Hefeweizen', 'American Pale Ale (APA)', 'European Pale Lager', 'Winter Warmer', 'Bohemian Pilsener', 'European Strong Lager', 'Smoke Beer', 'American Wild Ale', 'Herb and Spice Beer', 'English Extra Special / Strong Bitter (ESB)', 'Leipzig Gose', 'Baltic Porter', 'American Lager', 'Fruit and Field Beer', 'American Brown Ale', 'Russian Imperial Stout', 'German Kristalweizen', 'English Porter', 'Belgian Pale Ale', 'Braggot', 'American Imperial IPA', 'Belgian IPA', 'American Amber / Red Ale', 'German Weizenbock', 'German Dunkelweizen', 'American Black Ale', 'German Märzen / Oktoberfest', 'Scotch Ale / Wee Heavy', 'German Bock', 'English Sweet / Milk Stout', 'European Dark Lager', 'Belgian Quadrupel (Quad)', 'Belgian Dubbel', 'German Kellerbier / Zwickelbier', 'British Barleywine', 'Belgian Blonde Ale', 'Vienna Lager', 'German Schwarzbier', 'English India Pale Ale (IPA)', 'American Light Lager', 'German Doppelbock', 'Russian Kvass', 'American Adjunct Lager', 'Low Alcohol Beer', 'Belgian Strong Pale Ale', 'English Pale Ale', 'American Imperial Stout', 'American Porter', 'Belgian Fruit Lambic', 'Irish Dry Stout', 'American Barleywine', 'Belgian Strong Dark Ale', 'American Blonde Ale', 'German Roggenbier', 'Flanders Red Ale', 'English Old Ale', 'American Malt Liquor', 'Munich Dunkel Lager', 'Pumpkin Beer', 'English Bitter', 'California Common / Steam Beer', 'Robust Porter', 'American Strong Ale', 'Belgian Tripel', 'Irish Red Ale', 'Rye Beer', 'Finnish Sahti', 'American Imperial Pilsner', 'New England IPA', 'German Rauchbier', 'American Cream Ale', 'English Pale Mild Ale', 'English Brown Ale', 'English Dark Mild Ale', 'American Wheatwine Ale', 'French Bière de Garde', 'German Helles', 'German Maibock', 'German Altbier', 'European Export / Dortmunder', 'Belgian Dark Ale', 'American Brett', 'Scottish Ale', 'German Eisbock']
CH: ['European Pale Lager', 'European Export / Dortmunder', 'German Helles', 'German Pilsner', 'German Kellerbier / Zwickelbier', 'Fruit and Field Beer', 'English Brown Ale', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'German Hefeweizen', 'English Old Ale', 'Belgian Strong Pale Ale', 'American Porter', 'American Strong Ale', 'Belgian IPA', 'Russian Imperial Stout', 'American Blonde Ale', 'American IPA', 'American Imperial IPA', 'Irish Dry Stout', 'American Imperial Stout', 'Herb and Spice Beer', 'English Pale Ale', 'American Black Ale', 'Pumpkin Beer', 'German Altbier', 'German Märzen / Oktoberfest', 'European Dark Lager', 'Vienna Lager', 'German Schwarzbier', 'German Bock', 'American Lager', 'English Porter', 'English Bitter', 'Belgian Strong Dark Ale', 'Munich Dunkel Lager', 'German Dunkelweizen', 'German Weizenbock', 'Belgian Dark Ale', 'Belgian Pale Ale', 'Belgian Witbier', 'Belgian Dubbel', 'Smoke Beer', 'American Stout', 'English India Pale Ale (IPA)', 'California Common / Steam Beer', 'American Pale Wheat Ale', 'Belgian Tripel', 'American Wheatwine Ale', 'English Sweet / Milk Stout', 'American Wild Ale', 'Belgian Saison', 'English Stout', 'German Kölsch', 'English Extra Special / Strong Bitter (ESB)', 'Flanders Red Ale', 'Irish Red Ale', 'American Brett', 'Flanders Oud Bruin', 'American Brown Ale', 'Leipzig Gose', 'Belgian Fruit Lambic', 'American Cream Ale', 'American Barleywine', 'Belgian Blonde Ale', 'Baltic Porter', 'American Light Lager', 'German Maibock', 'European Strong Lager', 'Bohemian Pilsener', 'Rye Beer', 'Scotch Ale / Wee Heavy', 'French Bière de Garde', 'English Dark Mild Ale', 'New England IPA', 'English Oatmeal Stout', 'German Doppelbock', 'American Amber / Red Lager', 'Scottish Ale', 'Berliner Weisse', 'Chile Beer', 'Winter Warmer', 'American Imperial Pilsner', 'Japanese Rice Lager', 'Belgian Quadrupel (Quad)', 'German Kristalweizen', 'German Rauchbier', 'German Eisbock', 'Bière de Champagne / Bière Brut', 'British Barleywine', 'Scottish Gruit / Ancient Herbed Ale']
NO: ['European Pale Lager', 'German Pilsner', 'Vienna Lager', 'Herb and Spice Beer', 'German Bock', 'English India Pale Ale (IPA)', 'American Amber / Red Ale', 'German Hefeweizen', 'Bohemian Pilsener', 'German Doppelbock', 'American IPA', 'German Altbier', 'Belgian Witbier', 'American Blonde Ale', 'Belgian Quadrupel (Quad)', 'English Pale Ale', 'Belgian Saison', 'American Amber / Red Lager', 'English Stout', 'American Pale Wheat Ale', 'Winter Warmer', 'American Imperial Stout', 'American Pale Ale (APA)', 'English Sweet / Milk Stout', 'English Porter', 'California Common / Steam Beer', 'Fruit and Field Beer', 'English Dark Mild Ale', 'Russian Imperial Stout', 'Belgian Pale Ale', 'Belgian Tripel', 'English Brown Ale', 'Irish Dry Stout', 'Belgian Strong Dark Ale', 'French Bière de Garde', 'English Extra Special / Strong Bitter (ESB)', 'American Barleywine', 'Smoke Beer', 'English Old Ale', 'American Porter', 'American Imperial IPA', 'German Dunkelweizen', 'Belgian Dubbel', 'American Black Ale', 'American Stout', 'English Bitter', 'American Brown Ale', 'Belgian IPA', 'Belgian Strong Pale Ale', 'Scottish Ale', 'English Oatmeal Stout', 'German Rauchbier', 'European Export / Dortmunder', 'British Barleywine', 'European Dark Lager', 'German Kristalweizen', 'American Wild Ale', 'New England IPA', 'Berliner Weisse', 'Leipzig Gose', 'Munich Dunkel Lager', 'German Weizenbock', 'Baltic Porter', 'Belgian Blonde Ale', 'Belgian Dark Ale', 'Flanders Oud Bruin', 'Belgian Fruit Lambic', 'Scottish Gruit / Ancient Herbed Ale', 'Belgian Lambic', 'German Märzen / Oktoberfest', 'German Maibock', 'Irish Red Ale', 'German Kölsch', 'American Cream Ale', 'Rye Beer', 'Scotch Ale / Wee Heavy', 'Pumpkin Beer', 'American Imperial Pilsner', 'Low Alcohol Beer', 'American Imperial Porter', 'American Strong Ale', 'Finnish Sahti', 'German Schwarzbier', 'American Light Lager', 'American Lager', 'German Helles', 'American Adjunct Lager', 'European Strong Lager', 'Flanders Red Ale', 'English Strong Ale']
PH: ['Russian Imperial Stout', 'American Imperial IPA', 'Belgian Tripel', 'English Oatmeal Stout', 'American IPA', 'American Pale Wheat Ale', 'German Kölsch', 'American Wild Ale', 'American Brown Ale', 'Belgian Saison', 'English Dark Mild Ale', 'Herb and Spice Beer', 'German Dunkelweizen', 'American Imperial Stout', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'American Blonde Ale', 'American Amber / Red Ale', 'English Pale Ale', 'American Porter', 'German Hefeweizen', 'Belgian Pale Ale', 'English Sweet / Milk Stout', 'Leipzig Gose', 'American Adjunct Lager', 'Irish Red Ale', 'American Stout', 'Belgian Strong Pale Ale', 'American Lager', 'American Dark Wheat Ale', 'German Bock', 'American Strong Ale', 'Belgian Witbier', 'Rye Beer', 'English Brown Ale', 'American Cream Ale', 'English Bitter', 'Chile Beer', 'Belgian Dubbel', 'English India Pale Ale (IPA)', 'European Dark Lager', 'English Old Ale', 'European Export / Dortmunder', 'German Märzen / Oktoberfest', 'English Porter', 'Baltic Porter', 'Scotch Ale / Wee Heavy', 'Irish Dry Stout', 'Bohemian Pilsener', 'Winter Warmer', 'German Schwarzbier', 'American Light Lager', 'British Barleywine', 'German Rauchbier', 'Pumpkin Beer', 'Berliner Weisse', 'German Helles', 'German Altbier', 'English Extra Special / Strong Bitter (ESB)', 'American Brett', 'Belgian Strong Dark Ale', 'Scottish Gruit / Ancient Herbed Ale', 'California Common / Steam Beer', 'Belgian Fruit Lambic', 'German Maibock', 'German Weizenbock', 'German Doppelbock', 'Belgian Quadrupel (Quad)', 'Belgian Dark Ale', 'English Strong Ale', 'Belgian Blonde Ale', 'Vienna Lager', 'American Barleywine', 'Belgian IPA', 'American Imperial Red Ale', 'American Imperial Porter', 'American Malt Liquor', 'European Strong Lager', 'German Pilsner', 'English Stout', 'Scottish Ale', 'American Black Ale', 'French Bière de Garde', 'Japanese Happoshu', 'Belgian Lambic', 'New England IPA', 'American Amber / Red Lager', 'Munich Dunkel Lager', 'American Imperial Pilsner', 'Smoke Beer']
CL: ['Foreign / Export Stout', 'English Porter', 'English Pale Ale', 'German Altbier', 'Herb and Spice Beer', 'European Pale Lager', 'Low Alcohol Beer', 'European Export / Dortmunder', 'German Hefeweizen', 'Bohemian Pilsener', 'German Doppelbock', 'American IPA', 'German Pilsner', 'German Bock', 'American Black Ale', 'Fruit and Field Beer', 'Belgian Pale Ale', 'English Oatmeal Stout', 'Russian Imperial Stout', 'American Amber / Red Ale', 'Scotch Ale / Wee Heavy', 'American Blonde Ale', 'German Schwarzbier', 'American Adjunct Lager', 'American Light Lager', 'American Stout', 'English Sweet / Milk Stout', 'American Porter', 'English India Pale Ale (IPA)', 'American Pale Ale (APA)', 'European Strong Lager', 'Scottish Ale', 'American Brown Ale', 'Belgian Dark Ale', 'English Stout', 'Irish Red Ale', 'German Dunkelweizen', 'Belgian Saison', 'German Kölsch', 'British Barleywine', 'American Imperial IPA', 'Scottish Gruit / Ancient Herbed Ale', 'Berliner Weisse', 'Belgian Witbier', 'American Imperial Stout', 'California Common / Steam Beer', 'Baltic Porter', 'Belgian Strong Dark Ale', 'Belgian Dubbel', 'American Wild Ale', 'Belgian Quadrupel (Quad)', 'American Lager', 'American Strong Ale', 'Belgian Tripel', 'Flanders Red Ale', 'Vienna Lager', 'English Extra Special / Strong Bitter (ESB)', 'American Pale Wheat Ale', 'American Barleywine', 'Winter Warmer', 'American Wheatwine Ale', 'Japanese Rice Lager', 'German Märzen / Oktoberfest', 'European Dark Lager', 'English Brown Ale', 'Chile Beer', 'American Amber / Red Lager', 'German Maibock', 'Pumpkin Beer', 'English Bitter', 'Irish Dry Stout', 'American Cream Ale', 'Smoke Porter', 'Belgian IPA', 'Belgian Blonde Ale', 'American Imperial Pilsner', 'English Old Ale', 'German Weizenbock', 'American Imperial Red Ale', 'Rye Beer', 'Braggot', 'Leipzig Gose', 'American Brett', 'English Dark Mild Ale', 'Smoke Beer', 'American Imperial Porter', 'American Dark Wheat Ale', 'German Roggenbier', 'English Strong Ale']
AR: ['Belgian Strong Dark Ale', 'English Old Ale', 'Belgian Tripel', 'Fruit and Field Beer', 'Belgian Strong Pale Ale', 'Flanders Red Ale', 'Belgian Witbier', 'American Porter', 'American Stout', 'American Imperial IPA', 'American Wild Ale', 'Belgian Saison', 'Belgian Dubbel', 'American Pale Wheat Ale', 'Belgian Quadrupel (Quad)', 'American IPA', 'Belgian Pale Ale', 'Belgian Dark Ale', 'American Pale Ale (APA)', 'German Hefeweizen', 'Scotch Ale / Wee Heavy', 'Bière de Champagne / Bière Brut', 'Belgian Fruit Lambic', 'American Amber / Red Ale', 'German Kölsch', 'American Black Ale', 'American Blonde Ale', 'American Lager', 'Belgian IPA', 'American Barleywine', 'American Cream Ale', 'Irish Red Ale', 'Chile Beer', 'British Barleywine', 'American Imperial Porter', 'Bohemian Pilsener', 'German Bock', 'Irish Dry Stout', 'American Adjunct Lager', 'English India Pale Ale (IPA)', 'English Porter', 'American Imperial Stout', 'English Stout', 'Pumpkin Beer', 'American Brown Ale', 'German Weizenbock', 'Scottish Ale', 'American Amber / Red Lager', 'Berliner Weisse', 'German Pilsner', 'English Extra Special / Strong Bitter (ESB)', 'German Doppelbock', 'English Oatmeal Stout', 'Russian Imperial Stout', 'German Altbier', 'Smoke Beer', 'English Bitter', 'American Light Lager', 'English Pale Ale', 'Herb and Spice Beer', 'English Strong Ale', 'German Kristalweizen', 'European Pale Lager', 'Foreign / Export Stout', 'American Malt Liquor', 'European Dark Lager', 'Belgian Blonde Ale', 'Baltic Porter', 'German Dunkelweizen', 'German Märzen / Oktoberfest', 'American Strong Ale', 'Low Alcohol Beer', 'English Sweet / Milk Stout', 'Winter Warmer', 'English Brown Ale', 'Rye Beer', 'Vienna Lager', 'German Schwarzbier', 'German Rauchbier', 'Flanders Oud Bruin', 'California Common / Steam Beer', 'English Dark Mild Ale', 'German Maibock', 'American Imperial Pilsner', 'French Bière de Garde', 'German Helles', 'Leipzig Gose', 'American Dark Wheat Ale']
MX: ['German Bock', 'Russian Imperial Stout', 'Bohemian Pilsener', 'American Light Lager', 'Vienna Lager', 'American Pale Ale (APA)', 'German Schwarzbier', 'American Blonde Ale', 'English Oatmeal Stout', 'American Black Ale', 'American IPA', 'American Amber / Red Ale', 'Fruit and Field Beer', 'Belgian Witbier', 'American Imperial Red Ale', 'German Helles', 'English Brown Ale', 'German Märzen / Oktoberfest', 'Munich Dunkel Lager', 'Irish Red Ale', 'German Kölsch', 'German Pilsner', 'English Pale Ale', 'American Amber / Red Lager', 'European Export / Dortmunder', 'English Strong Ale', 'American Porter', 'English Porter', 'Belgian IPA', 'English India Pale Ale (IPA)', 'Belgian Pale Ale', 'English Stout', 'American Imperial IPA', 'Pumpkin Beer', 'American Pale Wheat Ale', 'German Weizenbock', 'American Wild Ale', 'American Stout', 'Belgian Saison', 'American Brown Ale', 'Berliner Weisse', 'Belgian Tripel', 'Herb and Spice Beer', 'Irish Dry Stout', 'German Hefeweizen', 'English Bitter', 'Belgian Strong Dark Ale', 'Belgian Strong Pale Ale', 'Scottish Ale', 'English Sweet / Milk Stout', 'American Lager', 'English Pale Mild Ale', 'German Maibock', 'American Adjunct Lager', 'California Common / Steam Beer', 'Belgian Quadrupel (Quad)', 'Robust Porter', 'American Cream Ale', 'German Altbier', 'American Imperial Stout', 'Belgian Dubbel', 'Low Alcohol Beer', 'American Barleywine', 'German Dunkelweizen', 'German Kristalweizen', 'Winter Warmer', 'Chile Beer', 'Japanese Rice Lager', 'European Dark Lager', 'American Strong Ale', 'Braggot', 'Foreign / Export Stout', 'Scottish Gruit / Ancient Herbed Ale', 'English Extra Special / Strong Bitter (ESB)', 'Smoke Beer', 'British Barleywine', 'Rye Beer', 'Belgian Blonde Ale', 'English Old Ale', 'American Malt Liquor', 'Belgian Dark Ale', 'Baltic Porter', 'German Rauchbier', 'Leipzig Gose', 'Scotch Ale / Wee Heavy', 'French Bière de Garde']
AT: ['German Weizenbock', 'German Pilsner', 'German Hefeweizen', 'German Kellerbier / Zwickelbier', 'American Pale Ale (APA)', 'European Pale Lager', 'Fruit and Field Beer', 'German Märzen / Oktoberfest', 'Bohemian Pilsener', 'Low Alcohol Beer', 'German Maibock', 'German Helles', 'German Bock', 'German Doppelbock', 'British Barleywine', 'German Eisbock', 'Winter Warmer', 'English Extra Special / Strong Bitter (ESB)', 'Pumpkin Beer', 'American Imperial Stout', 'Herb and Spice Beer', 'Vienna Lager', 'European Dark Lager', 'German Roggenbier', 'English Pale Ale', 'American IPA', 'American Imperial Pilsner', 'English Strong Ale', 'Leipzig Gose', 'German Kölsch', 'American Imperial IPA', 'Rye Beer', 'German Schwarzbier', 'Belgian Strong Pale Ale', 'Belgian Strong Dark Ale', 'Bière de Champagne / Bière Brut', 'American Amber / Red Ale', 'Irish Dry Stout', 'Chile Beer', 'American Brown Ale', 'American Blonde Ale', 'New England IPA', 'English Porter', 'English India Pale Ale (IPA)', 'Munich Dunkel Lager', 'European Export / Dortmunder', 'American Porter', 'German Dunkelweizen', 'German Altbier', 'Belgian Witbier', 'American Black Ale', 'American Wild Ale', 'American Amber / Red Lager', 'Belgian Saison', 'English Oatmeal Stout', 'French Bière de Garde', 'Scotch Ale / Wee Heavy', 'Berliner Weisse', 'Smoke Beer', 'English Brown Ale', 'English Stout', 'German Rauchbier', 'Flanders Red Ale', 'Russian Imperial Stout', 'Belgian Blonde Ale', 'Foreign / Export Stout', 'Irish Red Ale', 'Belgian IPA', 'English Bitter', 'Belgian Pale Ale', 'American Barleywine', 'English Sweet / Milk Stout', 'Belgian Dubbel', 'German Kristalweizen', 'American Light Lager', 'American Stout', 'European Strong Lager', 'Flanders Oud Bruin', 'American Brett', 'Scottish Ale', 'Smoke Porter', 'Belgian Tripel', 'Baltic Porter']
FI: ['English Porter', 'Belgian IPA', 'American Wild Ale', 'Russian Imperial Stout', 'American Porter', 'Berliner Weisse', 'American Amber / Red Ale', 'American IPA', 'American Imperial Stout', 'Belgian Pale Ale', 'American Imperial IPA', 'European Dark Lager', 'English Brown Ale', 'English Extra Special / Strong Bitter (ESB)', 'Low Alcohol Beer', 'German Pilsner', 'European Pale Lager', 'German Märzen / Oktoberfest', 'American Amber / Red Lager', 'German Hefeweizen', 'European Strong Lager', 'American Adjunct Lager', 'American Blonde Ale', 'American Lager', 'American Light Lager', 'European Export / Dortmunder', 'German Roggenbier', 'Smoke Beer', 'Baltic Porter', 'Belgian Dark Ale', 'Herb and Spice Beer', 'German Bock', 'Belgian Witbier', 'Rye Beer', 'English Strong Ale', 'Finnish Sahti', 'English Bitter', 'American Pale Ale (APA)', 'English India Pale Ale (IPA)', 'Bohemian Pilsener', 'German Dunkelweizen', 'Belgian Saison', 'American Barleywine', 'American Imperial Porter', 'Belgian Strong Dark Ale', 'American Pale Wheat Ale', 'American Stout', 'American Brown Ale', 'English Oatmeal Stout', 'German Doppelbock', 'German Schwarzbier', 'English Sweet / Milk Stout', 'British Barleywine', 'Braggot', 'German Maibock', 'German Rauchbier', 'Irish Dry Stout', 'English Pale Ale', 'Belgian Dubbel', 'Fruit and Field Beer', 'Belgian Blonde Ale', 'German Helles', 'American Cream Ale', 'American Black Ale', 'Chile Beer', 'Vienna Lager', 'Scotch Ale / Wee Heavy', 'Munich Dunkel Lager', 'Winter Warmer', 'English Stout', 'Irish Red Ale', 'Belgian Tripel', 'German Weizenbock', 'California Common / Steam Beer', 'German Kristalweizen', 'Pumpkin Beer', 'Belgian Strong Pale Ale', 'German Kölsch', 'Scottish Ale', 'Scottish Gruit / Ancient Herbed Ale', 'German Kellerbier / Zwickelbier']
PT: ['American Amber / Red Lager', 'European Dark Lager', 'European Pale Lager', 'German Kölsch', 'English Porter', 'American IPA', 'Bohemian Pilsener', 'German Pilsner', 'American Imperial Stout', 'English Extra Special / Strong Bitter (ESB)', 'English Oatmeal Stout', 'Belgian Dubbel', 'British Barleywine', 'Winter Warmer', 'American Imperial IPA', 'Scotch Ale / Wee Heavy', 'German Hefeweizen', 'German Bock', 'Herb and Spice Beer', 'English Stout', 'French Bière de Garde', 'English India Pale Ale (IPA)', 'German Helles', 'Baltic Porter', 'American Amber / Red Ale', 'American Lager', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'American Stout', 'Belgian Witbier', 'Belgian Pale Ale', 'German Weizenbock', 'Irish Dry Stout', 'American Adjunct Lager', 'Belgian Saison', 'Low Alcohol Beer', 'Bière de Champagne / Bière Brut', 'European Strong Lager', 'Russian Imperial Stout', 'Munich Dunkel Lager', 'English Brown Ale', 'English Pale Ale', 'American Barleywine', 'German Dunkelweizen', 'American Wheatwine Ale', 'Belgian Tripel', 'Irish Red Ale', 'American Imperial Red Ale', 'American Black Ale', 'Vienna Lager', 'English Old Ale', 'Belgian Blonde Ale', 'Rye Beer', 'American Brown Ale', 'Berliner Weisse', 'California Common / Steam Beer', 'Finnish Sahti', 'American Wild Ale', 'Scottish Ale', 'Smoke Beer', 'English Sweet / Milk Stout', 'American Pale Wheat Ale', 'Belgian Gueuze', 'Belgian Strong Pale Ale', 'Pumpkin Beer', 'Belgian Strong Dark Ale', 'German Schwarzbier', 'New England IPA', 'Belgian Dark Ale', 'German Doppelbock', 'Leipzig Gose', 'American Brett', 'Flanders Red Ale', 'American Cream Ale', 'Belgian Quadrupel (Quad)']
HU: ['German Doppelbock', 'American IPA', 'German Dunkelweizen', 'American Pale Ale (APA)', 'English Strong Ale', 'English Pale Ale', 'German Hefeweizen', 'English Porter', 'Belgian Saison', 'English Stout', 'Belgian Dubbel', 'American Brown Ale', 'English India Pale Ale (IPA)', 'European Pale Lager', 'Fruit and Field Beer', 'Munich Dunkel Lager', 'German Pilsner', 'Belgian Witbier', 'American Adjunct Lager', 'Vienna Lager', 'European Strong Lager', 'European Export / Dortmunder', 'German Kristalweizen', 'American Imperial IPA', 'European Dark Lager', 'Baltic Porter', 'American Pale Wheat Ale', 'American Lager', 'New England IPA', 'American Light Lager', 'Bohemian Pilsener', 'Low Alcohol Beer', 'Irish Red Ale', 'Herb and Spice Beer', 'German Altbier', 'German Helles', 'German Bock', 'American Imperial Stout', 'Belgian Fruit Lambic', 'American Black Ale', 'American Blonde Ale', 'Russian Imperial Stout', 'American Stout', 'Winter Warmer', 'Braggot', 'English Bitter', 'American Wheatwine Ale', 'Belgian Tripel', 'British Barleywine', 'American Barleywine', 'German Kölsch', 'English Sweet / Milk Stout', 'American Amber / Red Ale', 'Belgian Pale Ale', 'American Imperial Porter', 'Smoke Beer', 'Scottish Ale', 'American Porter', 'American Wild Ale', 'American Brett', 'German Kellerbier / Zwickelbier', 'English Oatmeal Stout', 'Irish Dry Stout', 'German Weizenbock', 'American Strong Ale', 'Berliner Weisse', 'Leipzig Gose', 'Foreign / Export Stout', 'Belgian IPA', 'California Common / Steam Beer', 'American Imperial Pilsner', 'German Märzen / Oktoberfest']
EE: ['American Imperial IPA', 'American Black Ale', 'American IPA', 'Belgian Saison', 'American Imperial Stout', 'American Barleywine', 'Chile Beer', 'Belgian Strong Pale Ale', 'English Pale Ale', 'English Sweet / Milk Stout', 'English India Pale Ale (IPA)', 'Baltic Porter', 'Smoke Beer', 'American Porter', 'English Oatmeal Stout', 'American Brown Ale', 'English Porter', 'Rye Beer', 'Foreign / Export Stout', 'American Stout', 'Russian Imperial Stout', 'American Pale Ale (APA)', 'Bière de Champagne / Bière Brut', 'American Amber / Red Ale', 'European Pale Lager', 'European Dark Lager', 'Herb and Spice Beer', 'Fruit and Field Beer', 'German Kellerbier / Zwickelbier', 'American Pale Wheat Ale', 'German Dunkelweizen', 'German Pilsner', 'German Hefeweizen', 'German Helles', 'American Wild Ale', 'American Lager', 'Flanders Red Ale', 'American Strong Ale', 'Scotch Ale / Wee Heavy', 'Leipzig Gose', 'Scottish Gruit / Ancient Herbed Ale', 'Pumpkin Beer', 'British Barleywine', 'Berliner Weisse', 'Belgian Witbier', 'German Weizenbock', 'Irish Dry Stout', 'Finnish Sahti', 'Belgian IPA', 'New England IPA', 'Munich Dunkel Lager', 'German Märzen / Oktoberfest', 'European Export / Dortmunder', 'German Altbier', 'English Old Ale', 'Russian Kvass', 'American Blonde Ale', 'German Bock', 'European Strong Lager', 'American Adjunct Lager', 'Low Alcohol Beer', 'German Schwarzbier', 'Vienna Lager', 'German Doppelbock', 'Bohemian Pilsener', 'Belgian Strong Dark Ale', 'Braggot', 'American Light Lager']
CN: ['European Pale Lager', 'American Light Lager', 'Fruit and Field Beer', 'American Adjunct Lager', 'American IPA', 'Belgian Witbier', 'English Brown Ale', 'Pumpkin Beer', 'English Oatmeal Stout', 'American Imperial IPA', 'Baltic Porter', 'English Extra Special / Strong Bitter (ESB)', 'American Pale Wheat Ale', 'American Amber / Red Lager', 'Berliner Weisse', 'Belgian Saison', 'Belgian Dubbel', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'California Common / Steam Beer', 'American Black Ale', 'Bohemian Pilsener', 'American Imperial Stout', 'German Märzen / Oktoberfest', 'Herb and Spice Beer', 'Smoke Porter', 'German Helles', 'American Brown Ale', 'Belgian Quadrupel (Quad)', 'American Blonde Ale', 'German Pilsner', 'German Altbier', 'Vienna Lager', 'American Porter', 'Scottish Ale', 'American Stout', 'American Lager', 'European Dark Lager', 'German Hefeweizen', 'Japanese Rice Lager', 'Low Alcohol Beer', 'European Export / Dortmunder', 'American Barleywine', 'English Pale Ale', 'American Wheatwine Ale', 'Scotch Ale / Wee Heavy', 'German Weizenbock', 'English Porter', 'German Kölsch', 'English Dark Mild Ale', 'Belgian Tripel', 'Belgian Blonde Ale', 'English Stout', 'German Schwarzbier', 'Foreign / Export Stout', 'German Bock', 'German Doppelbock', 'English Sweet / Milk Stout', 'English India Pale Ale (IPA)', 'British Barleywine', 'Belgian IPA', 'American Imperial Red Ale', 'American Strong Ale', 'English Bitter', 'Belgian Dark Ale', 'Smoke Beer']
ZA: ['European Pale Lager', 'American IPA', 'German Kristalweizen', 'American Imperial IPA', 'Bohemian Pilsener', 'Berliner Weisse', 'American Blonde Ale', 'English Pale Ale', 'Belgian Witbier', 'Belgian Saison', 'English Oatmeal Stout', 'American Stout', 'German Pilsner', 'German Hefeweizen', 'Irish Red Ale', 'American Pale Ale (APA)', 'English Bitter', 'American Pale Wheat Ale', 'American Porter', 'English Stout', 'Munich Dunkel Lager', 'German Märzen / Oktoberfest', 'German Helles', 'American Amber / Red Ale', 'Herb and Spice Beer', 'German Altbier', 'English Brown Ale', 'American Lager', 'Russian Imperial Stout', 'Belgian Strong Dark Ale', 'English Sweet / Milk Stout', 'American Wild Ale', 'American Barleywine', 'Bière de Champagne / Bière Brut', 'English Pale Mild Ale', 'English India Pale Ale (IPA)', 'English Porter', 'Vienna Lager', 'English Strong Ale', 'Fruit and Field Beer', 'German Kölsch', 'German Rauchbier', 'English Dark Mild Ale', 'American Amber / Red Lager', 'Irish Dry Stout', 'European Dark Lager', 'American Light Lager', 'California Common / Steam Beer', 'English Extra Special / Strong Bitter (ESB)', 'American Adjunct Lager', 'Belgian Strong Pale Ale', 'Scottish Ale', 'British Barleywine', 'American Cream Ale', 'Belgian Pale Ale', 'Flanders Oud Bruin', 'Belgian Dark Ale', 'American Black Ale', 'German Schwarzbier', 'Belgian Tripel', 'German Maibock', 'European Strong Lager', 'German Weizenbock', 'Belgian Dubbel', 'American Strong Ale', 'Pumpkin Beer']
JM: ['English Bitter', 'English India Pale Ale (IPA)', 'English Old Ale', 'American Cream Ale', 'English Pale Ale', 'English Extra Special / Strong Bitter (ESB)', 'Herb and Spice Beer', 'Munich Dunkel Lager', 'Fruit and Field Beer', 'European Pale Lager', 'American Light Lager', 'English Porter', 'English Sweet / Milk Stout', 'American Lager', 'Irish Red Ale', 'American IPA', 'German Dunkelweizen', 'American Imperial IPA', 'American Pale Ale (APA)', 'Belgian Saison', 'American Pale Wheat Ale', 'American Brown Ale', 'Belgian Witbier', 'American Wild Ale', 'Belgian Tripel', 'European Strong Lager', 'German Hefeweizen', 'Leipzig Gose', 'English Pale Mild Ale', 'German Rauchbier', 'American Blonde Ale', 'English Oatmeal Stout', 'American Stout', 'Berliner Weisse', 'California Common / Steam Beer', 'Russian Imperial Stout', 'American Porter', 'Belgian Strong Dark Ale', 'Flanders Red Ale', 'Belgian Pale Ale', 'Bohemian Pilsener', 'German Helles', 'American Imperial Stout', 'American Brett', 'American Amber / Red Ale', 'Rye Beer', 'American Black Ale', 'Belgian IPA', 'Foreign / Export Stout', 'English Stout', 'Smoke Beer', 'German Doppelbock', 'American Barleywine', 'American Adjunct Lager', 'American Amber / Red Lager', 'English Brown Ale', 'Scotch Ale / Wee Heavy', 'German Schwarzbier', 'German Altbier', 'Irish Dry Stout', 'American Strong Ale', 'German Märzen / Oktoberfest', 'Belgian Dubbel', 'Belgian Dark Ale']
KR: ['American IPA', 'American Pale Wheat Ale', 'Belgian Dark Ale', 'American Imperial Pilsner', 'Belgian Saison', 'English Stout', 'Leipzig Gose', 'Rye Beer', 'American Pale Ale (APA)', 'Pumpkin Beer', 'Belgian Blonde Ale', 'American Amber / Red Ale', 'Scottish Ale', 'American Porter', 'American Wild Ale', 'Belgian IPA', 'Berliner Weisse', 'European Pale Lager', 'German Pilsner', 'German Dunkelweizen', 'English Brown Ale', 'Foreign / Export Stout', 'German Hefeweizen', 'Baltic Porter', 'Fruit and Field Beer', 'American Black Ale', 'Belgian Strong Pale Ale', 'American Barleywine', 'American Blonde Ale', 'Munich Dunkel Lager', 'American Adjunct Lager', 'American Lager', 'American Malt Liquor', 'Low Alcohol Beer', 'English Dark Mild Ale', 'European Dark Lager', 'American Light Lager', 'Japanese Happoshu', 'American Stout', 'German Maibock', 'English India Pale Ale (IPA)', 'Vienna Lager', 'American Imperial Stout', 'American Imperial IPA', 'German Weizenbock', 'American Brown Ale', 'New England IPA', 'Belgian Witbier', 'Irish Red Ale', 'English Sweet / Milk Stout', 'English Pale Mild Ale', 'English Oatmeal Stout', 'Bohemian Pilsener', 'English Bitter', 'English Pale Ale', 'German Schwarzbier', 'American Amber / Red Lager', 'Japanese Rice Lager', 'Irish Dry Stout', 'German Bock', 'Winter Warmer', 'English Extra Special / Strong Bitter (ESB)']
IM: ['English Brown Ale', 'English Bitter', 'English Pale Ale', 'English India Pale Ale (IPA)', 'English Dark Mild Ale', 'Winter Warmer', 'English Stout', 'American IPA', 'American Pale Ale (APA)', 'English Extra Special / Strong Bitter (ESB)', 'German Altbier', 'English Porter', 'American Pale Wheat Ale', 'American Amber / Red Lager', 'American Lager', 'American Imperial IPA', 'Belgian Dubbel', 'Scotch Ale / Wee Heavy', 'American Stout', 'English Old Ale', 'American Wild Ale', 'American Porter', 'Belgian Saison', 'German Doppelbock', 'Foreign / Export Stout', 'Herb and Spice Beer', 'English Sweet / Milk Stout', 'Baltic Porter', 'Fruit and Field Beer', 'American Brown Ale', 'Chile Beer', 'German Dunkelweizen', 'English Oatmeal Stout', 'Scottish Gruit / Ancient Herbed Ale', 'French Bière de Garde', 'English Pale Mild Ale', 'Smoke Porter', 'German Rauchbier', 'American Imperial Stout', 'American Blonde Ale', 'Scottish Ale', 'Belgian Tripel', 'German Pilsner', 'American Cream Ale', 'Russian Imperial Stout', 'German Weizenbock', 'American Barleywine', 'American Wheatwine Ale', 'Pumpkin Beer', 'German Helles', 'Belgian Gueuze', 'American Black Ale', 'American Strong Ale', 'Irish Dry Stout', 'Smoke Beer', 'German Kölsch', 'American Amber / Red Ale', 'Rye Beer', 'Vienna Lager', 'Irish Red Ale', 'German Märzen / Oktoberfest']
IS: ['English Porter', 'Fruit and Field Beer', 'German Altbier', 'European Dark Lager', 'Smoke Beer', 'European Pale Lager', 'English Sweet / Milk Stout', 'Herb and Spice Beer', 'German Pilsner', 'Bohemian Pilsener', 'English Bitter', 'American IPA', 'Vienna Lager', 'American Porter', 'Munich Dunkel Lager', 'New England IPA', 'German Kölsch', 'American Pale Wheat Ale', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'German Schwarzbier', 'American Imperial IPA', 'Belgian Pale Ale', 'American Imperial Stout', 'American Stout', 'American Blonde Ale', 'Braggot', 'English Dark Mild Ale', 'Belgian Dubbel', 'Belgian Witbier', 'Belgian Strong Pale Ale', 'Baltic Porter', 'Belgian IPA', 'Russian Imperial Stout', 'German Hefeweizen', 'American Wild Ale', 'Belgian Saison', 'American Barleywine', 'American Lager', 'Belgian Quadrupel (Quad)', 'American Wheatwine Ale', 'Belgian Strong Dark Ale', 'American Adjunct Lager', 'European Strong Lager', 'Low Alcohol Beer', 'American Light Lager', 'German Doppelbock', 'English Pale Ale', 'Leipzig Gose', 'English Brown Ale', 'German Märzen / Oktoberfest', 'Scotch Ale / Wee Heavy', 'Winter Warmer', 'English Stout', 'German Bock', 'English Extra Special / Strong Bitter (ESB)', 'German Helles', 'American Brown Ale', 'German Weizenbock', 'California Common / Steam Beer', 'Irish Red Ale']
IL: ['American Amber / Red Ale', 'Belgian Blonde Ale', 'American Porter', 'German Hefeweizen', 'Munich Dunkel Lager', 'Irish Dry Stout', 'English India Pale Ale (IPA)', 'German Pilsner', 'Belgian Tripel', 'Fruit and Field Beer', 'Bohemian Pilsener', 'Belgian Strong Pale Ale', 'American Pale Wheat Ale', 'Belgian Witbier', 'French Bière de Garde', 'American IPA', 'Foreign / Export Stout', 'American Imperial Stout', 'Winter Warmer', 'Belgian Pale Ale', 'English Pale Ale', 'Belgian Dark Ale', 'American Stout', 'Smoke Beer', 'English Porter', 'American Imperial IPA', 'American Pale Ale (APA)', 'American Adjunct Lager', 'European Dark Lager', 'American Lager', 'Vienna Lager', 'Russian Kvass', 'European Pale Lager', 'American Black Ale', 'English Oatmeal Stout', 'European Strong Lager', 'Baltic Porter', 'English Old Ale', 'American Blonde Ale', 'Scottish Ale', 'American Brown Ale', 'American Wild Ale', 'Herb and Spice Beer', 'English Extra Special / Strong Bitter (ESB)', 'English Stout', 'English Pale Mild Ale', 'Belgian Saison', 'Irish Red Ale', 'German Dunkelweizen', 'American Amber / Red Lager', 'American Malt Liquor', 'German Kellerbier / Zwickelbier', 'German Rauchbier', 'German Roggenbier', 'English Dark Mild Ale', 'English Strong Ale', 'German Maibock', 'German Doppelbock', 'Belgian Strong Dark Ale', 'German Bock']
BM: ['English India Pale Ale (IPA)', 'American Black Ale', 'English Bitter', 'Bohemian Pilsener', 'English Porter', 'German Hefeweizen', 'Fruit and Field Beer', 'American Pale Ale (APA)', 'Belgian Witbier', 'English Sweet / Milk Stout', 'American IPA', 'Belgian Saison', 'Belgian Strong Pale Ale', 'American Blonde Ale', 'American Pale Wheat Ale', 'Irish Dry Stout', 'Belgian Lambic', 'Leipzig Gose', 'American Imperial IPA', 'American Imperial Porter', 'American Imperial Stout', 'American Wild Ale', 'New England IPA', 'Berliner Weisse', 'American Amber / Red Ale', 'American Brut IPA', 'Scotch Ale / Wee Heavy', 'Irish Red Ale', 'English Oatmeal Stout', 'American Porter', 'Flanders Red Ale', 'Smoke Beer', 'Belgian Tripel', 'German Dunkelweizen', 'English Old Ale', 'Belgian Strong Dark Ale', 'German Pilsner', 'English Extra Special / Strong Bitter (ESB)', 'German Schwarzbier', 'American Strong Ale', 'American Stout', 'American Imperial Red Ale', 'American Barleywine', 'American Brown Ale', 'German Bock', 'German Märzen / Oktoberfest', 'English Brown Ale', 'Baltic Porter', 'Winter Warmer', 'Russian Imperial Stout', 'Foreign / Export Stout', 'English Pale Ale', 'Belgian Dubbel', 'English Pale Mild Ale', 'Rye Beer', 'Pumpkin Beer', 'Belgian IPA', 'French Bière de Garde', 'American Brett']
RO: ['German Hefeweizen', 'European Pale Lager', 'Bohemian Pilsener', 'Low Alcohol Beer', 'American Pale Ale (APA)', 'American Imperial IPA', 'Belgian Dark Ale', 'European Dark Lager', 'American IPA', 'Belgian IPA', 'Belgian Strong Dark Ale', 'Belgian Witbier', 'Belgian Saison', 'Belgian Tripel', 'German Bock', 'German Pilsner', 'German Märzen / Oktoberfest', 'European Strong Lager', 'Fruit and Field Beer', 'Russian Imperial Stout', 'American Porter', 'Belgian Dubbel', 'English India Pale Ale (IPA)', 'German Weizenbock', 'American Amber / Red Ale', 'American Stout', 'German Kellerbier / Zwickelbier', 'English Oatmeal Stout', 'English Sweet / Milk Stout', 'Berliner Weisse', 'Smoke Beer', 'American Pale Wheat Ale', 'British Barleywine', 'American Imperial Stout', 'Winter Warmer', 'American Black Ale', 'New England IPA', 'English Extra Special / Strong Bitter (ESB)', 'Herb and Spice Beer', 'German Helles', 'Belgian Pale Ale', 'Leipzig Gose', 'German Kölsch', 'Pumpkin Beer', 'English Bitter', 'American Lager', 'English Pale Ale', 'English Stout', 'Scotch Ale / Wee Heavy', 'Belgian Quadrupel (Quad)', 'Belgian Blonde Ale', 'English Porter', 'Vienna Lager', 'American Amber / Red Lager', 'American Brown Ale', 'German Schwarzbier', 'American Blonde Ale', 'Munich Dunkel Lager']
AW: ['Foreign / Export Stout', 'American Adjunct Lager', 'German Märzen / Oktoberfest', 'American Pale Ale (APA)', 'European Pale Lager', 'American Porter', 'German Hefeweizen', 'American IPA', 'Belgian Saison', 'German Kölsch', 'British Barleywine', 'American Imperial IPA', 'English Oatmeal Stout', 'Scottish Gruit / Ancient Herbed Ale', 'American Stout', 'Berliner Weisse', 'American Amber / Red Ale', 'American Brown Ale', 'Belgian Witbier', 'American Imperial Stout', 'California Common / Steam Beer', 'Belgian Pale Ale', 'Baltic Porter', 'Belgian Strong Dark Ale', 'Belgian Dubbel', 'American Blonde Ale', 'American Wild Ale', 'Scotch Ale / Wee Heavy', 'Belgian Quadrupel (Quad)', 'Low Alcohol Beer', 'American Lager', 'American Strong Ale', 'Belgian Tripel', 'Flanders Red Ale', 'Vienna Lager', 'German Pilsner', 'English Extra Special / Strong Bitter (ESB)', 'American Pale Wheat Ale', 'American Barleywine', 'Winter Warmer', 'Fruit and Field Beer', 'German Dunkelweizen', 'English Pale Ale', 'American Wheatwine Ale', 'Japanese Rice Lager', 'German Bock', 'Bohemian Pilsener', 'German Doppelbock', 'European Dark Lager', 'English India Pale Ale (IPA)', 'American Black Ale', 'Russian Imperial Stout', 'English Sweet / Milk Stout', 'English Brown Ale']
RS: ['American Pale Ale (APA)', 'American Stout', 'American Imperial IPA', 'Herb and Spice Beer', 'Rye Beer', 'American IPA', 'German Altbier', 'German Kölsch', 'German Hefeweizen', 'English Pale Mild Ale', 'Irish Dry Stout', 'American Amber / Red Ale', 'German Pilsner', 'Winter Warmer', 'European Pale Lager', 'German Kellerbier / Zwickelbier', 'Belgian Saison', 'Smoke Beer', 'Fruit and Field Beer', 'American Light Lager', 'American Amber / Red Lager', 'Vienna Lager', 'European Dark Lager', 'European Strong Lager', 'Bohemian Pilsener', 'German Schwarzbier', 'English Stout', 'Belgian Strong Pale Ale', 'American Lager', 'English Pale Ale', 'American Imperial Stout', 'Belgian Pale Ale', 'Belgian Witbier', 'English Porter', 'Belgian Blonde Ale', 'American Porter', 'English India Pale Ale (IPA)', 'Belgian Fruit Lambic', 'Belgian IPA', 'American Cream Ale', 'German Dunkelweizen', 'American Pale Wheat Ale', 'Russian Kvass', 'English Extra Special / Strong Bitter (ESB)', 'German Märzen / Oktoberfest', 'American Adjunct Lager', 'German Doppelbock', 'English Oatmeal Stout', 'Scotch Ale / Wee Heavy', 'Berliner Weisse', 'American Malt Liquor', 'American Strong Ale', 'American Black Ale', 'German Helles']
PA: ['Irish Red Ale', 'German Märzen / Oktoberfest', 'Scotch Ale / Wee Heavy', 'American Stout', 'Winter Warmer', 'American Wild Ale', 'American Porter', 'American Imperial IPA', 'American Imperial Red Ale', 'Belgian Quadrupel (Quad)', 'American Black Ale', 'American IPA', 'Belgian Tripel', 'American Amber / Red Ale', 'German Kölsch', 'American Barleywine', 'American Pale Wheat Ale', 'French Bière de Garde', 'Rye Beer', 'American Pale Ale (APA)', 'Scottish Ale', 'English Sweet / Milk Stout', 'Chile Beer', 'Fruit and Field Beer', 'California Common / Steam Beer', 'American Amber / Red Lager', 'Belgian Strong Dark Ale', 'Russian Imperial Stout', 'American Light Lager', 'European Dark Lager', 'American Adjunct Lager', 'American Brown Ale', 'English Porter', 'Belgian Pale Ale', 'English Pale Ale', 'German Pilsner', 'Irish Dry Stout', 'American Blonde Ale', 'English Brown Ale', 'Belgian Witbier', 'European Pale Lager', 'Berliner Weisse', 'Leipzig Gose', 'German Rauchbier', 'Belgian Saison', 'American Imperial Stout', 'American Lager', 'American Imperial Pilsner', 'German Hefeweizen', 'English India Pale Ale (IPA)', 'English Extra Special / Strong Bitter (ESB)', 'Herb and Spice Beer', 'German Doppelbock']
UY: ['English Oatmeal Stout', 'American Pale Ale (APA)', 'Scottish Ale', 'American Blonde Ale', 'Belgian Witbier', 'American Stout', 'Scotch Ale / Wee Heavy', 'American Cream Ale', 'English Sweet / Milk Stout', 'American IPA', 'Belgian Dubbel', 'British Barleywine', 'Foreign / Export Stout', 'Low Alcohol Beer', 'German Pilsner', 'Munich Dunkel Lager', 'American Amber / Red Ale', 'German Hefeweizen', 'American Adjunct Lager', 'American Amber / Red Lager', 'American Porter', 'European Pale Lager', 'English Pale Ale', 'English India Pale Ale (IPA)', 'Belgian Strong Dark Ale', 'English Old Ale', 'Belgian Tripel', 'Fruit and Field Beer', 'Belgian Strong Pale Ale', 'Flanders Red Ale', 'American Imperial IPA', 'American Wild Ale', 'Belgian Saison', 'American Pale Wheat Ale', 'Belgian Quadrupel (Quad)', 'Belgian Pale Ale', 'Belgian Dark Ale', 'Bière de Champagne / Bière Brut', 'Belgian Fruit Lambic', 'German Kölsch', 'American Black Ale', 'American Lager', 'Belgian IPA', 'American Barleywine', 'Irish Red Ale', 'Chile Beer', 'American Imperial Porter', 'English Porter', 'Pumpkin Beer', 'Belgian Blonde Ale', 'Herb and Spice Beer']
VN: ['European Pale Lager', 'American Adjunct Lager', 'Bohemian Pilsener', 'Munich Dunkel Lager', 'Belgian Witbier', 'American IPA', 'American Amber / Red Ale', 'American Cream Ale', 'American Imperial IPA', 'New England IPA', 'American Imperial Stout', 'American Blonde Ale', 'European Export / Dortmunder', 'German Schwarzbier', 'American Porter', 'American Pale Ale (APA)', 'English Old Ale', 'Belgian Saison', 'American Pale Wheat Ale', 'American Barleywine', 'German Kölsch', 'Berliner Weisse', 'English Extra Special / Strong Bitter (ESB)', 'Fruit and Field Beer', 'Belgian Pale Ale', 'Leipzig Gose', 'Vienna Lager', 'German Hefeweizen', 'Belgian Strong Pale Ale', 'Herb and Spice Beer', 'European Dark Lager', 'Irish Red Ale', 'German Helles', 'English Stout', 'Rye Beer', 'English India Pale Ale (IPA)', 'American Amber / Red Lager', 'Belgian Strong Dark Ale', 'Braggot', 'American Wild Ale', 'American Brown Ale', 'English Sweet / Milk Stout', 'Winter Warmer', 'Foreign / Export Stout', 'Smoke Beer', 'Pumpkin Beer', 'English Porter', 'German Pilsner', 'German Altbier']
EC: ['American IPA', 'American Blonde Ale', 'Scottish Ale', 'American Porter', 'American Stout', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'Belgian IPA', 'German Hefeweizen', 'Fruit and Field Beer', 'American Barleywine', 'German Helles', 'American Imperial Stout', 'German Maibock', 'Herb and Spice Beer', 'Belgian Strong Dark Ale', 'Smoke Beer', 'Low Alcohol Beer', 'Russian Imperial Stout', 'German Eisbock', 'Irish Red Ale', 'American Adjunct Lager', 'Belgian Pale Ale', 'Munich Dunkel Lager', 'Belgian Tripel', 'Belgian Witbier', 'American Cream Ale', 'English Pale Ale', 'English Porter', 'German Pilsner', 'Bohemian Pilsener', 'Belgian Strong Pale Ale', 'American Amber / Red Lager', 'English India Pale Ale (IPA)', 'English Oatmeal Stout', 'Belgian Saison', 'American Brown Ale', 'American Black Ale', 'American Light Lager', 'Vienna Lager', 'German Doppelbock', 'German Altbier', 'German Kristalweizen', 'German Kölsch']
BS: ['Fruit and Field Beer', 'Foreign / Export Stout', 'American Adjunct Lager', 'American Light Lager', 'American IPA', 'Belgian Witbier', 'Herb and Spice Beer', 'American Imperial Stout', 'Bohemian Pilsener', 'American Stout', 'American Porter', 'German Kölsch', 'American Cream Ale', 'Russian Imperial Stout', 'American Brown Ale', 'Winter Warmer', 'American Pale Ale (APA)', 'Pumpkin Beer', 'American Dark Wheat Ale', 'German Märzen / Oktoberfest', 'American Blonde Ale', 'English Brown Ale', 'American Pale Wheat Ale', 'Munich Dunkel Lager', 'English Bitter', 'English Oatmeal Stout', 'German Maibock', 'English Pale Mild Ale', 'Berliner Weisse', 'Belgian Saison', 'American Amber / Red Ale', 'American Barleywine', 'American Imperial IPA', 'German Altbier', 'New England IPA', 'American Lager', 'American Wild Ale', 'American Strong Ale', 'American Black Ale', 'Belgian Pale Ale', 'American Amber / Red Lager', 'European Pale Lager', 'American Malt Liquor']
IN: ['American Pale Ale (APA)', 'American Pale Wheat Ale', 'English Porter', 'German Pilsner', 'German Hefeweizen', 'English Pale Ale', 'Irish Red Ale', 'American Blonde Ale', 'Irish Dry Stout', 'American Imperial IPA', 'Belgian Witbier', 'Belgian Strong Pale Ale', 'American IPA', 'Herb and Spice Beer', 'English Stout', 'Bohemian Pilsener', 'Belgian Tripel', 'German Märzen / Oktoberfest', 'European Pale Lager', 'English Strong Ale', 'American Malt Liquor', 'American Adjunct Lager', 'American Stout', 'Belgian IPA', 'German Helles', 'Belgian Blonde Ale', 'Fruit and Field Beer', 'Belgian Pale Ale', 'Belgian Quadrupel (Quad)', 'American Amber / Red Ale', 'German Doppelbock', 'American Lager', 'American Strong Ale', 'Scottish Ale', 'German Weizenbock', 'American Light Lager', 'European Strong Lager', 'German Kölsch', 'German Kellerbier / Zwickelbier', 'English India Pale Ale (IPA)', 'American Brown Ale', 'European Dark Lager']
LR: ['European Pale Lager', 'European Dark Lager', 'American Imperial IPA', 'American IPA', 'New England IPA', 'American Pale Ale (APA)', 'American Lager', 'German Hefeweizen', 'American Stout', 'English Extra Special / Strong Bitter (ESB)', 'Belgian Strong Dark Ale', 'Belgian Dubbel', 'German Dunkelweizen', 'German Altbier', 'Bohemian Pilsener', 'German Doppelbock', 'German Märzen / Oktoberfest', 'Fruit and Field Beer', 'Belgian Strong Pale Ale', 'American Light Lager', 'Vienna Lager', 'American Amber / Red Ale', 'German Maibock', 'American Blonde Ale', 'American Amber / Red Lager', 'American Brown Ale', 'German Kölsch', 'English Oatmeal Stout', 'Belgian Pale Ale', 'American Adjunct Lager', 'German Pilsner', 'English Brown Ale', 'American Pale Wheat Ale', 'Belgian Saison', 'English Sweet / Milk Stout', 'Belgian Tripel', 'American Imperial Stout', 'American Strong Ale', 'Leipzig Gose', 'Belgian Witbier', 'American Porter', 'Munich Dunkel Lager']
LV: ['Herb and Spice Beer', 'English Bitter', 'American Amber / Red Ale', 'American Porter', 'American IPA', 'Belgian Saison', 'Belgian Dark Ale', 'Belgian Witbier', 'Fruit and Field Beer', 'British Barleywine', 'American Pale Ale (APA)', 'Braggot', 'American Imperial IPA', 'Belgian Strong Pale Ale', 'American Imperial Stout', 'English Brown Ale', 'Baltic Porter', 'English Pale Ale', 'English Oatmeal Stout', 'Leipzig Gose', 'Russian Kvass', 'European Pale Lager', 'Munich Dunkel Lager', 'Vienna Lager', 'German Pilsner', 'American Brown Ale', 'Pumpkin Beer', 'American Stout', 'German Kellerbier / Zwickelbier', 'German Schwarzbier', 'German Bock', 'European Export / Dortmunder', 'Bohemian Pilsener', 'European Strong Lager', 'American Amber / Red Lager', 'European Dark Lager', 'German Hefeweizen', 'American Blonde Ale', 'Belgian Dubbel', 'Smoke Beer', 'American Lager', 'German Märzen / Oktoberfest']
CO: ['American Adjunct Lager', 'Low Alcohol Beer', 'American Light Lager', 'Belgian Dubbel', 'English Porter', 'Scottish Ale', 'Bohemian Pilsener', 'English Brown Ale', 'English Pale Ale', 'American IPA', 'Belgian Witbier', 'English Oatmeal Stout', 'English India Pale Ale (IPA)', 'German Pilsner', 'German Hefeweizen', 'German Märzen / Oktoberfest', 'German Helles', 'German Bock', 'Fruit and Field Beer', 'English Dark Mild Ale', 'American Pale Ale (APA)', 'American Blonde Ale', 'Belgian Strong Pale Ale', 'Irish Dry Stout', 'Belgian Pale Ale', 'European Pale Lager', 'American Amber / Red Ale', 'German Kölsch', 'Irish Red Ale', 'American Lager', 'Vienna Lager', 'European Strong Lager', 'American Imperial IPA', 'American Stout', 'American Cream Ale', 'English Bitter', 'English Pale Mild Ale', 'American Porter', 'American Strong Ale', 'English Stout', 'German Kristalweizen']
SI: ['Rye Beer', 'American Black Ale', 'American Pale Ale (APA)', 'American IPA', 'German Hefeweizen', 'Robust Porter', 'American Amber / Red Ale', 'English Brown Ale', 'American Porter', 'English Porter', 'English Extra Special / Strong Bitter (ESB)', 'English Stout', 'Bohemian Pilsener', 'English Pale Ale', 'English India Pale Ale (IPA)', 'Belgian Witbier', 'European Pale Lager', 'Fruit and Field Beer', 'German Kellerbier / Zwickelbier', 'European Strong Lager', 'Munich Dunkel Lager', 'German Bock', 'German Pilsner', 'European Dark Lager', 'American Imperial IPA', 'Belgian Pale Ale', 'American Imperial Stout', 'Herb and Spice Beer', 'American Brut IPA', 'English Sweet / Milk Stout', 'Smoke Beer', 'German Doppelbock', 'Vienna Lager', 'American Light Lager', 'European Export / Dortmunder', 'American Lager', 'American Adjunct Lager', 'American Stout', 'Russian Imperial Stout', 'American Brown Ale']
HK: ['Belgian Saison', 'American Lager', 'American Imperial IPA', 'German Hefeweizen', 'American IPA', 'English Oatmeal Stout', 'Smoke Beer', 'Winter Warmer', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'American Imperial Stout', 'Bière de Champagne / Bière Brut', 'English Porter', 'Belgian Dubbel', 'American Amber / Red Ale', 'Belgian Tripel', 'American Porter', 'American Stout', 'American Pale Wheat Ale', 'New England IPA', 'English Pale Ale', 'Belgian Witbier', 'German Pilsner', 'Foreign / Export Stout', 'Berliner Weisse', 'Bohemian Pilsener', 'Vienna Lager', 'European Pale Lager', 'English India Pale Ale (IPA)', 'American Black Ale', 'Rye Beer', 'American Wild Ale', 'Leipzig Gose', 'American Brut IPA', 'German Weizenbock', 'American Blonde Ale', 'American Brown Ale', 'American Amber / Red Lager', 'English Dark Mild Ale']
BG: ['American Black Ale', 'American Stout', 'English Oatmeal Stout', 'Herb and Spice Beer', 'American Amber / Red Ale', 'German Hefeweizen', 'Fruit and Field Beer', 'American Pale Ale (APA)', 'European Dark Lager', 'American Adjunct Lager', 'European Pale Lager', 'English Bitter', 'German Schwarzbier', 'German Kellerbier / Zwickelbier', 'American IPA', 'Smoke Beer', 'American Porter', 'German Helles', 'Irish Dry Stout', 'American Pale Wheat Ale', 'Bohemian Pilsener', 'Berliner Weisse', 'English Sweet / Milk Stout', 'American Imperial IPA', 'Vienna Lager', 'German Pilsner', 'English Pale Ale', 'Belgian Saison', 'English Porter', 'English India Pale Ale (IPA)', 'Belgian Dubbel', 'American Blonde Ale', 'Foreign / Export Stout', 'Munich Dunkel Lager', 'Low Alcohol Beer', 'German Bock', 'German Maibock', 'Belgian Blonde Ale']
VE: ['English Brown Ale', 'English India Pale Ale (IPA)', 'American Amber / Red Ale', 'Belgian Pale Ale', 'Belgian Dark Ale', 'Irish Red Ale', 'American Blonde Ale', 'Smoke Beer', 'German Dunkelweizen', 'Belgian Tripel', 'American Imperial IPA', 'American Pale Ale (APA)', 'American IPA', 'Rye Beer', 'Pumpkin Beer', 'Herb and Spice Beer', 'Vienna Lager', 'American Amber / Red Lager', 'American Black Ale', 'Belgian Saison', 'American Porter', 'Belgian Dubbel', 'American Pale Wheat Ale', 'Baltic Porter', 'American Imperial Stout', 'American Lager', 'American Brown Ale', 'Belgian IPA', 'German Hefeweizen', 'American Stout', 'English Oatmeal Stout', 'German Weizenbock', 'German Kölsch', 'English Strong Ale', 'German Pilsner', 'American Light Lager', 'European Pale Lager', 'European Strong Lager']
HR: ['Fruit and Field Beer', 'Bohemian Pilsener', 'English Old Ale', 'European Pale Lager', 'Munich Dunkel Lager', 'German Märzen / Oktoberfest', 'American Amber / Red Ale', 'American Imperial IPA', 'German Maibock', 'German Hefeweizen', 'American Blonde Ale', 'European Dark Lager', 'American Pale Ale (APA)', 'American Adjunct Lager', 'American Pale Wheat Ale', 'American IPA', 'Russian Imperial Stout', 'American Porter', 'English Bitter', 'American Brown Ale', 'New England IPA', 'Foreign / Export Stout', 'Berliner Weisse', 'English Stout', 'English India Pale Ale (IPA)', 'Rye Beer', 'German Dunkelweizen', 'American Light Lager', 'Belgian Witbier', 'European Strong Lager', 'Low Alcohol Beer', 'American Amber / Red Lager', 'Irish Red Ale', 'German Helles', 'English Pale Ale', 'Vienna Lager', 'German Schwarzbier']
BZ: ['American IPA', 'Belgian Saison', 'American Imperial Pilsner', 'Belgian Pale Ale', 'Belgian Strong Dark Ale', 'Belgian Blonde Ale', 'Belgian IPA', 'Belgian Tripel', 'American Pale Ale (APA)', 'American Wild Ale', 'Belgian Quadrupel (Quad)', 'American Blonde Ale', 'New England IPA', 'Fruit and Field Beer', 'Irish Dry Stout', 'Belgian Dubbel', 'American Imperial IPA', 'German Hefeweizen', 'Bohemian Pilsener', 'American Imperial Stout', 'German Schwarzbier', 'American Brown Ale', 'American Light Lager', 'American Porter', 'American Amber / Red Ale', 'German Pilsner', 'German Weizenbock', 'English Bitter', 'American Barleywine', 'English Extra Special / Strong Bitter (ESB)', 'American Stout', 'Foreign / Export Stout', 'American Adjunct Lager', 'English Sweet / Milk Stout', 'European Pale Lager', 'American Lager']
PR: ['German Schwarzbier', 'European Dark Lager', 'American Lager', 'German Roggenbier', 'German Kölsch', 'German Hefeweizen', 'German Märzen / Oktoberfest', 'American Blonde Ale', 'American Pale Ale (APA)', 'English Sweet / Milk Stout', 'German Helles', 'American Pale Wheat Ale', 'American IPA', 'Fruit and Field Beer', 'American Brown Ale', 'American Amber / Red Ale', 'American Imperial Stout', 'Belgian Saison', 'German Doppelbock', 'American Stout', 'American Imperial IPA', 'Bohemian Pilsener', 'American Black Ale', 'Smoke Porter', 'Vienna Lager', 'English Oatmeal Stout', 'Irish Red Ale', 'Belgian Dubbel', 'American Light Lager', 'Low Alcohol Beer', 'English Porter', 'American Porter', 'Scottish Ale', 'American Adjunct Lager', 'German Bock', 'Flanders Oud Bruin']
VI: ['English Brown Ale', 'Fruit and Field Beer', 'English Oatmeal Stout', 'American Porter', 'American Amber / Red Ale', 'German Dunkelweizen', 'American Blonde Ale', 'American Imperial IPA', 'Irish Red Ale', 'American Lager', 'American IPA', 'Scottish Gruit / Ancient Herbed Ale', 'American Stout', 'Bohemian Pilsener', 'German Doppelbock', 'Belgian Dubbel', 'American Adjunct Lager', 'English Porter', 'English India Pale Ale (IPA)', 'Vienna Lager', 'American Cream Ale', 'German Märzen / Oktoberfest', 'Belgian Witbier', 'Herb and Spice Beer', 'German Weizenbock', 'Belgian Strong Dark Ale', 'English Strong Ale', 'American Pale Ale (APA)', 'Irish Dry Stout', 'English Pale Ale', 'German Helles', 'American Brown Ale', 'Belgian Saison', 'American Imperial Stout', 'Winter Warmer', 'American Amber / Red Lager']
PE: ['American IPA', 'Belgian Witbier', 'Scottish Ale', 'Belgian Pale Ale', 'German Kölsch', 'British Barleywine', 'European Dark Lager', 'Belgian Saison', 'German Schwarzbier', 'American Adjunct Lager', 'English Sweet / Milk Stout', 'European Pale Lager', 'German Märzen / Oktoberfest', 'American Amber / Red Lager', 'German Hefeweizen', 'American Porter', 'American Black Ale', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'American Stout', 'American Strong Ale', 'English Pale Ale', 'American Blonde Ale', 'Belgian Strong Pale Ale', 'Belgian Tripel', 'American Barleywine', 'American Pale Wheat Ale', 'American Imperial Stout', 'American Brown Ale', 'German Dunkelweizen', 'Irish Dry Stout', 'English Oatmeal Stout', 'American Lager', 'Fruit and Field Beer', 'German Pilsner']
TW: ['English Stout', 'German Pilsner', 'German Hefeweizen', 'Scotch Ale / Wee Heavy', 'English Pale Ale', 'American Pale Ale (APA)', 'Vienna Lager', 'European Pale Lager', 'Munich Dunkel Lager', 'Leipzig Gose', 'American Imperial IPA', 'American IPA', 'American Pale Wheat Ale', 'Belgian Witbier', 'Fruit and Field Beer', 'American Lager', 'American Adjunct Lager', 'American Light Lager', 'Japanese Rice Lager', 'American Amber / Red Lager', 'European Dark Lager', 'Belgian Dubbel', 'Belgian Strong Dark Ale', 'Foreign / Export Stout', 'Belgian Fruit Lambic', 'Belgian Saison', 'American Amber / Red Ale', 'English India Pale Ale (IPA)', 'German Roggenbier', 'American Imperial Stout', 'Belgian Tripel', 'California Common / Steam Beer', 'English Porter', 'Herb and Spice Beer']
SK: ['American Pale Wheat Ale', 'English India Pale Ale (IPA)', 'California Common / Steam Beer', 'American Black Ale', 'American Amber / Red Ale', 'American Porter', 'European Pale Lager', 'Vienna Lager', 'European Dark Lager', 'American Adjunct Lager', 'Low Alcohol Beer', 'American IPA', 'Pumpkin Beer', 'Bohemian Pilsener', 'German Pilsner', 'Herb and Spice Beer', 'American Imperial IPA', 'Leipzig Gose', 'American Amber / Red Lager', 'European Strong Lager', 'Munich Dunkel Lager', 'American Pale Ale (APA)', 'American Imperial Pilsner', 'German Schwarzbier', 'Russian Imperial Stout', 'English Pale Ale', 'German Märzen / Oktoberfest', 'German Hefeweizen', 'German Rauchbier', 'English Stout', 'Braggot', 'Fruit and Field Beer', 'Baltic Porter']
TR: ['European Pale Lager', 'European Strong Lager', 'Vienna Lager', 'German Märzen / Oktoberfest', 'Bohemian Pilsener', 'German Pilsner', 'European Dark Lager', 'Winter Warmer', 'German Hefeweizen', 'American IPA', 'English Porter', 'Herb and Spice Beer', 'American Amber / Red Ale', 'American Blonde Ale', 'English Pale Ale', 'Fruit and Field Beer', 'American Cream Ale', 'German Rauchbier', 'German Kölsch', 'American Malt Liquor', 'Irish Red Ale', 'Low Alcohol Beer', 'German Dunkelweizen', 'Berliner Weisse', 'American Light Lager', 'American Adjunct Lager', 'Irish Dry Stout', 'German Helles', 'American Stout', 'German Doppelbock', 'English India Pale Ale (IPA)']
KH: ['European Pale Lager', 'Foreign / Export Stout', 'European Strong Lager', 'American Adjunct Lager', 'American IPA', 'American Stout', 'Belgian Witbier', 'Herb and Spice Beer', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'English Pale Ale', 'German Weizenbock', 'German Kölsch', 'American Pale Wheat Ale', 'German Hefeweizen', 'Belgian Saison', 'American Cream Ale', 'German Kellerbier / Zwickelbier', 'Bohemian Pilsener', 'Munich Dunkel Lager', 'European Dark Lager', 'German Pilsner', 'German Helles', 'American Black Ale', 'English Bitter', 'American Lager', 'English Sweet / Milk Stout', 'American Blonde Ale', 'American Porter']
BY: ['Irish Red Ale', 'European Pale Lager', 'Low Alcohol Beer', 'German Hefeweizen', 'Herb and Spice Beer', 'Russian Kvass', 'English India Pale Ale (IPA)', 'Smoke Beer', 'German Dunkelweizen', 'Baltic Porter', 'Munich Dunkel Lager', 'American Adjunct Lager', 'European Strong Lager', 'Fruit and Field Beer', 'German Pilsner', 'European Dark Lager', 'Foreign / Export Stout', 'Vienna Lager', 'American Pale Ale (APA)', 'American IPA', 'Bohemian Pilsener', 'Belgian Fruit Lambic', 'European Export / Dortmunder', 'Belgian Witbier', 'Belgian Strong Dark Ale', 'German Kellerbier / Zwickelbier', 'English Pale Ale', 'American Light Lager']
LU: ['German Pilsner', 'Belgian Witbier', 'Belgian Dark Ale', 'European Pale Lager', 'Munich Dunkel Lager', 'German Hefeweizen', 'American IPA', 'Fruit and Field Beer', 'European Dark Lager', 'Belgian Tripel', 'Belgian Pale Ale', 'New England IPA', 'American Pale Wheat Ale', 'Belgian IPA', 'English Porter', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'American Stout', 'German Dunkelweizen', 'Belgian Blonde Ale', 'Vienna Lager', 'Belgian Strong Pale Ale', 'German Kellerbier / Zwickelbier', 'American Imperial Stout', 'German Maibock', 'Bohemian Pilsener', 'English Brown Ale', 'German Helles']
KE: ['American Adjunct Lager', 'Bohemian Pilsener', 'European Pale Lager', 'American IPA', 'American Amber / Red Ale', 'Belgian Witbier', 'American Lager', 'Vienna Lager', 'Herb and Spice Beer', 'German Märzen / Oktoberfest', 'English Porter', 'German Maibock', 'English Stout', 'English Bitter', 'English Brown Ale', 'German Kristalweizen', 'Belgian Tripel', 'German Pilsner', 'English Pale Ale', 'Fruit and Field Beer', 'German Kölsch', 'German Dunkelweizen', 'Belgian Dubbel', 'German Hefeweizen', 'American Light Lager', 'European Strong Lager', 'American Brown Ale']
AG: ['American Pale Ale (APA)', 'American Stout', 'American Pale Wheat Ale', 'Irish Red Ale', 'Fruit and Field Beer', 'Belgian Pale Ale', 'American IPA', 'Irish Dry Stout', 'American Porter', 'English Pale Ale', 'American Cream Ale', 'American Brown Ale', 'American Amber / Red Ale', 'American Blonde Ale', 'American Imperial IPA', 'Belgian Saison', 'American Lager', 'American Malt Liquor', 'German Märzen / Oktoberfest', 'American Imperial Pilsner', 'American Light Lager', 'American Adjunct Lager', 'American Amber / Red Lager', 'English India Pale Ale (IPA)', 'Winter Warmer', 'California Common / Steam Beer']
CY: ['English Pale Ale', 'English Pale Mild Ale', 'English Brown Ale', 'German Pilsner', 'German Weizenbock', 'American Adjunct Lager', 'English Porter', 'American Light Lager', 'American Blonde Ale', 'Belgian Witbier', 'American Amber / Red Ale', 'Bohemian Pilsener', 'Belgian Saison', 'English Oatmeal Stout', 'German Märzen / Oktoberfest', 'American IPA', 'Vienna Lager', 'English Extra Special / Strong Bitter (ESB)', 'English Bitter', 'Irish Red Ale', 'American Pale Ale (APA)', 'American Barleywine', 'German Schwarzbier', 'Belgian Strong Pale Ale', 'English Stout', 'American Amber / Red Lager']
NI: ['American Blonde Ale', 'Irish Dry Stout', 'English Pale Ale', 'American Light Lager', 'German Doppelbock', 'European Pale Lager', 'European Dark Lager', 'Low Alcohol Beer', 'European Strong Lager', 'American Adjunct Lager', 'Belgian Saison', 'American Lager', 'American Wild Ale', 'German Kölsch', 'German Hefeweizen', 'American IPA', 'German Altbier', 'American Imperial IPA', 'American Stout', 'Fruit and Field Beer', 'Belgian Witbier', 'American Pale Ale (APA)', 'American Amber / Red Ale', 'German Kellerbier / Zwickelbier', 'German Märzen / Oktoberfest', 'American Brown Ale']
JE: ['German Maibock', 'British Barleywine', 'German Eisbock', 'Winter Warmer', 'German Bock', 'German Kellerbier / Zwickelbier', 'German Helles', 'English Extra Special / Strong Bitter (ESB)', 'Pumpkin Beer', 'American Imperial Stout', 'German Märzen / Oktoberfest', 'Bohemian Pilsener', 'Herb and Spice Beer', 'German Doppelbock', 'Vienna Lager', 'English Pale Ale', 'English Brown Ale', 'American Amber / Red Ale', 'English Bitter', 'English India Pale Ale (IPA)', 'European Pale Lager', 'English Strong Ale', 'American Brown Ale', 'English Stout', 'English Dark Mild Ale']
MD: ['European Pale Lager', 'American Amber / Red Ale', 'Russian Kvass', 'Fruit and Field Beer', 'American Adjunct Lager', 'European Strong Lager', 'American Wild Ale', 'German Weizenbock', 'American IPA', 'German Hefeweizen', 'American Pale Ale (APA)', 'Irish Dry Stout', 'British Barleywine', 'American Porter', 'English Porter', 'Berliner Weisse', 'American Stout', 'Belgian Witbier', 'American Lager', 'German Pilsner', 'American Brut IPA', 'German Kellerbier / Zwickelbier', 'Vienna Lager', 'Munich Dunkel Lager', 'English Sweet / Milk Stout']
TH: ['English Porter', 'German Hefeweizen', 'German Pilsner', 'English Extra Special / Strong Bitter (ESB)', 'Japanese Rice Lager', 'American Imperial IPA', 'American IPA', 'Munich Dunkel Lager', 'German Helles', 'American Lager', 'German Schwarzbier', 'Belgian Witbier', 'English Pale Mild Ale', 'European Pale Lager', 'American Light Lager', 'American Adjunct Lager', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'English Bitter', 'American Porter', 'Fruit and Field Beer', 'European Dark Lager', 'Foreign / Export Stout', 'American Brown Ale', 'American Pale Wheat Ale']
BA: ['American Imperial IPA', 'English Brown Ale', 'American Pale Ale (APA)', 'American Strong Ale', 'American Stout', 'American IPA', 'Rye Beer', 'American Barleywine', 'European Dark Lager', 'European Pale Lager', 'American Amber / Red Ale', 'German Hefeweizen', 'American Cream Ale', 'English Pale Ale', 'Bohemian Pilsener', 'German Schwarzbier', 'Fruit and Field Beer', 'German Kellerbier / Zwickelbier', 'Low Alcohol Beer', 'English Porter', 'Belgian Pale Ale', 'Smoke Beer']
GT: ['American Adjunct Lager', 'German Weizenbock', 'English India Pale Ale (IPA)', 'Belgian Witbier', 'English Stout', 'European Pale Lager', 'American Amber / Red Ale', 'European Dark Lager', 'German Bock', 'American Lager', 'American Light Lager', 'Vienna Lager', 'Fruit and Field Beer', 'American Porter', 'American Brown Ale', 'Belgian Pale Ale', 'Scottish Ale', 'American IPA', 'German Hefeweizen', 'American Blonde Ale']
LB: ['Fruit and Field Beer', 'Bohemian Pilsener', 'Low Alcohol Beer', 'Munich Dunkel Lager', 'German Pilsner', 'European Pale Lager', 'European Strong Lager', 'Irish Dry Stout', 'Irish Red Ale', 'American Amber / Red Ale', 'Belgian Witbier', 'Belgian Tripel', 'American Imperial Stout', 'Herb and Spice Beer', 'English Porter', 'American Black Ale', 'American IPA', 'English India Pale Ale (IPA)', 'English Stout', 'American Barleywine']
GU: ['American IPA', 'Smoke Porter', 'American Pale Ale (APA)', 'Fruit and Field Beer', 'Herb and Spice Beer', 'American Adjunct Lager', 'American Imperial IPA', 'English Sweet / Milk Stout', 'Belgian Saison', 'Scottish Ale', 'American Black Ale', 'English Strong Ale', 'American Lager', 'Irish Red Ale', 'German Märzen / Oktoberfest', 'American Porter', 'American Blonde Ale', 'American Brown Ale', 'Belgian Tripel']
GL: ['German Bock', 'European Pale Lager', 'Winter Warmer', 'American Pale Ale (APA)', 'German Pilsner', 'German Hefeweizen', 'German Maibock', 'German Doppelbock', 'American Lager', 'American Amber / Red Ale', 'German Kölsch', 'American Amber / Red Lager', 'Munich Dunkel Lager', 'German Altbier', 'English Brown Ale', 'English Pale Ale', 'Herb and Spice Beer', 'Vienna Lager']
MT: ['Bohemian Pilsener', 'English India Pale Ale (IPA)', 'European Strong Lager', 'Fruit and Field Beer', 'European Export / Dortmunder', 'English Pale Ale', 'English Pale Mild Ale', 'English Sweet / Milk Stout', 'American Adjunct Lager', 'English Strong Ale', 'European Pale Lager', 'English Bitter', 'English Porter', 'American Blonde Ale', 'Belgian Dubbel', 'Leipzig Gose', 'Irish Dry Stout', 'Belgian Witbier']
BB: ['American Lager', 'Fruit and Field Beer', 'Irish Dry Stout', 'American Adjunct Lager', 'English Dark Mild Ale', 'Low Alcohol Beer', 'American Light Lager', 'English Sweet / Milk Stout', 'German Pilsner', 'American Amber / Red Ale', 'European Strong Lager', 'Bohemian Pilsener', 'American Brown Ale', 'Belgian Witbier', 'Irish Red Ale', 'English Extra Special / Strong Bitter (ESB)', 'American Pale Ale (APA)']
BO: ['American Brown Ale', 'German Helles', 'Bohemian Pilsener', 'Munich Dunkel Lager', 'American Adjunct Lager', 'German Schwarzbier', 'American Amber / Red Lager', 'German Kölsch', 'German Märzen / Oktoberfest', 'German Bock', 'American Amber / Red Ale', 'German Kellerbier / Zwickelbier', 'Belgian Witbier', 'Belgian Pale Ale', 'German Pilsner', 'English Stout']
ID: ['Belgian Witbier', 'German Pilsner', 'Fruit and Field Beer', 'European Pale Lager', 'German Dunkelweizen', 'American Blonde Ale', 'English Stout', 'American Amber / Red Ale', 'American Pale Ale (APA)', 'American Lager', 'Bohemian Pilsener', 'Low Alcohol Beer', 'American Adjunct Lager', 'Foreign / Export Stout', 'European Strong Lager', 'Irish Dry Stout']
FO: ['American Amber / Red Ale', 'American Pale Ale (APA)', 'English Pale Ale', 'American Porter', 'American Imperial Pilsner', 'American Amber / Red Lager', 'European Pale Lager', 'American Imperial Stout', 'Bohemian Pilsener', 'European Dark Lager', 'German Pilsner', 'American Stout', 'European Strong Lager', 'German Märzen / Oktoberfest', 'Vienna Lager']
MN: ['American Lager', 'Munich Dunkel Lager', 'Bohemian Pilsener', 'Vienna Lager', 'German Maibock', 'German Pilsner', 'European Export / Dortmunder', 'European Pale Lager', 'German Doppelbock', 'German Kellerbier / Zwickelbier', 'German Weizenbock', 'German Hefeweizen', 'German Märzen / Oktoberfest', 'German Kristalweizen', 'European Dark Lager']
MU: ['Belgian Tripel', 'Belgian Witbier', 'German Märzen / Oktoberfest', 'American IPA', 'American Blonde Ale', 'German Helles', 'Belgian Strong Dark Ale', 'Smoke Beer', 'German Weizenbock', 'Belgian Quadrupel (Quad)', 'American Imperial Stout', 'European Strong Lager', 'European Pale Lager', 'American Lager', 'Fruit and Field Beer']
SV: ['American Pale Wheat Ale', 'American Lager', 'Belgian Witbier', 'German Hefeweizen', 'American IPA', 'Irish Dry Stout', 'American Amber / Red Ale', 'German Märzen / Oktoberfest', 'American Blonde Ale', 'Vienna Lager', 'American Light Lager', 'European Pale Lager', 'European Dark Lager', 'American Adjunct Lager', 'German Pilsner']
GE: ['European Dark Lager', 'German Helles', 'European Pale Lager', 'German Pilsner', 'German Hefeweizen', 'Bohemian Pilsener', 'European Strong Lager', 'German Kellerbier / Zwickelbier', 'English Porter', 'German Rauchbier', 'German Schwarzbier', 'Russian Kvass', 'American Adjunct Lager', 'Baltic Porter']
SY: ['European Pale Lager', 'American Adjunct Lager', 'German Hefeweizen', 'American Porter', 'Belgian Fruit Lambic', 'Rye Beer', 'American IPA', 'Irish Dry Stout', 'American Imperial IPA', 'American Brown Ale', 'American Light Lager', 'American Amber / Red Ale', 'American Black Ale', 'German Pilsner']
AM: ['European Pale Lager', 'Munich Dunkel Lager', 'Bohemian Pilsener', 'American Pale Ale (APA)', 'English Oatmeal Stout', 'American Blonde Ale', 'American Imperial IPA', 'American IPA', 'Vienna Lager', 'Smoke Beer', 'European Dark Lager', 'American Adjunct Lager', 'American Light Lager']
JO: ['American Malt Liquor', 'American Adjunct Lager', 'American Porter', 'English Pale Ale', 'Winter Warmer', 'Baltic Porter', 'Irish Red Ale', 'German Pilsner', 'American Blonde Ale', 'English India Pale Ale (IPA)', 'Leipzig Gose', 'American Stout', 'Scotch Ale / Wee Heavy']
SX: ['American Amber / Red Ale', 'German Hefeweizen', 'Belgian Saison', 'English Bitter', 'American Barleywine', 'American Porter', 'English Dark Mild Ale', 'Flanders Red Ale', 'American IPA', 'American Imperial Stout', 'American Pale Ale (APA)', 'American Lager', 'Fruit and Field Beer']
TZ: ['English Stout', 'English Pale Ale', 'European Strong Lager', 'Vienna Lager', 'European Pale Lager', 'Fruit and Field Beer', 'English Sweet / Milk Stout', 'American Adjunct Lager', 'German Pilsner', 'American Malt Liquor', 'English Bitter', 'American Light Lager', 'American Amber / Red Ale']
EG: ['German Hefeweizen', 'American Malt Liquor', 'European Pale Lager', 'European Strong Lager', 'German Pilsner', 'Low Alcohol Beer', 'American Amber / Red Lager', 'German Märzen / Oktoberfest', 'American Light Lager', 'European Export / Dortmunder', 'American Adjunct Lager', 'Foreign / Export Stout']
MK: ['German Pilsner', 'European Pale Lager', 'European Dark Lager', 'Fruit and Field Beer', 'German Kellerbier / Zwickelbier', 'European Strong Lager', 'German Dunkelweizen', 'German Rauchbier', 'German Hefeweizen', 'English India Pale Ale (IPA)', 'English Porter', 'American Amber / Red Lager']
RE: ['American Amber / Red Ale', 'Fruit and Field Beer', 'Belgian Witbier', 'European Pale Lager', 'American Blonde Ale', 'Belgian Dark Ale', 'Herb and Spice Beer', 'Belgian Pale Ale', 'Belgian Blonde Ale', 'American Porter', 'Belgian Tripel', 'Belgian Dubbel']
HN: ['English Porter', 'American Pale Ale (APA)', 'Irish Red Ale', 'American Stout', 'American Blonde Ale', 'American Imperial IPA', 'American Black Ale', 'Rye Beer', 'American Brown Ale', 'American Adjunct Lager', 'German Pilsner']
KG: ['European Pale Lager', 'American Pale Wheat Ale', 'Irish Red Ale', 'Foreign / Export Stout', 'Bohemian Pilsener', 'German Kölsch', 'European Export / Dortmunder', 'German Märzen / Oktoberfest', 'Munich Dunkel Lager', 'European Dark Lager', 'American Lager']
KZ: ['Bohemian Pilsener', 'European Pale Lager', 'European Dark Lager', 'European Strong Lager', 'American Adjunct Lager', 'Belgian Witbier', 'German Hefeweizen', 'German Kellerbier / Zwickelbier', 'Munich Dunkel Lager', 'German Pilsner', 'Fruit and Field Beer']
PS: ['English Stout', 'German Altbier', 'German Pilsner', 'Winter Warmer', 'Belgian Witbier', 'Low Alcohol Beer', 'English India Pale Ale (IPA)', 'German Bock', 'Belgian Pale Ale', 'Herb and Spice Beer', 'Foreign / Export Stout']
LC: ['Foreign / Export Stout', 'English Sweet / Milk Stout', 'European Pale Lager', 'American Adjunct Lager', 'Fruit and Field Beer', 'English Pale Ale', 'German Pilsner', 'Munich Dunkel Lager', 'American Amber / Red Ale', 'American Porter']
SM: ['German Pilsner', 'American IPA', 'Smoke Beer', 'English Brown Ale', 'English Bitter', 'German Kellerbier / Zwickelbier', 'German Hefeweizen', 'European Pale Lager', 'English Pale Ale', 'American Amber / Red Ale']
TT: ['American Adjunct Lager', 'English Sweet / Milk Stout', 'European Dark Lager', 'Herb and Spice Beer', 'German Helles', 'Low Alcohol Beer', 'Foreign / Export Stout', 'American Light Lager', 'Bohemian Pilsener', 'American IPA']
ZW: ['English Pale Ale', 'English Stout', 'English Bitter', 'European Pale Lager', 'English India Pale Ale (IPA)', 'Belgian Pale Ale', 'American Amber / Red Ale', 'Bohemian Pilsener', 'American Adjunct Lager', 'American Light Lager']
AL: ['European Pale Lager', 'German Maibock', 'German Hefeweizen', 'German Märzen / Oktoberfest', 'Munich Dunkel Lager', 'Bohemian Pilsener', 'American Amber / Red Lager', 'American Blonde Ale', 'European Dark Lager']
DZ: ['English Brown Ale', 'European Pale Lager', 'German Pilsner', 'American Strong Ale', 'American Light Lager', 'European Strong Lager', 'European Dark Lager', 'Munich Dunkel Lager', 'English Pale Ale']
ME: ['Fruit and Field Beer', 'American Adjunct Lager', 'German Kellerbier / Zwickelbier', 'German Doppelbock', 'European Pale Lager', 'American IPA', 'German Hefeweizen', 'European Dark Lager', 'German Märzen / Oktoberfest']
MG: ['Low Alcohol Beer', 'Belgian Witbier', 'American Imperial Pilsner', 'American Amber / Red Ale', 'American Amber / Red Lager', 'German Pilsner', 'German Hefeweizen', 'Fruit and Field Beer', 'American Blonde Ale']
UZ: ['European Pale Lager', 'American Light Lager', 'American Adjunct Lager', 'German Pilsner', 'Munich Dunkel Lager', 'European Dark Lager', 'Vienna Lager', 'American Lager', 'American Imperial Pilsner']
AD: ['American Blonde Ale', 'German Hefeweizen', 'English India Pale Ale (IPA)', 'Smoke Beer', 'German Doppelbock', 'Foreign / Export Stout', 'American Pale Ale (APA)', 'German Pilsner']
GG: ['English Bitter', 'Winter Warmer', 'English Stout', 'American Adjunct Lager', 'English Dark Mild Ale', 'American IPA', 'English Pale Ale', 'American Amber / Red Ale']
LA: ['American Lager', 'Vienna Lager', 'Belgian Witbier', 'European Dark Lager', 'Japanese Rice Lager', 'American Adjunct Lager', 'American Light Lager', 'Herb and Spice Beer']
LI: ['German Hefeweizen', 'European Pale Lager', 'Munich Dunkel Lager', 'English Sweet / Milk Stout', 'German Maibock', 'Belgian Witbier', 'German Helles', 'English India Pale Ale (IPA)']
LK: ['American Malt Liquor', 'Foreign / Export Stout', 'European Strong Lager', 'American Adjunct Lager', 'Belgian Witbier', 'European Pale Lager', 'Irish Red Ale', 'English Stout']
CW: ['Belgian Witbier', 'American Blonde Ale', 'German Märzen / Oktoberfest', 'English Brown Ale', 'American IPA', 'Fruit and Field Beer', 'European Pale Lager']
GD: ['American Amber / Red Ale', 'Belgian Witbier', 'American Blonde Ale', 'Belgian Tripel', 'American IPA', 'English Extra Special / Strong Bitter (ESB)', 'American Porter']
KP: ['German Schwarzbier', 'European Dark Lager', 'Belgian Witbier', 'European Pale Lager', 'German Hefeweizen', 'American Blonde Ale', 'American Adjunct Lager']
MY: ['Belgian Witbier', 'European Pale Lager', 'European Dark Lager', 'American Adjunct Lager', 'Foreign / Export Stout', 'American Malt Liquor', 'Low Alcohol Beer']
NP: ['European Pale Lager', 'American Malt Liquor', 'American Lager', 'American Light Lager', 'American Adjunct Lager', 'European Strong Lager', 'German Kölsch']
VU: ['European Pale Lager', 'English Porter', 'English Bitter', 'American Blonde Ale', 'American Lager', 'European Strong Lager', 'Fruit and Field Beer']
BT: ['American Adjunct Lager', 'American Lager', 'American Malt Liquor', 'German Hefeweizen', 'American Amber / Red Ale', 'English Stout']
MM: ['European Strong Lager', 'American Adjunct Lager', 'Foreign / Export Stout', 'English Stout', 'English Strong Ale', 'Herb and Spice Beer']
PF: ['European Pale Lager', 'American Adjunct Lager', 'American Amber / Red Lager', 'American Blonde Ale', 'Belgian Witbier', 'American Amber / Red Ale']
AZ: ['European Pale Lager', 'European Dark Lager', 'Bohemian Pilsener', 'European Strong Lager', 'European Export / Dortmunder']
DO: ['American Amber / Red Lager', 'Bohemian Pilsener', 'American Light Lager', 'American Adjunct Lager', 'Low Alcohol Beer']
FJ: ['American Adjunct Lager', 'American Malt Liquor', 'European Pale Lager', 'English Bitter', 'American Blonde Ale']
GH: ['European Pale Lager', 'American Adjunct Lager', 'Foreign / Export Stout', 'Herb and Spice Beer', 'Fruit and Field Beer']
MC: ['Herb and Spice Beer', 'German Pilsner', 'Belgian Witbier', 'Fruit and Field Beer', 'Belgian Pale Ale']
MQ: ['American Light Lager', 'English Porter', 'German Hefeweizen', 'American Pale Wheat Ale', 'American Amber / Red Ale']
NG: ['European Pale Lager', 'Foreign / Export Stout', 'Low Alcohol Beer', 'American Adjunct Lager', 'European Dark Lager']
PW: ['American Stout', 'American Blonde Ale', 'British Barleywine', 'Irish Dry Stout', 'American Amber / Red Ale']
TC: ['American Adjunct Lager', 'American Amber / Red Lager', 'English India Pale Ale (IPA)', 'Foreign / Export Stout', 'German Hefeweizen']
TN: ['German Hefeweizen', 'Munich Dunkel Lager', 'German Helles', 'Low Alcohol Beer', 'European Pale Lager']
UG: ['European Strong Lager', 'American Adjunct Lager', 'European Pale Lager', 'American Lager', 'English Sweet / Milk Stout']
CG: ['European Pale Lager', 'Vienna Lager', 'Munich Dunkel Lager', 'European Dark Lager']
CV: ['European Dark Lager', 'American Adjunct Lager', 'European Strong Lager', 'European Pale Lager']
ER: ['German Pilsner', 'American Adjunct Lager', 'Low Alcohol Beer', 'Foreign / Export Stout']
GF: ['Belgian Witbier', 'Belgian Pale Ale', 'American Stout', 'American Blonde Ale']
MA: ['American Barleywine', 'European Pale Lager', 'European Strong Lager', 'Low Alcohol Beer']
MZ: ['European Pale Lager', 'American Adjunct Lager', 'Fruit and Field Beer', 'German Märzen / Oktoberfest']
NC: ['American Lager', 'American Amber / Red Ale', 'Fruit and Field Beer', 'European Pale Lager']
PG: ['European Pale Lager', 'Foreign / Export Stout', 'American Adjunct Lager', 'European Export / Dortmunder']
SR: ['European Pale Lager', 'Fruit and Field Beer', 'American Adjunct Lager', 'Foreign / Export Stout']
CI: ['European Pale Lager', 'German Bock', 'American Malt Liquor']
CK: ['English Porter', 'English Pale Ale', 'American Lager']
MW: ['Vienna Lager', 'European Pale Lager', 'English Sweet / Milk Stout']
SZ: ['Vienna Lager', 'European Pale Lager', 'Low Alcohol Beer']
TG: ['German Pilsner', 'English Brown Ale', 'European Pale Lager']
TO: ['European Pale Lager', 'European Export / Dortmunder', 'European Dark Lager']
WS: ['European Pale Lager', 'German Pilsner', 'European Strong Lager']
AE: ['Low Alcohol Beer', 'German Helles']
CM: ['European Pale Lager', 'European Dark Lager']
FM: ['American Amber / Red Lager', 'Berliner Weisse']
GM: ['European Pale Lager', 'European Export / Dortmunder']
GP: ['European Pale Lager', 'American Lager']
HT: ['American Brown Ale', 'American Adjunct Lager']
PK: ['European Strong Lager', 'European Pale Lager']
RW: ['European Pale Lager', 'European Dark Lager']
SC: ['European Pale Lager', 'English Strong Ale']
TM: ['European Pale Lager', 'Vienna Lager']
VC: ['American Adjunct Lager', 'Foreign / Export Stout']
VG: ['American Lager', 'American Imperial IPA']
ZM: ['American Adjunct Lager', 'European Pale Lager']
AO: ['European Pale Lager']
BD: ['European Pale Lager']
BF: ['European Pale Lager']
BJ: ['European Pale Lager']
BW: ['Low Alcohol Beer']
CF: ['European Pale Lager']
DM: ['American Adjunct Lager']
GA: ['European Pale Lager']
GN: ['European Pale Lager']
GQ: ['European Pale Lager']
GW: ['European Pale Lager']
IQ: ['European Pale Lager']
IR: ['Low Alcohol Beer']
LS: ['American Adjunct Lager']
LY: ['Low Alcohol Beer']
MO: ['European Pale Lager']
NE: ['European Pale Lager']
PY: ['German Pilsner']
SB: ['European Pale Lager']
SN: ['European Pale Lager']
SS: ['American Adjunct Lager']
ST: ['European Pale Lager']
TD: ['European Pale Lager']
TJ: ['European Pale Lager']
YT: ['European Pale Lager']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Node-Similarity-Algorithm"><strong>Node Similarity Algorithm</strong><a class="anchor-link" href="#Node-Similarity-Algorithm">¶</a></h5>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 5.1. Which two countries are most similiar when it comes to their top five most produced Beer styles?</span>
<span class="c1"># Step 0 - Clear graph</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""CALL gds.graph.drop('CountryBeerStyleSimilarityGraph') YIELD graphName;"""</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record graphName='beerGraphMostSimilar'&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1 - Create an appropriate graph</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        CALL gds.graph.project.cypher(</span>
<span class="s2">            'CountryBeerStyleSimilarityGraph',</span>

<span class="s2">            // Node projection: Include COUNTRIES and STYLE nodes (200 + 113 = 313 nodes)</span>
<span class="s2">            "MATCH (n)</span>
<span class="s2">            WHERE head(labels(n)) = 'COUNTRIES' OR head(labels(n)) = 'STYLE'</span>
<span class="s2">            RETURN id(n) AS id",</span>

<span class="s2">            // Relationships: COUNTRIES to top 5 most produced STYLEs (excluding countries with less than 5 styles and without a name)</span>
<span class="s2">            "MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">            WHERE size([(c)&lt;-[:BELONGS_TO]-(:CITIES)-[:IN]-(:BREWERIES)-[:BREWED]-(:BEERS)-[:HAS_STYLE]-&gt;(:STYLE) | 1]) &gt;= 5 and c.name IS NOT NULL</span>
<span class="s2">            WITH c, s, count(b) AS beerCount</span>
<span class="s2">            ORDER BY beerCount DESC</span>
<span class="s2">            WITH c, collect({styleId: id(s), count: beerCount})[0..5] AS topStyles</span>
<span class="s2">            UNWIND topStyles AS styleData</span>
<span class="s2">            RETURN id(c) AS source, styleData.styleId AS target, styleData.count AS weight"</span>
<span class="s2">    )</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error projecting graph: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1">## #  graphName='CountryBeerStyleSimilarityGraph' nodeCount=313 relationshipCount=723</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record nodeQuery="MATCH (n)\n            WHERE head(labels(n)) = 'COUNTRIES' OR head(labels(n)) = 'STYLE'\n            RETURN id(n) AS id" relationshipQuery='MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)\n            WHERE size([(c)&lt;-[:BELONGS_TO]-(:CITIES)-[:IN]-(:BREWERIES)-[:BREWED]-(:BEERS)-[:HAS_STYLE]-&gt;(:STYLE) | 1]) &gt;= 5 and c.name IS NOT NULL\n            WITH c, s, count(b) AS beerCount\n            ORDER BY beerCount DESC\n            WITH c, collect({styleId: id(s), count: beerCount})[0..5] AS topStyles\n            UNWIND topStyles AS styleData\n            RETURN id(c) AS source, styleData.styleId AS target, styleData.count AS weight' graphName='beerGraphMostSimilar' nodeCount=313 relationshipCount=723 projectMillis=4693&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [175]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1.2 - Run relationship query</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        MATCH (c:COUNTRIES)&lt;-[:BELONGS_TO]-(ci:CITIES)&lt;-[:IN]-(br:BREWERIES)-[:BREWED]-&gt;(b:BEERS)-[:HAS_STYLE]-&gt;(s:STYLE)</span>
<span class="s2">        WHERE size([(c)&lt;-[:BELONGS_TO]-(:CITIES)-[:IN]-(:BREWERIES)-[:BREWED]-(:BEERS)-[:HAS_STYLE]-&gt;(:STYLE) | 1]) &gt;= 5 and c.name IS NOT NULL</span>
<span class="s2">        WITH c, s, count(b) AS beerCount</span>
<span class="s2">        ORDER BY beerCount DESC</span>
<span class="s2">        WITH c, collect({styleId: id(s), count: beerCount})[0..5] AS topStyles</span>
<span class="s2">        UNWIND topStyles AS styleData</span>
<span class="s2">        RETURN id(c) AS source, styleData.styleId AS target, styleData.count AS weight</span>
<span class="s2">        LIMIT 10</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error projecting graph: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record source=1 target=9494220 weight=38566&gt;,
 &lt;Record source=1 target=9494228 weight=17929&gt;,
 &lt;Record source=1 target=9494236 weight=16417&gt;,
 &lt;Record source=1 target=9494241 weight=15182&gt;,
 &lt;Record source=1 target=9494237 weight=11416&gt;,
 &lt;Record source=5 target=9494220 weight=4107&gt;,
 &lt;Record source=5 target=9494228 weight=2501&gt;,
 &lt;Record source=5 target=9494241 weight=2224&gt;,
 &lt;Record source=5 target=9494236 weight=1655&gt;,
 &lt;Record source=5 target=9494237 weight=1313&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><p>The output above shows <strong><code>source</code></strong>, <strong><code>target</code></strong>, and <strong><code>weight</code></strong>, meaning that <strong>countries</strong> (source) are correctly connected to <strong>styles</strong> (target) with an appropriate weight (<strong>beer count</strong>).</p>
</li>
<li><p>From the query above we can see that our validation process was successful.</p>
<ul>
<li>From these ten distinct relationships, we can see that each of the two countries (sources) that appear are connected to 5 distinct styles (targets) with different weights (beer count), indicating a successful projection of the graph.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 2 - Run the Node Similarity Algorithm</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        CALL gds.nodeSimilarity.stream('CountryBeerStyleSimilarityGraph', {relationshipWeightProperty: 'weight'})</span>
<span class="s2">        YIELD node1, node2, similarity</span>
<span class="s2">        WITH gds.util.asNode(node1).name AS Country1,</span>
<span class="s2">             gds.util.asNode(node2).name AS Country2, similarity</span>
<span class="s2">        RETURN Country1, Country2, similarity</span>
<span class="s2">        ORDER BY similarity DESC</span>
<span class="s2">        LIMIT 3</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error running similarity: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        
<span class="c1">#     [&lt;Record Country1='ET' Country2='CU' similarity=1.0&gt;,</span>
<span class="c1">#  &lt;Record Country1='CU' Country2='ET' similarity=1.0&gt;,</span>
<span class="c1">#  &lt;Record Country1='KY' Country2='SG' similarity=0.9865016872890888&gt;]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record Country1='ET' Country2='CU' similarity=1.0&gt;,
 &lt;Record Country1='CU' Country2='ET' similarity=1.0&gt;,
 &lt;Record Country1='KY' Country2='SG' similarity=0.9865016872890888&gt;]
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [179]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\033</span><span class="s2">[1mMost Similar Countries Based on Beer Styles:</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'Country1'</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'Country2'</span><span class="p">]</span><span class="si">}</span><span class="s2"> - Similarity: </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">'similarity'</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre><span class="ansi-bold">Most Similar Countries Based on Beer Styles:</span>
ET and CU - Similarity: 1.00
CU and ET - Similarity: 1.00
KY and SG - Similarity: 0.99
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Results"><strong>Results</strong><a class="anchor-link" href="#Results">¶</a></h5><blockquote>
<p>Based on the results obtained above, we can conclude that <strong>the two most similar countries when it comes to their top five most produced beer styles are</strong>: *<strong>ET</strong>* and <strong>CU</strong> with a similarity score of $1$.</p>
</blockquote>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="5.2.-%F0%9F%8D%BA-Which-beer-is-the-most-popular-when-considering-the-number-of-users-who-reviewed-it?"><strong>5.2. 🍺 Which beer is the most popular when considering the number of users who reviewed it?</strong><a class="anchor-link" href="#5.2.-%F0%9F%8D%BA-Which-beer-is-the-most-popular-when-considering-the-number-of-users-who-reviewed-it?">¶</a></h3><div class="alert alert-block alert" style="background-color:rgb(255, 255, 255, 0); border: 0px; border-left: 10px solid rgb(243, 202, 0); padding: 10px; border-radius: 10px;">
<h4 id="Query-Organization"><strong>Query Organization</strong><a class="anchor-link" href="#Query-Organization">¶</a></h4><ol>
<li><strong>Clear Graph</strong>: Drops the existing graph to ensure a clean slate for the new graph projection.</li>
<li><strong>Create Graph</strong>: Projects <code>BEERS</code> and <code>USER</code> nodes with <code>RATED</code> relationships into <strong><code>beerGraphMostPopular</code></strong> to enable graph algorithms.</li>
<li><strong>Verify Single Relationships</strong>: Checks for multiple <strong><code>RATED</code></strong> relationships between the same <strong><code>USER-BEERS</code></strong> pairs to ensure data integrity post-migration.</li>
<li><strong>Check Multiple Reviews</strong>: Identifies users with multiple reviews for the same beer to validate if duplicates exist in the original data.</li>
<li><strong>Centrality Algorithm</strong>: Runs degree centrality on <strong><code>beerGraphMostPopular</code></strong> to find popular beers based on the number of users who reviewed them.</li>
</ol>
<h4 id="Degree-Centrality"><strong><a href="https://neo4j.com/docs/graph-data-science/current/algorithms/degree-centrality/">Degree Centrality</a></strong><a class="anchor-link" href="#Degree-Centrality">¶</a></h4><ul>
<li><strong>Degree Centrality</strong> is a measure of the number of incoming relationships to a node. In this context, it calculates the number of users who have reviewed each beer, providing insights into the popularity of beers based on the number of reviews.</li>
</ul>
$$d_i = k_i $$<p>Where:</p>
<ul>
<li>$d_i$ is the degree centrality of node $i$ (beer)</li>
<li>$k_i$ is the number of incoming relationships to node $i$ (users who reviewed the beer)</li>
</ul>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [180]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># 5.2. Which beer is the most popular when considering the number of users who reviewed it?</span>

<span class="c1"># Step 0 - Clear graph</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""CALL gds.graph.drop('beerGraphMostPopular') YIELD graphName;"""</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>ClientError('Failed to invoke procedure `gds.graph.drop`: Caused by: java.util.NoSuchElementException: Graph with name `beerGraphMostPopular` does not exist on database `neo4j`. It might exist on another database.')
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [181]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1 - Create an appropriate graph</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        CALL gds.graph.project.cypher(</span>
<span class="s2">            'beerGraphMostPopular',</span>

<span class="s2">            // Node projection: Include BEERS and USER nodes</span>
<span class="s2">            "MATCH (n)</span>
<span class="s2">             WHERE head(labels(n)) = 'BEERS' OR head(labels(n)) = 'USER'</span>
<span class="s2">             RETURN id(n) AS id",</span>

<span class="s2">            // Relationships: BEERS to USERs who reviewed them</span>
<span class="s2">            "MATCH (b:BEERS)&lt;-[:RATED]-(u:USER)</span>
<span class="s2">             RETURN id(b) AS source, id(u) AS target"</span>
<span class="s2">        )</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error creating graph: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># graphName='beerGraphMostPopular' nodeCount=482804 relationshipCount=2537753 (BEERS and USERs)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record nodeQuery="MATCH (n)\n             WHERE head(labels(n)) = 'BEERS' OR head(labels(n)) = 'USER'\n             RETURN id(n) AS id" relationshipQuery='MATCH (b:BEERS)&lt;-[:RATED]-(u:USER)\n             RETURN id(b) AS source, id(u) AS target' graphName='beerGraphMostPopular' nodeCount=482804 relationshipCount=2537753 projectMillis=3159&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>After creating the graph, we can see that_</p>
<ul>
<li><strong>Total Nodes</strong>: $482\;804$  = $417\;746$ <strong>BEERS</strong> + $33\;387$ <strong>USER</strong></li>
<li><strong>Total Relationships</strong>: $2\;537\;753$ (matches <strong><code>RATED</code></strong> count)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [182]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1.1 - Verify the graph has only 1 relationship between BEERS and USER</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        MATCH (b:BEERS)&lt;-[r:RATED]-(u:USER)</span>
<span class="s2">        WITH b, u, count(r) AS reviewCount</span>
<span class="s2">        WHERE reviewCount &gt; 1 </span>
<span class="s2">            AND b.id IS NOT NULL </span>
<span class="s2">            AND u.name IS NOT NULL         </span>
<span class="s2">        RETURN b.id AS beerId, u.name AS userName, reviewCount AS relationshipCount</span>
<span class="s2">        LIMIT 5</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Verification: Only 1 relationship exists between each BEERS and USER pair in the original data."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Verification: Multiple reviews found in original data (expected, but graph should deduplicate):"</span><span class="p">)</span>
        <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error verifying graph: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Verification: Only 1 relationship exists between each BEERS and USER pair in the original data.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>No duplicates found, confirming single relationships.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [183]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 1.2. Not consider more than one review per user for the same beer</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)&lt;-[r:RATED]-(u:USER)</span>
<span class="s2">    WITH b, u, count(r) AS reviewCount</span>
<span class="s2">    WHERE reviewCount &gt; 1</span>
<span class="s2">    WITH b, u, reviewCount</span>
<span class="s2">    ORDER BY reviewCount DESC</span>
<span class="s2">    RETURN b.name AS beerName, u.name AS userName, reviewCount AS relationshipCount</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>The result confirms that no user has rated the same beer multiple times, either because it never happened or duplicates were handled earlier.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [184]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Step 2 - Run a centrality algorithm to find the most popular beer</span>
<span class="c1"># Source: https://neo4j.com/docs/graph-data-science/current/algorithms/degree-centrality/</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">        CALL gds.degree.stream('beerGraphMostPopular')</span>
<span class="s2">        YIELD nodeId, score</span>
<span class="s2">        WITH gds.util.asNode(nodeId).name AS BeerName, score AS NumberOfReviews</span>
<span class="s2">        RETURN BeerName, NumberOfReviews</span>
<span class="s2">        ORDER BY NumberOfReviews DESC</span>
<span class="s2">        LIMIT 10</span>
<span class="s2">    """</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Most popular beer by number of users who reviewed it:"</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error running centrality: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Most popular beer by number of users who reviewed it:
[&lt;Record BeerName='Breakfast Stout' NumberOfReviews=4828.0&gt;,
 &lt;Record BeerName='90 Minute IPA' NumberOfReviews=4394.0&gt;,
 &lt;Record BeerName='Pliny The Elder' NumberOfReviews=4213.0&gt;,
 &lt;Record BeerName='Two Hearted Ale' NumberOfReviews=4168.0&gt;,
 &lt;Record BeerName='Heady Topper' NumberOfReviews=3973.0&gt;,
 &lt;Record BeerName='Sculpin IPA' NumberOfReviews=3959.0&gt;,
 &lt;Record BeerName='Hopslam Ale' NumberOfReviews=3843.0&gt;,
 &lt;Record BeerName='KBS (Kentucky Breakfast Stout)' NumberOfReviews=3709.0&gt;,
 &lt;Record BeerName='Bourbon County Brand Stout' NumberOfReviews=3615.0&gt;,
 &lt;Record BeerName='Old Rasputin' NumberOfReviews=3529.0&gt;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>Running the Degree Centrality algorithm on the <strong><code>beerGraphMostPopular</code></strong> graph, we can see that the top beer is *<strong>Breakfast Stout</strong>* (4828 users).</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<hr/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Extra-%7C-Confirm-the-Results"><strong>Extra | Confirm the Results</strong><a class="anchor-link" href="#Extra-%7C-Confirm-the-Results">¶</a></h4><ul>
<li>We can confirm the results by running without graph algorithms and checking the top 5 beers with the most reviews.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [190]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Query to find the most popular beer by the number of users who reviewed it</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)&lt;-[r:RATED]-(u:USER)</span>
<span class="s2">    WITH b, count(u) AS NumberOfUsers</span>
<span class="s2">    RETURN b.name AS BeerName, NumberOfUsers</span>
<span class="s2">    ORDER BY NumberOfUsers DESC</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Most popular beer by number of users who reviewed it:"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\033</span><span class="s2">[1mMost Popular Beer by Number of Users Who Reviewed It:</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'BeerName'</span><span class="p">]</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'NumberOfUsers'</span><span class="p">]</span><span class="si">}</span><span class="s2"> users"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Most popular beer by number of users who reviewed it:
[&lt;Record BeerName='Breakfast Stout' NumberOfUsers=4828&gt;,
 &lt;Record BeerName='90 Minute IPA' NumberOfUsers=4394&gt;,
 &lt;Record BeerName='Pliny The Elder' NumberOfUsers=4213&gt;,
 &lt;Record BeerName='Two Hearted Ale' NumberOfUsers=4168&gt;,
 &lt;Record BeerName='Heady Topper' NumberOfUsers=3973&gt;]

<span class="ansi-bold">Most Popular Beer by Number of Users Who Reviewed It:</span>
Breakfast Stout with 4828 users
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>After running the query, we can see that the top beer is *<strong>Breakfast Stout</strong>* with *<strong>4828</strong>* reviews, corroborating the results obtained with the Degree Centrality algorithm.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [189]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Alternative Query: Find the most popular beer by the number of users who reviewed it</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)&lt;-[r:RATED]-(u:USER)</span>
<span class="s2">    RETURN b.name AS BeerName, count(u) AS NumberOfUsers</span>
<span class="s2">    ORDER BY NumberOfUsers DESC</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\033</span><span class="s2">[1mMost Popular Beer by Number of Users Who Reviewed It:</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'BeerName'</span><span class="p">]</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'NumberOfUsers'</span><span class="p">]</span><span class="si">}</span><span class="s2"> users"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record BeerName='IPA' NumberOfUsers=8768&gt;,
 &lt;Record BeerName='Porter' NumberOfUsers=5877&gt;,
 &lt;Record BeerName='Imperial Stout' NumberOfUsers=5134&gt;,
 &lt;Record BeerName='Breakfast Stout' NumberOfUsers=4956&gt;,
 &lt;Record BeerName='Pale Ale' NumberOfUsers=4671&gt;,
 &lt;Record BeerName='90 Minute IPA' NumberOfUsers=4394&gt;,
 &lt;Record BeerName='Pliny The Elder' NumberOfUsers=4213&gt;,
 &lt;Record BeerName='Two Hearted Ale' NumberOfUsers=4168&gt;,
 &lt;Record BeerName='Heady Topper' NumberOfUsers=3973&gt;,
 &lt;Record BeerName='Sculpin IPA' NumberOfUsers=3959&gt;]

<span class="ansi-bold">Most Popular Beer by Number of Users Who Reviewed It:</span>
IPA with 8768 users
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>However, when we run the query without the <strong><code>WITH</code></strong> clause, we can see a different result.</li>
</ul>
<p>According to the query, the top beer is *<strong>IPA</strong>* with *<strong>8768</strong>* reviews, corresponding to the result in <strong>3.1.</strong>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [188]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Alternative Query: Find the most popular beer by the number of users who reviewed it (without reviews with BEER.id or USER.name missing)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">    MATCH (b:BEERS)&lt;-[r:RATED]-(u:USER)</span>
<span class="s2">   </span>
<span class="s2">    // Filter out invalid reviews</span>
<span class="s2">    WHERE b.id IS NOT NULL AND u.name IS NOT NULL</span>
<span class="s2">    </span>
<span class="s2">    RETURN b.name AS BeerName, count(DISTINCT u) AS NumberOfUsers</span>
<span class="s2">    ORDER BY NumberOfUsers DESC</span>
<span class="s2">    LIMIT 10</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">execute_read</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\033</span><span class="s2">[1mMost Popular Beer by Number of Users Who Reviewed It:</span><span class="se">\033</span><span class="s2">[0m"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'BeerName'</span><span class="p">]</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'NumberOfUsers'</span><span class="p">]</span><span class="si">}</span><span class="s2"> users"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>[&lt;Record BeerName='IPA' NumberOfUsers=6883&gt;,
 &lt;Record BeerName='Breakfast Stout' NumberOfUsers=4929&gt;,
 &lt;Record BeerName='Porter' NumberOfUsers=4736&gt;,
 &lt;Record BeerName='90 Minute IPA' NumberOfUsers=4393&gt;,
 &lt;Record BeerName='Imperial Stout' NumberOfUsers=4262&gt;,
 &lt;Record BeerName='Pliny The Elder' NumberOfUsers=4212&gt;,
 &lt;Record BeerName='Two Hearted Ale' NumberOfUsers=4167&gt;,
 &lt;Record BeerName='Heady Topper' NumberOfUsers=3972&gt;,
 &lt;Record BeerName='Sculpin IPA' NumberOfUsers=3958&gt;,
 &lt;Record BeerName='Hopslam Ale' NumberOfUsers=3842&gt;]

<span class="ansi-bold">Most Popular Beer by Number of Users Who Reviewed It:</span>
IPA with 6883 users
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li>Even after filtering the <strong>reviews</strong> with <strong><code>BEER.id</code></strong> or <strong><code>USER.name</code></strong> missing values, we still have the same result, but with different values.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<div class="alert alert-block alert" style="background-color:rgb(255, 255, 255, 0); border: 0px; border-left: 10px solid rgb(243, 202, 0); padding: 10px; border-radius: 10px;">
<h4 id="Comments-%7C-Interpretation-and-Discrepancies"><strong>Comments | Interpretation and Discrepancies</strong><a class="anchor-link" href="#Comments-%7C-Interpretation-and-Discrepancies">¶</a></h4><ul>
<li><p>The discrepancy between the results obtained with the Degree Centrality algorithm and the query without the <strong><code>WITH</code></strong> clause is due to the different calculations performed by each method.</p>
</li>
<li><p>Possibly, the query without the <strong><code>WITH</code></strong> clause is counting the total number of reviews for each beer, while the <strong>Degree Centrality algorithm</strong> is calculating the number of unique users who reviewed each beer.</p>
</li>
</ul>
<br/>
<hr/>
<h5 id="Conclusion"><strong>Conclusion</strong><a class="anchor-link" href="#Conclusion">¶</a></h5><ul>
<li><strong>Most Popular Beer</strong>: <strong><code>Breakfast Stout</code></strong> (4828 reviews) when considering unique users who reviewed it.</li>
<li><strong>Most Reviewed Beer</strong>: <strong><code>IPA</code></strong> (8768 reviews) when considering all reviews.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<br/>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="%F0%9F%94%97-Bibliography/References"><strong>🔗 Bibliography/References</strong><a class="anchor-link" href="#%F0%9F%94%97-Bibliography/References">¶</a></h2><p><strong><a href="https://www.hopsandhopes.nl/en/beers/snake-venom">[1]</a></strong> Hops &amp; Hopes. (2025). Snake Venom. Nederlands; Hops&amp;Hopes. <a href="https://www.hopsandhopes.nl/en/beers/snake-venom">https://www.hopsandhopes.nl/en/beers/snake-venom</a></p>
<p><strong><a href="https://neo4j.com/docs/cypher-manual/current/">[2]</a></strong> Neo4j Cypher Manual. (2025). Neo4j. <a href="https://neo4j.com/docs/cypher-manual/current/">https://neo4j.com/docs/cypher-manual/current/</a></p>
<p><strong><a href="https://neo4j.com/docs/graph-algorithms/current/">[3]</a></strong> Neo4j Graph Algorithms Manual. (2025). Neo4j. <a href="https://neo4j.com/docs/graph-algorithms/current/">https://neo4j.com/docs/graph-algorithms/current/</a></p>
<p><strong><a href="https://community.neo4j.com/t/about-db-hits-of-neo4j/12764">[4]</a></strong> Neo4j Community. (2025). About DbHits of Neo4j. <a href="https://community.neo4j.com/t/about-db-hits-of-neo4j/12764">https://community.neo4j.com/t/about-db-hits-of-neo4j/12764</a></p>
<p><strong><a href="https://stackoverflow.com/questions/60839183/what-is-difference-between-result-available-after-and-result-consumed-after">[5]</a></strong> Stack Overflow. (2020). What is the difference between result available after and result consumed after. <a href="https://stackoverflow.com/questions/60839183/what-is-difference-between-result-available-after-and-result-consumed-after">https://stackoverflow.com/questions/60839183/what-is-difference-between-result-available-after-and-result-consumed-after</a></p>
</div>
</div>
</div>
</div>
</main>
</body>
</html>
